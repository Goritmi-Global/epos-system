import{_ as Ye,c as J,r as g,w as ne,o as Ge,n as Ke,I as Je,E as We,a as re,b as l,d as M,e as p,f as t,u as m,h as Qe,p as $,g as o,F as N,i as ie,j as b,k as et,t as n,l as y,m as j,v as U,C as tt,P as at,q as V,s as r}from"./app-V2s1lVwu.js";import{_ as st}from"./Master-WElJ1C4A.js";import{s as be}from"./index-MBvvLjiN.js";import{u as lt}from"./useFormatters-DBoQqG9N.js";import{s as de}from"./index-XvgJR8h_.js";import{E as ot,a as nt,X as rt,u as Z,w as it}from"./xlsx-CFUnkIXt.js";import{I as dt}from"./importFile-BsAmPoU7.js";import{s as ut,a as ct,b as he,c as mt,d as ue}from"./index-BQ5GddxR.js";import{F as pt}from"./FilterModal-DUiOIWh-.js";import{s as vt}from"./index-UlX-uW-d.js";import{c as ft}from"./createLucideIcon-Coq8DOvK.js";import{C as gt}from"./circle-check-big-aK5XXc8q.js";import{D as bt}from"./dollar-sign-BXWY2kwf.js";import{P as ht}from"./percent-VykwpHFC.js";import{P as _e}from"./plus-BKVyIOGe.js";import{P as ye}from"./pencil-Wnn9pGcO.js";import"./index-DoagSzzV.js";import"./index-Cak9KJ6C.js";import"./index-DzFuXtkm.js";import"./sun-DZ5FTXo1.js";import"./index-BkYT2TiQ.js";import"./index-BF4Ii756.js";import"./index-DnuCJBtX.js";/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=ft("tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]),yt={class:"page-wrapper"},xt={class:"mt-3"},St={class:"row g-3"},wt={class:"card border-0 shadow-sm rounded-4"},Pt={class:"card-body d-flex align-items-center"},kt={class:"mb-0 fw-bold"},Dt={class:"text-muted mb-0 small"},Ct={class:"card border-0 shadow-lg rounded-4 mt-0"},Mt={class:"card-body"},It={class:"d-flex flex-wrap gap-2 justify-content-between align-items-center mb-3"},Vt={class:"d-flex flex-wrap gap-2 align-items-center"},Ft={class:"search-wrap"},$t={key:1,class:"form-control search-input",placeholder:"Search",disabled:"",type:"text"},Tt={class:"table-responsive"},Et={class:"table table-striped"},Nt={key:0},At={class:"fw-semibold"},Lt={class:"text-center"},Bt={class:"text-center"},jt={class:"d-inline-flex align-items-center gap-3"},Ut=["onClick"],Ot=["title"],Rt={key:1},Zt={key:0,class:"mt-4 d-flex justify-content-between align-items-center"},zt={class:"text-muted small"},qt={class:"modal fade",id:"promoModal",tabindex:"-1","aria-hidden":"true"},Xt={class:"modal-dialog modal-lg modal-dialog-centered"},Ht={class:"modal-content rounded-4"},Yt={class:"modal-header"},Gt={class:"modal-title fw-semibold"},Kt={class:"modal-body"},Jt={class:"row g-3"},Wt={class:"col-12"},Qt={key:0,class:"text-danger"},ea={class:"col-md-6"},ta={key:0,class:"text-danger"},aa={class:"col-md-6"},sa={key:0,class:"text-danger"},la={class:"col-12"},oa={key:0,class:"text-danger"},na={class:"col-md-6"},ra={key:0,class:"text-danger"},ia={class:"col-md-6"},da={key:0,class:"text-danger"},ua={class:"col-md-6"},ca={key:0,class:"text-danger"},ma={class:"col-md-6"},pa={key:0,class:"text-danger"},va={class:"col-12"},fa={key:0,class:"text-danger"},ga={class:"mt-4"},ba=["disabled"],ha={class:"mt-3"},_a={class:"card border-0 shadow-lg rounded-4 mt-0"},ya={class:"card-body"},xa={class:"d-flex flex-wrap gap-2 justify-content-between align-items-center mb-3"},Sa={class:"d-flex flex-wrap gap-2 align-items-center"},wa={class:"table-responsive"},Pa={class:"table table-striped"},ka={key:0},Da={key:1,class:"text-muted"},Ca={key:0},Ma={key:1,class:"text-muted"},Ia={key:0},Va={key:1,class:"text-muted"},Fa={class:"text-center"},$a=["onClick"],Ta={key:0},Ea={class:"modal fade",id:"promoScopeModal",tabindex:"-1","aria-hidden":"true"},Na={class:"modal-dialog modal-lg modal-dialog-centered"},Aa={class:"modal-content rounded-4"},La={class:"modal-header"},Ba={class:"modal-title fw-semibold"},ja={class:"modal-body"},Ua={class:"row g-3"},Oa={class:"col-12"},Ra={key:0,class:"text-danger"},Za={class:"col-md-6"},za={key:0,class:"text-danger"},qa={class:"col-md-6"},Xa={key:0,class:"text-danger"},Ha={class:"mt-4 text-end"},Ya=["disabled"],Ga={__name:"Index",props:{meals:{type:Array,required:!0}},setup(xe){const{formatCurrencySymbol:z,dateFmt:C}=lt(),q=xe,Se=J(()=>q.meals||[]),we=J(()=>{if(!q.meals||!Array.isArray(q.meals))return[];const a=q.meals.flatMap(s=>(s.menu_items||[]).map(S=>({...S,meal_name:s.name}))),e=[],u=new Set;for(const s of a)u.has(s.id)||(u.add(s.id),e.push(s));return e}),k=g([]),A=g(null),F=g(!1),i=g({}),ce=g(0),W=g([]),O=g(null),w=g({}),Q=g(null),Pe=[{label:"PDF",value:"pdf"},{label:"Excel",value:"excel"},{label:"CSV",value:"csv"}],ke=a=>{a.value&&(Oe(a.value),Q.value=null)},De=[{label:"Flat Amount",value:"flat"},{label:"Percentage",value:"percent"}],Ce=[{label:"Active",value:"active"},{label:"Deactive",value:"inactive"}],x=g({promo_id:null,meals:[],menu_items:[]});ne(()=>x.value.meals,a=>{},{deep:!0}),ne(()=>x.value.menu_items,a=>{},{deep:!0});const Me=["Promo Name","Type","Discount Amount","Start Date","End Date","Min Purchase","Max Discount","Status","Description"],Ie=[["Summer Sale","percent","20","2025-06-01","2025-08-31","50","100","active","Summer discount"],["Flat Discount","flat","10","2025-01-01","2025-12-31","30","","active","Flat 10 off"]],Ve=a=>{if(!a||a.length<=1){r.error("The imported file is empty.");return}a[0];const u=a.slice(1).map(d=>{const I=P=>{if(!P)return"";if(!isNaN(P)&&Number(P)>3e4){const le=Number(P),R=new Date((le-25569)*86400*1e3),oe=R.getFullYear(),Xe=String(R.getMonth()+1).padStart(2,"0"),He=String(R.getDate()).padStart(2,"0");return`${oe}-${Xe}-${He}`}if(typeof P=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(P))return P;const K=new Date(P);if(!isNaN(K.getTime())){const le=K.getFullYear(),R=String(K.getMonth()+1).padStart(2,"0"),oe=String(K.getDate()).padStart(2,"0");return`${le}-${R}-${oe}`}return""};return{name:d[0]||"",type:d[1]||"percent",discount_amount:d[2]||"",start_date:I(d[3]),end_date:I(d[4]),min_purchase:d[5]||"0",max_discount:d[6]||null,status:d[7]||"active",description:d[8]||""}}).filter(d=>d.name.trim());if(u.length===0){r.error("No valid promos found in the file.");return}const s=u.map(d=>d.name.trim().toLowerCase()),S=s.filter((d,I)=>s.indexOf(d)!==I);if(S.length>0){r.error(`Duplicate promo names found in CSV: ${[...new Set(S)].join(", ")}`);return}const _=k.value.map(d=>d.name.trim().toLowerCase()),v=u.filter(d=>_.includes(d.name.trim().toLowerCase()));if(v.length>0){const d=v.map(I=>I.name).join(", ");r.error(`Promos already exist in the table: ${d}`);return}const c=["flat","percent"];if(u.filter(d=>!c.includes(d.type.toLowerCase())).length>0){r.error("Invalid type found. Type must be either 'flat' or 'percent'.");return}const qe=["active","inactive"];if(u.filter(d=>!qe.includes(d.status.toLowerCase())).length>0){r.error("Invalid status found. Status must be either 'active' or 'inactive'.");return}V.post("/api/promos/import",{promos:u}).then(()=>{r.success("Promos imported successfully"),T()}).catch(d=>{console.error("Import error:",d);const I=d.response?.data?.message||"Import failed",P=d.response?.data?.errors||[];P.length>0?(console.error("Detailed errors:",P),r.error(`${I}: ${P.join(", ")}`)):r.error(I)})},T=async(a=1)=>{D.value=!0;try{const e=await V.get("/api/promos/all",{params:{page:a,per_page:te.value,q:E.value.trim()||null,status:h.value.stockStatus||null,category:h.value.category||null,sort_by:h.value.sortBy||null,price_min:h.value.priceMin||null,price_max:h.value.priceMax||null,date_from:h.value.dateFrom||null,date_to:h.value.dateTo||null}});k.value=e.data.data||[],e.data.pagination&&(L.value=e.data.pagination.current_page,ae.value=e.data.pagination.total,H.value=e.data.pagination.links)}catch(e){console.error("Failed to fetch promos:",e),r.error("Failed to load promos")}finally{D.value=!1}},Fe=a=>{if(!a||D.value)return;const u=new URLSearchParams(a.split("?")[1]).get("page");u&&T(parseInt(u))},me=async()=>{try{const a=await V.get("/promo-scopes");W.value=a.data.data||[]}catch(a){console.error("Failed to fetch promo scopes:",a),r.error("Failed to load promo scopes")}};Ge(async()=>{E.value="",pe.value=Date.now(),await Ke(),setTimeout(()=>{ve.value=!0;const e=document.getElementById(ee);e&&(e.value="",E.value="")},100),await T(),await me();const a=document.getElementById("promosFilterModal");a&&a.addEventListener("hidden.bs.modal",()=>{se.value||fe(),se.value=!1})});const $e=J(()=>[{label:"Total Promos",value:k.value.length,icon:_t,iconBg:"bg-light-primary",iconColor:"text-primary"},{label:"Active Promos",value:k.value.filter(a=>a.status==="active").length,icon:gt,iconBg:"bg-light-success",iconColor:"text-success"},{label:"Flat Discount",value:k.value.filter(a=>a.type==="flat").length,icon:bt,iconBg:"bg-light-warning",iconColor:"text-warning"},{label:"Percentage",value:k.value.filter(a=>a.type==="percent").length,icon:ht,iconBg:"bg-light-danger",iconColor:"text-danger"}]),E=g(""),pe=g(Date.now()),ee=`search-${Math.random().toString(36).substr(2,9)}`,ve=g(!1),X=g({sortBy:"",stockStatus:"",priceMin:null,priceMax:null,dateFrom:null,dateTo:null}),h=g({sortBy:"",stockStatus:"",category:"",priceMin:null,priceMax:null,dateFrom:null,dateTo:null}),L=g(1),te=g(10),ae=g(0),H=g([]),D=g(!1),Te=J(()=>[{id:"flat",name:"Flat"},{id:"percent",name:"Percentage"}]),se=g(!1),Ee=a=>{h.value={...a},X.value={...a},L.value=1,se.value=!0,T(1)},fe=()=>{X.value={sortBy:"",stockStatus:"",category:"",priceMin:null,priceMax:null,dateFrom:null,dateTo:null},h.value={sortBy:"",stockStatus:"",category:"",priceMin:null,priceMax:null,dateFrom:null,dateTo:null},L.value=1,T(1)},f=g({name:"",type:"percent",status:"active",start_date:"",end_date:"",min_purchase:0,max_discount:null,description:"",discount_amount:null}),Y=()=>{f.value={name:"",type:"percent",status:"active",start_date:"",end_date:"",min_purchase:0,max_discount:null,description:"",discount_amount:null},A.value=null,i.value={}},G=()=>{x.value={promo_id:null,meals:[],menu_items:[]},O.value=null,w.value={}},Ne=async()=>{F.value=!0,i.value={};try{A.value?(await V.post(`/promos/${A.value.id}`,f.value),r.success("Promo updated successfully")):(await V.post("/promos",f.value),r.success("Promo created successfully")),bootstrap.Modal.getInstance(document.getElementById("promoModal"))?.hide(),Y(),await T()}catch(a){if(console.error("❌ Error:",a.response?.data||a.message),a.response?.status===422&&a.response?.data?.errors){i.value=a.response.data.errors;const e=Object.values(a.response.data.errors).flat();r.error(e.join(`
`))}else{const e=a.response?.data?.message||"Failed to save promo";r.error(e)}}finally{F.value=!1}};let ge=null;ne(E,()=>{clearTimeout(ge),ge=setTimeout(()=>{L.value=1,T(1)},500)});const Ae=async()=>{F.value=!0,w.value={},console.log("Submitting promo scope:",x.value);try{const a={promos:x.value.promos||[],meals:x.value.meals||[],menu_items:x.value.menu_items||[]};console.log("Payload:",a),O.value?(await V.put(`/promo-scopes/${O.value.id}`,a),r.success("Promo scope updated successfully")):(await V.post("/promo-scopes",a),r.success("Promo scope created successfully")),bootstrap.Modal.getInstance(document.getElementById("promoScopeModal"))?.hide(),G(),await me()}catch(a){if(console.error("❌ Error:",a.response?.data||a.message),a.response?.status===422&&a.response?.data?.errors)w.value=a.response.data.errors,Object.values(a.response.data.errors).flat(),r.error("Please filled all the required fields.");else{const e=a.response?.data?.message||"Failed to save promo scope";r.error(e)}}finally{F.value=!1}},Le=a=>{A.value=a,f.value={name:a.name,type:a.type,status:a.status,start_date:a.start_date?new Date(a.start_date):null,end_date:a.end_date?new Date(a.end_date):null,min_purchase:a.min_purchase,max_discount:a.max_discount,description:a.description||"",discount_amount:a.discount_amount};const e=document.getElementById("promoModal");new bootstrap.Modal(e).show()},Be=a=>{O.value=a,x.value={promos:a.promos?a.promos.map(s=>s.id):[],meals:a.meals?a.meals.map(s=>s.id):[],menu_items:a.menu_items?a.menu_items.map(s=>s.id):[]};const e=document.getElementById("promoScopeModal");new bootstrap.Modal(e).show()},je=async a=>{const e=a.status==="active"?"inactive":"active";try{await V.patch(`/api/promos/${a.id}/toggle-status`,{status:e}),a.status=e,r.success(`Promo status updated to ${e}`),ce.value++}catch(u){console.error("Failed to update status:",u),r.error("Failed to update status")}};Je(()=>window.feather?.replace());const Ue=async()=>{try{return D.value=!0,(await V.get("/api/promos/all",{params:{export:"all",q:E.value.trim()||null,status:h.value.stockStatus||null,category:h.value.category||null,sort_by:h.value.sortBy||null,price_min:h.value.priceMin||null,price_max:h.value.priceMax||null,date_from:h.value.dateFrom||null,date_to:h.value.dateTo||null}})).data.data||[]}catch(a){return console.error("❌ Error fetching export data:",a),r.error("Failed to load data for export"),[]}finally{D.value=!1}},Oe=async a=>{if(!k.value||k.value.length===0){r.error("No Promos data to download");return}try{D.value=!0;const e=await Ue();if(!e.length){r.error("No promos found to download"),D.value=!1;return}a==="pdf"?Ze(e):a==="excel"?ze(e):a==="csv"?Re(e):r.error("Invalid download type")}catch(e){console.error("Download failed:",e),r.error(`Download failed: ${e.message}`)}finally{D.value=!1}},Re=a=>{try{const e=["S.#","Promo Name","Type","Discount Amount","Start Date","End Date","Min Purchase","Max Discount","Status","Description"],u=a.map((c,B)=>[`${B+1}`,`"${c.name||""}"`,`"${c.type||""}"`,`${c.discount_amount||""}`,`"${C(c.start_date)||""}"`,`"${C(c.end_date)||""}"`,`${c.min_purchase||""}`,`${c.max_discount||""}`,`"${c.status||""}"`,`"${c.description||""}"`]),s=[e.join(","),...u.map(c=>c.join(","))].join(`
`),S=new Blob([s],{type:"text/csv;charset=utf-8;"}),_=URL.createObjectURL(S),v=document.createElement("a");v.setAttribute("href",_),v.setAttribute("download",`Promos_${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(v),v.click(),document.body.removeChild(v),r.success("CSV downloaded successfully")}catch(e){console.error("CSV generation error:",e),r.error(`CSV generation failed: ${e.message}`)}},Ze=a=>{try{const e=new ot("l","mm","a4");e.setFontSize(18),e.setFont("helvetica","bold"),e.text("Promos Report",14,20),e.setFontSize(10),e.setFont("helvetica","normal");const u=new Date().toLocaleString();e.text(`Generated on: ${u}`,14,28),e.text(`Total Promos: ${a.length}`,14,34);const s=["S.#","Name","Type","Discount","Start Date","End Date","Min Purchase","Max Discount","Status"],S=a.map((v,c)=>[c+1,v.name||"",v.type==="flat"?"Flat":"Percent",v.discount_amount||"",C(v.start_date)||"",C(v.end_date)||"",z(v.min_purchase)||"",v.max_discount?z(v.max_discount):"N/A",v.status==="active"?"Active":"Inactive"]);nt(e,{head:[s],body:S,startY:40,styles:{fontSize:8,cellPadding:2,halign:"left",lineColor:[0,0,0],lineWidth:.1},headStyles:{fillColor:[41,128,185],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]},margin:{left:14,right:14},didDrawPage:v=>{const c=e.internal.getNumberOfPages(),B=e.internal.pageSize.height;e.setFontSize(8),e.text(`Page ${v.pageNumber} of ${c}`,v.settings.margin.left,B-10)}});const _=`Promos_${new Date().toISOString().split("T")[0]}.pdf`;e.save(_),r.success("PDF downloaded successfully")}catch(e){console.error("PDF generation error:",e),r.error(`PDF generation failed: ${e.message}`)}},ze=a=>{try{if(typeof rt>"u")throw new Error("XLSX library is not loaded");const e=a.map((c,B)=>({"S.#":B+1,"Promo Name":c.name||"",Type:c.type==="flat"?"Flat":"Percent","Discount Amount":c.discount_amount||"","Start Date":C(c.start_date)||"","End Date":C(c.end_date)||"","Min Purchase":c.min_purchase||"","Max Discount":c.max_discount||"",Status:c.status==="active"?"Active":"Inactive",Description:c.description||""})),u=Z.book_new(),s=Z.json_to_sheet(e);s["!cols"]=[{wch:8},{wch:25},{wch:12},{wch:15},{wch:15},{wch:15},{wch:15},{wch:15},{wch:12},{wch:30}],Z.book_append_sheet(u,s,"Promos");const S=[{Info:"Report",Value:"Promos Export"},{Info:"Generated On",Value:new Date().toLocaleString()},{Info:"Total Records",Value:a.length},{Info:"Exported By",Value:"Inventory Management System"}],_=Z.json_to_sheet(S);Z.book_append_sheet(u,_,"Report Info");const v=`Promos_${new Date().toISOString().split("T")[0]}.xlsx`;it(u,v),r.success("Excel file downloaded successfully")}catch(e){console.error("Excel generation error:",e),r.error(`Excel generation failed: ${e.message}`)}};return(a,e)=>{const u=We("VueDatePicker");return l(),re(st,null,{default:M(()=>[p(m(Qe),{title:"Promo"}),t("div",yt,[e[50]||(e[50]=t("h4",{class:"fw-semibold mb-3"},"Promo Management",-1)),p(m(ut),{value:"0",class:"w-100"},{default:M(()=>[p(m(ct),null,{default:M(()=>[p(m(he),{value:"0"},{default:M(()=>[...e[17]||(e[17]=[$("Promos",-1)])]),_:1}),p(m(he),{value:"1"},{default:M(()=>[...e[18]||(e[18]=[$("Promo Scope",-1)])]),_:1})]),_:1}),p(m(mt),null,{default:M(()=>[p(m(ue),{value:"0"},{default:M(()=>[p(m(ue),{value:"0"},{default:M(()=>[t("div",xt,[t("div",St,[(l(!0),o(N,null,ie($e.value,s=>(l(),o("div",{key:s.label,class:"col-md-6 col-xl-3"},[t("div",wt,[t("div",Pt,[t("div",{class:b([[s.iconBg,s.iconColor],"rounded-circle p-3 d-flex align-items-center justify-content-center me-3"]),style:{width:"56px",height:"56px"}},[(l(),re(et(s.icon),{class:"w-6 h-6"}))],2),t("div",null,[t("h3",kt,n(s.value),1),t("p",Dt,n(s.label),1)])])])]))),128))]),t("div",Ct,[t("div",Mt,[t("div",It,[e[22]||(e[22]=t("h5",{class:"mb-0 fw-semibold"},"Promos",-1)),t("div",Vt,[p(pt,{modelValue:X.value,"onUpdate:modelValue":e[0]||(e[0]=s=>X.value=s),title:"Promos",modalId:"promosFilterModal",modalSize:"modal-lg",sortOptions:[{value:"name_asc",label:"Name: A to Z"},{value:"name_desc",label:"Name: Z to A"}],categories:Te.value,categoryLabel:"Promo Type",statusLabel:"Promo Status",showPriceRange:!0,"show-stock-status":!1,priceRangeLabel:"Discount Amount Range",showDateRange:!0,onApply:Ee,onClear:fe},null,8,["modelValue","categories"]),t("div",Ft,[e[19]||(e[19]=t("i",{class:"bi bi-search"},null,-1)),e[20]||(e[20]=t("input",{type:"email",name:"email",autocomplete:"email",style:{position:"absolute",left:"-9999px",width:"1px",height:"1px"},tabindex:"-1","aria-hidden":"true"},null,-1)),ve.value?j((l(),o("input",{id:ee,"onUpdate:modelValue":e[1]||(e[1]=s=>E.value=s),key:pe.value,class:"form-control search-input",placeholder:"Search",type:"search",autocomplete:"new-password",name:ee,role:"presentation",onFocus:e[2]||(e[2]=(...s)=>a.handleFocus&&a.handleFocus(...s))},null,32)),[[U,E.value]]):(l(),o("input",$t))]),t("button",{"data-bs-toggle":"modal","data-bs-target":"#promoModal",onClick:Y,class:"d-flex align-items-center gap-1 px-4 py-2 rounded-pill btn btn-primary text-white"},[p(m(_e),{class:"w-4 h-4"}),e[21]||(e[21]=$(" Add Promo ",-1))]),p(dt,{label:"Import Promos",sampleHeaders:Me,sampleData:Ie,onOnImport:Ve}),p(m(vt),{modelValue:Q.value,"onUpdate:modelValue":e[3]||(e[3]=s=>Q.value=s),options:Pe,optionLabel:"label",optionValue:"value",placeholder:"Export",class:"export-dropdown",onChange:ke},null,8,["modelValue"])])]),t("div",Tt,[t("table",Et,[e[25]||(e[25]=t("thead",{class:"border-top small text-muted"},[t("tr",null,[t("th",null,"S.#"),t("th",null,"Name"),t("th",null,"Type"),t("th",null,"Start Date"),t("th",null,"End Date"),t("th",null,"Min Purchase"),t("th",null,"Max Discount"),t("th",{class:"text-center"},"Status"),t("th",{class:"text-center"},"Action")])],-1)),t("tbody",null,[D.value?(l(),o("tr",Nt,[...e[23]||(e[23]=[t("td",{colspan:"9",class:"text-center py-4"},[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")])],-1)])])):y("",!0),(l(!0),o(N,null,ie(k.value,(s,S)=>(l(),o("tr",{key:s.id},[t("td",null,n(S+1),1),t("td",At,n(s.name),1),t("td",null,[t("span",{class:b(s.type==="flat"?"badge bg-primary px-4 py-2 rounded-pill":"badge bg-warning px-4 py-2 rounded-pill")},n(s.type==="flat"?"Flat":"Percent"),3)]),t("td",null,n(m(C)(s.start_date)),1),t("td",null,n(m(C)(s.end_date)),1),t("td",null,n(m(z)(s.min_purchase)),1),t("td",null,n(s.max_discount?m(z)(s.max_discount):"N/A"),1),t("td",Lt,[t("span",{class:b(s.status==="active"?"badge bg-success px-4 py-2 rounded-pill":"badge bg-danger px-4 py-2 rounded-pill")},n(s.status==="active"?"Active":"Inactive"),3)]),t("td",Bt,[t("div",jt,[t("button",{onClick:_=>Le(s),title:"Edit",class:"p-2 rounded-full text-blue-600 hover:bg-blue-100"},[p(m(ye),{class:"w-4 h-4"})],8,Ut),(l(),re(tt,{key:`confirm-${s.id}-${ce.value}`,title:"Confirm Status Change",message:`Are you sure you want to set ${s.name} to ${s.status==="active"?"Inactive":"Active"}?`,showStatusButton:!0,confirmText:"Yes, Change",cancelText:"Cancel",status:s.status,onConfirm:_=>je(s)},{trigger:M(()=>[t("button",{class:b(["relative inline-flex items-center w-8 h-4 rounded-full transition-colors duration-300 focus:outline-none",s.status==="active"?"bg-green-500 hover:bg-green-600":"bg-red-400 hover:bg-red-500"]),title:s.status==="active"?"Set Inactive":"Set Active"},[t("span",{class:b(["absolute left-0.5 top-0.5 w-3 h-3 bg-white rounded-full shadow transform transition-transform duration-300",s.status==="active"?"translate-x-4":"translate-x-0"])},null,2)],10,Ot)]),_:2},1032,["message","status","onConfirm"]))])])]))),128)),!D.value&&k.value.length===0?(l(),o("tr",Rt,[...e[24]||(e[24]=[t("td",{colspan:"9",class:"text-center text-muted py-4"}," No promos found. ",-1)])])):y("",!0)])])]),H.value&&H.value.length>0&&!D.value?(l(),o("div",Zt,[t("div",zt," Showing "+n((L.value-1)*te.value+1)+" to "+n(Math.min(L.value*te.value,ae.value))+" of "+n(ae.value)+" entries ",1),p(at,{pagination:H.value,isApiDriven:!0,onPageChanged:Fe},null,8,["pagination"])])):y("",!0)])]),t("div",qt,[t("div",Xt,[t("div",Ht,[t("div",Yt,[t("h5",Gt,n(A.value?"Edit Promo":"Add New Promo"),1),t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110",onClick:Y,"data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[...e[26]||(e[26]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",Kt,[t("div",Jt,[t("div",Wt,[e[27]||(e[27]=t("label",{class:"form-label"},"Promo Name",-1)),j(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>f.value.name=s),type:"text",class:b(["form-control",{"is-invalid":i.value.name}]),placeholder:"Enter promo name"},null,2),[[U,f.value.name]]),i.value.name?(l(),o("small",Qt,n(i.value.name[0]),1)):y("",!0)]),t("div",ea,[e[28]||(e[28]=t("label",{class:"form-label"},"Discount Type",-1)),p(m(be),{modelValue:f.value.type,"onUpdate:modelValue":e[5]||(e[5]=s=>f.value.type=s),options:De,optionLabel:"label",appendTo:"self",autoZIndex:!0,baseZIndex:2e3,optionValue:"value",class:b(["form-select",{"is-invalid":i.value.type}])},null,8,["modelValue","class"]),i.value.type?(l(),o("small",ta,n(i.value.type[0]),1)):y("",!0)]),t("div",aa,[e[29]||(e[29]=t("label",{class:"form-label"},"Status",-1)),p(m(be),{modelValue:f.value.status,"onUpdate:modelValue":e[6]||(e[6]=s=>f.value.status=s),options:Ce,optionLabel:"label",optionValue:"value",class:b(["form-select",{"is-invalid":i.value.status}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","class"]),i.value.status?(l(),o("small",sa,n(i.value.status[0]),1)):y("",!0)]),t("div",la,[e[30]||(e[30]=t("label",{class:"form-label"},"Discount Amount",-1)),j(t("input",{"onUpdate:modelValue":e[7]||(e[7]=s=>f.value.discount_amount=s),type:"number",class:b(["form-control",{"is-invalid":i.value.discount_amount}]),placeholder:"Enter discount amount"},null,2),[[U,f.value.discount_amount]]),i.value.discount_amount?(l(),o("small",oa,n(i.value.discount_amount[0]),1)):y("",!0)]),t("div",na,[e[31]||(e[31]=t("label",{class:"form-label"},"Start Date",-1)),p(u,{modelValue:f.value.start_date,"onUpdate:modelValue":e[8]||(e[8]=s=>f.value.start_date=s),format:m(C),"min-date":new Date,enableTimePicker:!1,placeholder:"Select Start date",class:b({"is-invalid":i.value.start_date})},null,8,["modelValue","format","min-date","class"]),i.value.start_date?(l(),o("small",ra,n(i.value.start_date[0]),1)):y("",!0)]),t("div",ia,[e[32]||(e[32]=t("label",{class:"form-label"},"End Date",-1)),p(u,{modelValue:f.value.end_date,"onUpdate:modelValue":e[9]||(e[9]=s=>f.value.end_date=s),format:m(C),"min-date":new Date,enableTimePicker:!1,placeholder:"Select End date",class:b({"is-invalid":i.value.end_date})},null,8,["modelValue","format","min-date","class"]),i.value.end_date?(l(),o("small",da,n(i.value.end_date[0]),1)):y("",!0)]),t("div",ua,[e[33]||(e[33]=t("label",{class:"form-label"},"Minimum Purchase Amount",-1)),j(t("input",{"onUpdate:modelValue":e[10]||(e[10]=s=>f.value.min_purchase=s),type:"number",step:"0.01",class:b(["form-control",{"is-invalid":i.value.min_purchase}]),placeholder:"0.00"},null,2),[[U,f.value.min_purchase]]),i.value.min_purchase?(l(),o("small",ca,n(i.value.min_purchase[0]),1)):y("",!0)]),t("div",ma,[e[34]||(e[34]=t("label",{class:"form-label"},"Maximum Discount",-1)),j(t("input",{"onUpdate:modelValue":e[11]||(e[11]=s=>f.value.max_discount=s),type:"number",step:"0.01",class:b(["form-control",{"is-invalid":i.value.max_discount}]),placeholder:"0.00"},null,2),[[U,f.value.max_discount]]),i.value.max_discount?(l(),o("small",pa,n(i.value.max_discount[0]),1)):y("",!0)]),t("div",va,[e[35]||(e[35]=t("label",{class:"form-label"},"Description (Optional)",-1)),j(t("textarea",{"onUpdate:modelValue":e[12]||(e[12]=s=>f.value.description=s),class:b(["form-control",{"is-invalid":i.value.description}]),rows:"3",placeholder:"Enter promo description"},null,2),[[U,f.value.description]]),i.value.description?(l(),o("small",fa,n(i.value.description[0]),1)):y("",!0)])]),e[38]||(e[38]=t("hr",{class:"my-4"},null,-1)),t("div",ga,[t("button",{class:"btn btn-primary rounded-pill px-4",disabled:F.value,onClick:e[13]||(e[13]=s=>Ne())},[F.value?(l(),o(N,{key:0},[e[36]||(e[36]=t("span",{class:"spinner-border spinner-border-sm me-2"},null,-1)),e[37]||(e[37]=$(" Saving... ",-1))],64)):(l(),o(N,{key:1},[$(n((A.value,"Save")),1)],64))],8,ba),t("button",{class:"btn btn-secondary rounded-pill px-4 ms-2","data-bs-dismiss":"modal",onClick:Y}," Cancel ")])])])])])])]),_:1})]),_:1}),p(m(ue),{value:"1"},{default:M(()=>[t("div",ha,[t("div",_a,[t("div",ya,[t("div",xa,[e[40]||(e[40]=t("h5",{class:"mb-0 fw-semibold"},"Promo Scope",-1)),t("div",Sa,[t("button",{"data-bs-toggle":"modal","data-bs-target":"#promoScopeModal",onClick:G,class:"d-flex align-items-center gap-1 px-4 py-2 rounded-pill btn btn-primary text-white"},[p(m(_e),{class:"w-4 h-4"}),e[39]||(e[39]=$(" Add Promo Scope ",-1))])])]),t("div",wa,[t("table",Pa,[e[42]||(e[42]=t("thead",{class:"border-top small text-muted"},[t("tr",null,[t("th",null,"S.#"),t("th",null,"Promo Name"),t("th",null,"Meals"),t("th",null,"Menu Items"),t("th",{class:"text-center"},"Action")])],-1)),t("tbody",null,[(l(!0),o(N,null,ie(W.value,(s,S)=>(l(),o("tr",{key:s.id},[t("td",null,n(S+1),1),t("td",null,[s.promos&&s.promos.length>0?(l(),o("span",ka,n(s.promos.map(_=>_.name).join(", ")),1)):(l(),o("span",Da,"N/A"))]),t("td",null,[s.meals&&s.meals.length>0?(l(),o("span",Ca,n(s.meals.map(_=>_.name).join(", ")),1)):(l(),o("span",Ma,"None"))]),t("td",null,[s.menu_items&&s.menu_items.length>0?(l(),o("span",Ia,n(s.menu_items.map(_=>_.name).join(", ")),1)):(l(),o("span",Va,"None"))]),t("td",Fa,[t("button",{onClick:_=>Be(s),title:"Edit",class:"p-2 rounded-full text-blue-600 hover:bg-blue-100"},[p(m(ye),{class:"w-4 h-4"})],8,$a)])]))),128)),W.value.length===0?(l(),o("tr",Ta,[...e[41]||(e[41]=[t("td",{colspan:"5",class:"text-center text-muted py-4"}," No promo scopes found. ",-1)])])):y("",!0)])])])])]),t("div",Ea,[t("div",Na,[t("div",Aa,[t("div",La,[t("h5",Ba,n(O.value?"Edit Promo Scope":"Add New Promo Scope"),1),t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close",onClick:G},[...e[43]||(e[43]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",ja,[t("div",Ua,[t("div",Oa,[e[44]||(e[44]=t("label",{class:"form-label"},"Select Promos *",-1)),p(m(de),{modelValue:x.value.promos,"onUpdate:modelValue":e[14]||(e[14]=s=>x.value.promos=s),options:k.value,optionLabel:"name",optionValue:"id",placeholder:"Select promos",class:b(["w-100",{"is-invalid":w.value.promos}]),display:"chip",appendTo:"self",autoZIndex:!0,baseZIndex:2e3,filter:!0},null,8,["modelValue","options","class"]),w.value.promos?(l(),o("small",Ra,n(w.value.promos[0]),1)):y("",!0)]),t("div",Za,[e[45]||(e[45]=t("label",{class:"form-label"},"Select Meals",-1)),p(m(de),{modelValue:x.value.meals,"onUpdate:modelValue":e[15]||(e[15]=s=>x.value.meals=s),options:Se.value,optionLabel:"name",optionValue:"id",placeholder:"Select meals",class:b(["w-100",{"is-invalid":w.value.meals}]),display:"chip",appendTo:"self",autoZIndex:!0,baseZIndex:2e3,filter:!0},null,8,["modelValue","options","class"]),w.value.meals?(l(),o("small",za,n(w.value.meals[0]),1)):y("",!0)]),t("div",qa,[e[46]||(e[46]=t("label",{class:"form-label"},"Select Menu Items",-1)),p(m(de),{modelValue:x.value.menu_items,"onUpdate:modelValue":e[16]||(e[16]=s=>x.value.menu_items=s),options:we.value,optionLabel:"name",optionValue:"id",placeholder:"Select menu items",class:b(["w-100",{"is-invalid":w.value.menu_items}]),display:"chip",appendTo:"self",autoZIndex:!0,baseZIndex:2e3,filter:!0},null,8,["modelValue","options","class"]),w.value.menu_items?(l(),o("small",Xa,n(w.value.menu_items[0]),1)):y("",!0)])]),e[49]||(e[49]=t("hr",{class:"my-4"},null,-1)),t("div",Ha,[t("button",{class:"btn btn-secondary rounded-pill px-4 me-2","data-bs-dismiss":"modal",onClick:G}," Cancel "),t("button",{class:"btn btn-primary rounded-pill px-4",disabled:F.value,onClick:Ae},[F.value?(l(),o(N,{key:0},[e[47]||(e[47]=t("span",{class:"spinner-border spinner-border-sm me-2"},null,-1)),e[48]||(e[48]=$(" Saving... ",-1))],64)):(l(),o(N,{key:1},[$(" Save ")],64))],8,Ya)])])])])])])]),_:1})]),_:1})]),_:1})])]),_:1})}}},ys=Ye(Ga,[["__scopeId","data-v-e3394e97"]]);export{ys as default};
