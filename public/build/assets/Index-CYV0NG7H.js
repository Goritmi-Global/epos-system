import{_ as Le,c as U,r as h,y as ue,o as je,n as Be,I as Ue,E as Oe,a as te,b as l,w as C,d as f,e as t,u as m,h as Re,l as I,f as n,F as V,g as se,i as g,j as Ze,t as u,k as A,v as L,m as w,C as ze,p as $,q as r}from"./app-BPm8Jqa8.js";import{_ as qe}from"./Master-B-oa1_ok.js";import{s as ce}from"./index-B4iN4Yec.js";import{u as He}from"./useFormatters-SHi38_16.js";import{s as ae}from"./index-CYhDVrii.js";import{E as Xe,a as Ye,X as Ge,u as O,w as Ke}from"./xlsx-DiILdRon.js";import{I as Je}from"./importFile-Cyt9lZ9u.js";import{s as We,a as Qe,b as me,c as et,d as oe}from"./index-CPv0OMZm.js";import{F as tt}from"./FilterModal-DGgiBVnc.js";import{c as st}from"./createLucideIcon-CtC6jb4d.js";import{C as at}from"./circle-check-big-DQgyAkGs.js";import{D as ot}from"./dollar-sign-Bg8dCO2Y.js";import{P as lt}from"./percent-BdcF9Ygw.js";import{P as pe}from"./plus-Df91vZ7X.js";import{P as ve}from"./pencil-DVWli0Kn.js";import"./index-CkTwpF0O.js";import"./index-z4fDpXBL.js";import"./index-Cydqvc8x.js";import"./sun-BfHbTYSR.js";import"./index-CVWe-1l6.js";import"./index-CYhawANY.js";import"./index-Ddx3-wbt.js";/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nt=st("tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]),rt={class:"page-wrapper"},it={class:"mt-3"},dt={class:"row g-3"},ut={class:"card border-0 shadow-sm rounded-4"},ct={class:"card-body d-flex align-items-center"},mt={class:"mb-0 fw-bold"},pt={class:"text-muted mb-0 small"},vt={class:"card border-0 shadow-lg rounded-4 mt-0"},ft={class:"card-body"},bt={class:"d-flex flex-wrap gap-2 justify-content-between align-items-center mb-3"},gt={class:"d-flex flex-wrap gap-2 align-items-center"},_t={class:"search-wrap"},ht={key:1,class:"form-control search-input",placeholder:"Search",disabled:"",type:"text"},yt={class:"dropdown"},xt={class:"dropdown-menu dropdown-menu-end shadow rounded-4 py-2"},wt={class:"table-responsive"},St={class:"table table-striped"},kt={class:"fw-semibold"},Dt={class:"text-center"},Pt={class:"text-center"},Ct={class:"d-inline-flex align-items-center gap-3"},Mt=["onClick"],Ft=["title"],It={key:0},$t={class:"modal fade",id:"promoModal",tabindex:"-1","aria-hidden":"true"},Vt={class:"modal-dialog modal-lg modal-dialog-centered"},Et={class:"modal-content rounded-4"},Tt={class:"modal-header"},Nt={class:"modal-title fw-semibold"},At={class:"modal-body"},Lt={class:"row g-3"},jt={class:"col-12"},Bt={key:0,class:"text-danger"},Ut={class:"col-md-6"},Ot={key:0,class:"text-danger"},Rt={class:"col-md-6"},Zt={key:0,class:"text-danger"},zt={class:"col-12"},qt={key:0,class:"text-danger"},Ht={class:"col-md-6"},Xt={key:0,class:"text-danger"},Yt={class:"col-md-6"},Gt={key:0,class:"text-danger"},Kt={class:"col-md-6"},Jt={key:0,class:"text-danger"},Wt={class:"col-md-6"},Qt={key:0,class:"text-danger"},es={class:"col-12"},ts={key:0,class:"text-danger"},ss={class:"mt-4"},as=["disabled"],os={class:"mt-3"},ls={class:"card border-0 shadow-lg rounded-4 mt-0"},ns={class:"card-body"},rs={class:"d-flex flex-wrap gap-2 justify-content-between align-items-center mb-3"},is={class:"d-flex flex-wrap gap-2 align-items-center"},ds={class:"table-responsive"},us={class:"table table-striped"},cs={key:0},ms={key:1,class:"text-muted"},ps={key:0},vs={key:1,class:"text-muted"},fs={key:0},bs={key:1,class:"text-muted"},gs={class:"text-center"},_s=["onClick"],hs={key:0},ys={class:"modal fade",id:"promoScopeModal",tabindex:"-1","aria-hidden":"true"},xs={class:"modal-dialog modal-lg modal-dialog-centered"},ws={class:"modal-content rounded-4"},Ss={class:"modal-header"},ks={class:"modal-title fw-semibold"},Ds={class:"modal-body"},Ps={class:"row g-3"},Cs={class:"col-12"},Ms={key:0,class:"text-danger"},Fs={class:"col-md-6"},Is={key:0,class:"text-danger"},$s={class:"col-md-6"},Vs={key:0,class:"text-danger"},Es={class:"mt-4 text-end"},Ts=["disabled"],Ns={__name:"Index",props:{meals:{type:Array,required:!0}},setup(fe){const{formatCurrencySymbol:R,dateFmt:P}=He(),Z=fe,be=U(()=>Z.meals||[]),ge=U(()=>{if(!Z.meals||!Array.isArray(Z.meals))return[];const s=Z.meals.flatMap(a=>(a.menu_items||[]).map(x=>({...x,meal_name:a.name}))),e=[],o=new Set;for(const a of s)o.has(a.id)||(o.add(a.id),e.push(a));return e}),D=h([]),E=h(null),F=h(!1),i=h({}),le=h(0),X=h([]),j=h(null),S=h({}),_e=[{label:"Flat Amount",value:"flat"},{label:"Percentage",value:"percent"}],he=[{label:"Active",value:"active"},{label:"Deactive",value:"inactive"}],y=h({promo_id:null,meals:[],menu_items:[]});ue(()=>y.value.meals,s=>{},{deep:!0}),ue(()=>y.value.menu_items,s=>{},{deep:!0});const ye=["Promo Name","Type","Discount Amount","Start Date","End Date","Min Purchase","Max Discount","Status","Description"],xe=[["Summer Sale","percent","20","2025-06-01","2025-08-31","50","100","active","Summer discount"],["Flat Discount","flat","10","2025-01-01","2025-12-31","30","","active","Flat 10 off"]],we=s=>{if(!s||s.length<=1){r.error("The imported file is empty.");return}s[0];const o=s.slice(1).map(d=>{const M=k=>{if(!k)return"";if(!isNaN(k)&&Number(k)>3e4){const Q=Number(k),B=new Date((Q-25569)*86400*1e3),ee=B.getFullYear(),Ne=String(B.getMonth()+1).padStart(2,"0"),Ae=String(B.getDate()).padStart(2,"0");return`${ee}-${Ne}-${Ae}`}if(typeof k=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(k))return k;const H=new Date(k);if(!isNaN(H.getTime())){const Q=H.getFullYear(),B=String(H.getMonth()+1).padStart(2,"0"),ee=String(H.getDate()).padStart(2,"0");return`${Q}-${B}-${ee}`}return""};return{name:d[0]||"",type:d[1]||"percent",discount_amount:d[2]||"",start_date:M(d[3]),end_date:M(d[4]),min_purchase:d[5]||"0",max_discount:d[6]||null,status:d[7]||"active",description:d[8]||""}}).filter(d=>d.name.trim());if(o.length===0){r.error("No valid promos found in the file.");return}const a=o.map(d=>d.name.trim().toLowerCase()),x=a.filter((d,M)=>a.indexOf(d)!==M);if(x.length>0){r.error(`Duplicate promo names found in CSV: ${[...new Set(x)].join(", ")}`);return}const _=D.value.map(d=>d.name.trim().toLowerCase()),p=o.filter(d=>_.includes(d.name.trim().toLowerCase()));if(p.length>0){const d=p.map(M=>M.name).join(", ");r.error(`Promos already exist in the table: ${d}`);return}const c=["flat","percent"];if(o.filter(d=>!c.includes(d.type.toLowerCase())).length>0){r.error("Invalid type found. Type must be either 'flat' or 'percent'.");return}const Te=["active","inactive"];if(o.filter(d=>!Te.includes(d.status.toLowerCase())).length>0){r.error("Invalid status found. Status must be either 'active' or 'inactive'.");return}$.post("/api/promos/import",{promos:o}).then(()=>{r.success("Promos imported successfully"),Y()}).catch(d=>{console.error("Import error:",d);const M=d.response?.data?.message||"Import failed",k=d.response?.data?.errors||[];k.length>0?(console.error("Detailed errors:",k),r.error(`${M}: ${k.join(", ")}`)):r.error(M)})},Y=async()=>{try{const s=await $.get("/api/promos/all");D.value=s.data.data}catch(s){console.error("Failed to fetch promos:",s),r.error("Failed to load promos")}},ne=async()=>{try{const s=await $.get("/promo-scopes");X.value=s.data.data||[]}catch(s){console.error("Failed to fetch promo scopes:",s),r.error("Failed to load promo scopes")}};je(async()=>{T.value="",re.value=Date.now(),await Be(),setTimeout(()=>{ie.value=!0;const e=document.getElementById(G);e&&(e.value="",T.value="")},100),await Y(),await ne();const s=document.getElementById("promosFilterModal");s&&s.addEventListener("hidden.bs.modal",()=>{J.value||de(),J.value=!1})});const Se=U(()=>[{label:"Total Promos",value:D.value.length,icon:nt,iconBg:"bg-light-primary",iconColor:"text-primary"},{label:"Active Promos",value:D.value.filter(s=>s.status==="active").length,icon:at,iconBg:"bg-light-success",iconColor:"text-success"},{label:"Flat Discount",value:D.value.filter(s=>s.type==="flat").length,icon:ot,iconBg:"bg-light-warning",iconColor:"text-warning"},{label:"Percentage",value:D.value.filter(s=>s.type==="percent").length,icon:lt,iconBg:"bg-light-danger",iconColor:"text-danger"}]),T=h(""),re=h(Date.now()),G=`search-${Math.random().toString(36).substr(2,9)}`,ie=h(!1),b=h({sortBy:"",stockStatus:"",priceMin:null,priceMax:null,dateFrom:null,dateTo:null}),ke=U(()=>[{id:"flat",name:"Flat"},{id:"percent",name:"Percentage"}]),K=U(()=>{let s=D.value;const e=T.value.trim().toLowerCase();if(e&&(s=s.filter(o=>o.name.toLowerCase().includes(e))),b.value.stockStatus&&(s=s.filter(o=>o.status===b.value.stockStatus)),b.value.category&&(s=s.filter(o=>o.type===b.value.category)),b.value.priceMin!==null&&b.value.priceMin!==""&&(s=s.filter(o=>parseFloat(o.max_discount)>=parseFloat(b.value.priceMin))),b.value.priceMax!==null&&b.value.priceMax!==""&&(s=s.filter(o=>parseFloat(o.max_discount)<=parseFloat(b.value.priceMax))),b.value.dateFrom){const o=new Date(b.value.dateFrom);s=s.filter(a=>new Date(a.start_date)>=o)}if(b.value.dateTo){const o=new Date(b.value.dateTo);s=s.filter(a=>new Date(a.start_date)<=o)}if(b.value.sortBy)switch(s=[...s],b.value.sortBy){case"discount_asc":s.sort((o,a)=>parseFloat(o.discount_amount)-parseFloat(a.discount_amount));break;case"discount_desc":s.sort((o,a)=>parseFloat(a.discount_amount)-parseFloat(o.discount_amount));break;case"name_asc":s.sort((o,a)=>o.name.localeCompare(a.name));break;case"name_desc":s.sort((o,a)=>a.name.localeCompare(o.name));break;case"date_asc":s.sort((o,a)=>new Date(o.start_date)-new Date(a.start_date));break;case"date_desc":s.sort((o,a)=>new Date(a.start_date)-new Date(o.start_date));break}return s}),J=h(!1),De=s=>{b.value={...b.value,...s},J.value=!0},de=()=>{b.value={sortBy:"",stockStatus:"",category:"",priceMin:null,priceMax:null,dateFrom:null,dateTo:null},appliedFilters.value={sortBy:"",stockStatus:"",category:"",priceMin:null,priceMax:null,dateFrom:null,dateTo:null}},v=h({name:"",type:"percent",status:"active",start_date:"",end_date:"",min_purchase:0,max_discount:null,description:"",discount_amount:null}),z=()=>{v.value={name:"",type:"percent",status:"active",start_date:"",end_date:"",min_purchase:0,max_discount:null,description:"",discount_amount:null},E.value=null,i.value={}},q=()=>{y.value={promo_id:null,meals:[],menu_items:[]},j.value=null,S.value={}},Pe=async()=>{F.value=!0,i.value={};try{E.value?(await $.post(`/promos/${E.value.id}`,v.value),r.success("Promo updated successfully")):(await $.post("/promos",v.value),r.success("Promo created successfully")),bootstrap.Modal.getInstance(document.getElementById("promoModal"))?.hide(),z(),await Y()}catch(s){if(console.error("❌ Error:",s.response?.data||s.message),s.response?.status===422&&s.response?.data?.errors){i.value=s.response.data.errors;const e=Object.values(s.response.data.errors).flat();r.error(e.join(`
`))}else{const e=s.response?.data?.message||"Failed to save promo";r.error(e)}}finally{F.value=!1}},Ce=async()=>{F.value=!0,S.value={},console.log("Submitting promo scope:",y.value);try{const s={promos:y.value.promos||[],meals:y.value.meals||[],menu_items:y.value.menu_items||[]};console.log("Payload:",s),j.value?(await $.put(`/promo-scopes/${j.value.id}`,s),r.success("Promo scope updated successfully")):(await $.post("/promo-scopes",s),r.success("Promo scope created successfully")),bootstrap.Modal.getInstance(document.getElementById("promoScopeModal"))?.hide(),q(),await ne()}catch(s){if(console.error("❌ Error:",s.response?.data||s.message),s.response?.status===422&&s.response?.data?.errors)S.value=s.response.data.errors,Object.values(s.response.data.errors).flat(),r.error("Please filled all the required fields.");else{const e=s.response?.data?.message||"Failed to save promo scope";r.error(e)}}finally{F.value=!1}},Me=s=>{E.value=s,v.value={name:s.name,type:s.type,status:s.status,start_date:s.start_date?new Date(s.start_date):null,end_date:s.end_date?new Date(s.end_date):null,min_purchase:s.min_purchase,max_discount:s.max_discount,description:s.description||"",discount_amount:s.discount_amount};const e=document.getElementById("promoModal");new bootstrap.Modal(e).show()},Fe=s=>{j.value=s,y.value={promos:s.promos?s.promos.map(a=>a.id):[],meals:s.meals?s.meals.map(a=>a.id):[],menu_items:s.menu_items?s.menu_items.map(a=>a.id):[]};const e=document.getElementById("promoScopeModal");new bootstrap.Modal(e).show()},Ie=async s=>{const e=s.status==="active"?"inactive":"active";try{await $.patch(`/api/promos/${s.id}/toggle-status`,{status:e}),s.status=e,r.success(`Promo status updated to ${e}`),le.value++}catch(o){console.error("Failed to update status:",o),r.error("Failed to update status")}};Ue(()=>window.feather?.replace());const W=s=>{if(!D.value||D.value.length===0){r.error("No Promos data to download");return}const e=T.value.trim()?K.value:D.value;if(e.length===0){r.error("No Promos found to download");return}try{s==="pdf"?Ve(e):s==="excel"?Ee(e):s==="csv"?$e(e):r.error("Invalid download type")}catch(o){console.error("Download failed:",o),r.error(`Download failed: ${o.message}`)}},$e=s=>{try{const e=["S.#","Promo Name","Type","Discount Amount","Start Date","End Date","Min Purchase","Max Discount","Status","Description"],o=s.map((c,N)=>[`${N+1}`,`"${c.name||""}"`,`"${c.type||""}"`,`${c.discount_amount||""}`,`"${P(c.start_date)||""}"`,`"${P(c.end_date)||""}"`,`${c.min_purchase||""}`,`${c.max_discount||""}`,`"${c.status||""}"`,`"${c.description||""}"`]),a=[e.join(","),...o.map(c=>c.join(","))].join(`
`),x=new Blob([a],{type:"text/csv;charset=utf-8;"}),_=URL.createObjectURL(x),p=document.createElement("a");p.setAttribute("href",_),p.setAttribute("download",`Promos_${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(p),p.click(),document.body.removeChild(p),r.success("CSV downloaded successfully")}catch(e){console.error("CSV generation error:",e),r.error(`CSV generation failed: ${e.message}`)}},Ve=s=>{try{const e=new Xe("l","mm","a4");e.setFontSize(18),e.setFont("helvetica","bold"),e.text("Promos Report",14,20),e.setFontSize(10),e.setFont("helvetica","normal");const o=new Date().toLocaleString();e.text(`Generated on: ${o}`,14,28),e.text(`Total Promos: ${s.length}`,14,34);const a=["S.#","Name","Type","Discount","Start Date","End Date","Min Purchase","Max Discount","Status"],x=s.map((p,c)=>[c+1,p.name||"",p.type==="flat"?"Flat":"Percent",p.discount_amount||"",P(p.start_date)||"",P(p.end_date)||"",R(p.min_purchase)||"",p.max_discount?R(p.max_discount):"N/A",p.status==="active"?"Active":"Inactive"]);Ye(e,{head:[a],body:x,startY:40,styles:{fontSize:8,cellPadding:2,halign:"left",lineColor:[0,0,0],lineWidth:.1},headStyles:{fillColor:[41,128,185],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]},margin:{left:14,right:14},didDrawPage:p=>{const c=e.internal.getNumberOfPages(),N=e.internal.pageSize.height;e.setFontSize(8),e.text(`Page ${p.pageNumber} of ${c}`,p.settings.margin.left,N-10)}});const _=`Promos_${new Date().toISOString().split("T")[0]}.pdf`;e.save(_),r.success("PDF downloaded successfully")}catch(e){console.error("PDF generation error:",e),r.error(`PDF generation failed: ${e.message}`)}},Ee=s=>{try{if(typeof Ge>"u")throw new Error("XLSX library is not loaded");const e=s.map((c,N)=>({"S.#":N+1,"Promo Name":c.name||"",Type:c.type==="flat"?"Flat":"Percent","Discount Amount":c.discount_amount||"","Start Date":P(c.start_date)||"","End Date":P(c.end_date)||"","Min Purchase":c.min_purchase||"","Max Discount":c.max_discount||"",Status:c.status==="active"?"Active":"Inactive",Description:c.description||""})),o=O.book_new(),a=O.json_to_sheet(e);a["!cols"]=[{wch:8},{wch:25},{wch:12},{wch:15},{wch:15},{wch:15},{wch:15},{wch:15},{wch:12},{wch:30}],O.book_append_sheet(o,a,"Promos");const x=[{Info:"Report",Value:"Promos Export"},{Info:"Generated On",Value:new Date().toLocaleString()},{Info:"Total Records",Value:s.length},{Info:"Exported By",Value:"Inventory Management System"}],_=O.json_to_sheet(x);O.book_append_sheet(o,_,"Report Info");const p=`Promos_${new Date().toISOString().split("T")[0]}.xlsx`;Ke(o,p),r.success("Excel file downloaded successfully")}catch(e){console.error("Excel generation error:",e),r.error(`Excel generation failed: ${e.message}`)}};return(s,e)=>{const o=Oe("VueDatePicker");return l(),te(qe,null,{default:C(()=>[f(m(Re),{title:"Promo"}),t("div",rt,[e[52]||(e[52]=t("h4",{class:"fw-semibold mb-3"},"Promo Management",-1)),f(m(We),{value:"0",class:"w-100"},{default:C(()=>[f(m(Qe),null,{default:C(()=>[f(m(me),{value:"0"},{default:C(()=>[...e[19]||(e[19]=[I("Promos",-1)])]),_:1}),f(m(me),{value:"1"},{default:C(()=>[...e[20]||(e[20]=[I("Promo Scope",-1)])]),_:1})]),_:1}),f(m(et),null,{default:C(()=>[f(m(oe),{value:"0"},{default:C(()=>[f(m(oe),{value:"0"},{default:C(()=>[t("div",it,[t("div",dt,[(l(!0),n(V,null,se(Se.value,a=>(l(),n("div",{key:a.label,class:"col-md-6 col-xl-3"},[t("div",ut,[t("div",ct,[t("div",{class:g([[a.iconBg,a.iconColor],"rounded-circle p-3 d-flex align-items-center justify-content-center me-3"]),style:{width:"56px",height:"56px"}},[(l(),te(Ze(a.icon),{class:"w-6 h-6"}))],2),t("div",null,[t("h3",mt,u(a.value),1),t("p",pt,u(a.label),1)])])])]))),128))]),t("div",vt,[t("div",ft,[t("div",bt,[e[25]||(e[25]=t("h5",{class:"mb-0 fw-semibold"},"Promos",-1)),t("div",gt,[f(tt,{modelValue:b.value,"onUpdate:modelValue":e[0]||(e[0]=a=>b.value=a),title:"Promos",modalId:"promosFilterModal",modalSize:"modal-lg",sortOptions:[{value:"name_asc",label:"Name: A to Z"},{value:"name_desc",label:"Name: Z to A"},{value:"discount_asc",label:"Discount: Low to High"},{value:"discount_desc",label:"Discount: High to Low"}],categories:ke.value,categoryLabel:"Promo Type",statusLabel:"Promo Status",showPriceRange:!0,"show-stock-status":!1,priceRangeLabel:"Discount Amount Range",showDateRange:!0,onApply:De,onClear:de},null,8,["modelValue","categories"]),t("div",_t,[e[21]||(e[21]=t("i",{class:"bi bi-search"},null,-1)),e[22]||(e[22]=t("input",{type:"email",name:"email",autocomplete:"email",style:{position:"absolute",left:"-9999px",width:"1px",height:"1px"},tabindex:"-1","aria-hidden":"true"},null,-1)),ie.value?A((l(),n("input",{id:G,"onUpdate:modelValue":e[1]||(e[1]=a=>T.value=a),key:re.value,class:"form-control search-input",placeholder:"Search",type:"search",autocomplete:"new-password",name:G,role:"presentation",onFocus:e[2]||(e[2]=(...a)=>s.handleFocus&&s.handleFocus(...a))},null,32)),[[L,T.value]]):(l(),n("input",ht))]),t("button",{"data-bs-toggle":"modal","data-bs-target":"#promoModal",onClick:z,class:"d-flex align-items-center gap-1 px-4 py-2 rounded-pill btn btn-primary text-white"},[f(m(pe),{class:"w-4 h-4"}),e[23]||(e[23]=I(" Add Promo ",-1))]),f(Je,{label:"Import Promos",sampleHeaders:ye,sampleData:xe,onOnImport:we}),t("div",yt,[e[24]||(e[24]=t("button",{class:"btn btn-outline-secondary rounded-pill py-2 btn-sm px-4 dropdown-toggle","data-bs-toggle":"dropdown"}," Export ",-1)),t("ul",xt,[t("li",null,[t("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:e[3]||(e[3]=a=>W("pdf"))},"Export as PDF")]),t("li",null,[t("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:e[4]||(e[4]=a=>W("excel"))},"Export as Excel")]),t("li",null,[t("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:e[5]||(e[5]=a=>W("csv"))}," Export as CSV ")])])])])]),t("div",wt,[t("table",St,[e[27]||(e[27]=t("thead",{class:"border-top small text-muted"},[t("tr",null,[t("th",null,"S.#"),t("th",null,"Name"),t("th",null,"Type"),t("th",null,"Start Date"),t("th",null,"End Date"),t("th",null,"Min Purchase"),t("th",null,"Max Discount"),t("th",{class:"text-center"},"Status"),t("th",{class:"text-center"},"Action")])],-1)),t("tbody",null,[(l(!0),n(V,null,se(K.value,(a,x)=>(l(),n("tr",{key:a.id},[t("td",null,u(x+1),1),t("td",kt,u(a.name),1),t("td",null,[t("span",{class:g(a.type==="flat"?"badge bg-primary px-4 py-2 rounded-pill":"badge bg-warning px-4 py-2 rounded-pill")},u(a.type==="flat"?"Flat":"Percent"),3)]),t("td",null,u(m(P)(a.start_date)),1),t("td",null,u(m(P)(a.end_date)),1),t("td",null,u(m(R)(a.min_purchase)),1),t("td",null,u(a.max_discount?m(R)(a.max_discount):"N/A"),1),t("td",Dt,[t("span",{class:g(a.status==="active"?"badge bg-success px-4 py-2 rounded-pill":"badge bg-danger px-4 py-2 rounded-pill")},u(a.status==="active"?"Active":"Inactive"),3)]),t("td",Pt,[t("div",Ct,[t("button",{onClick:_=>Me(a),title:"Edit",class:"p-2 rounded-full text-blue-600 hover:bg-blue-100"},[f(m(ve),{class:"w-4 h-4"})],8,Mt),(l(),te(ze,{key:`confirm-${a.id}-${le.value}`,title:"Confirm Status Change",message:`Are you sure you want to set ${a.name} to ${a.status==="active"?"Inactive":"Active"}?`,showStatusButton:!0,confirmText:"Yes, Change",cancelText:"Cancel",status:a.status,onConfirm:_=>Ie(a)},{trigger:C(()=>[t("button",{class:g(["relative inline-flex items-center w-8 h-4 rounded-full transition-colors duration-300 focus:outline-none",a.status==="active"?"bg-green-500 hover:bg-green-600":"bg-red-400 hover:bg-red-500"]),title:a.status==="active"?"Set Inactive":"Set Active"},[t("span",{class:g(["absolute left-0.5 top-0.5 w-3 h-3 bg-white rounded-full shadow transform transition-transform duration-300",a.status==="active"?"translate-x-4":"translate-x-0"])},null,2)],10,Ft)]),_:2},1032,["message","status","onConfirm"]))])])]))),128)),K.value.length===0?(l(),n("tr",It,[...e[26]||(e[26]=[t("td",{colspan:"9",class:"text-center text-muted py-4"}," No promos found. ",-1)])])):w("",!0)])])])])]),t("div",$t,[t("div",Vt,[t("div",Et,[t("div",Tt,[t("h5",Nt,u(E.value?"Edit Promo":"Add New Promo"),1),t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110",onClick:z,"data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[...e[28]||(e[28]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",At,[t("div",Lt,[t("div",jt,[e[29]||(e[29]=t("label",{class:"form-label"},"Promo Name",-1)),A(t("input",{"onUpdate:modelValue":e[6]||(e[6]=a=>v.value.name=a),type:"text",class:g(["form-control",{"is-invalid":i.value.name}]),placeholder:"Enter promo name"},null,2),[[L,v.value.name]]),i.value.name?(l(),n("small",Bt,u(i.value.name[0]),1)):w("",!0)]),t("div",Ut,[e[30]||(e[30]=t("label",{class:"form-label"},"Discount Type",-1)),f(m(ce),{modelValue:v.value.type,"onUpdate:modelValue":e[7]||(e[7]=a=>v.value.type=a),options:_e,optionLabel:"label",appendTo:"self",autoZIndex:!0,baseZIndex:2e3,optionValue:"value",class:g(["form-select",{"is-invalid":i.value.type}])},null,8,["modelValue","class"]),i.value.type?(l(),n("small",Ot,u(i.value.type[0]),1)):w("",!0)]),t("div",Rt,[e[31]||(e[31]=t("label",{class:"form-label"},"Status",-1)),f(m(ce),{modelValue:v.value.status,"onUpdate:modelValue":e[8]||(e[8]=a=>v.value.status=a),options:he,optionLabel:"label",optionValue:"value",class:g(["form-select",{"is-invalid":i.value.status}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","class"]),i.value.status?(l(),n("small",Zt,u(i.value.status[0]),1)):w("",!0)]),t("div",zt,[e[32]||(e[32]=t("label",{class:"form-label"},"Discount Amount",-1)),A(t("input",{"onUpdate:modelValue":e[9]||(e[9]=a=>v.value.discount_amount=a),type:"number",class:g(["form-control",{"is-invalid":i.value.discount_amount}]),placeholder:"Enter discount amount"},null,2),[[L,v.value.discount_amount]]),i.value.discount_amount?(l(),n("small",qt,u(i.value.discount_amount[0]),1)):w("",!0)]),t("div",Ht,[e[33]||(e[33]=t("label",{class:"form-label"},"Start Date",-1)),f(o,{modelValue:v.value.start_date,"onUpdate:modelValue":e[10]||(e[10]=a=>v.value.start_date=a),format:m(P),"min-date":new Date,enableTimePicker:!1,placeholder:"Select Start date",class:g({"is-invalid":i.value.start_date})},null,8,["modelValue","format","min-date","class"]),i.value.start_date?(l(),n("small",Xt,u(i.value.start_date[0]),1)):w("",!0)]),t("div",Yt,[e[34]||(e[34]=t("label",{class:"form-label"},"End Date",-1)),f(o,{modelValue:v.value.end_date,"onUpdate:modelValue":e[11]||(e[11]=a=>v.value.end_date=a),format:m(P),"min-date":new Date,enableTimePicker:!1,placeholder:"Select End date",class:g({"is-invalid":i.value.end_date})},null,8,["modelValue","format","min-date","class"]),i.value.end_date?(l(),n("small",Gt,u(i.value.end_date[0]),1)):w("",!0)]),t("div",Kt,[e[35]||(e[35]=t("label",{class:"form-label"},"Minimum Purchase Amount",-1)),A(t("input",{"onUpdate:modelValue":e[12]||(e[12]=a=>v.value.min_purchase=a),type:"number",step:"0.01",class:g(["form-control",{"is-invalid":i.value.min_purchase}]),placeholder:"0.00"},null,2),[[L,v.value.min_purchase]]),i.value.min_purchase?(l(),n("small",Jt,u(i.value.min_purchase[0]),1)):w("",!0)]),t("div",Wt,[e[36]||(e[36]=t("label",{class:"form-label"},"Maximum Discount",-1)),A(t("input",{"onUpdate:modelValue":e[13]||(e[13]=a=>v.value.max_discount=a),type:"number",step:"0.01",class:g(["form-control",{"is-invalid":i.value.max_discount}]),placeholder:"0.00"},null,2),[[L,v.value.max_discount]]),i.value.max_discount?(l(),n("small",Qt,u(i.value.max_discount[0]),1)):w("",!0)]),t("div",es,[e[37]||(e[37]=t("label",{class:"form-label"},"Description (Optional)",-1)),A(t("textarea",{"onUpdate:modelValue":e[14]||(e[14]=a=>v.value.description=a),class:g(["form-control",{"is-invalid":i.value.description}]),rows:"3",placeholder:"Enter promo description"},null,2),[[L,v.value.description]]),i.value.description?(l(),n("small",ts,u(i.value.description[0]),1)):w("",!0)])]),e[40]||(e[40]=t("hr",{class:"my-4"},null,-1)),t("div",ss,[t("button",{class:"btn btn-primary rounded-pill px-4",disabled:F.value,onClick:e[15]||(e[15]=a=>Pe())},[F.value?(l(),n(V,{key:0},[e[38]||(e[38]=t("span",{class:"spinner-border spinner-border-sm me-2"},null,-1)),e[39]||(e[39]=I(" Saving... ",-1))],64)):(l(),n(V,{key:1},[I(u((E.value,"Save")),1)],64))],8,as),t("button",{class:"btn btn-secondary rounded-pill px-4 ms-2","data-bs-dismiss":"modal",onClick:z}," Cancel ")])])])])])])]),_:1})]),_:1}),f(m(oe),{value:"1"},{default:C(()=>[t("div",os,[t("div",ls,[t("div",ns,[t("div",rs,[e[42]||(e[42]=t("h5",{class:"mb-0 fw-semibold"},"Promo Scope",-1)),t("div",is,[t("button",{"data-bs-toggle":"modal","data-bs-target":"#promoScopeModal",onClick:q,class:"d-flex align-items-center gap-1 px-4 py-2 rounded-pill btn btn-primary text-white"},[f(m(pe),{class:"w-4 h-4"}),e[41]||(e[41]=I(" Add Promo Scope ",-1))])])]),t("div",ds,[t("table",us,[e[44]||(e[44]=t("thead",{class:"border-top small text-muted"},[t("tr",null,[t("th",null,"S.#"),t("th",null,"Promo Name"),t("th",null,"Meals"),t("th",null,"Menu Items"),t("th",{class:"text-center"},"Action")])],-1)),t("tbody",null,[(l(!0),n(V,null,se(X.value,(a,x)=>(l(),n("tr",{key:a.id},[t("td",null,u(x+1),1),t("td",null,[a.promos&&a.promos.length>0?(l(),n("span",cs,u(a.promos.map(_=>_.name).join(", ")),1)):(l(),n("span",ms,"N/A"))]),t("td",null,[a.meals&&a.meals.length>0?(l(),n("span",ps,u(a.meals.map(_=>_.name).join(", ")),1)):(l(),n("span",vs,"None"))]),t("td",null,[a.menu_items&&a.menu_items.length>0?(l(),n("span",fs,u(a.menu_items.map(_=>_.name).join(", ")),1)):(l(),n("span",bs,"None"))]),t("td",gs,[t("button",{onClick:_=>Fe(a),title:"Edit",class:"p-2 rounded-full text-blue-600 hover:bg-blue-100"},[f(m(ve),{class:"w-4 h-4"})],8,_s)])]))),128)),X.value.length===0?(l(),n("tr",hs,[...e[43]||(e[43]=[t("td",{colspan:"5",class:"text-center text-muted py-4"}," No promo scopes found. ",-1)])])):w("",!0)])])])])]),t("div",ys,[t("div",xs,[t("div",ws,[t("div",Ss,[t("h5",ks,u(j.value?"Edit Promo Scope":"Add New Promo Scope"),1),t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close",onClick:q},[...e[45]||(e[45]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",Ds,[t("div",Ps,[t("div",Cs,[e[46]||(e[46]=t("label",{class:"form-label"},"Select Promos *",-1)),f(m(ae),{modelValue:y.value.promos,"onUpdate:modelValue":e[16]||(e[16]=a=>y.value.promos=a),options:D.value,optionLabel:"name",optionValue:"id",placeholder:"Select promos",class:g(["w-100",{"is-invalid":S.value.promos}]),display:"chip",appendTo:"self",autoZIndex:!0,baseZIndex:2e3,filter:!0},null,8,["modelValue","options","class"]),S.value.promos?(l(),n("small",Ms,u(S.value.promos[0]),1)):w("",!0)]),t("div",Fs,[e[47]||(e[47]=t("label",{class:"form-label"},"Select Meals",-1)),f(m(ae),{modelValue:y.value.meals,"onUpdate:modelValue":e[17]||(e[17]=a=>y.value.meals=a),options:be.value,optionLabel:"name",optionValue:"id",placeholder:"Select meals",class:g(["w-100",{"is-invalid":S.value.meals}]),display:"chip",appendTo:"self",autoZIndex:!0,baseZIndex:2e3,filter:!0},null,8,["modelValue","options","class"]),S.value.meals?(l(),n("small",Is,u(S.value.meals[0]),1)):w("",!0)]),t("div",$s,[e[48]||(e[48]=t("label",{class:"form-label"},"Select Menu Items",-1)),f(m(ae),{modelValue:y.value.menu_items,"onUpdate:modelValue":e[18]||(e[18]=a=>y.value.menu_items=a),options:ge.value,optionLabel:"name",optionValue:"id",placeholder:"Select menu items",class:g(["w-100",{"is-invalid":S.value.menu_items}]),display:"chip",appendTo:"self",autoZIndex:!0,baseZIndex:2e3,filter:!0},null,8,["modelValue","options","class"]),S.value.menu_items?(l(),n("small",Vs,u(S.value.menu_items[0]),1)):w("",!0)])]),e[51]||(e[51]=t("hr",{class:"my-4"},null,-1)),t("div",Es,[t("button",{class:"btn btn-secondary rounded-pill px-4 me-2","data-bs-dismiss":"modal",onClick:q}," Cancel "),t("button",{class:"btn btn-primary rounded-pill px-4",disabled:F.value,onClick:Ce},[F.value?(l(),n(V,{key:0},[e[49]||(e[49]=t("span",{class:"spinner-border spinner-border-sm me-2"},null,-1)),e[50]||(e[50]=I(" Saving... ",-1))],64)):(l(),n(V,{key:1},[I(" Save ")],64))],8,Ts)])])])])])])]),_:1})]),_:1})]),_:1})])]),_:1})}}},la=Le(Ns,[["__scopeId","data-v-8dc8f496"]]);export{la as default};
