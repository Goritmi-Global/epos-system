import{_ as B,r as m,c as y,f as d,b as r,e as o,t as p,K as P,u as f,a as _,F as j,g as N,i as T,m as $,j as F,l as I,q as v,p as x}from"./app-DMtB1k9Z.js";import L from"./Step1-D_uNe84U.js";import M from"./Step2-WYLqRHF2.js";import V from"./Step3-DSAuv2Zj.js";import A from"./Step4-v9MMVD5k.js";import E from"./Step5-CTjDp9Xd.js";import q from"./Step6-DQgp8-PL.js";import D from"./Step7-BPCLvQMD.js";import W from"./Step8-DBnMgxwT.js";import H from"./Step9-2RKVKV4d.js";import{u as K,a as R}from"./index-DcRx_qMm.js";import{M as Y,S as G}from"./sun-Cn8MmWHN.js";import"./index-6n_iKpwB.js";import"./index-Ds9HV7qR.js";import"./index-Bep5Ew2j.js";import"./index-CptKtDcN.js";import"./index-D3qxtxH9.js";import"./useFormatters-BAefhHg6.js";import"./createLucideIcon-Celos4K_.js";const J={class:"onboarding-wrapper"},Q={class:"d-flex justify-content-between align-items-center mb-4 px-2"},U={class:"text-muted"},X={class:"d-flex align-items-center gap-2",style:{"min-width":"220px"}},Z={class:"progress flex-grow-1",style:{height:"6px"}},ee={class:"fw-semibold"},te={class:"row g-lg-4"},se={class:"col-lg-3 mb-4"},oe={class:"wizard-aside"},le={class:"steps-nav shadow-sm rounded-4 p-3 bg-white"},re={class:"steps-list list-unstyled m-0"},ie=["onClick"],ae={key:0,class:"bi bi-check-circle-fill float-end text-success"},ne={class:"col-lg-9"},ce={class:"card wizard-card shadow-lg border-0 rounded-4 d-flex flex-column"},de={class:"wizard-scroll p-3 p-md-4"},ue={class:"wizard-footer footer d-flex justify-content-end gap-2 p-3"},pe=["disabled"],me=["disabled"],ve={key:0,class:"d-flex align-items-center"},fe={key:1},ge={__name:"Index",props:{isOnboarding:{type:Boolean,default:!0}},setup(_e){const i=m({}),a=m({current_step:1,completed_steps:[]}),t=m(1),g=m({}),n=m(!1),b=K({selector:"html",attribute:"class",valueDark:"dark",valueLight:"light"}),S=R(b),c=[{id:1,title:"Welcome & Language Selection"},{id:2,title:"Business Information"},{id:3,title:"Currency & Locale"},{id:4,title:"Tax & VAT Setup"},{id:5,title:"Order Type & Service Options"},{id:6,title:"Receipt & Printer Setup"},{id:7,title:"Payment Methods"},{id:8,title:"Business Hours"},{id:9,title:"Optional Features"}],w=y(()=>({1:L,2:M,3:V,4:A,5:E,6:q,7:D,8:W,9:H})[t.value]),k=y(()=>t.value/c.length*100);function C(e){if(e!==t.value){if(e<t.value){console.log("Prev: ",e),t.value=e;return}if(a.value.completed_steps.includes(e)){console.log("Steps Completed: ",e),t.value=e;return}if(e===t.value+1&&a.value.completed_steps.includes(t.value)){t.value=e;return}v.error("Please complete the Current step to proceed")}}const z=e=>{console.log("Payload received:",e);try{const s=e?.step||t.value,l=e?.data||{},u=i.value||{};Object.assign(i.value,l),console.log("Step Number:",s),console.log("Step Data:",l),console.log("Profile After Merge:",i.value),s===9&&h(i.value)}catch(s){console.error("saveStep error:",s)}};async function O(){try{n.value=!0;const{data:e}=await x.post("/onboarding/complete",{profile:i.value,completed_steps:a.value.completed_steps});v.success("Onboarding completed successfully! Your profile created."),setTimeout(()=>{window.location.href="/dashboard"},3e3)}catch(e){console.error("final save error:",e),v.error("Something went wrong while completing onboarding.")}finally{n.value=!1}}async function h(e){if(g.value={},!n.value){n.value=!0;try{let s;t.value===2&&e.logo_file||t.value===6&&e.receipt_logo_file?(s=new FormData,Object.keys(e).forEach(u=>{e[u]!==null&&e[u]!==void 0&&s.append(u,e[u])})):s=e;const{data:l}=await x.post(`/onboarding/step/${t.value}`,s,t.value===2&&e.logo_file||t.value===6&&e.receipt_logo_file?{headers:{"Content-Type":"multipart/form-data"}}:{});Object.assign(i.value,l.profile||{}),a.value.completed_steps.includes(t.value)||a.value.completed_steps.push(t.value),t.value<c.length&&t.value++}catch(s){s?.response?.status===422&&s.response.data?.errors?(g.value=s.response.data.errors,v.error("Please fill in all required fields correctly.")):(v.error("An unexpected error occurred."),console.error(s))}finally{n.value=!1}}}return(e,s)=>(r(),d("div",J,[o("div",Q,[o("div",null,[s[3]||(s[3]=o("h5",{class:"fw-bold mb-0"},"Onboarding Wizard",-1)),o("small",U," Step "+p(t.value)+" of "+p(c.length)+" - "+p(c.find(l=>l.id===t.value)?.title),1)]),o("div",X,[o("div",Z,[o("div",{class:"progress-bar progress-bar-striped",role:"progressbar",style:P({width:k.value+"%"})},null,4)]),o("small",ee,p(t.value)+"/"+p(c.length),1),o("button",{style:{"border-radius":"50%"},class:"btn btn-sm btn-outline-secondary py-2",onClick:s[0]||(s[0]=l=>f(S)())},[f(b)?(r(),_(f(Y),{key:0,size:20})):(r(),_(f(G),{key:1,size:20}))])])]),o("div",te,[o("div",se,[o("div",oe,[o("div",le,[o("ul",re,[(r(),d(j,null,N(c,l=>o("li",{key:l.id,class:T(["step-item p-2 rounded mb-1",{"active-step":t.value===l.id,"completed-step":a.value.completed_steps?.includes(l.id)}]),onClick:u=>C(l.id)},[o("span",null,p(l.title),1),a.value.completed_steps?.includes(l.id)?(r(),d("i",ae)):$("",!0)],10,ie)),64))])])])]),o("div",ne,[o("div",ce,[o("div",de,[(r(),_(F(w.value),{model:i.value,"form-errors":g.value,onSave:z,"is-onboarding":!0},null,40,["model","form-errors"]))]),o("div",ue,[o("button",{class:"btn btn-secondary py-2 px-4",disabled:t.value===1,onClick:s[1]||(s[1]=l=>t.value--)},"Back",8,pe),t.value<c.length?(r(),d("button",{key:0,class:"btn btn-primary rounded-pill px-4 py-2",onClick:s[2]||(s[2]=l=>h(i.value))}," Next ")):(r(),d("button",{key:1,class:"btn btn-success rounded-pill px-4 d-flex align-items-center justify-content-center gap-2",onClick:O,disabled:n.value},[n.value?(r(),d("span",ve,[...s[4]||(s[4]=[o("div",{class:"spinner-border spinner-border-sm text-light me-2",role:"status",style:{width:"1rem",height:"1rem"}},null,-1),I(" Saving... ",-1)])])):(r(),d("span",fe,"Finish & Save"))],8,me))])])])])]))}},Me=B(ge,[["__scopeId","data-v-0c275a3c"]]);export{Me as default};
