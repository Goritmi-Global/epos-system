import{_ as Ve,a as re,b as d,w as Ae,f as u,m as f,e as t,t as n,V as tt,c as A,r as y,o as lt,n as Se,y as Ce,p as $,I as at,E as ot,d as x,u as k,h as st,F as N,g as X,i as b,j as nt,k as w,v as S,l as ie,W as it,T as rt,X as dt,q as g}from"./app-BoyYQDe8.js";import{_ as ut}from"./Master-CPVtVnI4.js";import{s as G}from"./index-Dbc8WUb1.js";import{s as Ie}from"./index-D0ridfLM.js";import{E as ct,a as pt,X as mt,u as W,w as vt}from"./xlsx-hePAvcYj.js";import{F as gt}from"./FilterModal-BcHXGrS0.js";import{u as yt}from"./useFormatters-D_81Aa_M.js";import{I as ft}from"./importFile-CtaHyV9s.js";import{P as bt}from"./package-D4WwQe3i.js";import{C as _t}from"./circle-x-D071zuu_.js";import{T as ht}from"./triangle-alert-DxBogJ7N.js";import{c as de}from"./createLucideIcon-ChBG8ZBO.js";import{P as kt}from"./plus-D0XJ_9ss.js";import{E as xt}from"./eye-DxuBuI9A.js";import{P as wt}from"./pencil-CsVFTzWr.js";import"./index-OEb9M1lf.js";import"./index-L2ub2HX8.js";import"./index-C31nZpoI.js";import"./sun-BgVcPDYw.js";import"./index-CRQzX_M8.js";import"./index-DfVEt9cK.js";import"./index-Dj3d1R6-.js";/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const St=de("calendar-clock",[["path",{d:"M16 14v2.2l1.6 1",key:"fo4ql5"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]]);/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ct=de("calendar-x-2",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 13V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"3spt84"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m17 22 5-5",key:"1k6ppv"}],["path",{d:"m17 17 5 5",key:"p7ous7"}]]);/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const It=de("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),Vt={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},At={class:"bg-white rounded-xl shadow-xl w-full max-w-md p-6 animate-drop-in relative"},Mt={class:"text-center text-lg font-medium text-gray-800 mb-2"},Ft={class:"text-center text-sm text-gray-500 mb-6"},$t={__name:"StockOutConfirmationModal",props:{show:Boolean,title:String,message:String},emits:["confirm","close"],setup(O,{emit:P}){const D=P,M=()=>D("confirm"),Y=()=>D("close");return(B,I)=>(d(),re(tt,{name:"fade-slide"},{default:Ae(()=>[O.show?(d(),u("div",Vt,[t("div",At,[t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110",onClick:Y,title:"Close"},[...I[0]||(I[0]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])]),I[1]||(I[1]=t("div",{class:"flex justify-center mb-4"},[t("div",{class:"bg-gray-100 p-3 rounded-full"},[t("svg",{class:"w-8 h-8 text-danger",fill:"none",stroke:"currentColor","stroke-width":"2",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v2m0 4h.01M12 19a7 7 0 100-14 7 7 0 000 14z"})])])],-1)),t("h3",Mt,n(O.title),1),t("p",Ft,n(O.message),1),t("div",{class:"flex justify-center gap-3"},[t("button",{onClick:M,class:"btn btn-primary d-flex align-items-center gap-1 px-3 py-2 rounded-pill text-white"}," Yes, I'm sure "),t("button",{onClick:Y,class:"btn btn-secondary d-flex align-items-center gap-1 px-3 py-2 rounded-pill text-white"}," Cancel ")])])])):f("",!0)]),_:1}))}},Ut=Ve($t,[["__scopeId","data-v-500efa34"]]),Et={class:"page-wrapper"},qt={class:"row g-4"},Dt={class:"card border-0 shadow-sm rounded-4"},jt={class:"card-body d-flex align-items-center justify-content-between"},Nt={class:"fw-bold fs-4"},Pt={class:"text-muted fs-6"},Lt={class:"card border-0 shadow-lg rounded-4"},Tt={class:"card-body"},Ot={class:"d-flex flex-wrap gap-2 justify-content-between align-items-center mb-3"},Bt={class:"d-flex flex-wrap gap-2 align-items-center"},Rt={class:"search-wrap"},Qt={key:1,class:"form-control search-input",placeholder:"Search",disabled:"",type:"text"},Ht={class:"dropdown"},Kt={class:"dropdown-menu dropdown-menu-end shadow rounded-4 py-2"},zt={class:"table-responsive"},Zt={class:"table table-striped"},Xt={key:0},Gt={key:1},Wt={class:"fw-semibold"},Yt={class:"text-truncate",style:{"max-width":"260px"}},Jt={class:"text-center"},el={key:0,class:"badge bg-red-600 rounded-pill d-inline-block text-center",style:{"min-width":"100px"}},tl={key:1,class:"badge bg-warning rounded-pill d-inline-block text-center",style:{"min-width":"100px"}},ll={key:2,class:"badge bg-success rounded-pill d-inline-block text-center",style:{"min-width":"100px"}},al={class:"text-center"},ol={class:"d-inline-flex align-items-center gap-3"},sl=["onClick"],nl=["onClick"],il=["onClick"],rl={key:0},dl={key:0,class:"mt-4 d-flex justify-content-between align-items-center"},ul={class:"text-muted small"},cl={class:"modal fade",id:"addItemModal",tabindex:"-1","aria-hidden":"true"},pl={class:"modal-dialog modal-lg modal-dialog-centered",role:"document"},ml={class:"modal-content rounded-4"},vl={class:"modal-header"},gl={class:"modal-title fw-semibold"},yl={class:"modal-body"},fl={class:"row g-3"},bl={class:"col-md-6"},_l={key:0,class:"text-danger"},hl={class:"col-md-6"},kl={key:0,class:"text-danger"},xl={key:0,class:"col-md-6"},wl={key:0,class:"text-danger"},Sl={class:"col-md-6"},Cl={key:0,class:"text-danger"},Il={class:"col-md-6"},Vl={key:0,class:"text-danger"},Al={class:"col-md-6"},Ml={key:0,class:"text-danger"},Fl={class:"col-md-6"},$l={key:0,class:"text-danger"},Ul={class:"col-12"},El={key:0,class:"text-danger"},ql={class:"row g-3"},Dl={class:"col-md-3"},jl={key:0,class:"text-danger"},Nl={class:"col-md-3"},Pl={key:0,class:"text-danger"},Ll={class:"col-md-3"},Tl={key:0,class:"text-danger"},Ol={class:"col-md-3"},Bl={key:0,class:"text-danger"},Rl={class:"row g-4 mt-1"},Ql={class:"col-md-6"},Hl={key:0,class:"text-danger"},Kl={class:"col-md-6"},zl={key:0,class:"text-danger"},Zl={class:"col-md-4"},Xl=["src"],Gl={key:1,class:"placeholder"},Wl={key:0,class:"text-danger"},Yl={class:"mt-4"},Jl=["disabled"],ea={class:"modal fade",id:"viewItemModal",tabindex:"-1","aria-hidden":"true"},ta={class:"modal-dialog modal-lg modal-dialog-centered"},la={class:"modal-content border-0 shadow-lg rounded-4 overflow-hidden"},aa={class:"modal-header bg-light"},oa={class:"d-flex align-items-center gap-2"},sa={key:0,class:"text-muted"},na={class:"modal-body"},ia={key:0,class:"row g-4"},ra={class:"col-12 col-md-7"},da={class:"card border-0 shadow-sm rounded-4"},ua={class:"card-body"},ca={class:"fw-semibold mb-3"},pa={class:"text-muted small mb-2"},ma={class:"row g-3 small"},va={class:"col-6"},ga={class:"fw-semibold text-muted"},ya={class:"col-6"},fa={class:"fw-semibold text-muted"},ba={class:"col-6"},_a={class:"fw-semibold text-muted"},ha={class:"col-12"},ka={class:"fw-semibold text-muted"},xa={class:"col-12"},wa={class:"fw-semibold text-muted"},Sa={class:"d-flex flex-wrap gap-2 mt-2"},Ca={class:"badge rounded-pill bg-primary text-white"},Ia={class:"badge rounded-pill bg-success text-white"},Va={class:"badge rounded-pill bg-warning text-white"},Aa={class:"badge rounded-pill bg-secondary text-white"},Ma={class:"d-flex flex-wrap gap-2 mt-2"},Fa={class:"d-flex flex-wrap gap-2 mt-2"},$a={class:"col-12 col-md-5"},Ua={class:"card border-0 shadow-sm rounded-4 h-100"},Ea={class:"card-body d-flex flex-column align-items-center justify-content-center"},qa={key:0,class:"w-100"},Da=["src"],ja={class:"card-footer bg-transparent small d-flex justify-content-between"},Na={class:"badge bg-gray-500 rounded-pill text-white p-2"},Pa={class:"card-footer bg-transparent small d-flex justify-content-between"},La={class:"fw-semibold"},Ta={class:"card-footer bg-transparent small d-flex justify-content-between"},Oa={class:"fw-semibold"},Ba={class:"card border-0 shadow-lg rounded-4 overflow-hidden"},Ra={class:"table-responsive"},Qa={class:"table table-striped mb-0"},Ha={class:"fw-semibold"},Ka={class:"fw-semibold"},za={class:"text-muted"},Za={class:"text-muted"},Xa={class:"text-muted"},Ga={class:"text-center"},Wa={key:0},Ya={class:"fw-semibold text-muted w-50"},Ja={class:"modal fade",id:"stockInModal",tabindex:"-1","aria-hidden":"true"},eo={class:"modal-dialog modal-lg modal-dialog-centered"},to={class:"modal-content rounded-4"},lo={class:"modal-header"},ao={class:"modal-title"},oo={class:"modal-body"},so={class:"row g-3"},no={class:"col-md-6"},io={key:0,class:"text-danger"},ro={class:"col-md-6"},uo=["value"],co={key:0,class:"text-danger"},po={class:"col-md-6"},mo={key:0,class:"text-danger"},vo={class:"col-md-6"},go={class:"col-md-4"},yo={key:0,class:"text-danger"},fo={class:"col-md-4"},bo={key:0,class:"text-danger"},_o={class:"col-md-4"},ho={class:"col-md-12"},ko={key:0,class:"text-danger"},xo={class:"col-md-12"},wo={class:"mt-4"},So=["disabled"],Co={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},Io={class:"modal fade",id:"stockOutModal",tabindex:"-1","aria-hidden":"true"},Vo={class:"modal-dialog modal-lg modal-dialog-centered"},Ao={class:"modal-content rounded-4"},Mo={class:"modal-header"},Fo={class:"modal-title"},$o={class:"modal-body"},Uo={class:"row g-3"},Eo={class:"col-md-6"},qo={class:"col-md-6"},Do=["value"],jo={key:0,class:"text-danger"},No={class:"col-md-6"},Po={class:"col-md-6"},Lo={key:0,class:"text-danger"},To={class:"col-md-12"},Oo={class:"mt-4 text-end"},Bo=["disabled"],Ro={__name:"Index",props:{inventories:Array,allergies:Array,tags:Array,units:Array,suppliers:Array,categories:Array},setup(O){const{formatCurrencySymbol:P,dateFmt:D}=yt(),M=O,Y=A(()=>M.categories.filter(l=>!l.parent_id)),B=A(()=>M.categories.filter(l=>l.parent_id===i.value.category_id)),I=y(!1),V=y({current_page:1,last_page:1,per_page:10,total:0,from:0,to:0,links:[]}),R=y(M.inventories?.data||[]),Q=A(()=>R.value),q=async(l=null)=>{I.value=!0;try{console.log("üîç Fetching with params:",{q:U.value,page:l||V.value.current_page,per_page:V.value.per_page});const e=await $.get("inventory/api-inventories",{params:{q:U.value,page:l||V.value.current_page,per_page:V.value.per_page}});R.value=e.data.data||[],console.log("üìä Response pagination:",{current_page:e.data.current_page,last_page:e.data.last_page,per_page:e.data.per_page,total:e.data.total,data_length:R.value.length}),V.value={current_page:e.data.current_page,last_page:e.data.last_page,per_page:e.data.per_page,total:e.data.total,from:e.data.from,to:e.data.to,links:e.data.links},I.value=!1}catch(e){console.error("‚ùå Fetch inventories error:",e),g.error("Failed to load inventories"),I.value=!1}},Me=async()=>{try{return I.value=!0,(await $.get("inventory/api-inventories",{params:{q:U.value,per_page:1e4,page:1}})).data.data||[]}catch(l){return console.error("‚ùå Error fetching export data:",l),g.error("Failed to load data for export"),[]}finally{I.value=!1}},Fe=l=>{if(!l)return;const o=new URLSearchParams(l.split("?")[1]).get("page");o&&q(parseInt(o))};lt(async()=>{U.value="",ue.value=Date.now(),await Se(),setTimeout(()=>{ce.value=!0;const e=document.getElementById(le);e&&(e.value="",U.value="")},100),q(),H();const l=document.getElementById("inventoryFilterModal");l&&l.addEventListener("hidden.bs.modal",()=>{C.value={...ae.value}})});const U=y(""),ue=y(Date.now()),le=`search-${Math.random().toString(36).substr(2,9)}`,ce=y(!1);y("");const C=y({sortBy:"",category:"",supplier:"",stockStatus:"",priceMin:null,priceMax:null,dateFrom:"",dateTo:""}),ae=y({...C.value}),$e=A(()=>{let l=[...Q.value];const e=U.value.trim().toLowerCase();return e&&(l=l.filter(o=>{const a=(o?.name||"").toLowerCase(),c=o.category&&typeof o.category=="object"?(o.category.name||"").toLowerCase():(o?.category||"").toString().toLowerCase(),_=o.unit&&typeof o.unit=="object"?(o?.unit?.name||"").toLowerCase():(o?.unit||"").toString().toLowerCase();return a.includes(e)||c.includes(e)||_.includes(e)})),C.value.category&&(l=l.filter(o=>(o?.category&&typeof o.category=="object"?o.category.id:o?.category_id)==C.value.category)),C.value.supplier&&(l=l.filter(o=>(o?.supplier&&typeof o.supplier=="object"?o.supplier.id:o?.supplier_id)==C.value.supplier)),C.value.stockStatus&&(l=l.filter(o=>{const a=o.availableStock||0,c=o.minAlert||5;switch(C.value.stockStatus){case"in_stock":return a>=c;case"low_stock":return a>0&&a<c;case"out_of_stock":return a<=0;case"expired":return o.status==="expired";case"near_expiry":return o.status==="near_expiry";default:return!0}})),(C.value.priceMin!==null||C.value.priceMax!==null)&&(l=l.filter(o=>{const a=o.price||o.stockValue||0,c=C.value.priceMin||0,_=C.value.priceMax||1/0;return a>=c&&a<=_})),l}),Ue=()=>{ae.value={...C.value}},Ee=()=>{C.value={sortBy:"",category:"",supplier:"",stockStatus:"",priceMin:null,priceMax:null,dateFrom:"",dateTo:""},ae.value={...C.value}},pe=A(()=>{const l=[...$e.value];switch(C.value.sortBy){case"stock_desc":return l.sort((o,a)=>(a.availableStock||0)-(o.availableStock||0));case"stock_asc":return l.sort((o,a)=>(o.availableStock||0)-(a.availableStock||0));case"name_asc":return l.sort((o,a)=>(o.name||"").localeCompare(a.name||""));case"name_desc":return l.sort((o,a)=>(a.name||"").localeCompare(o.name||""));default:return l}});let me=null;Ce(U,(l,e)=>{clearTimeout(me),me=setTimeout(()=>{V.value.current_page=1,(!l||l.trim()==="")&&(V.value.per_page=10),q(1)},500)});const J=A(()=>({sortOptions:[{value:"stock_desc",label:"Stock: High to Low"},{value:"stock_asc",label:"Stock: Low to High"},{value:"name_asc",label:"Name: A to Z"},{value:"name_desc",label:"Name: Z to A"}],categories:M.categories||[],suppliers:M.suppliers||[],stockStatusOptions:[{value:"in_stock",label:"In Stock"},{value:"low_stock",label:"Low Stock"},{value:"out_of_stock",label:"Out of Stock"},{value:"expired",label:"Expired"},{value:"near_expiry",label:"Near Expiry"}]}));A(()=>Q.value.length);const ve=y([]),L=y({total_items:0,out_of_stock:0,low_stock:0,expired:0,near_expiry:0}),H=async()=>{try{const l=await $.get("/inventory/kpi-stats");L.value=l.data}catch(l){console.error("‚ùå Failed to fetch KPI stats:",l)}};A(()=>Q.value.filter(l=>l.availableStock>0&&l.availableStock<(l.minAlert||5)).length),A(()=>Q.value.filter(l=>l.availableStock<=0).length),A(()=>ve.value.filter(l=>{if(l.stock_type!=="stockin"||!l.expiry_date)return!1;const e=new Date(l.expiry_date),o=new Date;e.setHours(0,0,0,0),o.setHours(0,0,0,0);const a=e<o,c=(l.quantity||0)>(l.allocated_quantity||0);return a&&c}).length),A(()=>ve.value.filter(l=>{if(l.stock_type!=="stockin"||!l.expiry_date)return!1;const a=(new Date(l.expiry_date)-new Date)/(1e3*60*60*24),c=a>0&&a<=15,_=(l.quantity||0)>(l.allocated_quantity||0);return c&&_}).length);const qe=A(()=>[{label:"Total Items",value:L.value.total_items??0,icon:bt,iconBg:"bg-soft-success",iconColor:"text-success"},{label:"Out of Stock",value:L.value.out_of_stock??0,icon:_t,iconBg:"bg-soft-danger",iconColor:"text-danger"},{label:"Low Stock",value:L.value.low_stock??0,icon:ht,iconBg:"bg-soft-warning",iconColor:"text-warning"},{label:"Expired Stock",value:L.value.expired??0,icon:Ct,iconBg:"bg-soft-danger",iconColor:"text-danger"},{label:"Near Expire Stock",value:L.value.near_expiry??0,icon:St,iconBg:"bg-soft-info",iconColor:"text-info"}]);at(()=>window.feather?.replace?.());const s=y({}),i=y({id:null,name:"",category_id:null,subcategory_id:null,unit_id:null,supplier_id:null,minAlert:null,sku:"",description:"",nutrition:{calories:0,fat:0,protein:0,carbs:0},allergies:[],tags:[],imageFile:null,imageUrl:null}),ee=y(!1),De=async()=>{ee.value=!0,s.value={};const l=new FormData;if(l.append("name",(i.value.name||"").trim()),i.value.category_id&&l.append("category_id",i.value.category_id),B.value.length&&i.value.subcategory_id&&l.append("subcategory_id",i.value.subcategory_id),i.value.unit_id&&l.append("unit_id",i.value.unit_id),i.value.minAlert!==null&&i.value.minAlert!==""&&l.append("minAlert",i.value.minAlert),i.value.supplier_id&&l.append("supplier_id",i.value.supplier_id),l.append("sku",i.value.sku||""),l.append("description",i.value.description||""),l.append("nutrition[calories]",i.value.nutrition.calories),l.append("nutrition[fat]",i.value.nutrition.fat),l.append("nutrition[protein]",i.value.nutrition.protein),l.append("nutrition[carbs]",i.value.nutrition.carbs),(i.value.allergies||[]).forEach((e,o)=>l.append(`allergies[${o}]`,e)),(i.value.tags||[]).forEach((e,o)=>l.append(`tags[${o}]`,e)),i.value.imageFile){const e=(i.value.imageFile.type?.split("/")?.[1]||"webp").replace("jpeg","jpg");l.append("image",i.value.imageFile,`image.${e}`)}try{i.value.id?(await $.post(`/inventory/${i.value.id}?_method=PUT`,l,{headers:{"Content-Type":"multipart/form-data"}}),g.success(" Inventory Item updated successfully")):(await $.post("/inventory",l,{headers:{"Content-Type":"multipart/form-data"}}),g.success(" Inventory Item created successfully")),oe(),await q();const e=document.getElementById("addItemModal");bootstrap.Modal.getInstance(e)?.hide()}catch(e){e?.response?.status===422&&e.response.data?.errors?(s.value=e.response.data.errors,g.error("Please fill in all required fields correctly.")):(console.error("‚ùå Error saving:",e.response?.data||e.message),g.error("Failed to save Inventory Item"))}finally{ee.value=!1}};Ce(i,l=>{Object.keys(s.value).forEach(e=>{if(e.includes(".")){const[o,a]=e.split(".");l[o]&&l[o][a]!==""&&delete s.value[e]}else{const o=l[e];o!=null&&o!==""&&(!Array.isArray(o)||o.length>0)&&delete s.value[e]}})},{deep:!0});const je=l=>{const e=c=>c===""||c===null||c===void 0?null:Number(c);let o=null,a=null;if(l.category&&typeof l.category=="object"){const c=l.category;c.parent_id?(a=e(c.id),o=e(c.parent_id)):(o=e(c.id),a=null)}else o=e(l.category_id),a=e(l.subcategory_id);i.value={id:l.id,name:l.name??"",category_id:o,subcategory_id:a,unit_id:e(l.unit_id),supplier_id:e(l.supplier_id),minAlert:l.minAlert??0,sku:l.sku??"",description:l.description??"",nutrition:l.nutrition??{calories:0,protein:0,fat:0,carbs:0},allergies:l.allergy_ids??[],tags:l.tag_ids??[],imageFile:null,imageUrl:l.image_url??null},Se(()=>{B.value.some(_=>_.id===i.value.subcategory_id)||(i.value.subcategory_id=null)})};function oe(){i.value={id:null,name:"",category_id:null,subcategory_id:null,unit_id:null,minAlert:"",supplier_id:null,sku:"",description:"",nutrition:{calories:"",fat:"",protein:"",carbs:""},allergies:[],tags:[],imageFile:null,imageUrl:null}}const h=y({}),Ne=async l=>{try{const e=await $.get(`/inventory/${l.id}`);h.value=e.data,await We(l.id)}catch(e){console.error("Error fetching item:",e)}};function K(){const l=Number(m.value.quantity||0),e=Number(m.value.price||0);m.value.value=l*e}const m=y({product_id:null,name:"",category_id:null,supplier_id:null,available_quantity:0,quantity:0,price:0,value:0,expiry_date:"",description:"",operation_type:"purchase",stock_type:"stockin",purchase_date:new Date().toISOString().slice(0,10),user_id:1}),E=y(!1),z=y();function ge(){m.value.quantity=0,m.value.price=0,m.value.value=0,m.value.expiry_date="",m.value.description=""}const ye=()=>{s.value={}};async function Pe(){console.log(m.value),E.value=!0,K();try{await $.post("/stock_entries",m.value),g.success(" Stock In saved successfully"),ge(),bootstrap.Modal.getInstance(document.getElementById("stockInModal"))?.hide(),await q(),await H()}catch(l){l?.response?.status===422&&l.response.data?.errors?(s.value=l.response.data.errors,g.error("Please fill in all required fields correctly.")):(g.error("Something went wrong. Please try again.",{autoClose:3e3}),console.error(l))}finally{E.value=!1}}const Le=y(null),Te=y(null);y(null);const T=y(!1),se=y(null),Oe=l=>{se.value=l,T.value=!0},Be=()=>{if(T.value=!1,!se.value){console.error("‚ùå No item selected for stock out"),g.error("No item selected");return}Re(se.value)};async function Re(l){if(!l){console.error("‚ùå No item provided to confirmStockOut");return}try{console.log(" Attempting stock out for item:",l);const o=(await $.get(`/stock_entries/total/${l.id}`)).data||{},a=o.available||0;if(console.log(" Stock data received:",o),console.log(" Available quantity:",a),a<=0){g.warning(`No available stock for "${l.name}". Current stock: ${a}`,{autoClose:4e3}),T.value=!1;return}const c={product_id:l.id,name:l.name,category_id:l.category?.id,available_quantity:a,quantity:a,price:0,value:0,description:"Auto full stock-out",operation_type:"inventory_stockout",stock_type:"stockout",purchase_date:new Date().toISOString().slice(0,10),user_id:1};console.log(" Submitting stock out payload:",c),await $.post("/stock_entries",c),g.success(`Successfully stocked out ${a} units of "${l.name}"`,{autoClose:3e3}),await q(),await H()}catch(e){console.error("‚ùå Stock out error:",e),console.error("‚ùå Error response:",e.response?.data),e?.response?.data?.errors?.quantity?g.error(e.response.data.errors.quantity[0]):g.error("Stock out failed. Please try again.")}finally{T.value=!1}}async function Qe(){if(E.value=!0,K(),m.value.quantity>m.value.available_quantity){s.value.quantity=["The quantity should not exceed the available quantity."],g.error("The quantity should not exceed the available quantity."),E.value=!1;return}else s.value.quantity=null;try{await $.post("/stock_entries",m.value),g.success("Stock Out saved successfully"),ge(),bootstrap.Modal.getInstance(document.getElementById("stockOutModal"))?.hide(),await q(),await H()}catch(l){l?.response?.status===422&&l.response.data?.errors?(s.value=l.response.data.errors,g.error("Please fill in all required fields correctly.")):(g.error("Something went wrong. Please try again.",{autoClose:3e3}),console.error(l))}finally{E.value=!1}}const ne=async l=>{if(!R.value||R.value.length===0){g.error("No inventory data to download");return}try{I.value=!0;const e=await Me();if(!e.length){g.error("No inventory items found to download"),I.value=!1;return}l==="pdf"?Ke(e):l==="excel"?ze(e):l==="csv"?He(e):g.error("Invalid download type")}catch(e){console.error("Download failed:",e),g.error(`Download failed: ${e.message}`)}finally{I.value=!1}},He=l=>{try{const e=["name","sku","category","min_alert","unit","preferred_supplier","min_stock_alert","available_stock","calories","fat","protein","carbs","allergies","tags"],o=l.map(r=>{let p="";return r.nutrition&&typeof r.nutrition=="object"?p=Object.entries(r.nutrition).map(([F,j])=>`${F}: ${j}`).join("; "):typeof r.nutrition=="string"&&(p=r.nutrition),[`"${(r.name||"").replace(/"/g,'""')}"`,`"${(r.sku||"").replace(/"/g,'""')}"`,`"${(r.category?.name||"").replace(/"/g,'""')}"`,`"${r.minAlert||""}"`,`"${(r.unit_name||"").replace(/"/g,'""')}"`,`"${(r.supplier_name||"").replace(/"/g,'""')}"`,`"${r.minAlert||""}"`,`"${r.availableStock||""}"`,`"${r.nutrition?.calories||0}"`,`"${r.nutrition?.protein||0}"`,`"${r.nutrition?.fat||0}"`,`"${r.nutrition?.carbs||0}"`,`"${Array.isArray(r.allergies)?r.allergies.join(", "):r.allergies||""}"`,`"${Array.isArray(r.tags)?r.tags.join(", "):r.tags||""}"`]}),a=[e.join(","),...o.map(r=>r.join(","))].join(`
`),c=new Blob([a],{type:"text/csv;charset=utf-8;"}),_=URL.createObjectURL(c),v=document.createElement("a");v.setAttribute("href",_),v.setAttribute("download",`inventory_items_${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(v),v.click(),document.body.removeChild(v),URL.revokeObjectURL(_),g.success(`CSV downloaded successfully (${l.length} items)`,{autoClose:2500})}catch(e){console.error("CSV generation error:",e),g.error(`CSV generation failed: ${e.message}`,{autoClose:5e3})}},Ke=l=>{try{const e=new ct("l","mm","a4");e.setFontSize(18),e.setFont("helvetica","bold"),e.text("Inventory Items Report",14,15),e.setFontSize(10),e.setFont("helvetica","normal");const o=new Date().toLocaleString();e.text(`Generated on: ${o}`,14,22),e.text(`Total Items: ${l.length}`,14,28);const a=["Name","SKU","Category","Min Alert","Unit","Preferred Supplier","Min Stock Alert","Available Stock","Calories","Fat","Protein","Carbs","Allergies","Tags"],c=l.map(v=>[v.name||"",v.sku||"",v.category?.name||"",v.minAlert||"",v.unit_name||"",v.supplier_name||"",v.minAlert||"",v.availableStock||"",v.nutrition?.calories||"",v.nutrition?.fat||"",v.nutrition?.protein||"",v.nutrition?.carbs||"",Array.isArray(v.allergies)?v.allergies.join(", "):v.allergies||"",Array.isArray(v.tags)?v.tags.join(", "):v.tags||""]);pt(e,{head:[a],body:c,startY:35,styles:{fontSize:8,cellPadding:2,halign:"left",lineColor:[0,0,0],lineWidth:.1},headStyles:{fillColor:[41,128,185],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]},margin:{left:14,right:14},didDrawPage:v=>{const r=e.internal.getNumberOfPages(),p=e.internal.pageSize.height;e.setFontSize(8),e.text(`Page ${v.pageNumber} of ${r}`,v.settings.margin.left,p-10)}});const _=`inventory_items_${new Date().toISOString().split("T")[0]}.pdf`;e.save(_),g.success(`PDF downloaded successfully (${l.length} items)`,{autoClose:2500})}catch(e){console.error("PDF generation error:",e),g.error(`PDF generation failed: ${e.message}`,{autoClose:5e3})}},ze=l=>{try{if(typeof mt>"u")throw new Error("XLSX library is not loaded");const e=l.map(r=>({Name:r.name||"",SKU:r.sku||"",Category:r.category?.name||"",Min_Alert:r.minAlert||"",Unit:r.unit_name||"",Preferred_Supplier:r.supplier_name||"",Min_Stock_Alert:r.minAlert||"",Available_Stock:r.availableStock||"",Calories:r.nutrition?.calories||"",Fat:r.nutrition?.fat||"",Protein:r.nutrition?.protein||"",Carbs:r.nutrition?.carbs||"",Allergies:Array.isArray(r.allergies)?r.allergies.join(", "):r.allergies||"",Tags:Array.isArray(r.tags)?r.tags.join(", "):r.tags||""})),o=W.book_new(),a=W.json_to_sheet(e);a["!cols"]=[{wch:25},{wch:15},{wch:20},{wch:12},{wch:15},{wch:25},{wch:15},{wch:18},{wch:10},{wch:10},{wch:10},{wch:10},{wch:25},{wch:25}],W.book_append_sheet(o,a,"Inventory Items");const c=[{Info:"Generated On",Value:new Date().toLocaleString()},{Info:"Total Records",Value:l.length},{Info:"Exported By",Value:"Inventory Management System"}],_=W.json_to_sheet(c);W.book_append_sheet(o,_,"Report Info");const v=`inventory_items_${new Date().toISOString().split("T")[0]}.xlsx`;vt(o,v),g.success(`Excel file downloaded successfully (${l.length} items)`,{autoClose:2500})}catch(e){console.error("Excel generation error:",e),g.error(`Excel generation failed: ${e.message}`,{autoClose:5e3})}},fe=y(!1),Ze=y(!1),be=y(null);function Xe(l){be.value=i.value.imageUrl,be.value&&(Ze.value=!0)}function Ge({file:l}){i.value.imageFile=l,i.value.imageUrl=URL.createObjectURL(l)}y("");const _e=y(0),he=y(0),ke=y(0),xe=y(0),Z=y([]);async function We(l){try{const{data:e}=await $.get(`/stock_entries/by-item/${l}`),o=e?.data||{};console.log(o),Z.value=o.records||[],_e.value=o.near_count??0,he.value=o.expired_count??0,ke.value=o.near_qty??0,xe.value=o.expired_qty??0}catch(e){console.error(e),Z.value=[],_e.value=he.value=0,ke.value=xe.value=0}}function Ye(l){return l==="expired"?"Expired":l==="near"?"Near Expire":"Active"}function Je(l){return l==="expired"?"bg-danger":l==="near"?"bg-warning":"bg-success"}const te=A(()=>{const l=Z.value||[];let e=0,o=0,a=0,c=0,_=0;const v=new Date;v.setHours(0,0,0,0);for(const r of l){const p=parseFloat(r?.quantity??0);if(e+=p,o+=Number(r?.price??0),a+=Number(r?.value??0),!r?.expiry_date)c+=p;else{const we=new Date(r.expiry_date);we.setHours(0,0,0,0),we>=v&&(c+=p)}const F=parseFloat(r?.allocated_quantity??0),j=Math.max(0,p-F);(!r?.expiry_date||new Date(r.expiry_date)>=v)&&(_+=j)}return{totalQty:Number(e.toFixed(2)),totalPrice:Number(o.toFixed(2)),totalValue:Number(a.toFixed(2)),notExpiredQty:Number(c.toFixed(2)),availableQty:Number(_.toFixed(2))}}),et=l=>{if(!l||l.length<=1){g.error("The imported file is empty.");return}const e=l[0];console.log("headers are ",e);const o=l.slice(1);console.log("rows data",o);const a=o.map(p=>({name:p[0]||"",sku:p[1]||"",description:p[2]||"",category:p[3]||"",min_alert:p[4]||"",unit:p[5]||"",preferred_supplier:p[6]||"",purchase_price:p[7]||"",stock:parseInt(p[8])||0,active:p[9]||1,calories:parseFloat(p[10])||0,fat:parseFloat(p[11])||0,protein:parseFloat(p[12])||0,carbs:parseFloat(p[13])||0,allergies:p[14]||"",tags:p[15]||""})),c=a.map(p=>p.name.trim().toLowerCase()),_=c.filter((p,F)=>c.indexOf(p)!==F);if(_.length>0){g.error(`Duplicate item names found in CSV: ${[...new Set(_)].join(", ")}`);return}const v=Q.value.map(p=>p.name.trim().toLowerCase()),r=a.filter(p=>v.includes(p.name.trim().toLowerCase()));if(r.length>0){const p=r.map(F=>F.name).join(", ");g.error(`Items already exist in the table: ${p}`);return}$.post("/api/inventory/import",{items:a}).then(()=>{g.success("Items imported successfully");const p=document.querySelector(".modal.show");if(p){const F=bootstrap.Modal.getInstance(p);F&&F.hide()}setTimeout(()=>{document.querySelectorAll(".modal-backdrop").forEach(j=>j.remove()),document.body.classList.remove("modal-open"),document.body.style.overflow="",document.body.style.paddingRight=""},100),q(),H()}).catch(p=>{console.error(p),g.error("Import failed"),setTimeout(()=>{document.querySelectorAll(".modal-backdrop").forEach(j=>j.remove()),document.body.classList.remove("modal-open"),document.body.style.overflow="",document.body.style.paddingRight=""},100)})};return(l,e)=>{const o=ot("VueDatePicker");return d(),re(ut,null,{default:Ae(()=>[x(k(st),{title:"inventory Item"}),t("div",Et,[e[104]||(e[104]=t("h4",{class:"mb-3"},"Overall Inventory",-1)),t("div",qt,[(d(!0),u(N,null,X(qe.value,a=>(d(),u("div",{key:a.label,class:"col-md-6 col-xl-3"},[t("div",Dt,[t("div",jt,[t("div",null,[t("div",Nt,n(a.value),1),t("div",Pt,n(a.label),1)]),t("div",{class:b(["icon-chip",a.iconBg])},[(d(),re(nt(a.icon),{class:b(a.iconColor),size:"26"},null,8,["class"]))],2)])])]))),128))]),t("div",Lt,[t("div",Tt,[t("div",Ot,[e[44]||(e[44]=t("h4",{class:"mb-0"},"Stock",-1)),t("div",Bt,[t("div",Rt,[e[40]||(e[40]=t("i",{class:"bi bi-search"},null,-1)),e[41]||(e[41]=t("input",{type:"email",name:"email",autocomplete:"email",style:{position:"absolute",left:"-9999px",width:"1px",height:"1px"},tabindex:"-1","aria-hidden":"true"},null,-1)),ce.value?w((d(),u("input",{id:le,"onUpdate:modelValue":e[0]||(e[0]=a=>U.value=a),key:ue.value,class:"form-control search-input",placeholder:"Search",type:"search",autocomplete:"new-password",name:le,role:"presentation",onFocus:e[1]||(e[1]=(...a)=>l.handleFocus&&l.handleFocus(...a))},null,32)),[[S,U.value]]):(d(),u("input",Qt))]),x(gt,{modelValue:C.value,"onUpdate:modelValue":e[2]||(e[2]=a=>C.value=a),title:"Inventory Items","modal-id":"inventoryFilterModal","modal-size":"modal-lg",categories:J.value.categories,suppliers:J.value.suppliers,"sort-options":J.value.sortOptions,"stock-status-options":J.value.stockStatusOptions,"show-price-range":!0,"show-date-range":!1,priceRangeLabel:"Stock Value Range",onApply:Ue,onClear:Ee},null,8,["modelValue","categories","suppliers","sort-options","stock-status-options"]),t("button",{"data-bs-toggle":"modal","data-bs-target":"#addItemModal",class:"d-flex align-items-center gap-1 px-4 py-2 btn-sm rounded-pill btn btn-primary text-white",onClick:e[3]||(e[3]=a=>{oe(),s.value={},z.value="Create"})},[x(k(kt),{class:"w-4 h-4"}),e[42]||(e[42]=ie(" Add Item ",-1))]),x(ft,{label:"Import",sampleHeaders:["name","sku","description","category","min_alert","unit","preferred_supplier","purchase_price","stock","active","calories","fat","protein","carbs","allergies","tags"],sampleData:[["Milk","SKU-001","Sample one Description","Dairy",5,"Kilogram (kg)","Fresh Fruits Co.",200,350,1,150,33,23,44,"Eggs","Fairtrade"],["Honey","SKU-002","Sample Two Description","Sweets",5,"Kilogram (kg)","Green Veggies Ltd.",159,100,1,150,33,23,44,"Eggs","Fairtrade"]],onOnImport:et}),t("div",Ht,[e[43]||(e[43]=t("button",{class:"btn btn-outline-secondary btn-sm py-2 rounded-pill px-4 dropdown-toggle","data-bs-toggle":"dropdown"}," Export ",-1)),t("ul",Kt,[t("li",null,[t("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:e[4]||(e[4]=a=>ne("pdf"))},"Export as PDF")]),t("li",null,[t("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:e[5]||(e[5]=a=>ne("excel"))},"Export as Excel")]),t("li",null,[t("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:e[6]||(e[6]=a=>ne("csv"))},"Export as CSV")])])])])]),t("div",zt,[t("table",Zt,[e[47]||(e[47]=t("thead",{class:"border-top small text-muted"},[t("tr",null,[t("th",null,"S.#"),t("th",null,"Items"),t("th",null,"Image"),t("th",null,"Category"),t("th",null,"Unit"),t("th",null,"Available Stock"),t("th",null,"Stock Value"),t("th",{class:"text-center"},"Availability"),t("th",{class:"text-center"},"Action")])],-1)),I.value?(d(),u("tbody",Xt,[...e[45]||(e[45]=[t("tr",null,[t("td",{colspan:"10",class:"text-center py-5"},[t("div",{class:"spinner-border",role:"status","aria-label":"Loading"})])],-1)])])):(d(),u("tbody",Gt,[(d(!0),u(N,null,X(pe.value,(a,c)=>(d(),u("tr",{key:a.id},[t("td",null,n(V.value.from+c),1),t("td",Wt,n(a.name),1),t("td",null,[x(it,{file:a.image_url||"/assets/img/default.png",alt:a.name,width:50,height:50,custom_class:"cursor-pointer"},null,8,["file","alt"])]),t("td",Yt,n(a.category?.name),1),t("td",null,n(a.unit_name),1),t("td",null,n(a.availableStock?a.availableStock.toFixed(2):0),1),t("td",null,n(a.stockValue||0),1),t("td",Jt,[a.availableStock===0?(d(),u("span",el,"Out of stock")):a.availableStock<=a.minAlert?(d(),u("span",tl,"Low-stock")):(d(),u("span",ll,"In-stock"))]),t("td",al,[t("div",ol,[t("button",{onClick:_=>Oe(a),title:"Stock Out",class:"p-2 rounded-full text-red-600 hover:bg-red-100"},[x(k(It),{class:"w-4 h-4"})],8,sl),x(Ut,{show:T.value,title:"Confirm Stock Out",message:"Are you sure you want to stock out this item?",onConfirm:Be,onClose:e[7]||(e[7]=_=>T.value=!1)},null,8,["show"]),t("button",{onClick:_=>Ne(a),"data-bs-toggle":"modal","data-bs-target":"#viewItemModal",title:"View Item",class:"p-2 rounded-full text-primary hover:bg-gray-100"},[x(k(xt),{class:"w-4 h-4"})],8,nl),t("button",{onClick:()=>{je(a),s.value={},z.value="Edit"},"data-bs-toggle":"modal","data-bs-target":"#addItemModal",title:"Edit",class:"p-2 rounded-full text-blue-600 hover:bg-blue-100"},[x(k(wt),{class:"w-4 h-4"})],8,il)])])]))),128)),pe.value.length===0?(d(),u("tr",rl,[...e[46]||(e[46]=[t("td",{colspan:"10",class:"text-center text-muted py-4"}," No items found. ",-1)])])):f("",!0)]))])]),!I.value&&V.value.last_page>1?(d(),u("div",dl,[t("div",ul," Showing "+n(V.value.from)+" to "+n(V.value.to)+" of "+n(V.value.total)+" entries ",1),x(rt,{pagination:V.value.links,isApiDriven:!0,onPageChanged:Fe},null,8,["pagination"])])):f("",!0)])]),t("div",cl,[t("div",pl,[t("div",ml,[t("div",vl,[t("h5",gl,n(z.value==="Edit"?"Edit Item":"Add New Item"),1),e[48]||(e[48]=t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})])],-1))]),t("div",yl,[t("div",fl,[t("div",bl,[e[49]||(e[49]=t("label",{class:"form-label"},"Product Name",-1)),w(t("input",{"onUpdate:modelValue":e[8]||(e[8]=a=>i.value.name=a),type:"text",class:b(["form-control",{"is-invalid":s.value.name}]),placeholder:"e.g., Chicken Breast"},null,2),[[S,i.value.name]]),s.value.name?(d(),u("small",_l,n(s.value.name[0]),1)):f("",!0)]),t("div",hl,[e[50]||(e[50]=t("label",{class:"form-label"},"Category",-1)),x(k(G),{modelValue:i.value.category_id,"onUpdate:modelValue":[e[9]||(e[9]=a=>i.value.category_id=a),e[10]||(e[10]=a=>i.value.subcategory_id=null)],options:Y.value,optionLabel:"name",optionValue:"id",placeholder:"Select Category",class:b(["w-100 select",{"is-invalid":s.value.category_id}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","class"]),s.value.category_id?(d(),u("small",kl,n(s.value.category_id[0]),1)):f("",!0)]),B.value.length?(d(),u("div",xl,[e[51]||(e[51]=t("label",{class:"form-label"},"Subcategory",-1)),x(k(G),{modelValue:i.value.subcategory_id,"onUpdate:modelValue":e[11]||(e[11]=a=>i.value.subcategory_id=a),options:B.value,optionLabel:"name",optionValue:"id",placeholder:"Select Subcategory",class:b(["w-100 select",{"is-invalid":s.value.subcategory_id}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","class"]),s.value.subcategory_id?(d(),u("small",wl,n(s.value.subcategory_id[0]),1)):f("",!0)])):f("",!0),t("div",Sl,[e[52]||(e[52]=t("label",{class:"form-label d-block"},"Minimum Stock Alert Level",-1)),w(t("input",{"onUpdate:modelValue":e[12]||(e[12]=a=>i.value.minAlert=a),type:"number",min:"0",class:b(["form-control",{"is-invalid":s.value.minAlert}]),placeholder:"e.g., 5"},null,2),[[S,i.value.minAlert]]),s.value.minAlert?(d(),u("small",Cl,n(s.value.minAlert[0]),1)):f("",!0)]),t("div",Il,[e[53]||(e[53]=t("label",{class:"form-label"},"Unit Type",-1)),x(k(G),{modelValue:i.value.unit_id,"onUpdate:modelValue":e[13]||(e[13]=a=>i.value.unit_id=a),options:M.units,optionLabel:"name",optionValue:"id",placeholder:"Select Unit",class:b(["w-100 select",{"is-invalid":s.value.unit_id}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","class"]),s.value.unit_id?(d(),u("small",Vl,n(s.value.unit_id[0]),1)):f("",!0)]),t("div",Al,[e[54]||(e[54]=t("label",{class:"form-label"},"Preferred Supplier",-1)),x(k(G),{modelValue:i.value.supplier_id,"onUpdate:modelValue":e[14]||(e[14]=a=>i.value.supplier_id=a),options:M.suppliers,optionLabel:"name",optionValue:"id",placeholder:"Select Supplier",class:b(["w-100 select",{"is-invalid":s.value.supplier_id}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","class"]),s.value.supplier_id?(d(),u("small",Ml,n(s.value.supplier_id[0]),1)):f("",!0)]),t("div",Fl,[e[55]||(e[55]=t("label",{class:"form-label"},"SKU (Optional)",-1)),w(t("input",{"onUpdate:modelValue":e[15]||(e[15]=a=>i.value.sku=a),type:"text",class:b(["form-control",{"is-invalid":s.value.sku}]),placeholder:"Stock Keeping Unit"},null,2),[[S,i.value.sku]]),s.value.sku?(d(),u("small",$l,n(s.value.sku[0]),1)):f("",!0)]),t("div",Ul,[e[56]||(e[56]=t("label",{class:"form-label"},"Description",-1)),w(t("textarea",{"onUpdate:modelValue":e[16]||(e[16]=a=>i.value.description=a),rows:"4",class:b(["form-control",{"is-invalid":s.value.description}]),placeholder:"Notes about this product"},null,2),[[S,i.value.description]]),s.value.description?(d(),u("small",El,n(s.value.description[0]),1)):f("",!0)])]),e[66]||(e[66]=t("h6",{class:"mb-3"}," Nutrition Information (per unit) ",-1)),t("div",ql,[t("div",Dl,[e[57]||(e[57]=t("label",{class:"form-label"},"Calories",-1)),w(t("input",{"onUpdate:modelValue":e[17]||(e[17]=a=>i.value.nutrition.calories=a),type:"number",min:"0",class:b(["form-control",{"is-invalid":s.value["nutrition.calories"]}])},null,2),[[S,i.value.nutrition.calories]]),s.value["nutrition.calories"]?(d(),u("small",jl,n(s.value["nutrition.calories"][0]),1)):f("",!0)]),t("div",Nl,[e[58]||(e[58]=t("label",{class:"form-label"},"Fat (g)",-1)),w(t("input",{"onUpdate:modelValue":e[18]||(e[18]=a=>i.value.nutrition.fat=a),type:"number",min:"0",class:b(["form-control",{"is-invalid":s.value["nutrition.fat"]}])},null,2),[[S,i.value.nutrition.fat]]),s.value["nutrition.fat"]?(d(),u("small",Pl,n(s.value["nutrition.fat"][0]),1)):f("",!0)]),t("div",Ll,[e[59]||(e[59]=t("label",{class:"form-label"},"Protein (g)",-1)),w(t("input",{"onUpdate:modelValue":e[19]||(e[19]=a=>i.value.nutrition.protein=a),type:"number",min:"0",class:b(["form-control",{"is-invalid":s.value["nutrition.protein"]}])},null,2),[[S,i.value.nutrition.protein]]),s.value["nutrition.protein"]?(d(),u("small",Tl,n(s.value["nutrition.protein"][0]),1)):f("",!0)]),t("div",Ol,[e[60]||(e[60]=t("label",{class:"form-label"},"Carbs (g)",-1)),w(t("input",{"onUpdate:modelValue":e[20]||(e[20]=a=>i.value.nutrition.carbs=a),type:"number",min:"0",class:b(["form-control",{"is-invalid":s.value["nutrition.carbs"]}])},null,2),[[S,i.value.nutrition.carbs]]),s.value["nutrition.carbs"]?(d(),u("small",Bl,n(s.value["nutrition.carbs"][0]),1)):f("",!0)])]),t("div",Rl,[t("div",Ql,[e[61]||(e[61]=t("label",{class:"form-label d-block"},"Allergies",-1)),x(k(Ie),{modelValue:i.value.allergies,"onUpdate:modelValue":e[21]||(e[21]=a=>i.value.allergies=a),options:M.allergies,optionLabel:"name",optionValue:"id",filter:"",placeholder:"Select Allergies",class:b(["w-full md:w-80 select",{"is-invalid":s.value.allergies}]),appendTo:"self",display:"chip"},null,8,["modelValue","options","class"]),s.value.allergies?(d(),u("small",Hl,n(s.value.allergies[0]),1)):f("",!0)]),t("div",Kl,[e[62]||(e[62]=t("label",{class:"form-label d-block"},"Tags (Halal, Haram, etc.)",-1)),x(k(Ie),{modelValue:i.value.tags,"onUpdate:modelValue":e[22]||(e[22]=a=>i.value.tags=a),options:M.tags,optionLabel:"name",optionValue:"id",filter:"",placeholder:"Select Tags",class:b(["w-full md:w-80 select",{"is-invalid":s.value.tags}]),appendTo:"self",display:"chip"},null,8,["modelValue","options","class"]),s.value.tags?(d(),u("small",zl,n(s.value.tags[0]),1)):f("",!0)])]),t("div",Zl,[t("div",{class:b(["logo-card",{"is-invalid":s.value.image}])},[t("div",{class:"logo-frame",onClick:e[23]||(e[23]=a=>i.value.imageUrl&&Xe())},[i.value.imageUrl?(d(),u("img",{key:0,src:i.value.imageUrl,alt:"Image"},null,8,Xl)):(d(),u("div",Gl,[...e[63]||(e[63]=[t("i",{class:"bi bi-image"},null,-1)])]))]),e[64]||(e[64]=t("small",{class:"text-muted mt-2 d-block"},"Upload Image",-1)),x(dt,{show:fe.value,onClose:e[24]||(e[24]=a=>fe.value=!1),onCropped:Ge},null,8,["show"])],2),s.value.image?(d(),u("small",Wl,n(s.value.image[0]),1)):f("",!0)]),t("div",Yl,[t("button",{class:"btn btn-primary btn-sm rounded-pill px-5 py-2",disabled:ee.value,onClick:De},[ee.value?(d(),u(N,{key:0},[e[65]||(e[65]=t("span",{class:"spinner-border spinner-border-sm me-2"},null,-1)),ie(" "+n((z.value==="Edit","Saving...")),1)],64)):(d(),u(N,{key:1},[ie(n((z.value==="Edit","Save")),1)],64))],8,Jl),t("button",{class:"btn btn-secondary rounded-pill px-4 ms-2","data-bs-dismiss":"modal",onClick:oe}," Cancel ")])])])])]),t("div",ea,[t("div",ta,[t("div",la,[t("div",aa,[t("div",oa,[e[68]||(e[68]=t("i",{class:"bi bi-box-seam text-primary fs-4"},null,-1)),t("div",null,[e[67]||(e[67]=t("h5",{class:"modal-title fw-semibold mb-0"}," View Inventory Item ",-1)),h.value?.sku?(d(),u("small",sa,"SKU: "+n(h.value.sku),1)):f("",!0)])]),e[69]||(e[69]=t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})])],-1))]),t("div",na,[h.value?(d(),u("div",ia,[t("div",ra,[t("div",da,[t("div",ua,[t("h5",ca,n(h.value.name),1),t("p",pa," SKU: "+n(h.value.sku),1),t("div",ma,[t("div",va,[e[70]||(e[70]=t("div",{class:"text-muted"}," Category ",-1)),t("div",ga,n(h.value.category_name||"‚Äî"),1)]),t("div",ya,[e[71]||(e[71]=t("div",{class:"text-muted"}," Unit ",-1)),t("div",fa,n(h.value.unit_name),1)]),t("div",ba,[e[72]||(e[72]=t("div",{class:"text-muted"}," Min Alert ",-1)),t("div",_a,n(h.value.minAlert),1)]),t("div",ha,[e[73]||(e[73]=t("div",{class:"text-muted"}," Supplier ",-1)),t("div",ka,n(h.value.supplier_name),1)]),t("div",xa,[e[74]||(e[74]=t("div",{class:"text-muted"}," Description ",-1)),t("div",wa,n(h.value.description||"‚Äî"),1)])]),e[75]||(e[75]=t("h6",{class:"fw-semibold"}," Nutrition (per 100g) ",-1)),t("div",Sa,[t("span",Ca,"Calories: "+n(h.value.nutrition?.calories??"‚Äî"),1),t("span",Ia,"Protein: "+n(h.value.nutrition?.protein??"‚Äî"),1),t("span",Va,"Fat: "+n(h.value.nutrition?.fat??"‚Äî"),1),t("span",Aa,"Carbs: "+n(h.value.nutrition?.carbs??"‚Äî"),1)]),e[76]||(e[76]=t("hr",null,null,-1)),e[77]||(e[77]=t("h6",{class:"fw-semibold"},"Tags",-1)),t("div",Ma,[(d(!0),u(N,null,X(h.value.tags,a=>(d(),u("span",{key:a,class:"badge rounded-pill bg-info text-white"},n(a),1))),128))]),e[78]||(e[78]=t("hr",null,null,-1)),e[79]||(e[79]=t("h6",{class:"fw-semibold"}," Allergies ",-1)),t("div",Fa,[(d(!0),u(N,null,X(h.value.allergies,a=>(d(),u("span",{key:a,class:"badge rounded-pill bg-danger text-white"},n(a),1))),128))])])])]),t("div",$a,[t("div",Ua,[t("div",Ea,[h.value.image_url?(d(),u("div",qa,[t("img",{src:h.value.image_url,alt:"Item Image",class:"w-100 rounded-3",style:{"object-fit":"cover"}},null,8,Da)])):f("",!0)]),t("div",ja,[e[80]||(e[80]=t("span",{class:"text-muted"},"Stocked In",-1)),t("span",Na,n(te.value.availableQty),1)]),t("div",Pa,[e[81]||(e[81]=t("span",{class:"text-muted"},"Updated On",-1)),t("span",La,n(k(D)(h.value.updated_at)),1)]),t("div",Ta,[e[82]||(e[82]=t("span",{class:"text-muted"},"Added By",-1)),t("span",Oa,n(h.value.user),1)])])])])):f("",!0),t("div",Ba,[e[87]||(e[87]=t("div",{class:"card-header bg-white d-flex justify-content-between align-items-center"},[t("h5",{class:"mb-0"},"Stock History")],-1)),t("div",Ra,[t("table",Qa,[e[86]||(e[86]=t("thead",{class:"table-primary"},[t("tr",null,[t("th",{style:{width:"80px"}},"S.#"),t("th",null,"Qty"),t("th",null,"Price"),t("th",null,"Value"),t("th",null,"Description"),t("th",null,"Purchase Date"),t("th",null,"Expiry Date"),t("th",{class:"text-center"}," Status ")])],-1)),t("tbody",null,[(d(!0),u(N,null,X(Z.value,(a,c)=>(d(),u("tr",{key:a.id},[t("td",Ha,n(c+1),1),t("td",null,n(a.quantity),1),t("td",null,n(k(P)(a.price)),1),t("td",Ka,n(k(P)(a.value)),1),t("td",za,n(a.description||"‚Äî"),1),t("td",Za,n(k(D)(a.purchase_date)),1),t("td",Xa,n(k(D)(a.expiry_date)),1),t("td",Ga,[t("span",{style:{"min-width":"100px"},class:b(["badge rounded-pill d-inline-block text-center",Je(a.status)])},n(Ye(a.status)),3)])]))),128)),Z.value.length?f("",!0):(d(),u("tr",Wa,[...e[83]||(e[83]=[t("td",{colspan:"9",class:"text-center text-muted py-4"}," No items found. ",-1)])]))]),t("tfoot",null,[t("tr",null,[e[84]||(e[84]=t("th",null,"Totals",-1)),t("th",null,n(te.value.totalQty),1),t("th",null,n(k(P)(te.value.totalPrice)),1),t("th",Ya,n(k(P)(te.value.totalValue)),1),e[85]||(e[85]=t("th",{colspan:"4"},null,-1))])])])])])])])])]),t("div",Ja,[t("div",eo,[t("div",to,[t("div",lo,[t("h5",ao," Stock In: "+n(m.value.name),1),t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close",onClick:ye},[...e[88]||(e[88]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",oo,[t("div",so,[t("div",no,[e[89]||(e[89]=t("label",{class:"form-label"},"Product Name",-1)),w(t("input",{type:"text","onUpdate:modelValue":e[25]||(e[25]=a=>m.value.name=a),class:b(["form-control",{"is-invalid":s.value.name}]),readonly:""},null,2),[[S,m.value.name]]),s.value.name?(d(),u("small",io,n(s.value.name[0]),1)):f("",!0)]),t("div",ro,[e[90]||(e[90]=t("label",{class:"form-label"},"Category",-1)),t("input",{type:"text",value:Te.value,class:"form-control",readonly:""},null,8,uo),s.value.category_id?(d(),u("small",co,n(s.value.category_id[0]),1)):f("",!0)]),t("div",po,[e[91]||(e[91]=t("label",{class:"form-label"},"Supplier",-1)),x(k(G),{modelValue:m.value.supplier_id,"onUpdate:modelValue":e[26]||(e[26]=a=>m.value.supplier_id=a),options:M.suppliers,optionLabel:"name",optionValue:"id",placeholder:"Select Supplier",class:b(["w-100",{"is-invalid":s.value.supplier_id}]),appendTo:"self"},null,8,["modelValue","options","class"]),s.value.supplier_id?(d(),u("small",mo,n(s.value.supplier_id[0]),1)):f("",!0)]),t("div",vo,[e[92]||(e[92]=t("label",{class:"form-label"},"Available Quantity",-1)),w(t("input",{type:"number","onUpdate:modelValue":e[27]||(e[27]=a=>m.value.available_quantity=a),class:"form-control",readonly:""},null,512),[[S,m.value.available_quantity]])]),t("div",go,[e[93]||(e[93]=t("label",{class:"form-label"},"Quantity",-1)),w(t("input",{type:"number","onUpdate:modelValue":e[28]||(e[28]=a=>m.value.quantity=a),class:b(["form-control",{"is-invalid":s.value.quantity}]),min:"0",onInput:e[29]||(e[29]=a=>K())},null,34),[[S,m.value.quantity]]),s.value.quantity?(d(),u("small",yo,n(s.value.quantity[0]),1)):f("",!0)]),t("div",fo,[e[94]||(e[94]=t("label",{class:"form-label"},"Price",-1)),w(t("input",{type:"number","onUpdate:modelValue":e[30]||(e[30]=a=>m.value.price=a),class:b(["form-control",{"is-invalid":s.value.price}]),min:"0",onInput:e[31]||(e[31]=a=>K())},null,34),[[S,m.value.price]]),s.value.price?(d(),u("small",bo,n(s.value.price[0]),1)):f("",!0)]),t("div",_o,[e[95]||(e[95]=t("label",{class:"form-label"},"Value",-1)),w(t("input",{type:"text","onUpdate:modelValue":e[32]||(e[32]=a=>m.value.value=a),class:"form-control",readonly:""},null,512),[[S,m.value.value]])]),t("div",ho,[e[96]||(e[96]=t("label",{class:"form-label"},"Expiry Date",-1)),x(o,{modelValue:m.value.expiry_date,"onUpdate:modelValue":e[33]||(e[33]=a=>m.value.expiry_date=a),format:k(D),"min-date":new Date,class:b({"is-invalid":s.value.expiry_date}),enableTimePicker:!1,placeholder:"Select date"},null,8,["modelValue","format","min-date","class"]),s.value.expiry_date?(d(),u("small",ko,n(s.value.expiry_date[0]),1)):f("",!0)]),t("div",xo,[e[97]||(e[97]=t("label",{class:"form-label"},"Notes / Reason",-1)),w(t("textarea",{"onUpdate:modelValue":e[34]||(e[34]=a=>m.value.description=a),rows:"3",class:"form-control"},null,512),[[S,m.value.description]])])]),t("div",wo,[t("button",{class:"d-flex align-items-center justify-content-center gap-2 px-4 py-2 rounded-pill btn btn-primary text-white",disabled:E.value,onClick:Pe},[E.value?(d(),u("span",Co)):f("",!0),t("span",null,n(E.value?"Saving...":"Stock In"),1)],8,So)])])])])]),t("div",Io,[t("div",Vo,[t("div",Ao,[t("div",Mo,[t("h5",Fo," Stock Out : "+n(m.value.name),1),t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close",onClick:ye},[...e[98]||(e[98]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",$o,[t("div",Uo,[t("div",Eo,[e[99]||(e[99]=t("label",{class:"form-label"},"Product Name",-1)),w(t("input",{type:"text","onUpdate:modelValue":e[35]||(e[35]=a=>m.value.name=a),class:"form-control",readonly:""},null,512),[[S,m.value.name]])]),t("div",qo,[e[100]||(e[100]=t("label",{class:"form-label"},"Category",-1)),t("input",{type:"text",value:Le.value,class:"form-control",readonly:""},null,8,Do),s.value.category_id?(d(),u("small",jo,n(s.value.category_id[0]),1)):f("",!0)]),t("div",No,[e[101]||(e[101]=t("label",{class:"form-label"},"Available Quantity",-1)),w(t("input",{type:"number","onUpdate:modelValue":e[36]||(e[36]=a=>m.value.available_quantity=a),class:"form-control",readonly:""},null,512),[[S,m.value.available_quantity]])]),t("div",Po,[e[102]||(e[102]=t("label",{class:"form-label"},"Quantity",-1)),w(t("input",{type:"number","onUpdate:modelValue":e[37]||(e[37]=a=>m.value.quantity=a),class:b(["form-control",{"is-invalid":s.value.quantity}]),min:"0",onInput:e[38]||(e[38]=a=>K())},null,34),[[S,m.value.quantity]]),s.value.quantity?(d(),u("small",Lo,n(s.value.quantity[0]),1)):f("",!0)]),t("div",To,[e[103]||(e[103]=t("label",{class:"form-label"},"Notes / Reason",-1)),w(t("textarea",{"onUpdate:modelValue":e[39]||(e[39]=a=>m.value.description=a),rows:"3",class:"form-control"},null,512),[[S,m.value.description]])])]),t("div",Oo,[t("button",{class:"d-flex align-items-center gap-1 px-4 py-2 rounded-pill btn btn-danger text-white",disabled:E.value,onClick:Qe}," Stock Out ",8,Bo)])])])])])])]),_:1})}}},ps=Ve(Ro,[["__scopeId","data-v-9fe6f381"]]);export{ps as default};
