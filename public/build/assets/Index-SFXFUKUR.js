import{_ as he,c as te,o as r,w as ae,g as u,i as g,b as t,t as n,T as Ye,C as I,r as y,k as We,p as ke,A,H as Je,j as et,D as tt,a as S,d as x,h as lt,F,v as H,n as f,B as st,x as h,y as w,f as ee,R as ot,S as at,m as b}from"./app-CYEkE9GK.js";import{_ as nt}from"./Master-D-99QHuT.js";import{s as Q}from"./index-CxspGS8A.js";import{P as it,s as xe}from"./index-Gp743lrj.js";import{E as rt,a as dt,X as ut,u as K,w as ct}from"./xlsx-BmzxC8vr.js";import{F as pt}from"./FilterModal-BLKsnOWP.js";import{u as mt}from"./useFormatters-BBfJnlDF.js";import{I as vt}from"./importFile-Dz0zDFVt.js";import{C as gt}from"./circle-x-8s9DTuY5.js";import{T as yt}from"./triangle-alert-DspJznCi.js";import{c as ne}from"./createLucideIcon-BvjKrCmJ.js";import{P as bt}from"./plus-BwDqOknZ.js";import{E as ft}from"./eye-B5CHwhPQ.js";import{P as _t}from"./pencil-CHVYe7FI.js";import"./index-DGJ9z-Qf.js";import"./sun-BKrnKPUQ.js";import"./index-CFvNnlhZ.js";/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kt=ne("calendar-clock",[["path",{d:"M16 14v2.2l1.6 1",key:"fo4ql5"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]]);/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xt=ne("calendar-x-2",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 13V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"3spt84"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m17 22 5-5",key:"1k6ppv"}],["path",{d:"m17 17 5 5",key:"p7ous7"}]]);/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=ne("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),wt={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},St={class:"bg-white rounded-xl shadow-xl w-full max-w-md p-6 animate-drop-in relative"},Ct={class:"text-center text-lg font-medium text-gray-800 mb-2"},It={class:"text-center text-sm text-gray-500 mb-6"},Vt={__name:"StockOutConfirmationModal",props:{show:Boolean,title:String,message:String},emits:["confirm","close"],setup(q,{emit:E}){const U=E,V=()=>U("confirm"),z=()=>U("close");return(T,$)=>(r(),te(Ye,{name:"fade-slide"},{default:ae(()=>[q.show?(r(),u("div",wt,[t("div",St,[t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110",onClick:z,title:"Close"},[...$[0]||($[0]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])]),$[1]||($[1]=t("div",{class:"flex justify-center mb-4"},[t("div",{class:"bg-gray-100 p-3 rounded-full"},[t("svg",{class:"w-8 h-8 text-danger",fill:"none",stroke:"currentColor","stroke-width":"2",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v2m0 4h.01M12 19a7 7 0 100-14 7 7 0 000 14z"})])])],-1)),t("h3",Ct,n(q.title),1),t("p",It,n(q.message),1),t("div",{class:"flex justify-center gap-3"},[t("button",{onClick:V,class:"btn btn-primary d-flex align-items-center gap-1 px-3 py-2 rounded-pill text-white"}," Yes, I'm sure "),t("button",{onClick:z,class:"btn btn-secondary d-flex align-items-center gap-1 px-3 py-2 rounded-pill text-white"}," Cancel ")])])])):g("",!0)]),_:1}))}},At=he(Vt,[["__scopeId","data-v-500efa34"]]),$t={class:"page-wrapper"},Mt={class:"row g-4"},Ut={class:"card border-0 shadow-sm rounded-4"},Ft={class:"card-body d-flex align-items-center justify-content-between"},Et={class:"fw-bold fs-4"},jt={class:"text-muted fs-6"},Dt={class:"card border-0 shadow-lg rounded-4"},Pt={class:"card-body"},qt={class:"d-flex flex-wrap gap-2 justify-content-between align-items-center mb-3"},Tt={class:"d-flex flex-wrap gap-2 align-items-center"},Lt={class:"search-wrap"},Nt={key:1,class:"form-control search-input",placeholder:"Search",disabled:"",type:"text"},Ot={class:"dropdown"},Bt={class:"dropdown-menu dropdown-menu-end shadow rounded-4 py-2"},Rt={class:"table-responsive"},Ht={class:"table table-striped"},Qt={key:0},Kt={key:1},zt={class:"fw-semibold"},Zt={class:"text-truncate",style:{"max-width":"260px"}},Xt={class:"text-center"},Gt={key:0,class:"badge bg-red-600 rounded-pill d-inline-block text-center",style:{"min-width":"100px"}},Yt={key:1,class:"badge bg-warning rounded-pill d-inline-block text-center",style:{"min-width":"100px"}},Wt={key:2,class:"badge bg-success rounded-pill d-inline-block text-center",style:{"min-width":"100px"}},Jt={class:"text-center"},el={class:"d-inline-flex align-items-center gap-3"},tl=["onClick"],ll=["onClick"],sl=["onClick"],ol={key:0},al={class:"modal fade",id:"addItemModal",tabindex:"-1","aria-hidden":"true"},nl={class:"modal-dialog modal-lg modal-dialog-centered",role:"document"},il={class:"modal-content rounded-4"},rl={class:"modal-header"},dl={class:"modal-title fw-semibold"},ul={class:"modal-body"},cl={class:"row g-3"},pl={class:"col-md-6"},ml={key:0,class:"text-danger"},vl={class:"col-md-6"},gl={key:0,class:"text-danger"},yl={key:0,class:"col-md-6"},bl={key:0,class:"text-danger"},fl={class:"col-md-6"},_l={key:0,class:"text-danger"},kl={class:"col-md-6"},xl={key:0,class:"text-danger"},hl={class:"col-md-6"},wl={key:0,class:"text-danger"},Sl={class:"col-md-6"},Cl={key:0,class:"text-danger"},Il={class:"col-12"},Vl={key:0,class:"text-danger"},Al={class:"row g-3"},$l={class:"col-md-3"},Ml={key:0,class:"text-danger"},Ul={class:"col-md-3"},Fl={key:0,class:"text-danger"},El={class:"col-md-3"},jl={key:0,class:"text-danger"},Dl={class:"col-md-3"},Pl={key:0,class:"text-danger"},ql={class:"row g-4 mt-1"},Tl={class:"col-md-6"},Ll={key:0,class:"text-danger"},Nl={class:"col-md-6"},Ol={key:0,class:"text-danger"},Bl={class:"col-md-4"},Rl=["src"],Hl={key:1,class:"placeholder"},Ql={key:0,class:"text-danger"},Kl={class:"mt-4"},zl=["disabled"],Zl={class:"modal fade",id:"viewItemModal",tabindex:"-1","aria-hidden":"true"},Xl={class:"modal-dialog modal-lg modal-dialog-centered"},Gl={class:"modal-content border-0 shadow-lg rounded-4 overflow-hidden"},Yl={class:"modal-header bg-light"},Wl={class:"d-flex align-items-center gap-2"},Jl={key:0,class:"text-muted"},es={class:"modal-body"},ts={key:0,class:"row g-4"},ls={class:"col-12 col-md-7"},ss={class:"card border-0 shadow-sm rounded-4"},os={class:"card-body"},as={class:"fw-semibold mb-3"},ns={class:"text-muted small mb-2"},is={class:"row g-3 small"},rs={class:"col-6"},ds={class:"fw-semibold text-muted"},us={class:"col-6"},cs={class:"fw-semibold text-muted"},ps={class:"col-6"},ms={class:"fw-semibold text-muted"},vs={class:"col-12"},gs={class:"fw-semibold text-muted"},ys={class:"col-12"},bs={class:"fw-semibold text-muted"},fs={class:"d-flex flex-wrap gap-2 mt-2"},_s={class:"badge rounded-pill bg-primary text-white"},ks={class:"badge rounded-pill bg-success text-white"},xs={class:"badge rounded-pill bg-warning text-white"},hs={class:"badge rounded-pill bg-secondary text-white"},ws={class:"d-flex flex-wrap gap-2 mt-2"},Ss={class:"d-flex flex-wrap gap-2 mt-2"},Cs={class:"col-12 col-md-5"},Is={class:"card border-0 shadow-sm rounded-4 h-100"},Vs={class:"card-body d-flex flex-column align-items-center justify-content-center"},As={key:0,class:"w-100"},$s=["src"],Ms={class:"card-footer bg-transparent small d-flex justify-content-between"},Us={class:"badge bg-gray-500 rounded-pill text-white p-2"},Fs={class:"card-footer bg-transparent small d-flex justify-content-between"},Es={class:"fw-semibold"},js={class:"card-footer bg-transparent small d-flex justify-content-between"},Ds={class:"fw-semibold"},Ps={class:"card border-0 shadow-lg rounded-4 overflow-hidden"},qs={class:"table-responsive"},Ts={class:"table table-striped mb-0"},Ls={class:"fw-semibold"},Ns={class:"fw-semibold"},Os={class:"text-muted"},Bs={class:"text-muted"},Rs={class:"text-muted"},Hs={class:"text-center"},Qs={key:0},Ks={class:"fw-semibold text-muted w-50"},zs={class:"modal fade",id:"stockInModal",tabindex:"-1","aria-hidden":"true"},Zs={class:"modal-dialog modal-lg modal-dialog-centered"},Xs={class:"modal-content rounded-4"},Gs={class:"modal-header"},Ys={class:"modal-title"},Ws={class:"modal-body"},Js={class:"row g-3"},eo={class:"col-md-6"},to={key:0,class:"text-danger"},lo={class:"col-md-6"},so=["value"],oo={key:0,class:"text-danger"},ao={class:"col-md-6"},no={key:0,class:"text-danger"},io={class:"col-md-6"},ro={class:"col-md-4"},uo={key:0,class:"text-danger"},co={class:"col-md-4"},po={key:0,class:"text-danger"},mo={class:"col-md-4"},vo={class:"col-md-12"},go={key:0,class:"text-danger"},yo={class:"col-md-12"},bo={class:"mt-4"},fo=["disabled"],_o={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},ko={class:"modal fade",id:"stockOutModal",tabindex:"-1","aria-hidden":"true"},xo={class:"modal-dialog modal-lg modal-dialog-centered"},ho={class:"modal-content rounded-4"},wo={class:"modal-header"},So={class:"modal-title"},Co={class:"modal-body"},Io={class:"row g-3"},Vo={class:"col-md-6"},Ao={class:"col-md-6"},$o=["value"],Mo={key:0,class:"text-danger"},Uo={class:"col-md-6"},Fo={class:"col-md-6"},Eo={key:0,class:"text-danger"},jo={class:"col-md-12"},Do={class:"mt-4 text-end"},Po=["disabled"],qo={__name:"Index",props:{inventories:Array,allergies:Array,tags:Array,units:Array,suppliers:Array,categories:Array},setup(q){const{formatCurrencySymbol:E,dateFmt:U}=mt(),V=q,z=I(()=>V.categories.filter(s=>!s.parent_id)),T=I(()=>V.categories.filter(s=>s.parent_id===i.value.category_id)),$=y(V.inventories?.data||[]),L=I(()=>$.value),N=y(!1),j=async()=>{try{N.value=!0;const e=(await A.get("inventory/api-inventories")).data.data||[];if(e.length===0){$.value=[],N.value=!1;return}$.value=await Promise.all(e.map(async o=>{const c=(await A.get(`/stock_entries/total/${o.id}`)).data.total?.original||{};return{...o,availableStock:c.available||0,stockValue:c.stockValue||0,minAlert:c.minAlert||0,expiry_date:c.expiry_date||null,status:c.status||null}})),N.value=!1}catch(s){console.error(s),N.value=!1}};We(async()=>{D.value="",ie.value=Date.now(),await ke(),setTimeout(()=>{re.value=!0;const s=document.getElementById(le);s&&(s.value="",D.value="")},100),j(),G()});const D=y(""),ie=y(Date.now()),le=`search-${Math.random().toString(36).substr(2,9)}`,re=y(!1);y("");const C=y({sortBy:"",category:"",supplier:"",stockStatus:"",priceMin:null,priceMax:null,dateFrom:"",dateTo:""}),de=I(()=>{let s=[...L.value];const e=D.value.trim().toLowerCase();return e&&(s=s.filter(o=>{const l=(o.name||"").toLowerCase(),c=typeof o.category=="object"?(o.category.name||"").toLowerCase():(o.category||"").toString().toLowerCase(),k=typeof o.unit=="object"?(o.unit.name||"").toLowerCase():(o.unit||"").toString().toLowerCase();return l.includes(e)||c.includes(e)||k.includes(e)})),C.value.category&&(s=s.filter(o=>(typeof o.category=="object"?o.category.id:o.category_id)==C.value.category)),C.value.supplier&&(s=s.filter(o=>(typeof o.supplier=="object"?o.supplier.id:o.supplier_id)==C.value.supplier)),C.value.stockStatus&&(s=s.filter(o=>{console.log("item item",o);const l=o.availableStock||0,c=o.minAlert||5;switch(C.value.stockStatus){case"in_stock":return l>=c;case"low_stock":return l>0&&l<c;case"out_of_stock":return l<=0;case"expired":return o.status==="expired";case"near_expiry":return o.status==="near_expiry";default:return!0}})),(C.value.priceMin!==null||C.value.priceMax!==null)&&(s=s.filter(o=>{const l=o.price||o.stockValue||0,c=C.value.priceMin||0,k=C.value.priceMax||1/0;return l>=c&&l<=k})),s}),ue=I(()=>{const s=[...de.value];switch(C.value.sortBy){case"stock_desc":return s.sort((o,l)=>(l.stockValue||0)-(o.stockValue||0));case"stock_asc":return s.sort((o,l)=>(o.stockValue||0)-(l.stockValue||0));case"name_asc":return s.sort((o,l)=>(o.name||"").localeCompare(l.name||""));case"name_desc":return s.sort((o,l)=>(l.name||"").localeCompare(o.name||""));default:return s}}),Z=I(()=>({sortOptions:[{value:"stock_desc",label:"Stock: High to Low"},{value:"stock_asc",label:"Stock: Low to High"},{value:"name_asc",label:"Name: A to Z"},{value:"name_desc",label:"Name: Z to A"}],categories:V.categories||[],suppliers:V.suppliers||[],stockStatusOptions:[{value:"in_stock",label:"In Stock"},{value:"low_stock",label:"Low Stock"},{value:"out_of_stock",label:"Out of Stock"},{value:"expired",label:"Expired"},{value:"near_expiry",label:"Near Expiry"}]})),we=s=>{console.log("Filters applied:",s)},Se=()=>{console.log("Filters cleared")},Ce=I(()=>L.value.length),X=y([]),G=async()=>{try{const s=await A.get("/stock_entries");X.value=s.data.data,console.log(X.value)}catch(s){console.error("Failed to fetch stock entries:",s)}},Ie=I(()=>L.value.filter(s=>s.availableStock>0&&s.availableStock<(s.minAlert||5)).length),Ve=I(()=>L.value.filter(s=>s.availableStock<=0).length),Ae=I(()=>X.value.filter(s=>{if(!s.expiry_date)return!1;const e=new Date(s.expiry_date),o=new Date;return e.setHours(0,0,0,0),o.setHours(0,0,0,0),e<o}).length),$e=I(()=>X.value.filter(s=>{if(!s.expiry_date)return!1;const l=(new Date(s.expiry_date)-new Date)/(1e3*60*60*24);return l>0&&l<=15}).length),Me=I(()=>[{label:"Total Items",value:Ce.value??0,icon:it,iconBg:"bg-soft-success",iconColor:"text-success"},{label:"Out of Stock",value:Ve.value??0,icon:gt,iconBg:"bg-soft-danger",iconColor:"text-danger"},{label:"Low Stock",value:Ie.value??0,icon:yt,iconBg:"bg-soft-warning",iconColor:"text-warning"},{label:"Expired Stock",value:Ae??0,icon:xt,iconBg:"bg-soft-danger",iconColor:"text-danger"},{label:"Near Expire Stock",value:$e??0,icon:kt,iconBg:"bg-soft-info",iconColor:"text-info"}]);Je(()=>window.feather?.replace?.());const a=y({}),i=y({id:null,name:"",category_id:null,subcategory_id:null,unit_id:null,supplier_id:null,minAlert:null,sku:"",description:"",nutrition:{calories:0,fat:0,protein:0,carbs:0},allergies:[],tags:[],imageFile:null,imageUrl:null}),Y=y(!1),Ue=async()=>{Y.value=!0,a.value={};const s=new FormData;if(s.append("name",(i.value.name||"").trim()),i.value.category_id&&s.append("category_id",i.value.category_id),T.value.length&&i.value.subcategory_id&&s.append("subcategory_id",i.value.subcategory_id),i.value.unit_id&&s.append("unit_id",i.value.unit_id),i.value.minAlert!==null&&i.value.minAlert!==""&&s.append("minAlert",i.value.minAlert),i.value.supplier_id&&s.append("supplier_id",i.value.supplier_id),s.append("sku",i.value.sku||""),s.append("description",i.value.description||""),s.append("nutrition[calories]",i.value.nutrition.calories),s.append("nutrition[fat]",i.value.nutrition.fat),s.append("nutrition[protein]",i.value.nutrition.protein),s.append("nutrition[carbs]",i.value.nutrition.carbs),(i.value.allergies||[]).forEach((e,o)=>s.append(`allergies[${o}]`,e)),(i.value.tags||[]).forEach((e,o)=>s.append(`tags[${o}]`,e)),i.value.imageFile){const e=(i.value.imageFile.type?.split("/")?.[1]||"webp").replace("jpeg","jpg");s.append("image",i.value.imageFile,`image.${e}`)}try{i.value.id?(await A.post(`/inventory/${i.value.id}?_method=PUT`,s,{headers:{"Content-Type":"multipart/form-data"}}),b.success(" Inventory Item updated successfully")):(await A.post("/inventory",s,{headers:{"Content-Type":"multipart/form-data"}}),b.success(" Inventory Item created successfully")),se(),await j();const e=document.getElementById("addItemModal");bootstrap.Modal.getInstance(e)?.hide()}catch(e){e?.response?.status===422&&e.response.data?.errors?(a.value=e.response.data.errors,b.error("Please fill in all required fields correctly.")):(console.error("❌ Error saving:",e.response?.data||e.message),b.error("Failed to save Inventory Item"))}finally{Y.value=!1}};et(i,s=>{Object.keys(a.value).forEach(e=>{if(e.includes(".")){const[o,l]=e.split(".");s[o]&&s[o][l]!==""&&delete a.value[e]}else{const o=s[e];o!=null&&o!==""&&(!Array.isArray(o)||o.length>0)&&delete a.value[e]}})},{deep:!0});const Fe=s=>{const e=c=>c===""||c===null||c===void 0?null:Number(c);let o=null,l=null;if(s.category&&typeof s.category=="object"){const c=s.category;c.parent_id?(l=e(c.id),o=e(c.parent_id)):(o=e(c.id),l=null)}else o=e(s.category_id),l=e(s.subcategory_id);i.value={id:s.id,name:s.name??"",category_id:o,subcategory_id:l,unit_id:e(s.unit_id),supplier_id:e(s.supplier_id),minAlert:s.minAlert??0,sku:s.sku??"",description:s.description??"",nutrition:s.nutrition??{calories:0,protein:0,fat:0,carbs:0},allergies:s.allergy_ids??[],tags:s.tag_ids??[],imageFile:null,imageUrl:s.image_url??null},ke(()=>{T.value.some(k=>k.id===i.value.subcategory_id)||(i.value.subcategory_id=null)})};function se(){i.value={id:null,name:"",category_id:null,subcategory_id:null,unit_id:null,minAlert:"",supplier_id:null,sku:"",description:"",nutrition:{calories:"",fat:"",protein:"",carbs:""},allergies:[],tags:[],imageFile:null,imageUrl:null}}const _=y({}),Ee=async s=>{try{const e=await A.get(`/inventory/${s.id}`);_.value=e.data,await Ke(s.id)}catch(e){console.error("Error fetching item:",e)}};function O(){const s=Number(p.value.quantity||0),e=Number(p.value.price||0);p.value.value=s*e}const p=y({product_id:null,name:"",category_id:null,supplier_id:null,available_quantity:0,quantity:0,price:0,value:0,expiry_date:"",description:"",operation_type:"purchase",stock_type:"stockin",purchase_date:new Date().toISOString().slice(0,10),user_id:1}),M=y(!1),B=y();function ce(){p.value.quantity=0,p.value.price=0,p.value.value=0,p.value.expiry_date="",p.value.description=""}const pe=()=>{a.value={}};async function je(){console.log(p.value),M.value=!0,O();try{await A.post("/stock_entries",p.value),b.success(" Stock In saved successfully"),ce(),bootstrap.Modal.getInstance(document.getElementById("stockInModal"))?.hide(),await j(),await G()}catch(s){s?.response?.status===422&&s.response.data?.errors?(a.value=s.response.data.errors,b.error("Please fill in all required fields correctly.")):(b.error("Something went wrong. Please try again.",{autoClose:3e3}),console.error(s))}finally{M.value=!1}}const De=y(null),Pe=y(null);y(null);const W=y(!1),qe=y(null),me=s=>{qe.value=s,W.value=!0};async function Te(s){if(me(),!!s)try{const l=((await A.get(`/stock_entries/total/${s.id}`)).data.total?.original||{}).available||0;if(l<=0){b.warning("No available stock to stock out.");return}const c={product_id:s.id,name:s.name,category_id:s.category?.id,available_quantity:l,quantity:l,price:0,value:0,description:"Auto full stock-out",operation_type:"inventory_stockout",stock_type:"stockout",purchase_date:new Date().toISOString().slice(0,10),user_id:1};await A.post("/stock_entries",c),b.success(`All ${l} items of "${s.name}" stock-out successfully.`),await j(),await G()}catch(e){b.error("Stock out failed. Please try again."),console.error(e)}finally{W.value=!1}}async function Le(){if(M.value=!0,O(),p.value.quantity>p.value.available_quantity){a.value.quantity=["The quantity should not exceed the available quantity."],b.error("The quantity should not exceed the available quantity."),M.value=!1;return}else a.value.quantity=null;try{await A.post("/stock_entries",p.value),b.success("Stock Out saved successfully"),ce(),bootstrap.Modal.getInstance(document.getElementById("stockOutModal"))?.hide(),await j(),await G()}catch(s){s?.response?.status===422&&s.response.data?.errors?(a.value=s.response.data.errors,b.error("Please fill in all required fields correctly.")):(b.error("Something went wrong. Please try again.",{autoClose:3e3}),console.error(s))}finally{M.value=!1}}const oe=s=>{if(!$.value||$.value.length===0){b.error("No Allergies data to download");return}const e=D.value.trim()?de.value:$.value;if(!e.length){b.error("No Inventory Item found to download");return}try{s==="pdf"?Oe(e):s==="excel"?Be(e):s==="csv"?Ne(e):b.error("Invalid download type")}catch(o){console.error("Download failed:",o),b.error(`Download failed: ${o.message}`)}},Ne=s=>{try{const e=["name","sku","category","min_alert","unit","preferred_supplier","min_stock_alert","available_stock","calories","fat","protein","carbs","allergies","tags"],o=s.map(d=>{console.log(s),console.log("data",s);let v="";return d.nutrition&&typeof d.nutrition=="object"?v=Object.entries(d.nutrition).map(([R,Ge])=>`${R}: ${Ge}`).join("; "):typeof d.nutrition=="string"&&(v=d.nutrition),[`"${d.name||""}"`,`"${d.sku||""}"`,`"${d.category.name||""}"`,`"${d.minAlert||""}"`,`"${d.unit_name||""}"`,`"${d.supplier_name||""}"`,`"${d.minAlert||""}"`,`"${d.availableStock||""}"`,`"${d.nutrition.calories}"`,`"${d.nutrition.protein}"`,`"${d.nutrition.fat}"`,`"${d.nutrition.carbs}"`,`"${Array.isArray(d.allergies)?d.allergies.join(", "):d.allergies||""}"`,`"${Array.isArray(d.tags)?d.tags.join(", "):d.tags||""}"`]}),l=[e.join(","),...o.map(d=>d.join(","))].join(`
`),c=new Blob([l],{type:"text/csv;charset=utf-8;"}),k=URL.createObjectURL(c),m=document.createElement("a");m.setAttribute("href",k),m.setAttribute("download",`inventory_items_${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(m),m.click(),document.body.removeChild(m),b.success("CSV downloaded successfully ",{autoClose:2500})}catch(e){console.error("CSV generation error:",e),b.error(`CSV generation failed: ${e.message}`,{autoClose:5e3})}},Oe=s=>{try{const e=new rt("l","mm","a4");e.setFontSize(18),e.setFont("helvetica","bold"),e.text("Inventory Items Report",14,15),e.setFontSize(10),e.setFont("helvetica","normal");const o=new Date().toLocaleString();e.text(`Generated on: ${o}`,14,22),e.text(`Total Items: ${s.length}`,14,28);const l=["Name","SKU","Category","Min Alert","Unit","Preferred Supplier","Min Stock Alert","Available Stock","Calories","Fat","Protein","Carbs","Allergies","Tags"],c=s.map(m=>[m.name||"",m.sku||"",m.category?.name||"",m.minAlert||"",m.unit_name||"",m.supplier_name||"",m.minAlert||"",m.availableStock||"",m.nutrition?.calories||"",m.nutrition?.fat||"",m.nutrition?.protein||"",m.nutrition?.carbs||"",Array.isArray(m.allergies)?m.allergies.join(", "):m.allergies||"",Array.isArray(m.tags)?m.tags.join(", "):m.tags||""]);dt(e,{head:[l],body:c,startY:35,styles:{fontSize:8,cellPadding:2,halign:"left",lineColor:[0,0,0],lineWidth:.1},headStyles:{fillColor:[41,128,185],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]},margin:{left:14,right:14},didDrawPage:m=>{const d=e.internal.getNumberOfPages(),v=e.internal.pageSize.height;e.setFontSize(8),e.text(`Page ${m.pageNumber} of ${d}`,m.settings.margin.left,v-10)}});const k=`inventory_items_${new Date().toISOString().split("T")[0]}.pdf`;e.save(k),b.success("PDF downloaded successfully",{autoClose:2500})}catch(e){console.error("PDF generation error:",e),b.error(`PDF generation failed: ${e.message}`,{autoClose:5e3})}},Be=s=>{try{if(typeof ut>"u")throw new Error("XLSX library is not loaded");const e=s.map(d=>({Name:d.name||"",SKU:d.sku||"",Category:d.category?.name||"",Min_Alert:d.minAlert||"",Unit:d.unit_name||"",Preferred_Supplier:d.supplier_name||"",Min_Stock_Alert:d.minAlert||"",Available_Stock:d.availableStock||"",Calories:d.nutrition?.calories||"",Fat:d.nutrition?.fat||"",Protein:d.nutrition?.protein||"",Carbs:d.nutrition?.carbs||"",Allergies:Array.isArray(d.allergies)?d.allergies.join(", "):d.allergies||"",Tags:Array.isArray(d.tags)?d.tags.join(", "):d.tags||""})),o=K.book_new(),l=K.json_to_sheet(e);l["!cols"]=[{wch:25},{wch:15},{wch:20},{wch:12},{wch:15},{wch:25},{wch:15},{wch:18},{wch:10},{wch:10},{wch:10},{wch:10},{wch:25},{wch:25}],K.book_append_sheet(o,l,"Inventory Items");const c=[{Info:"Generated On",Value:new Date().toLocaleString()},{Info:"Total Records",Value:s.length},{Info:"Exported By",Value:"Inventory Management System"}],k=K.json_to_sheet(c);K.book_append_sheet(o,k,"Report Info");const m=`inventory_items_${new Date().toISOString().split("T")[0]}.xlsx`;ct(o,m),b.success("Excel file downloaded successfully",{autoClose:2500})}catch(e){console.error("Excel generation error:",e),b.error(`Excel generation failed: ${e.message}`,{autoClose:5e3})}},ve=y(!1),Re=y(!1),ge=y(null);function He(s){ge.value=i.value.imageUrl,ge.value&&(Re.value=!0)}function Qe({file:s}){i.value.imageFile=s,i.value.imageUrl=URL.createObjectURL(s)}y("");const ye=y(0),be=y(0),fe=y(0),_e=y(0),P=y([]);async function Ke(s){try{const{data:e}=await A.get(`/stock_entries/by-item/${s}`),o=e?.data||{};console.log(o),P.value=o.records||[],ye.value=o.near_count??0,be.value=o.expired_count??0,fe.value=o.near_qty??0,_e.value=o.expired_qty??0}catch(e){console.error(e),P.value=[],ye.value=be.value=0,fe.value=_e.value=0}}console.log("stockedInItems",P.value);function ze(s){return s==="expired"?"Expired":s==="near"?"Near Expire":"Active"}function Ze(s){return s==="expired"?"bg-danger":s==="near"?"bg-warning":"bg-success"}const J=I(()=>{const s=P.value||[];let e=0,o=0,l=0,c=0;const k=new Date;k.setHours(0,0,0,0);for(const m of s){const d=m?.quantity??0;if(e+=d,o+=Number(m?.price??0),l+=Number(m?.value??0),!m?.expiry_date)c+=d;else{const v=new Date(m.expiry_date);v.setHours(0,0,0,0),v>=k&&(c+=d)}}return{totalQty:e,totalPrice:o,totalValue:l,notExpiredQty:c}}),Xe=s=>{if(!s||s.length<=1){b.error("The imported file is empty.");return}const e=s[0];console.log("headers are ",e);const o=s.slice(1);console.log("rows data",o);const l=o.map(v=>({name:v[0]||"",sku:v[1]||"",category:v[2]||"",min_alert:v[3]||"",unit:v[4]||"",preferred_supplier:v[5]||"",stock:parseInt(v[7])||0,active:1,calories:parseFloat(v[8])||0,protein:parseFloat(v[9])||0,fat:parseFloat(v[10])||0,carbs:parseFloat(v[11])||0,allergies:v[12]||"",tags:v[13]||"",purchase_price:0,sale_price:0})),c=l.map(v=>v.name.trim().toLowerCase()),k=c.filter((v,R)=>c.indexOf(v)!==R);if(k.length>0){b.error(`Duplicate item names found in CSV: ${[...new Set(k)].join(", ")}`);return}const m=L.value.map(v=>v.name.trim().toLowerCase()),d=l.filter(v=>m.includes(v.name.trim().toLowerCase()));if(d.length>0){const v=d.map(R=>R.name).join(", ");b.error(`Items already exist in the table: ${v}`);return}A.post("/api/inventory/import",{items:l}).then(()=>{b.success("Items imported successfully"),j()}).catch(v=>{console.error(v),b.error("Import failed")})};return(s,e)=>{const o=tt("VueDatePicker");return r(),te(nt,null,{default:ae(()=>[S(x(lt),{title:"inventory Item"}),t("div",$t,[e[106]||(e[106]=t("h4",{class:"mb-3"},"Overall Inventory",-1)),t("div",Mt,[(r(!0),u(F,null,H(Me.value,l=>(r(),u("div",{key:l.label,class:"col-md-6 col-xl-3"},[t("div",Ut,[t("div",Ft,[t("div",null,[t("div",Et,n(l.value),1),t("div",jt,n(l.label),1)]),t("div",{class:f(["icon-chip",l.iconBg])},[(r(),te(st(l.icon),{class:f(l.iconColor),size:"26"},null,8,["class"]))],2)])])]))),128))]),t("div",Dt,[t("div",Pt,[t("div",qt,[e[45]||(e[45]=t("h4",{class:"mb-0"},"Stock",-1)),t("div",Tt,[t("div",Lt,[e[40]||(e[40]=t("i",{class:"bi bi-search"},null,-1)),e[41]||(e[41]=t("input",{type:"email",name:"email",autocomplete:"email",style:{position:"absolute",left:"-9999px",width:"1px",height:"1px"},tabindex:"-1","aria-hidden":"true"},null,-1)),re.value?h((r(),u("input",{id:le,"onUpdate:modelValue":e[0]||(e[0]=l=>D.value=l),key:ie.value,class:"form-control search-input",placeholder:"Search",type:"search",autocomplete:"new-password",name:le,role:"presentation",onFocus:e[1]||(e[1]=(...l)=>s.handleFocus&&s.handleFocus(...l))},null,32)),[[w,D.value]]):(r(),u("input",Nt))]),S(pt,{modelValue:C.value,"onUpdate:modelValue":e[2]||(e[2]=l=>C.value=l),title:"Inventory Items","modal-id":"inventoryFilterModal","modal-size":"modal-lg",categories:Z.value.categories,suppliers:Z.value.suppliers,"sort-options":Z.value.sortOptions,"stock-status-options":Z.value.stockStatusOptions,"show-price-range":!0,"show-date-range":!1,onApply:we,onClear:Se},{customFilters:ae(({filters:l})=>[...e[42]||(e[42]=[t("div",{class:"col-12"},[t("label",{class:"form-label fw-semibold text-dark"},[t("i",{class:"fas fa-star me-2 text-muted"}),ee("Custom Filter ")])],-1)])]),_:1},8,["modelValue","categories","suppliers","sort-options","stock-status-options"]),t("button",{"data-bs-toggle":"modal","data-bs-target":"#addItemModal",class:"d-flex align-items-center gap-1 px-4 py-2 btn-sm rounded-pill btn btn-primary text-white",onClick:e[3]||(e[3]=l=>{se(),a.value={},B.value="Create"})},[S(x(bt),{class:"w-4 h-4"}),e[43]||(e[43]=ee(" Add Item ",-1))]),S(vt,{label:"Import",sampleHeaders:["name","sku","category","min_alert","unit","preferred_supplier","purchase_price","sale_price","stock","active","calories","fat","protein","carbs","allergies","tags"],sampleData:[["Black Tea","SKU-001","Dairy",5,"Kilogram (kg)","Supplier A","200","350","150","1",33,23,44,31,"Eggs","Fairtrade"],["Sugar","SKU-002","Sweets",5,"Kilogram (kg)","Supplier B","159","100","150","1",33,23,44,31,"Eggs","Fairtrade"]],onOnImport:Xe}),t("div",Ot,[e[44]||(e[44]=t("button",{class:"btn btn-outline-secondary btn-sm py-2 rounded-pill px-4 dropdown-toggle","data-bs-toggle":"dropdown"}," Export ",-1)),t("ul",Bt,[t("li",null,[t("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:e[4]||(e[4]=l=>oe("pdf"))},"Export as PDF")]),t("li",null,[t("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:e[5]||(e[5]=l=>oe("excel"))},"Export as Excel")]),t("li",null,[t("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:e[6]||(e[6]=l=>oe("csv"))},"Export as CSV")])])])])]),t("div",Rt,[t("table",Ht,[e[48]||(e[48]=t("thead",{class:"border-top small text-muted"},[t("tr",null,[t("th",null,"S.#"),t("th",null,"Items"),t("th",null,"Image"),t("th",null,"Category"),t("th",null,"Unit"),t("th",null,"Available Stock"),t("th",null,"Stock Value"),t("th",{class:"text-center"},"Availability"),t("th",{class:"text-center"},"Action")])],-1)),N.value?(r(),u("tbody",Qt,[...e[46]||(e[46]=[t("tr",null,[t("td",{colspan:"10",class:"text-center py-5"},[t("div",{class:"spinner-border",role:"status","aria-label":"Loading"})])],-1)])])):(r(),u("tbody",Kt,[(r(!0),u(F,null,H(ue.value,(l,c)=>(r(),u("tr",{key:l.id},[t("td",null,n(c+1),1),t("td",zt,n(l.name),1),t("td",null,[l.image_url?(r(),te(ot,{key:0,file:l.image_url,alt:l.name,width:50,height:50,custom_class:"cursor-pointer"},null,8,["file","alt"])):g("",!0)]),t("td",Zt,n(l.category?.name),1),t("td",null,n(l.unit_name),1),t("td",null,n(l.availableStock?l.availableStock.toFixed(1):0),1),t("td",null,n(l.stockValue||0),1),t("td",Xt,[l.availableStock===0?(r(),u("span",Gt,"Out of stock")):l.availableStock<=l.minAlert?(r(),u("span",Yt,"Low-stock")):(r(),u("span",Wt,"In-stock"))]),t("td",Jt,[t("div",el,[t("button",{onClick:k=>me(l),title:"Stock Out",class:"p-2 rounded-full text-red-600 hover:bg-red-100"},[S(x(ht),{class:"w-4 h-4"})],8,tl),S(At,{show:W.value,title:"Confirm Stock Out",message:"Are you sure you want to stock out this item?",onConfirm:k=>Te(l),onClose:e[7]||(e[7]=k=>W.value=!1)},null,8,["show","onConfirm"]),t("button",{onClick:k=>Ee(l),"data-bs-toggle":"modal","data-bs-target":"#viewItemModal",title:"View Item",class:"p-2 rounded-full text-primary hover:bg-gray-100"},[S(x(ft),{class:"w-4 h-4"})],8,ll),t("button",{onClick:()=>{Fe(l),a.value={},B.value="Edit"},"data-bs-toggle":"modal","data-bs-target":"#addItemModal",title:"Edit",class:"p-2 rounded-full text-blue-600 hover:bg-blue-100"},[S(x(_t),{class:"w-4 h-4"})],8,sl)])])]))),128)),ue.value.length===0?(r(),u("tr",ol,[...e[47]||(e[47]=[t("td",{colspan:"10",class:"text-center text-muted py-4"}," No items found. ",-1)])])):g("",!0)]))])])])]),t("div",al,[t("div",nl,[t("div",il,[t("div",rl,[t("h5",dl,n(B.value==="Edit"?"Edit Item":"Add New Item"),1),e[49]||(e[49]=t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})])],-1))]),t("div",ul,[t("div",cl,[t("div",pl,[e[50]||(e[50]=t("label",{class:"form-label"},"Product Name",-1)),h(t("input",{"onUpdate:modelValue":e[8]||(e[8]=l=>i.value.name=l),type:"text",class:f(["form-control",{"is-invalid":a.value.name}]),placeholder:"e.g., Chicken Breast"},null,2),[[w,i.value.name]]),a.value.name?(r(),u("small",ml,n(a.value.name[0]),1)):g("",!0)]),t("div",vl,[e[51]||(e[51]=t("label",{class:"form-label"},"Category",-1)),S(x(Q),{modelValue:i.value.category_id,"onUpdate:modelValue":[e[9]||(e[9]=l=>i.value.category_id=l),e[10]||(e[10]=l=>i.value.subcategory_id=null)],options:z.value,optionLabel:"name",optionValue:"id",placeholder:"Select Category",class:f(["w-100 select",{"is-invalid":a.value.category_id}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","class"]),a.value.category_id?(r(),u("small",gl,n(a.value.category_id[0]),1)):g("",!0)]),T.value.length?(r(),u("div",yl,[e[52]||(e[52]=t("label",{class:"form-label"},"Subcategory",-1)),S(x(Q),{modelValue:i.value.subcategory_id,"onUpdate:modelValue":e[11]||(e[11]=l=>i.value.subcategory_id=l),options:T.value,optionLabel:"name",optionValue:"id",placeholder:"Select Subcategory",class:f(["w-100 select",{"is-invalid":a.value.subcategory_id}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","class"]),a.value.subcategory_id?(r(),u("small",bl,n(a.value.subcategory_id[0]),1)):g("",!0)])):g("",!0),t("div",fl,[e[53]||(e[53]=t("label",{class:"form-label d-block"},"Minimum Stock Alert Level",-1)),h(t("input",{"onUpdate:modelValue":e[12]||(e[12]=l=>i.value.minAlert=l),type:"number",min:"0",class:f(["form-control",{"is-invalid":a.value.minAlert}]),placeholder:"e.g., 5"},null,2),[[w,i.value.minAlert]]),a.value.minAlert?(r(),u("small",_l,n(a.value.minAlert[0]),1)):g("",!0)]),t("div",kl,[e[54]||(e[54]=t("label",{class:"form-label"},"Unit Type",-1)),S(x(Q),{modelValue:i.value.unit_id,"onUpdate:modelValue":e[13]||(e[13]=l=>i.value.unit_id=l),options:V.units,optionLabel:"name",optionValue:"id",placeholder:"Select Unit",class:f(["w-100 select",{"is-invalid":a.value.unit_id}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","class"]),a.value.unit_id?(r(),u("small",xl,n(a.value.unit_id[0]),1)):g("",!0)]),t("div",hl,[e[55]||(e[55]=t("label",{class:"form-label"},"Preferred Supplier",-1)),S(x(Q),{modelValue:i.value.supplier_id,"onUpdate:modelValue":e[14]||(e[14]=l=>i.value.supplier_id=l),options:V.suppliers,optionLabel:"name",optionValue:"id",placeholder:"Select Supplier",class:f(["w-100 select",{"is-invalid":a.value.supplier_id}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","class"]),a.value.supplier_id?(r(),u("small",wl,n(a.value.supplier_id[0]),1)):g("",!0)]),t("div",Sl,[e[56]||(e[56]=t("label",{class:"form-label"},"SKU (Optional)",-1)),h(t("input",{"onUpdate:modelValue":e[15]||(e[15]=l=>i.value.sku=l),type:"text",class:f(["form-control",{"is-invalid":a.value.sku}]),placeholder:"Stock Keeping Unit"},null,2),[[w,i.value.sku]]),a.value.sku?(r(),u("small",Cl,n(a.value.sku[0]),1)):g("",!0)]),t("div",Il,[e[57]||(e[57]=t("label",{class:"form-label"},"Description",-1)),h(t("textarea",{"onUpdate:modelValue":e[16]||(e[16]=l=>i.value.description=l),rows:"4",class:f(["form-control",{"is-invalid":a.value.description}]),placeholder:"Notes about this product"},null,2),[[w,i.value.description]]),a.value.description?(r(),u("small",Vl,n(a.value.description[0]),1)):g("",!0)])]),e[67]||(e[67]=t("h6",{class:"mb-3"}," Nutrition Information (per unit) ",-1)),t("div",Al,[t("div",$l,[e[58]||(e[58]=t("label",{class:"form-label"},"Calories",-1)),h(t("input",{"onUpdate:modelValue":e[17]||(e[17]=l=>i.value.nutrition.calories=l),type:"number",min:"0",class:f(["form-control",{"is-invalid":a.value["nutrition.calories"]}])},null,2),[[w,i.value.nutrition.calories]]),a.value["nutrition.calories"]?(r(),u("small",Ml,n(a.value["nutrition.calories"][0]),1)):g("",!0)]),t("div",Ul,[e[59]||(e[59]=t("label",{class:"form-label"},"Fat (g)",-1)),h(t("input",{"onUpdate:modelValue":e[18]||(e[18]=l=>i.value.nutrition.fat=l),type:"number",min:"0",class:f(["form-control",{"is-invalid":a.value["nutrition.fat"]}])},null,2),[[w,i.value.nutrition.fat]]),a.value["nutrition.fat"]?(r(),u("small",Fl,n(a.value["nutrition.fat"][0]),1)):g("",!0)]),t("div",El,[e[60]||(e[60]=t("label",{class:"form-label"},"Protein (g)",-1)),h(t("input",{"onUpdate:modelValue":e[19]||(e[19]=l=>i.value.nutrition.protein=l),type:"number",min:"0",class:f(["form-control",{"is-invalid":a.value["nutrition.protein"]}])},null,2),[[w,i.value.nutrition.protein]]),a.value["nutrition.protein"]?(r(),u("small",jl,n(a.value["nutrition.protein"][0]),1)):g("",!0)]),t("div",Dl,[e[61]||(e[61]=t("label",{class:"form-label"},"Carbs (g)",-1)),h(t("input",{"onUpdate:modelValue":e[20]||(e[20]=l=>i.value.nutrition.carbs=l),type:"number",min:"0",class:f(["form-control",{"is-invalid":a.value["nutrition.carbs"]}])},null,2),[[w,i.value.nutrition.carbs]]),a.value["nutrition.carbs"]?(r(),u("small",Pl,n(a.value["nutrition.carbs"][0]),1)):g("",!0)])]),t("div",ql,[t("div",Tl,[e[62]||(e[62]=t("label",{class:"form-label d-block"},"Allergies",-1)),S(x(xe),{modelValue:i.value.allergies,"onUpdate:modelValue":e[21]||(e[21]=l=>i.value.allergies=l),options:V.allergies,optionLabel:"name",optionValue:"id",filter:"",placeholder:"Select Allergies",class:f(["w-full md:w-80 select",{"is-invalid":a.value.allergies}]),appendTo:"self",display:"chip"},null,8,["modelValue","options","class"]),a.value.allergies?(r(),u("small",Ll,n(a.value.allergies[0]),1)):g("",!0)]),t("div",Nl,[e[63]||(e[63]=t("label",{class:"form-label d-block"},"Tags (Halal, Haram, etc.)",-1)),S(x(xe),{modelValue:i.value.tags,"onUpdate:modelValue":e[22]||(e[22]=l=>i.value.tags=l),options:V.tags,optionLabel:"name",optionValue:"id",filter:"",placeholder:"Select Tags",class:f(["w-full md:w-80 select",{"is-invalid":a.value.tags}]),appendTo:"self",display:"chip"},null,8,["modelValue","options","class"]),a.value.tags?(r(),u("small",Ol,n(a.value.tags[0]),1)):g("",!0)])]),t("div",Bl,[t("div",{class:f(["logo-card",{"is-invalid":a.value.image}])},[t("div",{class:"logo-frame",onClick:e[23]||(e[23]=l=>i.value.imageUrl&&He())},[i.value.imageUrl?(r(),u("img",{key:0,src:i.value.imageUrl,alt:"Image"},null,8,Rl)):(r(),u("div",Hl,[...e[64]||(e[64]=[t("i",{class:"bi bi-image"},null,-1)])]))]),e[65]||(e[65]=t("small",{class:"text-muted mt-2 d-block"},"Upload Image",-1)),S(at,{show:ve.value,onClose:e[24]||(e[24]=l=>ve.value=!1),onCropped:Qe},null,8,["show"])],2),a.value.image?(r(),u("small",Ql,n(a.value.image[0]),1)):g("",!0)]),t("div",Kl,[t("button",{class:"btn btn-primary btn-sm rounded-pill px-5 py-2",disabled:Y.value,onClick:Ue},[Y.value?(r(),u(F,{key:0},[e[66]||(e[66]=t("span",{class:"spinner-border spinner-border-sm me-2"},null,-1)),ee(" "+n((B.value==="Edit","Saving...")),1)],64)):(r(),u(F,{key:1},[ee(n((B.value==="Edit","Save")),1)],64))],8,zl),t("button",{class:"btn btn-secondary rounded-pill px-4 ms-2","data-bs-dismiss":"modal",onClick:se}," Cancel ")])])])])]),t("div",Zl,[t("div",Xl,[t("div",Gl,[t("div",Yl,[t("div",Wl,[e[69]||(e[69]=t("i",{class:"bi bi-box-seam text-primary fs-4"},null,-1)),t("div",null,[e[68]||(e[68]=t("h5",{class:"modal-title fw-semibold mb-0"}," View Inventory Item ",-1)),_.value?.sku?(r(),u("small",Jl,"SKU: "+n(_.value.sku),1)):g("",!0)])]),e[70]||(e[70]=t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})])],-1))]),t("div",es,[_.value?(r(),u("div",ts,[t("div",ls,[t("div",ss,[t("div",os,[t("h5",as,n(_.value.name),1),t("p",ns," SKU: "+n(_.value.sku),1),t("div",is,[t("div",rs,[e[71]||(e[71]=t("div",{class:"text-muted"}," Category ",-1)),t("div",ds,n(_.value.category_name||"—"),1)]),t("div",us,[e[72]||(e[72]=t("div",{class:"text-muted"}," Unit ",-1)),t("div",cs,n(_.value.unit_name),1)]),t("div",ps,[e[73]||(e[73]=t("div",{class:"text-muted"}," Min Alert ",-1)),t("div",ms,n(_.value.minAlert),1)]),t("div",vs,[e[74]||(e[74]=t("div",{class:"text-muted"}," Supplier ",-1)),t("div",gs,n(_.value.supplier_name),1)]),t("div",ys,[e[75]||(e[75]=t("div",{class:"text-muted"}," Description ",-1)),t("div",bs,n(_.value.description||"—"),1)])]),e[76]||(e[76]=t("hr",null,null,-1)),e[77]||(e[77]=t("h6",{class:"fw-semibold"}," Nutrition (per 100g) ",-1)),t("div",fs,[t("span",_s,"Calories: "+n(_.value.nutrition?.calories??"—"),1),t("span",ks,"Protein: "+n(_.value.nutrition?.protein??"—"),1),t("span",xs,"Fat: "+n(_.value.nutrition?.fat??"—"),1),t("span",hs,"Carbs: "+n(_.value.nutrition?.carbs??"—"),1)]),e[78]||(e[78]=t("hr",null,null,-1)),e[79]||(e[79]=t("h6",{class:"fw-semibold"},"Tags",-1)),t("div",ws,[(r(!0),u(F,null,H(_.value.tags,l=>(r(),u("span",{key:l,class:"badge rounded-pill bg-info text-white"},n(l),1))),128))]),e[80]||(e[80]=t("hr",null,null,-1)),e[81]||(e[81]=t("h6",{class:"fw-semibold"}," Allergies ",-1)),t("div",Ss,[(r(!0),u(F,null,H(_.value.allergies,l=>(r(),u("span",{key:l,class:"badge rounded-pill bg-danger text-white"},n(l),1))),128))])])])]),t("div",Cs,[t("div",Is,[t("div",Vs,[_.value.image_url?(r(),u("div",As,[t("img",{src:_.value.image_url,alt:"Item Image",class:"w-100 rounded-3",style:{"object-fit":"cover"}},null,8,$s)])):g("",!0)]),t("div",Ms,[e[82]||(e[82]=t("span",{class:"text-muted"},"Stocked In",-1)),t("span",Us,n(J.value.notExpiredQty),1)]),t("div",Fs,[e[83]||(e[83]=t("span",{class:"text-muted"},"Updated On",-1)),t("span",Es,n(x(U)(_.value.updated_at)),1)]),t("div",js,[e[84]||(e[84]=t("span",{class:"text-muted"},"Added By",-1)),t("span",Ds,n(_.value.user),1)])])])])):g("",!0),t("div",Ps,[e[89]||(e[89]=t("div",{class:"card-header bg-white d-flex justify-content-between align-items-center"},[t("h5",{class:"mb-0"},"Stock Details")],-1)),t("div",qs,[t("table",Ts,[e[88]||(e[88]=t("thead",{class:"table-primary"},[t("tr",null,[t("th",{style:{width:"80px"}},"S.#"),t("th",null,"Qty"),t("th",null,"Price"),t("th",null,"Value"),t("th",null,"Description"),t("th",null,"Purchase Date"),t("th",null,"Expiry Date"),t("th",{class:"text-center"}," Status ")])],-1)),t("tbody",null,[(r(!0),u(F,null,H(P.value,(l,c)=>(r(),u("tr",{key:l.id},[t("td",Ls,n(c+1),1),t("td",null,n(l.quantity),1),t("td",null,n(x(E)(l.price)),1),t("td",Ns,n(x(E)(l.value)),1),t("td",Os,n(l.description||"—"),1),t("td",Bs,n(x(U)(l.purchase_date)),1),t("td",Rs,n(x(U)(l.expiry_date)),1),t("td",Hs,[t("span",{style:{"min-width":"100px"},class:f(["badge rounded-pill d-inline-block text-center",Ze(l.status)])},n(ze(l.status)),3)])]))),128)),P.value.length?g("",!0):(r(),u("tr",Qs,[...e[85]||(e[85]=[t("td",{colspan:"9",class:"text-center text-muted py-4"}," No items found. ",-1)])]))]),t("tfoot",null,[t("tr",null,[e[86]||(e[86]=t("th",null,"Totals",-1)),t("th",null,n(J.value.totalQty),1),t("th",null,n(x(E)(J.value.totalPrice)),1),t("th",Ks,n(x(E)(J.value.totalValue)),1),e[87]||(e[87]=t("th",{colspan:"4"},null,-1))])])])])])])])])]),t("div",zs,[t("div",Zs,[t("div",Xs,[t("div",Gs,[t("h5",Ys," Stock In: "+n(p.value.name),1),t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close",onClick:pe},[...e[90]||(e[90]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",Ws,[t("div",Js,[t("div",eo,[e[91]||(e[91]=t("label",{class:"form-label"},"Product Name",-1)),h(t("input",{type:"text","onUpdate:modelValue":e[25]||(e[25]=l=>p.value.name=l),class:f(["form-control",{"is-invalid":a.value.name}]),readonly:""},null,2),[[w,p.value.name]]),a.value.name?(r(),u("small",to,n(a.value.name[0]),1)):g("",!0)]),t("div",lo,[e[92]||(e[92]=t("label",{class:"form-label"},"Category",-1)),t("input",{type:"text",value:Pe.value,class:"form-control",readonly:""},null,8,so),a.value.category_id?(r(),u("small",oo,n(a.value.category_id[0]),1)):g("",!0)]),t("div",ao,[e[93]||(e[93]=t("label",{class:"form-label"},"Supplier",-1)),S(x(Q),{modelValue:p.value.supplier_id,"onUpdate:modelValue":e[26]||(e[26]=l=>p.value.supplier_id=l),options:V.suppliers,optionLabel:"name",optionValue:"id",placeholder:"Select Supplier",class:f(["w-100",{"is-invalid":a.value.supplier_id}]),appendTo:"self"},null,8,["modelValue","options","class"]),a.value.supplier_id?(r(),u("small",no,n(a.value.supplier_id[0]),1)):g("",!0)]),t("div",io,[e[94]||(e[94]=t("label",{class:"form-label"},"Available Quantity",-1)),h(t("input",{type:"number","onUpdate:modelValue":e[27]||(e[27]=l=>p.value.available_quantity=l),class:"form-control",readonly:""},null,512),[[w,p.value.available_quantity]])]),t("div",ro,[e[95]||(e[95]=t("label",{class:"form-label"},"Quantity",-1)),h(t("input",{type:"number","onUpdate:modelValue":e[28]||(e[28]=l=>p.value.quantity=l),class:f(["form-control",{"is-invalid":a.value.quantity}]),min:"0",onInput:e[29]||(e[29]=l=>O())},null,34),[[w,p.value.quantity]]),a.value.quantity?(r(),u("small",uo,n(a.value.quantity[0]),1)):g("",!0)]),t("div",co,[e[96]||(e[96]=t("label",{class:"form-label"},"Price",-1)),h(t("input",{type:"number","onUpdate:modelValue":e[30]||(e[30]=l=>p.value.price=l),class:f(["form-control",{"is-invalid":a.value.price}]),min:"0",onInput:e[31]||(e[31]=l=>O())},null,34),[[w,p.value.price]]),a.value.price?(r(),u("small",po,n(a.value.price[0]),1)):g("",!0)]),t("div",mo,[e[97]||(e[97]=t("label",{class:"form-label"},"Value",-1)),h(t("input",{type:"text","onUpdate:modelValue":e[32]||(e[32]=l=>p.value.value=l),class:"form-control",readonly:""},null,512),[[w,p.value.value]])]),t("div",vo,[e[98]||(e[98]=t("label",{class:"form-label"},"Expiry Date",-1)),S(o,{modelValue:p.value.expiry_date,"onUpdate:modelValue":e[33]||(e[33]=l=>p.value.expiry_date=l),format:x(U),"min-date":new Date,class:f({"is-invalid":a.value.expiry_date}),enableTimePicker:!1,placeholder:"Select date"},null,8,["modelValue","format","min-date","class"]),a.value.expiry_date?(r(),u("small",go,n(a.value.expiry_date[0]),1)):g("",!0)]),t("div",yo,[e[99]||(e[99]=t("label",{class:"form-label"},"Notes / Reason",-1)),h(t("textarea",{"onUpdate:modelValue":e[34]||(e[34]=l=>p.value.description=l),rows:"3",class:"form-control"},null,512),[[w,p.value.description]])])]),t("div",bo,[t("button",{class:"d-flex align-items-center justify-content-center gap-2 px-4 py-2 rounded-pill btn btn-primary text-white",disabled:M.value,onClick:je},[M.value?(r(),u("span",_o)):g("",!0),t("span",null,n(M.value?"Saving...":"Stock In"),1)],8,fo)])])])])]),t("div",ko,[t("div",xo,[t("div",ho,[t("div",wo,[t("h5",So," Stock Out : "+n(p.value.name),1),t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close",onClick:pe},[...e[100]||(e[100]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",Co,[t("div",Io,[t("div",Vo,[e[101]||(e[101]=t("label",{class:"form-label"},"Product Name",-1)),h(t("input",{type:"text","onUpdate:modelValue":e[35]||(e[35]=l=>p.value.name=l),class:"form-control",readonly:""},null,512),[[w,p.value.name]])]),t("div",Ao,[e[102]||(e[102]=t("label",{class:"form-label"},"Category",-1)),t("input",{type:"text",value:De.value,class:"form-control",readonly:""},null,8,$o),a.value.category_id?(r(),u("small",Mo,n(a.value.category_id[0]),1)):g("",!0)]),t("div",Uo,[e[103]||(e[103]=t("label",{class:"form-label"},"Available Quantity",-1)),h(t("input",{type:"number","onUpdate:modelValue":e[36]||(e[36]=l=>p.value.available_quantity=l),class:"form-control",readonly:""},null,512),[[w,p.value.available_quantity]])]),t("div",Fo,[e[104]||(e[104]=t("label",{class:"form-label"},"Quantity",-1)),h(t("input",{type:"number","onUpdate:modelValue":e[37]||(e[37]=l=>p.value.quantity=l),class:f(["form-control",{"is-invalid":a.value.quantity}]),min:"0",onInput:e[38]||(e[38]=l=>O())},null,34),[[w,p.value.quantity]]),a.value.quantity?(r(),u("small",Eo,n(a.value.quantity[0]),1)):g("",!0)]),t("div",jo,[e[105]||(e[105]=t("label",{class:"form-label"},"Notes / Reason",-1)),h(t("textarea",{"onUpdate:modelValue":e[39]||(e[39]=l=>p.value.description=l),rows:"3",class:"form-control"},null,512),[[w,p.value.description]])])]),t("div",Do,[t("button",{class:"d-flex align-items-center gap-1 px-4 py-2 rounded-pill btn btn-danger text-white",disabled:M.value,onClick:Le}," Stock Out ",8,Po)])])])])])])]),_:1})}}},ta=he(qo,[["__scopeId","data-v-16067c80"]]);export{ta as default};
