import{_ as Ie,r as g,R as J,c as Q,o as Ve,n as Pe,q as n,z as Ae,I as Ne,E as Le,a as ee,b as d,w,d as b,e as t,u as f,h as Re,l as x,f as m,F as N,g as te,i as _,j as Be,t as c,k as F,v as M,m as S,C as ie,p as $}from"./app-DrUr72II.js";import{_ as je}from"./Master-BeW6Lctk.js";import{s as re}from"./index-C4HWvfN4.js";import{u as Oe}from"./useFormatters-DMzlbhVl.js";import{s as Ue,a as ze,b as de,c as Xe,d as ce}from"./index-ZHsUw7cQ.js";import{E as Ze,a as Ye,X as qe,u as L,w as Ge}from"./xlsx-7aOw9oZM.js";import{I as He}from"./importFile-AWru9xi7.js";import{F as Ke}from"./FilterModal-nF80RTMq.js";import{P as We}from"./percent-BTxi3nLy.js";import{C as Je}from"./calendar-D9bm-B7r.js";import{C as Qe}from"./circle-x-CZ0G9APD.js";import{P as et}from"./plus-CmrmLSaN.js";import{P as tt}from"./pencil-Be4IWqC2.js";import{T as st}from"./trash-2-O8vdyQKr.js";import"./index-BLyqyTLg.js";import"./createLucideIcon-BENYThoS.js";import"./index-DMd6VC55.js";import"./index-DfwVUbck.js";import"./sun-pxRjjhfX.js";import"./index-CAExNS8U.js";import"./index-IACkjU4I.js";const at={class:"page-wrapper"},ot={class:"mt-3"},lt={class:"row g-3 mb-4"},nt={class:"card border-0 shadow-sm rounded-4"},it={class:"card-body d-flex align-items-center"},rt={class:"mb-0 fw-bold"},dt={class:"text-muted mb-0 small"},ct={class:"card border-0 shadow-lg rounded-4"},ut={class:"card-body"},mt={class:"d-flex flex-wrap gap-2 justify-content-between align-items-center mb-3"},pt={class:"d-flex flex-wrap gap-2 align-items-center"},vt={class:"search-wrap"},ft={key:1,class:"form-control search-input",placeholder:"Search discounts",disabled:"",type:"text"},bt={class:"dropdown"},gt={class:"dropdown-menu dropdown-menu-end shadow rounded-4 py-2"},yt={class:"table-responsive"},_t={class:"table table-striped"},ht={class:"fw-semibold"},xt={class:"text-center"},Dt={class:"text-center"},wt={class:"d-inline-flex align-items-center gap-3"},St=["onClick"],kt=["title"],Ct={title:"Delete",class:"p-2 rounded-full text-red-600 hover:bg-red-100"},$t={key:0},Ft={class:"mt-3"},Mt={class:"card border-0 shadow-sm rounded-4"},Tt={class:"card-body"},Et={key:0,class:"text-center py-5"},It={key:1,class:"text-center py-5"},Vt={key:2,class:"row g-3"},Pt={class:"card border border-warning rounded-4 h-100"},At={class:"card-body"},Nt={class:"d-flex justify-content-between align-items-start mb-3"},Lt={class:"fw-bold mb-1"},Rt={class:"text-end"},Bt={class:"h3 text-primary mb-0 fw-bold"},jt={class:"mb-3"},Ot={class:"d-flex align-items-center gap-2 mb-2"},Ut={class:"text-muted"},zt={class:"fw-semibold"},Xt={class:"d-flex align-items-center gap-2 mb-2"},Zt={class:"text-muted"},Yt={class:"mb-3"},qt=["onUpdate:modelValue"],Gt={class:"d-flex gap-2"},Ht=["onClick","disabled"],Kt=["onClick","disabled"],Wt={class:"modal fade",id:"discountModal",tabindex:"-1","aria-hidden":"true"},Jt={class:"modal-dialog modal-lg modal-dialog-centered"},Qt={class:"modal-content rounded-4"},es={class:"modal-header"},ts={class:"modal-title fw-semibold"},ss={class:"modal-body"},as={class:"row g-3"},os={class:"col-12"},ls={key:0,class:"text-danger"},ns={class:"col-md-6"},is={key:0,class:"text-danger"},rs={class:"col-md-6"},ds={key:0,class:"text-danger"},cs={class:"col-12"},us={key:0,class:"text-danger"},ms={class:"col-md-6"},ps={key:0,class:"text-danger"},vs={class:"col-md-6"},fs={key:0,class:"text-danger"},bs={class:"col-md-6"},gs={key:0,class:"text-danger"},ys={class:"col-md-6"},_s={key:0,class:"text-danger"},hs={class:"col-12"},xs={key:0,class:"text-danger"},Ds={class:"mt-4"},ws=["disabled"],Ss={__name:"Index",setup(ks){const{formatCurrencySymbol:T,dateFmt:D}=Oe(),k=g([]),E=g(null),R=g(!1),i=g({}),P=g([]),B=g(!1),j=J({}),O=J({});J({});const I=g(null),se=g(0),ue=g({sortBy:"",stockStatus:"",category:"",priceMin:null,priceMax:null,dateFrom:null,dateTo:null}),me=[{label:"Percentage",value:"percent"}],pe=[{label:"Active",value:"active"},{label:"Deactive",value:"inactive"}],p=g({name:"",type:"percent",status:"active",start_date:"",end_date:"",min_purchase:0,max_discount:null,description:"",discount_amount:null}),V=g(""),ae=g(Date.now()),Z=`search-${Math.random().toString(36).substr(2,9)}`,oe=g(!1);Q(()=>[{id:"flat",name:"Flat"},{id:"percent",name:"Percentage"}]);const v=g({sortBy:"",stockStatus:"",priceMin:null,priceMax:null,dateFrom:null,dateTo:null}),Y=Q(()=>{let a=k.value;const e=V.value.trim().toLowerCase();if(e&&(a=a.filter(o=>o.name.toLowerCase().includes(e))),v.value.stockStatus&&(a=a.filter(o=>o.status===v.value.stockStatus)),v.value.category&&(a=a.filter(o=>o.type===v.value.category)),v.value.priceMin!==null&&v.value.priceMin!==""&&(a=a.filter(o=>parseFloat(o.discount_amount)>=parseFloat(v.value.priceMin))),v.value.priceMax!==null&&v.value.priceMax!==""&&(a=a.filter(o=>parseFloat(o.discount_amount)<=parseFloat(v.value.priceMax))),v.value.dateFrom){const o=new Date(v.value.dateFrom);a=a.filter(s=>new Date(s.start_date)>=o)}if(v.value.dateTo){const o=new Date(v.value.dateTo);a=a.filter(s=>new Date(s.start_date)<=o)}if(v.value.sortBy)switch(v.value.sortBy){case"discount_asc":a.sort((o,s)=>parseFloat(o.discount_amount)-parseFloat(s.discount_amount));break;case"discount_desc":a.sort((o,s)=>parseFloat(s.discount_amount)-parseFloat(o.discount_amount));break;case"name_asc":a.sort((o,s)=>o.name.localeCompare(s.name));break;case"name_desc":a.sort((o,s)=>s.name.localeCompare(o.name));break;case"date_asc":a.sort((o,s)=>new Date(o.start_date)-new Date(s.start_date));break;case"date_desc":a.sort((o,s)=>new Date(s.start_date)-new Date(o.start_date));break}return a}),q=g(!1),ve=a=>{v.value={...v.value,...a},q.value=!0},le=()=>{v.value={sortBy:"",stockStatus:"",category:"",priceMin:null,priceMax:null,dateFrom:null,dateTo:null},ue.value={sortBy:"",stockStatus:"",category:"",priceMin:null,priceMax:null,dateFrom:null,dateTo:null}},fe=Q(()=>[{label:"Total Discounts",value:k.value.length,icon:We,iconBg:"bg-light-primary",iconColor:"text-primary"},{label:"Active Discounts",value:k.value.filter(a=>a.status==="active").length,icon:Je,iconBg:"bg-light-success",iconColor:"text-success"},{label:"Inactive Discounts",value:k.value.filter(a=>a.status==="inactive").length,icon:Qe,iconBg:"bg-light-danger",iconColor:"text-danger"}]),U=async()=>{try{const a=await $.get("/api/discounts/all");k.value=a.data.data}catch(a){console.error("Failed to fetch discounts:",a),n.error("Failed to load discounts")}},z=async(a=!1)=>{if(!(B.value&&!a)){a||(B.value=!0);try{const e=await $.get("/api/discount-approvals/pending");e.data.success&&(P.value=e.data.data)}catch(e){console.error("Error fetching pending requests:",e),a||n.error("Failed to load approval requests")}finally{a||(B.value=!1)}}},X=()=>{p.value={name:"",type:"percent",status:"active",start_date:"",end_date:"",min_purchase:0,max_discount:null,description:"",discount_amount:null},E.value=null,i.value={}},be=a=>{E.value=a,p.value={name:a.name,type:a.type,status:a.status,start_date:a.start_date?new Date(a.start_date):null,end_date:a.end_date?new Date(a.end_date):null,min_purchase:a.min_purchase,max_discount:a.max_discount,description:a.description||"",discount_amount:a.discount_amount};const e=document.getElementById("discountModal");new bootstrap.Modal(e).show()},ge=async()=>{R.value=!0,i.value={};try{E.value?(await $.patch(`/discounts/${E.value.id}`,p.value),n.success("Discount updated successfully")):(await $.post("/discounts",p.value),n.success("Discount created successfully"));const a=document.getElementById("discountModal"),e=bootstrap.Modal.getInstance(a);e&&e.hide(),setTimeout(()=>{document.body.classList.remove("modal-open"),document.body.style.overflow="",document.body.style.paddingRight="",document.querySelectorAll(".modal-backdrop").forEach(s=>s.remove())},100),X(),await U()}catch(a){if(console.error("âŒ Error:",a.response?.data||a.message),a.response?.status===422&&a.response?.data?.errors){i.value=a.response.data.errors;const e=Object.values(a.response.data.errors).flat();n.error(e.join(`
`))}else{const e=a.response?.data?.message||"Failed to save discount";n.error(e)}}finally{R.value=!1}setTimeout(()=>{document.querySelectorAll(".modal-backdrop").forEach(e=>e.remove()),document.body.classList.remove("modal-open"),document.body.style.overflow="",document.body.style.paddingRight=""},100)},ye=["Discount Name","Type","Discount Percent","Start Date","End Date","Min Purchase","Max Discount","Status","Description"],_e=[["Summer Sale","flat","20","2025-06-01","2025-08-31","50","100","active","Summer discount on all items"],["Winter Sale","flat","10","2025-01-01","2025-12-31","30","","active","Flat 10 off on purchase"]],he=a=>{const e=l=>{if(!l)return"";if(!isNaN(l)&&Number(l)>3e4){const K=Number(l),A=new Date((K-25569)*86400*1e3),W=A.getFullYear(),Te=String(A.getMonth()+1).padStart(2,"0"),Ee=String(A.getDate()).padStart(2,"0");return`${W}-${Te}-${Ee}`}if(typeof l=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(l))return l;const C=new Date(l);if(!isNaN(C.getTime())){const K=C.getFullYear(),A=String(C.getMonth()+1).padStart(2,"0"),W=String(C.getDate()).padStart(2,"0");return`${K}-${A}-${W}`}return""};if(!a||a.length<=1){n.error("The imported file is empty.");return}a[0];const s=a.slice(1).map(l=>({name:l[0]||"",type:l[1]||"percent",discount_amount:l[2]||"",start_date:e(l[3]),end_date:e(l[4]),min_purchase:l[5]||"0",max_discount:l[6]||null,status:l[7]||"active",description:l[8]||""})).filter(l=>l.name.trim());if(s.length===0){n.error("No valid discounts found in the file.");return}const y=s.map(l=>l.name.trim().toLowerCase()),h=y.filter((l,C)=>y.indexOf(l)!==C);if(h.length>0){n.error(`Duplicate discount names found: ${[...new Set(h)].join(", ")}`);return}const u=k.value.map(l=>l.name.trim().toLowerCase()),r=s.filter(l=>u.includes(l.name.trim().toLowerCase()));if(r.length>0){n.error(`Discounts already exist: ${r.map(l=>l.name).join(", ")}`);return}const H=["flat","percent"];if(s.filter(l=>!H.includes(l.type.toLowerCase())).length>0){n.error("Invalid type detected. Allowed: flat, percent");return}const Me=["active","inactive"];if(s.filter(l=>!Me.includes(l.status.toLowerCase())).length>0){n.error("Invalid status detected. Allowed: active, inactive");return}$.post("/api/discounts/import",{discounts:s}).then(()=>{n.success("Discounts imported successfully"),U()}).catch(l=>{const C=l.response?.data?.message||"Import failed";n.error(C)})},xe=async a=>{const e=a.status==="active"?"inactive":"active";try{await $.patch(`/api/discounts/${a.id}/toggle-status`,{status:e}),a.status=e,n.success(`Discount status updated to ${e}`),se.value++}catch(o){console.error("Failed to update status:",o),n.error("Failed to update status")}},De=async a=>{try{await $.delete(`/discounts/${a.id}`),n.success("Discount deleted successfully"),await U()}catch(e){console.error("Failed to delete discount:",e),n.error("Failed to delete discount")}},ne=async(a,e)=>{j[a]=!0;try{(await $.post(`/api/discount-approvals/${a}/respond`,{status:e,approval_note:O[a]||null})).data.success&&(n.success(`Discount ${e} successfully!`),P.value=P.value.filter(s=>s.id!==a),delete O[a])}catch(o){console.error("Error responding to request:",o),n.error(o.response?.data?.message||`Failed to ${e} discount`)}finally{j[a]=!1}},we=a=>a?new Date(a).toLocaleString("en-GB",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-",Se=()=>{I.value&&clearInterval(I.value),I.value=setInterval(()=>{z(!0)},3e4)},ke=()=>{I.value&&(clearInterval(I.value),I.value=null)};Ve(async()=>{V.value="",ae.value=Date.now(),await Pe(),setTimeout(()=>{oe.value=!0;const o=document.getElementById(Z);o&&(o.value="",V.value="")},100),await U(),await z(),Se(),window.Echo&&window.Echo.channel("discount-approvals").listen(".approval.requested",o=>{z(!0),n.info("New discount approval request received!")});const a=document.getElementById("discountModal");a&&a.addEventListener("hidden.bs.modal",()=>{document.body.classList.remove("modal-open"),document.body.style.overflow="",document.querySelectorAll(".modal-backdrop").forEach(s=>s.remove())});const e=document.getElementById("discountsFilterModal");e&&e.addEventListener("hidden.bs.modal",()=>{q.value||le(),q.value=!1})}),Ae(()=>{ke()}),Ne(()=>window.feather?.replace());const G=a=>{if(!k.value||k.value.length===0){n.error("No Discounts data to download");return}const e=V.value.trim()?Y.value:k.value;if(e.length===0){n.error("No Discounts found to download");return}try{a==="pdf"?$e(e):a==="excel"?Fe(e):a==="csv"?Ce(e):n.error("Invalid download type")}catch(o){console.error("Download failed:",o),n.error(`Download failed: ${o.message}`)}},Ce=a=>{try{const e=["ID","Discount Name","Type","Discount Percent","Start Date","End Date","Min Purchase","Max Discount","Status","Description"],o=a.map(r=>[`${r.id||""}`,`"${r.name||""}"`,`"${r.type||""}"`,`${r.discount_amount||""}`,`"${D(r.start_date)||""}"`,`"${D(r.end_date)||""}"`,`${r.min_purchase||""}`,`${r.max_discount||""}`,`"${r.status||""}"`,`"${r.description||""}"`]),s=[e.join(","),...o.map(r=>r.join(","))].join(`
`),y=new Blob([s],{type:"text/csv;charset=utf-8;"}),h=URL.createObjectURL(y),u=document.createElement("a");u.setAttribute("href",h),u.setAttribute("download",`Discounts_${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(u),u.click(),document.body.removeChild(u),n.success("CSV downloaded successfully")}catch(e){console.error("CSV generation error:",e),n.error(`CSV generation failed: ${e.message}`)}},$e=a=>{try{const e=new Ze("l","mm","a4");e.setFontSize(18),e.setFont("helvetica","bold"),e.text("Discounts Report",14,20),e.setFontSize(10),e.setFont("helvetica","normal");const o=new Date().toLocaleString();e.text(`Generated on: ${o}`,14,28),e.text(`Total Discounts: ${a.length}`,14,34);const s=["ID","Name","Type","Amount","Start Date","End Date","Min Purchase","Max Discount","Status"],y=a.map(u=>[u.id||"",u.name||"",u.type==="flat"?"Flat":"Percent",u.type==="flat"?T(u.discount_amount):u.discount_amount+"%",D(u.start_date)||"",D(u.end_date)||"",T(u.min_purchase)||"",u.max_discount?T(u.max_discount):"N/A",u.status==="active"?"Active":"Inactive"]);Ye(e,{head:[s],body:y,startY:40,styles:{fontSize:8,cellPadding:2,halign:"left",lineColor:[0,0,0],lineWidth:.1},headStyles:{fillColor:[41,128,185],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]},margin:{left:14,right:14},didDrawPage:u=>{const r=e.internal.getNumberOfPages(),H=e.internal.pageSize.height;e.setFontSize(8),e.text(`Page ${u.pageNumber} of ${r}`,u.settings.margin.left,H-10)}});const h=`Discounts_${new Date().toISOString().split("T")[0]}.pdf`;e.save(h),n.success("PDF downloaded successfully")}catch(e){console.error("PDF generation error:",e),n.error(`PDF generation failed: ${e.message}`)}},Fe=a=>{try{if(typeof qe>"u")throw new Error("XLSX library is not loaded");const e=a.map(r=>({ID:r.id||"","Discount Name":r.name||"",Type:r.type==="flat"?"Flat":"Percent","Discount Percent":r.type==="flat"?r.discount_amount:r.discount_amount+"%","Start Date":D(r.start_date)||"","End Date":D(r.end_date)||"","Min Purchase":r.min_purchase||"","Max Discount":r.max_discount||"",Status:r.status==="active"?"Active":"Inactive",Description:r.description||""})),o=L.book_new(),s=L.json_to_sheet(e);s["!cols"]=[{wch:8},{wch:25},{wch:12},{wch:15},{wch:15},{wch:15},{wch:15},{wch:15},{wch:12},{wch:30}],L.book_append_sheet(o,s,"Discounts");const y=[{Info:"Report",Value:"Discounts Export"},{Info:"Generated On",Value:new Date().toLocaleString()},{Info:"Total Records",Value:a.length},{Info:"Exported By",Value:"Inventory Management System"}],h=L.json_to_sheet(y);L.book_append_sheet(o,h,"Report Info");const u=`Discounts_${new Date().toISOString().split("T")[0]}.xlsx`;Ge(o,u),n.success("Excel file downloaded successfully")}catch(e){console.error("Excel generation error:",e),n.error(`Excel generation failed: ${e.message}`)}};return(a,e)=>{const o=Le("VueDatePicker");return d(),ee(je,null,{default:w(()=>[b(f(Re),{title:"Discount Management"}),t("div",at,[e[49]||(e[49]=t("h4",{class:"fw-semibold mb-3"},"Discount Management",-1)),b(f(Ue),{value:"0",class:"w-100"},{default:w(()=>[b(f(ze),null,{default:w(()=>[b(f(de),{value:"0"},{default:w(()=>[...e[15]||(e[15]=[x("Discounts",-1)])]),_:1}),b(f(de),{value:"1"},{default:w(()=>[...e[16]||(e[16]=[x("Discount Approvals",-1)])]),_:1})]),_:1}),b(f(Xe),null,{default:w(()=>[b(f(ce),{value:"0"},{default:w(()=>[t("div",ot,[t("div",lt,[(d(!0),m(N,null,te(fe.value,s=>(d(),m("div",{key:s.label,class:"col-md-6 col-xl-3"},[t("div",nt,[t("div",it,[t("div",{class:_([[s.iconBg,s.iconColor],"rounded-circle p-3 d-flex align-items-center justify-content-center me-3"]),style:{width:"56px",height:"56px"}},[(d(),ee(Be(s.icon),{class:"w-6 h-6"}))],2),t("div",null,[t("h3",rt,c(s.value),1),t("p",dt,c(s.label),1)])])])]))),128))]),t("div",ct,[t("div",ut,[t("div",mt,[e[21]||(e[21]=t("h5",{class:"mb-0 fw-semibold"},"Discounts",-1)),t("div",pt,[b(Ke,{modelValue:v.value,"onUpdate:modelValue":e[0]||(e[0]=s=>v.value=s),title:"Discounts",modalId:"discountsFilterModal",modalSize:"modal-lg",sortOptions:[{value:"name_asc",label:"Name: A to Z"},{value:"name_desc",label:"Name: Z to A"}],showStockStatus:!1,categoryLabel:"Discount Type",statusLabel:"Discount Status",showPriceRange:!0,priceRangeLabel:"Discount Percent Range",showDateRange:!0,onApply:ve,onClear:le},null,8,["modelValue"]),t("div",vt,[e[17]||(e[17]=t("i",{class:"bi bi-search"},null,-1)),e[18]||(e[18]=t("input",{type:"email",name:"email",autocomplete:"email",style:{position:"absolute",left:"-9999px",width:"1px",height:"1px"},tabindex:"-1","aria-hidden":"true"},null,-1)),oe.value?F((d(),m("input",{id:Z,"onUpdate:modelValue":e[1]||(e[1]=s=>V.value=s),key:ae.value,class:"form-control search-input",placeholder:"Search discounts",type:"search",autocomplete:"new-password",name:Z,role:"presentation"})),[[M,V.value]]):(d(),m("input",ft))]),t("button",{"data-bs-toggle":"modal","data-bs-target":"#discountModal",onClick:X,class:"d-flex align-items-center gap-1 px-4 py-2 rounded-pill btn btn-primary text-white"},[b(f(et),{class:"w-4 h-4"}),e[19]||(e[19]=x(" Add Discount ",-1))]),b(He,{label:"Import Discounts",sampleHeaders:ye,sampleData:_e,onOnImport:he}),t("div",bt,[e[20]||(e[20]=t("button",{class:"btn btn-outline-secondary rounded-pill py-2 btn-sm px-4 dropdown-toggle","data-bs-toggle":"dropdown"}," Export ",-1)),t("ul",gt,[t("li",null,[t("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:e[2]||(e[2]=s=>G("pdf"))},"Export as PDF")]),t("li",null,[t("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:e[3]||(e[3]=s=>G("excel"))},"Export as Excel")]),t("li",null,[t("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:e[4]||(e[4]=s=>G("csv"))},"Export as CSV")])])])])]),t("div",yt,[t("table",_t,[e[23]||(e[23]=t("thead",{class:"border-top small text-muted"},[t("tr",null,[t("th",null,"S.#"),t("th",null,"Name"),t("th",null,"Type"),t("th",null,"Discount (%)"),t("th",null,"Start Date"),t("th",null,"End Date"),t("th",null,"Min Purchase"),t("th",null,"Max Discount"),t("th",{class:"text-center"},"Status"),t("th",{class:"text-center"},"Action")])],-1)),t("tbody",null,[(d(!0),m(N,null,te(Y.value,(s,y)=>(d(),m("tr",{key:s.id},[t("td",null,c(y+1),1),t("td",ht,c(s.name),1),t("td",null,[t("span",{class:_(s.type==="flat"?"badge bg-primary px-4 py-2 rounded-pill":"badge bg-warning px-4 py-2 rounded-pill")},c(s.type==="flat"?"Flat":"Percent"),3)]),t("td",null,c(s.type==="flat"?f(T)(s.discount_amount):s.discount_amount+"%"),1),t("td",null,c(f(D)(s.start_date)),1),t("td",null,c(f(D)(s.end_date)),1),t("td",null,c(f(T)(s.min_purchase)),1),t("td",null,c(s.max_discount?f(T)(s.max_discount):"N/A"),1),t("td",xt,[t("span",{class:_(s.status==="active"?"badge bg-success px-4 py-2 rounded-pill":"badge bg-danger px-4 py-2 rounded-pill")},c(s.status==="active"?"Active":"Inactive"),3)]),t("td",Dt,[t("div",wt,[t("button",{onClick:h=>be(s),title:"Edit",class:"p-2 rounded-full text-blue-600 hover:bg-blue-100"},[b(f(tt),{class:"w-4 h-4"})],8,St),(d(),ee(ie,{key:`confirm-${s.id}-${se.value}`,title:"Confirm Status Change",message:`Are you sure you want to set ${s.name} to ${s.status==="active"?"Inactive":"Active"}?`,showStatusButton:!0,confirmText:"Yes, Change",cancelText:"Cancel",status:s.status,onConfirm:h=>xe(s)},{trigger:w(()=>[t("button",{class:_(["relative inline-flex items-center w-8 h-4 rounded-full transition-colors duration-300 focus:outline-none",s.status==="active"?"bg-green-500 hover:bg-green-600":"bg-red-400 hover:bg-red-500"]),title:s.status==="active"?"Set Inactive":"Set Active"},[t("span",{class:_(["absolute left-0.5 top-0.5 w-3 h-3 bg-white rounded-full shadow transform transition-transform duration-300",s.status==="active"?"translate-x-4":"translate-x-0"])},null,2)],10,kt)]),_:2},1032,["message","status","onConfirm"])),b(ie,{title:"Confirm Delete",message:`Are you sure you want to delete ${s.name}? This action cannot be undone.`,confirmText:"Yes, Delete",cancelText:"Cancel",onConfirm:h=>De(s)},{trigger:w(()=>[t("button",Ct,[b(f(st),{class:"w-4 h-4"})])]),_:1},8,["message","onConfirm"])])])]))),128)),Y.value.length===0?(d(),m("tr",$t,[...e[22]||(e[22]=[t("td",{colspan:"10",class:"text-center text-muted py-4"}," No discounts found. ",-1)])])):S("",!0)])])])])])])]),_:1}),b(f(ce),{value:"1"},{default:w(()=>[t("div",Ft,[t("div",Mt,[t("div",{class:"card-header bg-white border-0 d-flex justify-content-between align-items-center py-3"},[e[25]||(e[25]=t("h4",{class:"mb-0 fw-bold"},[t("i",{class:"bi bi-shield-check text-primary me-2"}),x(" Discount Approval Requests ")],-1)),t("button",{class:"btn btn-outline-primary btn-sm",onClick:z},[...e[24]||(e[24]=[t("i",{class:"bi bi-arrow-clockwise me-1"},null,-1),x(" Refresh ",-1)])])]),t("div",Tt,[B.value?(d(),m("div",Et,[...e[26]||(e[26]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"mt-3 text-muted"},"Loading approval requests...",-1)])])):P.value.length===0?(d(),m("div",It,[...e[27]||(e[27]=[t("i",{class:"bi bi-inbox",style:{"font-size":"4rem",opacity:"0.3"}},null,-1),t("p",{class:"mt-3 text-muted fw-semibold"},"No pending discount approval requests",-1)])])):(d(),m("div",Vt,[(d(!0),m(N,null,te(P.value,s=>(d(),m("div",{key:s.id,class:"col-md-4"},[t("div",Pt,[t("div",At,[t("div",Nt,[t("div",null,[t("h5",Lt,c(s.discount_name||s.discount.name),1),e[28]||(e[28]=t("span",{class:"badge bg-warning"},[t("i",{class:"bi bi-clock-history me-1"}),x(" Pending Approval ")],-1))]),t("div",Rt,[t("div",Bt,c(parseFloat(s.discount_percentage).toFixed(0))+"% ",1),e[29]||(e[29]=t("small",{class:"text-muted d-block"},"Discount Rate",-1))])]),t("div",jt,[t("div",Ot,[e[31]||(e[31]=t("i",{class:"bi bi-person-circle text-muted"},null,-1)),t("small",Ut,[e[30]||(e[30]=x(" Requested by: ",-1)),t("span",zt,c(s.requested_by.name),1)])]),t("div",Xt,[e[32]||(e[32]=t("i",{class:"bi bi-clock text-muted"},null,-1)),t("small",Zt,c(we(s.requested_at)),1)])]),t("div",Yt,[e[33]||(e[33]=t("label",{class:"form-label small fw-semibold"},"Response Note (Optional)",-1)),F(t("textarea",{"onUpdate:modelValue":y=>O[s.id]=y,class:"form-control form-control-sm",rows:"2",placeholder:"Add a note for the cashier..."},null,8,qt),[[M,O[s.id]]])]),t("div",Gt,[t("button",{class:"btn btn-success flex-fill",onClick:y=>ne(s.id,"approved"),disabled:j[s.id]},[...e[34]||(e[34]=[t("i",{class:"bi bi-check-circle me-1"},null,-1),x(" Approve ",-1)])],8,Ht),t("button",{class:"btn btn-danger flex-fill",onClick:y=>ne(s.id,"rejected"),disabled:j[s.id]},[...e[35]||(e[35]=[t("i",{class:"bi bi-x-circle me-1"},null,-1),x(" Reject ",-1)])],8,Kt)])])])]))),128))]))])])])]),_:1})]),_:1})]),_:1}),t("div",Wt,[t("div",Jt,[t("div",Qt,[t("div",es,[t("h5",ts,c(E.value?"Edit Discount":"Add New Discount"),1),t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110",onClick:X,"data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[...e[36]||(e[36]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",ss,[t("div",as,[t("div",os,[e[37]||(e[37]=t("label",{class:"form-label"},"Discount Name *",-1)),F(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>p.value.name=s),type:"text",class:_(["form-control",{"is-invalid":i.value.name}]),placeholder:"Enter discount name"},null,2),[[M,p.value.name]]),i.value.name?(d(),m("small",ls,c(i.value.name[0]),1)):S("",!0)]),t("div",ns,[e[38]||(e[38]=t("label",{class:"form-label"},"Discount Type *",-1)),b(f(re),{modelValue:p.value.type,"onUpdate:modelValue":e[6]||(e[6]=s=>p.value.type=s),options:me,optionLabel:"label",appendTo:"self",autoZIndex:!0,baseZIndex:2e3,optionValue:"value",class:_(["form-select",{"is-invalid":i.value.type}])},null,8,["modelValue","class"]),i.value.type?(d(),m("small",is,c(i.value.type[0]),1)):S("",!0)]),t("div",rs,[e[39]||(e[39]=t("label",{class:"form-label"},"Status *",-1)),b(f(re),{modelValue:p.value.status,"onUpdate:modelValue":e[7]||(e[7]=s=>p.value.status=s),options:pe,optionLabel:"label",optionValue:"value",class:_(["form-select",{"is-invalid":i.value.status}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","class"]),i.value.status?(d(),m("small",ds,c(i.value.status[0]),1)):S("",!0)]),t("div",cs,[e[40]||(e[40]=t("label",{class:"form-label"},"Discount Percent *",-1)),F(t("input",{"onUpdate:modelValue":e[8]||(e[8]=s=>p.value.discount_amount=s),type:"number",class:_(["form-control",{"is-invalid":i.value.discount_amount}]),placeholder:"Enter discount amount"},null,2),[[M,p.value.discount_amount]]),i.value.discount_amount?(d(),m("small",us,c(i.value.discount_amount[0]),1)):S("",!0)]),t("div",ms,[e[41]||(e[41]=t("label",{class:"form-label"},"Start Date *",-1)),b(o,{modelValue:p.value.start_date,"onUpdate:modelValue":e[9]||(e[9]=s=>p.value.start_date=s),format:f(D),"min-date":new Date,enableTimePicker:!1,placeholder:"Select start date",class:_({"is-invalid":i.value.start_date})},null,8,["modelValue","format","min-date","class"]),i.value.start_date?(d(),m("small",ps,c(i.value.start_date[0]),1)):S("",!0)]),t("div",vs,[e[42]||(e[42]=t("label",{class:"form-label"},"End Date *",-1)),b(o,{modelValue:p.value.end_date,"onUpdate:modelValue":e[10]||(e[10]=s=>p.value.end_date=s),format:f(D),"min-date":new Date,enableTimePicker:!1,placeholder:"Select end date",class:_({"is-invalid":i.value.end_date})},null,8,["modelValue","format","min-date","class"]),i.value.end_date?(d(),m("small",fs,c(i.value.end_date[0]),1)):S("",!0)]),t("div",bs,[e[43]||(e[43]=t("label",{class:"form-label"},"Minimum Purchase Amount *",-1)),F(t("input",{"onUpdate:modelValue":e[11]||(e[11]=s=>p.value.min_purchase=s),type:"number",step:"0.01",class:_(["form-control",{"is-invalid":i.value.min_purchase}]),placeholder:"0.00"},null,2),[[M,p.value.min_purchase]]),i.value.min_purchase?(d(),m("small",gs,c(i.value.min_purchase[0]),1)):S("",!0)]),t("div",ys,[e[44]||(e[44]=t("label",{class:"form-label"},"Maximum Discount (Optional)",-1)),F(t("input",{"onUpdate:modelValue":e[12]||(e[12]=s=>p.value.max_discount=s),type:"number",step:"0.01",class:_(["form-control",{"is-invalid":i.value.max_discount}]),placeholder:"0.00"},null,2),[[M,p.value.max_discount]]),i.value.max_discount?(d(),m("small",_s,c(i.value.max_discount[0]),1)):S("",!0)]),t("div",hs,[e[45]||(e[45]=t("label",{class:"form-label"},"Description (Optional)",-1)),F(t("textarea",{"onUpdate:modelValue":e[13]||(e[13]=s=>p.value.description=s),class:_(["form-control",{"is-invalid":i.value.description}]),rows:"3",placeholder:"Enter discount description"},null,2),[[M,p.value.description]]),i.value.description?(d(),m("small",xs,c(i.value.description[0]),1)):S("",!0)])]),e[48]||(e[48]=t("hr",{class:"my-4"},null,-1)),t("div",Ds,[t("button",{class:"btn btn-primary rounded-pill px-4",disabled:R.value,onClick:e[14]||(e[14]=s=>ge())},[R.value?(d(),m(N,{key:0},[e[46]||(e[46]=t("span",{class:"spinner-border spinner-border-sm me-2"},null,-1)),e[47]||(e[47]=x(" Saving... ",-1))],64)):(d(),m(N,{key:1},[x(c((E.value,"Save")),1)],64))],8,ws),t("button",{class:"btn btn-secondary rounded-pill px-4 ms-2","data-bs-dismiss":"modal",onClick:X}," Cancel ")])])])])])])]),_:1})}}},Hs=Ie(Ss,[["__scopeId","data-v-e08ed7a5"]]);export{Hs as default};
