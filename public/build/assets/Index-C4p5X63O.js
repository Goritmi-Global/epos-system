import{_ as Se}from"./Master-CIAemtMp.js";import{_ as ke,r as S,c as j,w as De,o as oe,I as Te,n as Re,g as d,b as u,e as k,u as c,h as Pe,d as Ce,f as e,l as v,p as x,J,F as y,t as i,i as O,K as B,q as Le}from"./app-BWJIgFUk.js";import{u as Ae}from"./useFormatters-D4QMfBkH.js";import{s as N}from"./index-CQSxWd0K.js";import{s as je}from"./index-Dlg67k_X.js";import{E as Me,a as Ve,u as W,w as Oe}from"./xlsx-BS8XIOXE.js";import"./index-N5It5Rdt.js";import"./createLucideIcon-BtxAcjLS.js";import"./PasswordVerificationModal-C7K_1d78.js";import"./index-566Dsl26.js";import"./index-DrwUNMx0.js";import"./sun-DRYQ-wZ1.js";import"./index-CTSD38n0.js";import"./index-zt3OxlBu.js";import"./index-DTkP46Ub.js";const Ne={class:"page-wrapper"},Ie={class:"d-flex flex-wrap gap-2 align-items-center justify-content-between mb-3"},$e={class:"card border-0 shadow-sm rounded-4 mb-4"},Ue={class:"card-body"},Ye={class:"row g-3"},Fe={class:"col-md-3"},qe={class:"col-md-3"},Qe={key:0,class:"col-md-3"},Ee={key:1,class:"col-md-2"},ze={key:2,class:"col-md-2"},Je={key:3,class:"col-md-3"},Be={key:4,class:"col-md-2"},We={key:5,class:"col-md-2"},Ge={class:"row g-3 mb-4"},Ke={class:"col-md-6 col-xl-3"},Xe={class:"card border-0 shadow-sm rounded-4"},He={class:"card-body d-flex align-items-center justify-content-between"},Ze={class:"mb-0 fw-bold"},et={class:"col-md-6 col-xl-3"},tt={class:"card border-0 shadow-sm rounded-4"},st={class:"card-body d-flex align-items-center justify-content-between"},lt={class:"mb-0 fw-bold"},at={class:"col-md-6 col-xl-3"},ot={class:"card border-0 shadow-sm rounded-4"},nt={class:"card-body d-flex align-items-center justify-content-between"},it={class:"mb-0 fw-bold"},dt={class:"col-md-6 col-xl-3"},ut={class:"card border-0 shadow-sm rounded-4"},rt={class:"card-body d-flex align-items-center justify-content-between"},ct={class:"mb-0 fw-bold"},mt={class:"col-md-6 col-xl-3"},vt={class:"card border-0 shadow-sm rounded-4"},yt={class:"card-body d-flex align-items-center justify-content-between"},pt={class:"mb-0 fw-bold"},ht={class:"col-md-6 col-xl-3"},bt={class:"card border-0 shadow-sm rounded-4"},gt={class:"card-body d-flex align-items-center justify-content-between"},_t={class:"mb-0 fw-bold"},ft={class:"col-md-6 col-xl-3"},xt={class:"card border-0 shadow-sm rounded-4"},wt={class:"card-body d-flex align-items-center justify-content-between"},St={class:"mb-0 fw-bold"},kt={class:"col-md-6 col-xl-3"},Dt={class:"card border-0 shadow-sm rounded-4"},Tt={class:"card-body d-flex align-items-center justify-content-between"},Rt={class:"mb-0 fw-bold"},Pt={class:"col-md-6 col-xl-3"},Ct={class:"card border-0 shadow-sm rounded-4"},Lt={class:"card-body d-flex align-items-center justify-content-between"},At={class:"mb-0 fw-bold"},jt={class:"col-md-6 col-xl-3"},Mt={class:"card border-0 shadow-sm rounded-4"},Vt={class:"card-body d-flex align-items-center justify-content-between"},Ot={class:"mb-0 fw-bold"},Nt={class:"col-md-6 col-xl-3"},It={class:"card border-0 shadow-sm rounded-4"},$t={class:"card-body d-flex align-items-center justify-content-between"},Ut={class:"mb-0 fw-bold"},Yt={class:"col-md-6 col-xl-3"},Ft={class:"card border-0 shadow-sm rounded-4"},qt={class:"card-body d-flex align-items-center justify-content-between"},Qt={class:"mb-0 fw-bold"},Et={class:"col-md-6 col-xl-3"},zt={class:"card border-0 shadow-sm rounded-4"},Jt={class:"card-body d-flex align-items-center justify-content-between"},Bt={class:"mb-0 fw-bold"},Wt={class:"col-md-6 col-xl-3"},Gt={class:"card border-0 shadow-sm rounded-4"},Kt={class:"card-body d-flex align-items-center justify-content-between"},Xt={class:"mb-0 fw-bold"},Ht={class:"col-md-6 col-xl-3"},Zt={class:"card border-0 shadow-sm rounded-4"},es={class:"card-body d-flex align-items-center justify-content-between"},ts={class:"mb-0 fw-bold"},ss={class:"col-md-6 col-xl-3"},ls={class:"card border-0 shadow-sm rounded-4"},as={class:"card-body d-flex align-items-center justify-content-between"},os={class:"mb-0 fw-bold"},ns={class:"col-md-6 col-xl-3"},is={class:"card border-0 shadow-sm rounded-4"},ds={class:"card-body d-flex align-items-center justify-content-between"},us={class:"mb-0 fw-bold"},rs={class:"col-md-6 col-xl-3"},cs={class:"card border-0 shadow-sm rounded-4"},ms={class:"card-body d-flex align-items-center justify-content-between"},vs={class:"mb-0 fw-bold"},ys={class:"col-md-6 col-xl-3"},ps={class:"card border-0 shadow-sm rounded-4"},hs={class:"card-body d-flex align-items-center justify-content-between"},bs={class:"mb-0 fw-bold"},gs={class:"col-md-6 col-xl-3"},_s={class:"card border-0 shadow-sm rounded-4"},fs={class:"card-body d-flex align-items-center justify-content-between"},xs={class:"mb-0 fw-bold"},ws={class:"col-md-6 col-xl-3"},Ss={class:"card border-0 shadow-sm rounded-4"},ks={class:"card-body d-flex align-items-center justify-content-between"},Ds={class:"mb-0 fw-bold"},Ts={class:"col-md-6 col-xl-3"},Rs={class:"card border-0 shadow-sm rounded-4"},Ps={class:"card-body d-flex align-items-center justify-content-between"},Cs={class:"mb-0 fw-bold"},Ls={class:"col-md-6 col-xl-3"},As={class:"card border-0 shadow-sm rounded-4"},js={class:"card-body d-flex align-items-center justify-content-between"},Ms={class:"mb-0 fw-bold"},Vs={class:"col-md-6 col-xl-3"},Os={class:"card border-0 shadow-sm rounded-4"},Ns={class:"card-body d-flex align-items-center justify-content-between"},Is={class:"mb-0 fw-bold"},$s={key:0,class:"alert alert-warning border-0 rounded-4 shadow-sm"},Us={class:"card border-0 shadow-sm rounded-4 mt-3"},Ys={class:"card-body"},Fs={class:"table-responsive"},qs={class:"table table-hover align-middle"},Qs={class:"small text-muted"},Es={key:0},zs={key:1},Js={key:2},Bs={key:3},Ws={key:4},Gs={key:5,style:{width:"150px"}},Ks={key:6,style:{width:"100px"}},Xs={key:7,style:{width:"100px"}},Hs={key:0},Zs={key:1},el={key:2,style:{width:"100px"}},tl={key:3},sl={key:4,style:{width:"150px"}},ll={key:5,style:{width:"150px"}},al={key:6,style:{width:"130px"}},ol={key:7,style:{width:"150px"}},nl={key:8,style:{width:"120px"}},il={key:9,style:{width:"100px"}},dl={class:"fw-semibold"},ul={key:0,class:"small"},rl={key:1,class:"small"},cl={class:"fw-bold text-success"},ml={key:2,class:"small"},vl={class:"fw-semibold"},yl={key:0,class:"fw-semibold"},pl={key:1,class:"small"},hl={key:0,class:"text-muted"},bl={key:1,class:"text-secondary"},gl={key:2,class:"small"},_l={class:"fw-bold text-success"},fl={key:3,class:"small"},xl={key:4},wl={key:0,class:"badge bg-success-subtle text-success px-3 py-2 rounded-pill"},Sl={key:1,class:"badge bg-warning-subtle text-warning px-3 py-2 rounded-pill"},kl={key:2,class:"badge bg-secondary-subtle text-secondary px-3 py-2 rounded-pill"},Dl={class:"fw-semibold"},Tl={class:"fw-semibold"},Rl={key:0,class:"badge bg-success-subtle text-success"},Pl={key:1,class:"badge bg-warning-subtle text-warning"},Cl={key:2,class:"badge bg-danger-subtle text-danger"},Ll={class:"fw-semibold"},Al={class:"fw-semibold"},jl={key:0,class:"table-active fw-bold border-top border-3"},Ml={class:"text-success"},Vl={key:1,class:"table-active fw-bold border-top border-3"},Ol={key:2},Nl={key:3},Il={class:"row g-3"},$l={class:"col-lg-8"},Ul={class:"card border-0 shadow-sm rounded-4 h-100"},Yl={class:"card-body"},Fl={class:"fw-semibold mb-2"},ql={class:"chart"},Ql={viewBox:"0 0 840 280"},El=["y1","y2"],zl=["x","y"],Jl=["x","y"],Bl=["d"],Wl=["d"],Gl={key:2},Kl={key:3,x:"430",y:"140","text-anchor":"middle",fill:"#6b7280"},Xl={class:"col-lg-4"},Hl={class:"card border-0 shadow-sm rounded-4 mb-3"},Zl={class:"card-body"},ea={class:"stack-row"},ta={class:"stack-val"},sa={class:"progress thin"},la={class:"card border-0 shadow-sm rounded-4"},aa={class:"card-body"},oa={class:"stack"},na={class:"stack-row"},ia={class:"stack-val"},da={class:"stack-row"},ua={class:"stack-val"},ra={class:"stack-row"},ca={class:"stack-val"},ma={class:"stack-row"},va={__name:"Index",setup(ya){const{formatNumber:w,formatCurrencySymbol:n,dateFmt:D}=Ae(),s=S({type:"sales",timeRange:"monthly",selectedMonth:"",selectedYear:"",selectedDate:"",selectedYear:"",dateFrom:"",dateTo:"",orderType:"",paymentType:""}),Y=S(null),ne=[{label:"PDF",value:"pdf"},{label:"Excel",value:"excel"}],ie=async m=>{m&&(m==="pdf"?he():m==="excel"&&be(),Y.value=null)},de=[{label:"Sales Analytics",value:"sales"},{label:"Purchase Analytics",value:"purchase"},{label:"Sales vs Purchase",value:"comparison"},{label:"Stock Analysis",value:"stock"},{label:"Cashier Performance",value:"userSales"},{label:"Category Analysis",value:"category"}],ue=[{label:"Daily",value:"daily"},{label:"Monthly",value:"monthly"},{label:"Yearly",value:"yearly"},{label:"Custom Range",value:"custom"}],C=S(!1),T=S(""),re=S(Date.now()),ce=`search-${Math.random().toString(36).substr(2,9)}`,me=S(!1),F=S(""),_=S({}),q=S([]),L=S([]),G=S([]),r=S({}),K=S("Just now"),X=S(0),ve=j(()=>{const m=[],t=["January","February","March","April","May","June","July","August","September","October","November","December"];for(let a=1;a<=12;a++){const l=String(a).padStart(2,"0");m.push({value:l,label:t[a-1]})}return m}),H=j(()=>{const m=new Date().getFullYear(),t=[];for(let a=m;a>=m-10;a--)t.push(a);return t}),Z=j(()=>({sales:"Sales Over Time",purchase:"Purchase Over Time",comparison:"Sales vs Purchase",stock:"Stock Trend",userSales:"Cashier Performance",category:"Category Distribution"})[s.value.type]||"Chart"),ee=j(()=>{if(s.value.timeRange==="daily")return s.value.selectedDate?`Date: ${s.value.selectedDate}`:"Select a date";if(s.value.timeRange==="monthly"){const t=["January","February","March","April","May","June","July","August","September","October","November","December"][parseInt(s.value.selectedMonth)-1]||"";return s.value.selectedMonth&&s.value.selectedYear?`${t} ${s.value.selectedYear}`:"Select month and year"}return s.value.timeRange==="yearly"?s.value.selectedYear?`Year: ${s.value.selectedYear}`:"Select a year":s.value.dateFrom&&s.value.dateTo?`${s.value.dateFrom} to ${s.value.dateTo}`:"Select dates"});function ye(m,t,a,l={l:50,r:20,t:40,b:50}){if(!m?.length)return{paths:[],xLabels:[],yLabels:[]};const b=m.map((p,f)=>f),o=m.map(p=>+p.total||+p.sales||+p.purchase||+p.value||0),g=m.map(p=>+p.purchase||0),$=0,ge=Math.max(1,b.length-1),_e=[...o,...g].filter(p=>p>0),te=0,se=Math.max(1,..._e),fe=Math.max(1,t-l.l-l.r),Q=Math.max(1,a-l.t-l.b),M=p=>l.l+(p-$)/(ge-$)*fe,V=p=>l.t+Q-(p-te)/(se-te)*Q;let E="";if(b.length===1){const p=M(0),f=V(o[0]);E=`M${p},${f} L${p+.01},${f}`}else E=b.map((p,f)=>`${f?"L":"M"}${M(p)},${V(o[f])}`).join(" ");let z="";if(g.some(p=>p>0))if(b.length===1){const p=M(0),f=V(g[0]);z=`M${p},${f} L${p+.01},${f}`}else z=b.map((p,f)=>`${f?"L":"M"}${M(p)},${V(g[f])}`).join(" ");const xe=m.map((p,f)=>{let P;if(p.date){const R=String(p.date);if(R.startsWith("Week "))P=R;else if(R.includes(":"))P=R;else if(R.length===7&&R.match(/^\d{4}-\d{2}$/)){const[U,we]=R.split("-");P=new Date(U,parseInt(we)-1,1).toLocaleDateString("en-US",{month:"short"})}else{const U=new Date(R);isNaN(U.getTime())?P=R:P=U.toLocaleDateString("en-US",{month:"short",day:"numeric"})}}else P=`Day ${f+1}`;return{x:M(f),y:l.t+Q+20,text:P}}),le=5,ae=[];for(let p=0;p<=le;p++){const f=se/le*p;ae.push({x:l.l-10,y:V(f),text:Math.round(f).toLocaleString()})}return{salesPath:E,purchasePath:z,xLabels:xe,yLabels:ae}}const A=j(()=>ye(q.value,840,280)),h=j(()=>{const m=F.value.trim().toLowerCase();return s.value.type!=="sales"?m?(L.value||[]).filter(t=>[t.name,t.cashierName,t.categoryName,t.metric].filter(Boolean).join(" ").toLowerCase().includes(m)):L.value||[]:m?(L.value||[]).filter(t=>[String(t.id),t.customer_name].filter(Boolean).join(" ").toLowerCase().includes(m)):L.value||[]}),pe=()=>{s.value.selectedMonth="",s.value.selectedYear="",s.value.selectedDate="",s.value.dateFrom="",s.value.dateTo=""},I=async()=>{if(s.value.timeRange==="daily"&&!s.value.selectedDate){T.value="Please select a date";return}if(s.value.timeRange==="monthly"&&(!s.value.selectedMonth||!s.value.selectedYear)){T.value="Please select both month and year";return}if(s.value.timeRange==="monthly"&&!s.value.selectedMonth){T.value="Please select a month";return}if(s.value.timeRange==="yearly"&&!s.value.selectedYear){T.value="Please select a year";return}if(s.value.timeRange==="custom"&&(!s.value.dateFrom||!s.value.dateTo)){T.value="Please select both start and end dates";return}C.value=!0,T.value="";try{const{data:m}=await Le.get("/api/analytics",{params:{type:s.value.type,timeRange:s.value.timeRange,selectedMonth:s.value.selectedMonth,selectedYear:s.value.selectedYear,selectedDate:s.value.selectedDate,dateFrom:s.value.dateFrom,dateTo:s.value.dateTo,orderType:s.value.orderType,paymentType:s.value.paymentType}});_.value=m.kpi||{},q.value=m.chartData||[],L.value=m.tableData||[],G.value=m.distributionData||[],r.value=m.totalsSummary||{},X.value=L.value.length,K.value=new Date().toLocaleTimeString()}catch(m){console.error(m),T.value=m.response?.data?.message||"Failed to load analytics"}finally{C.value=!1}};De(()=>[s.value.type,s.value.timeRange,s.value.selectedMonth,s.value.selectedYear,s.value.selectedDate],()=>{s.value.type&&s.value.timeRange&&(s.value.timeRange==="daily"&&s.value.selectedDate||s.value.timeRange==="monthly"&&s.value.selectedMonth&&s.value.selectedYear||s.value.timeRange==="yearly"&&s.value.selectedYear||s.value.timeRange==="custom"&&s.value.dateFrom&&s.value.dateTo)&&I()}),oe(()=>window.feather?.replace()),Te(()=>window.feather?.replace()),oe(async()=>{const m=new Date;s.value.selectedMonth=String(m.getMonth()+1).padStart(2,"0"),s.value.selectedYear=m.getFullYear(),F.value="",re.value=Date.now(),await Re(),setTimeout(()=>{me.value=!0;const t=document.getElementById(ce);t&&(t.value="",F.value="")},100)});const he=()=>{try{const m=new Me("l","mm","a4");m.setFontSize(18),m.setFont("helvetica","bold"),m.text(`${Z.value}`,14,20),m.setFontSize(10),m.setFont("helvetica","normal");const t=new Date().toLocaleString();m.text(`Generated on: ${t}`,14,28),m.text(`Period: ${ee.value}`,14,34),m.text(`Total Records: ${h.value.length}`,14,40);let a=[],l=[];if(s.value.type==="sales"){if(s.value.timeRange==="monthly"?(a=["S.#","Day","Orders","Items","Qty","Sub Total","Tax","Service","Delivery","Sales Disc.","Approved Disc.","Promo Disc.","Total"],l=h.value.map((o,g)=>[g+1,"Day "+new Date(o.order_date).getDate(),o.order_count,o.item_count,o.total_qty,n(o.sub_total),n(o.tax),n(o.service_charges),n(o.delivery_charges),n(o.sales_discount),n(o.approved_discounts),n(o.promo_discount),n(o.total_amount)])):s.value.timeRange==="yearly"?(a=["S.#","Month","Orders","Items","Qty","Sub Total","Tax","Service","Delivery","Sales Disc.","Approved Disc.","Promo Disc.","Total"],l=h.value.map((o,g)=>[g+1,new Date(o.order_month+"-01").toLocaleDateString("en-US",{month:"long",year:"numeric"}),o.order_count,o.item_count,o.total_qty,n(o.sub_total),n(o.tax),n(o.service_charges),n(o.delivery_charges),n(o.sales_discount),n(o.approved_discounts),n(o.promo_discount),n(o.total_amount)])):(a=["S.#","Order ID","Customer","Items","Qty","Sub Total","Tax","Service","Delivery","Sales Disc.","Approved Disc.","Promo Disc.","Promos","Promo Type","Total","Date"],l=h.value.map((o,g)=>[g+1,o.id,o.customer_name||"-",o.item_count,o.total_qty,n(o.sub_total),n(o.tax),n(o.service_charges),n(o.delivery_charges),n(o.sales_discount),n(o.approved_discounts),n(o.promo_discount),o.promo_names||"-",o.promo_types||"-",n(o.total_amount),D(o.order_date)])),r.value&&h.value.length>0){const o=s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?["TOTAL","-","-",r.value.item_count,r.value.total_qty,n(r.value.sub_total),n(r.value.tax),n(r.value.service_charges),n(r.value.delivery_charges),n(r.value.sales_discount),n(r.value.approved_discounts),n(r.value.promo_discount),n(r.value.total_amount)]:["TOTAL","-","-",r.value.item_count,r.value.total_qty,n(r.value.sub_total),n(r.value.tax),n(r.value.service_charges),n(r.value.delivery_charges),n(r.value.sales_discount),n(r.value.approved_discounts),n(r.value.promo_discount),"-","-",n(r.value.total_amount),"-"];l.push(o)}}else if(s.value.type==="purchase"){if(s.value.timeRange==="monthly"?(a=["S.#","Day","Purchases","Quantity","Unit Price","Sub Total","Suppliers","Total Amount"],l=h.value.map((o,g)=>[g+1,"Day "+new Date(o.purchase_date).getDate(),o.purchase_count,o.quantity,n(o.total_unit_price),n(o.sub_total),o.supplier_names||"-",n(o.total_amount)])):s.value.timeRange==="yearly"?(a=["S.#","Month","Purchases","Quantity","Unit Price","Sub Total","Suppliers","Total Amount"],l=h.value.map((o,g)=>[g+1,new Date(o.purchase_month+"-01").toLocaleDateString("en-US",{month:"long",year:"numeric"}),o.purchase_count,o.quantity,n(o.total_unit_price),n(o.sub_total),o.supplier_names||"-",n(o.total_amount)])):(a=["S.#","Purchase ID","Supplier","Product","Quantity","Unit Price","Sub Total","Expiry","Purchase Date","Status"],l=h.value.map((o,g)=>[g+1,o.purchase_id,o.supplier_name||"-",o.product_name||"-",o.quantity,n(o.unit_price),n(o.sub_total),o.expiry_date?D(o.expiry_date):"N/A",D(o.purchase_date),o.status||"-"])),r.value&&h.value.length>0){const o=s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?["TOTAL","-","-",r.value.quantity,n(r.value.total_unit_price),n(r.value.sub_total),"-",n(r.value.total_amount)]:["TOTAL","-","-","-",r.value.quantity,n(r.value.total_unit_price),n(r.value.sub_total),"-","-","-"];l.push(o)}}else s.value.type==="comparison"?(a=["S.#","Metric","Sales","Purchase","Difference"],l=h.value.map((o,g)=>[g+1,o.metric,n(o.sales),n(o.purchase),n(o.difference)])):s.value.type==="stock"?(a=["S.#","Item","Current Stock","Min Level","Status"],l=h.value.map((o,g)=>[g+1,o.name,o.currentStock,o.minLevel,o.currentStock>o.minLevel?"In Stock":o.currentStock>0?"Low Stock":"Out of Stock"])):s.value.type==="userSales"?(a=["S.#","Cashier Name","Orders","Total Sales","Avg Sale"],l=h.value.map((o,g)=>[g+1,o.cashierName,o.orderCount,n(o.totalSales),n(o.avgSale)])):s.value.type==="category"&&(a=["S.#","Category","Qty Sold","Revenue","% of Total"],l=h.value.map((o,g)=>[g+1,o.categoryName,o.qty,n(o.revenue),o.percentage+"%"]));Ve(m,{head:[a],body:l,startY:46,styles:{fontSize:7,cellPadding:2,halign:"left",lineColor:[0,0,0],lineWidth:.1},headStyles:{fillColor:[41,128,185],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]},margin:{left:14,right:14},didDrawPage:o=>{const g=m.internal.getNumberOfPages(),$=m.internal.pageSize.height;m.setFontSize(8),m.text(`Page ${o.pageNumber} of ${g}`,o.settings.margin.left,$-10)}});const b=`${s.value.type}_Analytics_${new Date().toISOString().split("T")[0]}.pdf`;m.save(b)}catch(m){console.error("PDF generation error:",m),T.value=`PDF generation failed: ${m.message}`}},be=()=>{let m=[];if(s.value.type==="sales"){if(s.value.timeRange==="monthly"?m=h.value.map((l,b)=>({"S.#":b+1,Day:"Day "+new Date(l.order_date).getDate(),Orders:l.order_count,"Item Count":l.item_count,"Total Qty":l.total_qty,"Sub Total":l.sub_total,Tax:l.tax,"Service Charge":l.service_charges,"Delivery Charge":l.delivery_charges,"Sales Discount":l.sales_discount,"Approved Discount":l.approved_discounts,"Promo Discount":l.promo_discount,"Total Amount":l.total_amount})):s.value.timeRange==="yearly"?m=h.value.map((l,b)=>({"S.#":b+1,Month:new Date(l.order_month+"-01").toLocaleDateString("en-US",{month:"long",year:"numeric"}),Orders:l.order_count,"Item Count":l.item_count,"Total Qty":l.total_qty,"Sub Total":l.sub_total,Tax:l.tax,"Service Charge":l.service_charges,"Delivery Charge":l.delivery_charges,"Sales Discount":l.sales_discount,"Approved Discount":l.approved_discounts,"Promo Discount":l.promo_discount,"Total Amount":l.total_amount})):m=h.value.map((l,b)=>({"S.#":b+1,"Order ID":l.id,"Customer Name":l.customer_name,"Item Count":l.item_count,"Total Qty":l.total_qty,"Sub Total":l.sub_total,Tax:l.tax,"Service Charge":l.service_charges,"Delivery Charge":l.delivery_charges,"Sales Discount":l.sales_discount,"Approved Discount":l.approved_discounts,"Promo Discount":l.promo_discount,"Applied Promos":l.promo_names,"Promo Type":l.promo_types,"Total Amount":l.total_amount,Date:D(l.order_date)})),r.value){const l=s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?{"S.#":"TOTAL",[s.value.timeRange==="monthly"?"Day":"Month"]:"-",Orders:"-","Item Count":r.value.item_count,"Total Qty":r.value.total_qty,"Sub Total":r.value.sub_total,Tax:r.value.tax,"Service Charge":r.value.service_charges,"Delivery Charge":r.value.delivery_charges,"Sales Discount":r.value.sales_discount,"Approved Discount":r.value.approved_discounts,"Promo Discount":r.value.promo_discount,"Total Amount":r.value.total_amount}:{"S.#":"TOTAL","Order ID":"-","Customer Name":"-","Item Count":r.value.item_count,"Total Qty":r.value.total_qty,"Sub Total":r.value.sub_total,Tax:r.value.tax,"Service Charge":r.value.service_charges,"Delivery Charge":r.value.delivery_charges,"Sales Discount":r.value.sales_discount,"Approved Discount":r.value.approved_discounts,"Promo Discount":r.value.promo_discount,"Applied Promos":"-","Promo Type":"-","Total Amount":r.value.total_amount,Date:"-"};m.push(l)}}else if(s.value.type==="purchase"){if(s.value.timeRange==="monthly"?m=h.value.map((l,b)=>({"S.#":b+1,Day:"Day "+new Date(l.purchase_date).getDate(),Purchases:l.purchase_count,Quantity:l.quantity,"Unit Price":l.total_unit_price,"Sub Total":l.sub_total,Suppliers:l.supplier_names,"Total Amount":l.total_amount})):s.value.timeRange==="yearly"?m=h.value.map((l,b)=>({"S.#":b+1,Month:new Date(l.purchase_month+"-01").toLocaleDateString("en-US",{month:"long",year:"numeric"}),Purchases:l.purchase_count,Quantity:l.quantity,"Unit Price":l.total_unit_price,"Sub Total":l.sub_total,Suppliers:l.supplier_names,"Total Amount":l.total_amount})):m=h.value.map((l,b)=>({"S.#":b+1,"Purchase ID":l.purchase_id,"Supplier Name":l.supplier_name,"Product Name":l.product_name,Quantity:l.quantity,"Unit Price":l.unit_price,"Sub Total":l.sub_total,"Expiry Date":l.expiry_date?D(l.expiry_date):"N/A","Purchase Date":D(l.purchase_date),Status:l.status})),r.value){const l=s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?{"S.#":"TOTAL",[s.value.timeRange==="monthly"?"Day":"Month"]:"-",Purchases:"-",Quantity:r.value.quantity,"Unit Price":r.value.total_unit_price,"Sub Total":r.value.sub_total,Suppliers:"-","Total Amount":r.value.total_amount}:{"S.#":"TOTAL","Purchase ID":"-","Supplier Name":"-","Product Name":"-",Quantity:r.value.quantity,"Unit Price":r.value.total_unit_price,"Sub Total":r.value.sub_total,"Expiry Date":"-","Purchase Date":"-",Status:"-"};m.push(l)}}else s.value.type==="comparison"?m=h.value.map((l,b)=>({"S.#":b+1,Metric:l.metric,Sales:l.sales,Purchase:l.purchase,Difference:l.difference})):s.value.type==="stock"?m=h.value.map((l,b)=>({"S.#":b+1,Item:l.name,"Current Stock":l.currentStock,"Min Level":l.minLevel,Status:l.currentStock>l.minLevel?"In Stock":l.currentStock>0?"Low Stock":"Out of Stock"})):s.value.type==="userSales"?m=h.value.map((l,b)=>({"S.#":b+1,"Cashier Name":l.cashierName,Orders:l.orderCount,"Total Sales":l.totalSales,"Avg Sale":l.avgSale})):s.value.type==="category"&&(m=h.value.map((l,b)=>({"S.#":b+1,Category:l.categoryName,"Qty Sold":l.qty,Revenue:l.revenue,"% of Total":l.percentage+"%"})));const t=W.json_to_sheet(m),a=W.book_new();W.book_append_sheet(a,t,s.value.type),Oe(a,`${s.value.type}-analytics-${Date.now()}.xlsx`)};return(m,t)=>(u(),d(y,null,[k(c(Pe),{title:"Analytics"}),k(Se,null,{default:Ce(()=>[e("div",Ne,[e("div",Ie,[t[9]||(t[9]=e("h4",{class:"mb-1"},"Analytics & Reports",-1)),t[10]||(t[10]=e("div",null,null,-1)),k(c(je),{modelValue:Y.value,"onUpdate:modelValue":[t[0]||(t[0]=a=>Y.value=a),ie],options:ne,optionLabel:"label",optionValue:"value",placeholder:"Export",class:"export-select"},null,8,["modelValue"])]),e("div",$e,[e("div",Ue,[e("div",Ye,[e("div",Fe,[t[11]||(t[11]=e("label",{class:"form-label fw-semibold text-dark"},[e("i",{class:"fas fa-chart-bar me-2 text-muted"}),x("Analytics Type ")],-1)),k(c(N),{modelValue:s.value.type,"onUpdate:modelValue":t[1]||(t[1]=a=>s.value.type=a),options:de,optionLabel:"label",optionValue:"value",placeholder:"Select Analytics Type",class:"w-100"},null,8,["modelValue"])]),e("div",qe,[t[12]||(t[12]=e("label",{class:"form-label fw-semibold text-dark"},[e("i",{class:"fas fa-calendar-alt me-2 text-muted"}),x("Time Range ")],-1)),k(c(N),{modelValue:s.value.timeRange,"onUpdate:modelValue":t[2]||(t[2]=a=>s.value.timeRange=a),options:ue,optionLabel:"label",optionValue:"value",placeholder:"Select Time Range",onChange:pe,class:"w-100"},null,8,["modelValue"])]),s.value.timeRange==="daily"?(u(),d("div",Qe,[t[13]||(t[13]=e("label",{class:"form-label fw-semibold text-dark"},[e("i",{class:"fas fa-calendar me-2 text-muted"}),x("Select Date ")],-1)),k(c(J),{modelValue:s.value.selectedDate,"onUpdate:modelValue":t[3]||(t[3]=a=>s.value.selectedDate=a),placeholder:"Choose Date",format:"yyyy-MM-dd","enable-time-picker":!1,"single-calendar":""},null,8,["modelValue"])])):v("",!0),s.value.timeRange==="monthly"?(u(),d("div",Ee,[t[14]||(t[14]=e("label",{class:"form-label fw-semibold text-dark"},[e("i",{class:"fas fa-calendar me-2 text-muted"}),x("Select Month ")],-1)),k(c(N),{modelValue:s.value.selectedMonth,"onUpdate:modelValue":t[4]||(t[4]=a=>s.value.selectedMonth=a),options:ve.value,optionLabel:"label",optionValue:"value",placeholder:"Choose Month",class:"w-100"},null,8,["modelValue","options"])])):v("",!0),s.value.timeRange==="monthly"?(u(),d("div",ze,[t[15]||(t[15]=e("label",{class:"form-label fw-semibold text-dark"},[e("i",{class:"fas fa-calendar me-2 text-muted"}),x("Select Year ")],-1)),k(c(N),{modelValue:s.value.selectedYear,"onUpdate:modelValue":t[5]||(t[5]=a=>s.value.selectedYear=a),options:H.value,placeholder:"Choose Year",class:"w-100"},null,8,["modelValue","options"])])):v("",!0),s.value.timeRange==="yearly"?(u(),d("div",Je,[t[16]||(t[16]=e("label",{class:"form-label fw-semibold text-dark"},[e("i",{class:"fas fa-calendar me-2 text-muted"}),x("Select Year ")],-1)),k(c(N),{modelValue:s.value.selectedYear,"onUpdate:modelValue":t[6]||(t[6]=a=>s.value.selectedYear=a),options:H.value,placeholder:"Choose Year",class:"w-100"},null,8,["modelValue","options"])])):v("",!0),s.value.timeRange==="custom"?(u(),d("div",Be,[t[17]||(t[17]=e("label",{class:"form-label fw-semibold text-dark"},[e("i",{class:"fas fa-calendar me-2 text-muted"}),x("Start Date ")],-1)),k(c(J),{modelValue:s.value.dateFrom,"onUpdate:modelValue":t[7]||(t[7]=a=>s.value.dateFrom=a),placeholder:"Select Start Date",format:"yyyy-MM-dd"},null,8,["modelValue"])])):v("",!0),s.value.timeRange==="custom"?(u(),d("div",We,[t[18]||(t[18]=e("label",{class:"form-label fw-semibold text-dark"},[e("i",{class:"fas fa-calendar me-2 text-muted"}),x("End Date ")],-1)),k(c(J),{modelValue:s.value.dateTo,"onUpdate:modelValue":t[8]||(t[8]=a=>s.value.dateTo=a),placeholder:"Select End Date",format:"yyyy-MM-dd"},null,8,["modelValue"])])):v("",!0)])])]),e("div",Ge,[s.value.type==="sales"?(u(),d(y,{key:0},[e("div",Ke,[e("div",Xe,[e("div",He,[e("div",null,[e("h4",Ze,i(c(n)(_.value.revenue||0)),1),t[19]||(t[19]=e("p",{class:"text-muted mb-0 small"},"Total Revenue",-1))]),t[20]||(t[20]=e("div",{class:"rounded-circle p-3 bg-success-subtle text-success d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-currency-pound fs-4"})],-1))])])]),e("div",et,[e("div",tt,[e("div",st,[e("div",null,[e("h4",lt,i(c(w)(_.value.ordersCount)),1),t[21]||(t[21]=e("p",{class:"text-muted mb-0 small"},"Total Orders",-1))]),t[22]||(t[22]=e("div",{class:"rounded-circle p-3 bg-primary-subtle text-primary d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-receipt fs-4"})],-1))])])]),e("div",at,[e("div",ot,[e("div",nt,[e("div",null,[e("h4",it,i(c(n)(_.value.aov||0)),1),t[23]||(t[23]=e("p",{class:"text-muted mb-0 small"},"Avg. Order Value",-1))]),t[24]||(t[24]=e("div",{class:"rounded-circle p-3 bg-warning-subtle text-warning d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-graph-up fs-4"})],-1))])])]),e("div",dt,[e("div",ut,[e("div",rt,[e("div",null,[e("h4",ct,i(c(w)(_.value.itemsSold)),1),t[25]||(t[25]=e("p",{class:"text-muted mb-0 small"},"Items Sold",-1))]),t[26]||(t[26]=e("div",{class:"rounded-circle p-3 bg-danger-subtle text-danger d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-basket fs-4"})],-1))])])])],64)):v("",!0),s.value.type==="purchase"?(u(),d(y,{key:1},[e("div",mt,[e("div",vt,[e("div",yt,[e("div",null,[e("h4",pt,i(c(n)(_.value.purchaseCost||0)),1),t[27]||(t[27]=e("p",{class:"text-muted mb-0 small"},"Total Purchase Cost",-1))]),t[28]||(t[28]=e("div",{class:"rounded-circle p-3 bg-info-subtle text-info d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-bag-check fs-4"})],-1))])])]),e("div",ht,[e("div",bt,[e("div",gt,[e("div",null,[e("h4",_t,i(c(w)(_.value.purchaseCount)),1),t[29]||(t[29]=e("p",{class:"text-muted mb-0 small"},"Total Purchases",-1))]),t[30]||(t[30]=e("div",{class:"rounded-circle p-3 bg-primary-subtle text-primary d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-box-seam fs-4"})],-1))])])]),e("div",ft,[e("div",xt,[e("div",wt,[e("div",null,[e("h4",St,i(c(n)(_.value.avgPurchaseValue||0)),1),t[31]||(t[31]=e("p",{class:"text-muted mb-0 small"},"Avg. Purchase Value",-1))]),t[32]||(t[32]=e("div",{class:"rounded-circle p-3 bg-warning-subtle text-warning d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-graph-up fs-4"})],-1))])])]),e("div",kt,[e("div",Dt,[e("div",Tt,[e("div",null,[e("h4",Rt,i(c(w)(_.value.itemsPurchased)),1),t[33]||(t[33]=e("p",{class:"text-muted mb-0 small"},"Items Purchased",-1))]),t[34]||(t[34]=e("div",{class:"rounded-circle p-3 bg-secondary-subtle text-secondary d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-boxes fs-4"})],-1))])])])],64)):v("",!0),s.value.type==="comparison"?(u(),d(y,{key:2},[e("div",Pt,[e("div",Ct,[e("div",Lt,[e("div",null,[e("h4",At,i(c(n)(_.value.salesRevenue)),1),t[35]||(t[35]=e("p",{class:"text-muted mb-0 small"},"Sales Revenue",-1))]),t[36]||(t[36]=e("div",{class:"rounded-circle p-3 bg-success-subtle text-success d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-arrow-up-right fs-4"})],-1))])])]),e("div",jt,[e("div",Mt,[e("div",Vt,[e("div",null,[e("h4",Ot,i(c(n)(_.value.purchaseCost)),1),t[37]||(t[37]=e("p",{class:"text-muted mb-0 small"},"Purchase Cost",-1))]),t[38]||(t[38]=e("div",{class:"rounded-circle p-3 bg-danger-subtle text-danger d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-arrow-down-left fs-4"})],-1))])])]),e("div",Nt,[e("div",It,[e("div",$t,[e("div",null,[e("h4",Ut,i(c(n)(_.value.grossProfit)),1),t[39]||(t[39]=e("p",{class:"text-muted mb-0 small"},"Gross Profit",-1))]),t[40]||(t[40]=e("div",{class:"rounded-circle p-3 bg-primary-subtle text-primary d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-graph-up fs-4"})],-1))])])]),e("div",Yt,[e("div",Ft,[e("div",qt,[e("div",null,[e("h4",Qt,i(_.value.profitMargin)+"%",1),t[41]||(t[41]=e("p",{class:"text-muted mb-0 small"},"Profit Margin",-1))]),t[42]||(t[42]=e("div",{class:"rounded-circle p-3 bg-info-subtle text-info d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-percent fs-4"})],-1))])])])],64)):v("",!0),s.value.type==="stock"?(u(),d(y,{key:3},[e("div",Et,[e("div",zt,[e("div",Jt,[e("div",null,[e("h4",Bt,i(c(w)(_.value.totalStock)),1),t[43]||(t[43]=e("p",{class:"text-muted mb-0 small"},"Total Items in Stock",-1))]),t[44]||(t[44]=e("div",{class:"rounded-circle p-3 bg-info-subtle text-info d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-box-seam fs-4"})],-1))])])]),e("div",Wt,[e("div",Gt,[e("div",Kt,[e("div",null,[e("h4",Xt,i(c(w)(_.value.lowStockItems)),1),t[45]||(t[45]=e("p",{class:"text-muted mb-0 small"},"Low Stock Items",-1))]),t[46]||(t[46]=e("div",{class:"rounded-circle p-3 bg-warning-subtle text-warning d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-exclamation-triangle fs-4"})],-1))])])]),e("div",Ht,[e("div",Zt,[e("div",es,[e("div",null,[e("h4",ts,i(c(w)(_.value.outOfStockItems)),1),t[47]||(t[47]=e("p",{class:"text-muted mb-0 small"},"Out of Stock",-1))]),t[48]||(t[48]=e("div",{class:"rounded-circle p-3 bg-danger-subtle text-danger d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-x-circle fs-4"})],-1))])])]),e("div",ss,[e("div",ls,[e("div",as,[e("div",null,[e("h4",os,i(c(n)(_.value.stockValue)),1),t[49]||(t[49]=e("p",{class:"text-muted mb-0 small"},"Total Stock Value",-1))]),t[50]||(t[50]=e("div",{class:"rounded-circle p-3 bg-success-subtle text-success d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-cash-coin fs-4"})],-1))])])])],64)):v("",!0),s.value.type==="userSales"?(u(),d(y,{key:4},[e("div",ns,[e("div",is,[e("div",ds,[e("div",null,[e("h4",us,i(c(n)(_.value.totalUserSales)),1),t[51]||(t[51]=e("p",{class:"text-muted mb-0 small"},"Total Sales",-1))]),t[52]||(t[52]=e("div",{class:"rounded-circle p-3 bg-success-subtle text-success d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-currency-pound fs-4"})],-1))])])]),e("div",rs,[e("div",cs,[e("div",ms,[e("div",null,[e("h4",vs,i(c(n)(_.value.avgCashierSales)),1),t[53]||(t[53]=e("p",{class:"text-muted mb-0 small"},"Avg. per Cashier",-1))]),t[54]||(t[54]=e("div",{class:"rounded-circle p-3 bg-primary-subtle text-primary d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-person-check fs-4"})],-1))])])]),e("div",ys,[e("div",ps,[e("div",hs,[e("div",null,[e("h4",bs,i(c(w)(_.value.activeCashiers)),1),t[55]||(t[55]=e("p",{class:"text-muted mb-0 small"},"Active Cashiers",-1))]),t[56]||(t[56]=e("div",{class:"rounded-circle p-3 bg-info-subtle text-info d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-people fs-4"})],-1))])])]),e("div",gs,[e("div",_s,[e("div",fs,[e("div",null,[e("h4",xs,i(c(n)(_.value.topCashierSales)),1),t[57]||(t[57]=e("p",{class:"text-muted mb-0 small"},"Top Cashier Sales",-1))]),t[58]||(t[58]=e("div",{class:"rounded-circle p-3 bg-warning-subtle text-warning d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-star fs-4"})],-1))])])])],64)):v("",!0),s.value.type==="category"?(u(),d(y,{key:5},[e("div",ws,[e("div",Ss,[e("div",ks,[e("div",null,[e("h4",Ds,i(c(w)(_.value.totalCategories)),1),t[59]||(t[59]=e("p",{class:"text-muted mb-0 small"},"Total Categories",-1))]),t[60]||(t[60]=e("div",{class:"rounded-circle p-3 bg-info-subtle text-info d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-tag fs-4"})],-1))])])]),e("div",Ts,[e("div",Rs,[e("div",Ps,[e("div",null,[e("h4",Cs,i(c(n)(_.value.categoryRevenue)),1),t[61]||(t[61]=e("p",{class:"text-muted mb-0 small"},"Total Revenue",-1))]),t[62]||(t[62]=e("div",{class:"rounded-circle p-3 bg-success-subtle text-success d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-currency-pound fs-4"})],-1))])])]),e("div",Ls,[e("div",As,[e("div",js,[e("div",null,[e("h4",Ms,i(_.value.topCategory),1),t[63]||(t[63]=e("p",{class:"text-muted mb-0 small"},"Top Category",-1))]),t[64]||(t[64]=e("div",{class:"rounded-circle p-3 bg-primary-subtle text-primary d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-trophy fs-4"})],-1))])])]),e("div",Vs,[e("div",Os,[e("div",Ns,[e("div",null,[e("h4",Is,i(c(w)(_.value.totalCategorySales)),1),t[65]||(t[65]=e("p",{class:"text-muted mb-0 small"},"Total Items Sold",-1))]),t[66]||(t[66]=e("div",{class:"rounded-circle p-3 bg-warning-subtle text-warning d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-bag-check fs-4"})],-1))])])])],64)):v("",!0)]),T.value?(u(),d("div",$s,i(T.value),1)):v("",!0),e("div",Us,[e("div",Ys,[t[106]||(t[106]=e("div",{class:"d-flex flex-wrap gap-2 justify-content-between align-items-center mb-3"},[e("h6",{class:"fw-semibold mb-0"},"Detailed Data")],-1)),e("div",Fs,[e("table",qs,[e("thead",Qs,[e("tr",null,[t[95]||(t[95]=e("th",{style:{width:"60px"}},"S.#",-1)),s.value.type==="sales"?(u(),d(y,{key:0},[s.value.timeRange==="monthly"?(u(),d("th",Es,"Day")):s.value.timeRange==="yearly"?(u(),d("th",zs,"Month")):(u(),d("th",Js,"Order ID")),s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?(u(),d("th",Bs," Orders")):(u(),d("th",Ws,"Customer Name")),t[67]||(t[67]=e("th",{style:{width:"120px"}},"Sub Total",-1)),t[68]||(t[68]=e("th",{style:{width:"120px"}},"Tax",-1)),t[69]||(t[69]=e("th",{style:{width:"120px"}},"Service Charge",-1)),t[70]||(t[70]=e("th",{style:{width:"120px"}},"Delivery Charge",-1)),t[71]||(t[71]=e("th",{style:{width:"120px"}},"Sale Discount",-1)),t[72]||(t[72]=e("th",{style:{width:"120px"}},"Approved Discount",-1)),t[73]||(t[73]=e("th",{style:{width:"140px"}},"Promo Discount",-1)),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("th",Gs,"Applied Promos")):v("",!0),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("th",Ks,"Promo Type")):v("",!0),t[74]||(t[74]=e("th",{style:{width:"140px"}},"Total Amount",-1)),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("th",Xs,"Date")):v("",!0)],64)):v("",!0),s.value.type==="purchase"?(u(),d(y,{key:1},[s.value.timeRange==="monthly"?(u(),d("th",Hs,"Day")):s.value.timeRange==="yearly"?(u(),d("th",Zs,"Month")):(u(),d("th",el,"Purchase ID")),s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?(u(),d("th",tl," Purchases")):(u(),d("th",sl,"Supplier Name")),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("th",ll,"Product Name")):v("",!0),t[75]||(t[75]=e("th",{style:{width:"100px"}},"Quantity",-1)),t[76]||(t[76]=e("th",{style:{width:"120px"}},"Unit Price",-1)),t[77]||(t[77]=e("th",{style:{width:"140px"}},"Sub Total",-1)),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("th",al,"Expiry Date")):v("",!0),s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?(u(),d("th",ol,"Suppliers")):v("",!0),t[78]||(t[78]=e("th",{style:{width:"140px"}},"Total Amount",-1)),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("th",nl,"Purchase Date")):v("",!0),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("th",il,"Status")):v("",!0)],64)):v("",!0),s.value.type==="comparison"?(u(),d(y,{key:2},[t[79]||(t[79]=e("th",null,"Metric",-1)),t[80]||(t[80]=e("th",{style:{width:"140px"}},"Sales",-1)),t[81]||(t[81]=e("th",{style:{width:"140px"}},"Purchase",-1)),t[82]||(t[82]=e("th",{style:{width:"140px"}},"Difference",-1))],64)):v("",!0),s.value.type==="stock"?(u(),d(y,{key:3},[t[83]||(t[83]=e("th",null,"Item",-1)),t[84]||(t[84]=e("th",{style:{width:"100px"}},"Stock",-1)),t[85]||(t[85]=e("th",{style:{width:"100px"}},"Min Level",-1)),t[86]||(t[86]=e("th",{style:{width:"120px"}},"Status",-1))],64)):v("",!0),s.value.type==="userSales"?(u(),d(y,{key:4},[t[87]||(t[87]=e("th",null,"Cashier Name",-1)),t[88]||(t[88]=e("th",{style:{width:"120px"}},"Orders",-1)),t[89]||(t[89]=e("th",{style:{width:"140px"}},"Total Sales",-1)),t[90]||(t[90]=e("th",{style:{width:"120px"}},"Avg Sale",-1))],64)):v("",!0),s.value.type==="category"?(u(),d(y,{key:5},[t[91]||(t[91]=e("th",null,"Category",-1)),t[92]||(t[92]=e("th",{style:{width:"120px"}},"Qty Sold",-1)),t[93]||(t[93]=e("th",{style:{width:"140px"}},"Revenue",-1)),t[94]||(t[94]=e("th",{style:{width:"100px"}},"% of Total",-1))],64)):v("",!0)])]),e("tbody",null,[(u(!0),d(y,null,O(h.value,(a,l)=>(u(),d("tr",{key:l},[e("td",null,i(l+1),1),s.value.type==="sales"?(u(),d(y,{key:0},[e("td",dl,[s.value.timeRange==="monthly"?(u(),d(y,{key:0},[x(i(new Date(a.order_date).toLocaleString("en-US",{month:"short"})+" "+String(new Date(a.order_date).getDate()).padStart(2,"0")),1)],64)):s.value.timeRange==="yearly"?(u(),d(y,{key:1},[x(i(new Date(a.order_month+"-01").toLocaleDateString("en-US",{month:"long",year:"numeric"})),1)],64)):(u(),d(y,{key:2},[x(i(a.id),1)],64))]),e("td",null,[s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?(u(),d(y,{key:0},[x(i(a.order_count)+" Orders ",1)],64)):(u(),d(y,{key:1},[x(i(a.customer_name),1)],64))]),e("td",null,i(c(n)(a.sub_total)),1),e("td",null,i(c(n)(a.tax)),1),e("td",null,i(c(n)(a.service_charges)),1),e("td",null,i(c(n)(a.delivery_charges)),1),e("td",null,i(c(n)(a.sales_discount)),1),e("td",null,i(c(n)(a.approved_discounts)),1),e("td",null,i(c(n)(a.promo_discount)),1),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("td",ul,i(a.promo_names),1)):v("",!0),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("td",rl,i(a.promo_types),1)):v("",!0),e("td",cl,i(c(n)(a.total_amount)),1),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("td",ml,i(c(D)(a.order_date)),1)):v("",!0)],64)):v("",!0),s.value.type==="purchase"?(u(),d(y,{key:1},[e("td",vl,[s.value.timeRange==="monthly"?(u(),d(y,{key:0},[x(i(new Date(a.purchase_date).toLocaleString("en-US",{month:"short"})+" "+String(new Date(a.purchase_date).getDate()).padStart(2,"0")),1)],64)):s.value.timeRange==="yearly"?(u(),d(y,{key:1},[x(i(new Date(a.purchase_month+"-01").toLocaleDateString("en-US",{month:"long",year:"numeric"})),1)],64)):(u(),d(y,{key:2},[x(i(a.purchase_id),1)],64))]),e("td",null,[s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?(u(),d(y,{key:0},[x(i(a.purchase_count)+" Purchases ",1)],64)):(u(),d(y,{key:1},[x(i(a.supplier_name),1)],64))]),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("td",yl,i(a.product_name),1)):v("",!0),e("td",null,i(c(w)(a.quantity)),1),e("td",null,i(c(n)(a.total_unit_price)),1),e("td",null,i(c(n)(a.sub_total)),1),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("td",pl,[a.expiry_date?(u(),d("span",hl,i(c(D)(a.expiry_date)),1)):(u(),d("span",bl,"N/A"))])):v("",!0),s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?(u(),d("td",gl,i(a.supplier_names),1)):v("",!0),e("td",_l,i(c(n)(a.total_amount)),1),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("td",fl,i(c(D)(a.purchase_date)),1)):v("",!0),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("td",xl,[a.status==="completed"?(u(),d("span",wl," Completed ")):a.status==="pending"?(u(),d("span",Sl," Pending ")):(u(),d("span",kl,i(a.status),1))])):v("",!0)],64)):v("",!0),s.value.type==="comparison"?(u(),d(y,{key:2},[e("td",Dl,i(a.metric),1),e("td",null,i(c(n)(a.sales)),1),e("td",null,i(c(n)(a.purchase)),1),e("td",{style:B({color:a.difference>0?"#10b981":"#ef4444"}),class:"fw-semibold"},i(c(n)(a.difference)),5)],64)):v("",!0),s.value.type==="stock"?(u(),d(y,{key:3},[e("td",Tl,i(a.name),1),e("td",null,i(c(w)(a.currentStock)),1),e("td",null,i(c(w)(a.minLevel)),1),e("td",null,[a.currentStock>a.minLevel?(u(),d("span",Rl," In Stock ")):a.currentStock>0?(u(),d("span",Pl," Low Stock ")):(u(),d("span",Cl," Out of Stock "))])],64)):v("",!0),s.value.type==="userSales"?(u(),d(y,{key:4},[e("td",Ll,i(a.cashierName),1),e("td",null,i(c(w)(a.orderCount)),1),e("td",null,i(c(n)(a.totalSales)),1),e("td",null,i(c(n)(a.avgSale)),1)],64)):v("",!0),s.value.type==="category"?(u(),d(y,{key:5},[e("td",Al,i(a.categoryName),1),e("td",null,i(c(w)(a.qty)),1),e("td",null,i(c(n)(a.revenue)),1),e("td",null,i(a.percentage)+"%",1)],64)):v("",!0)]))),128)),s.value.type==="sales"&&h.value.length>0?(u(),d("tr",jl,[t[96]||(t[96]=e("td",{colspan:"0",class:"text-end"},"TOTALS",-1)),t[97]||(t[97]=e("td",{colspan:"0"},"-",-1)),t[98]||(t[98]=e("td",{colspan:"0"},"-",-1)),e("td",null,i(c(n)(r.value.sub_total)),1),e("td",null,i(c(n)(r.value.tax)),1),e("td",null,i(c(n)(r.value.service_charges)),1),e("td",null,i(c(n)(r.value.delivery_charges)),1),e("td",null,i(c(n)(r.value.sales_discount+r.value.approved_discounts)),1),e("td",null,i(c(n)(r.value.approved_discounts)),1),e("td",null,i(c(n)(r.value.promo_discount)),1),e("td",Ml,i(c(n)(r.value.total_amount)),1),t[99]||(t[99]=e("td",null,null,-1))])):v("",!0),s.value.type==="purchase"&&h.value.length>0?(u(),d("tr",Vl,[t[100]||(t[100]=e("td",{colspan:"0"},"TOTALS",-1)),t[101]||(t[101]=e("td",null,"-",-1)),t[102]||(t[102]=e("td",null,"-",-1)),e("td",null,i(c(w)(r.value.quantity)),1),e("td",null,i(c(n)(r.value.total_unit_price)),1),e("td",null,i(c(n)(r.value.sub_total)),1),t[103]||(t[103]=e("td",{colspan:"3"},null,-1))])):v("",!0),!C.value&&h.value.length===0?(u(),d("tr",Ol,[...t[104]||(t[104]=[e("td",{colspan:16,class:"text-center text-muted py-4"}," No data available for this period. ",-1)])])):v("",!0),C.value?(u(),d("tr",Nl,[...t[105]||(t[105]=[e("td",{colspan:5,class:"text-center text-muted py-4"},[e("i",{class:"fas fa-spinner fa-spin me-2"}),x("Loadingâ€¦ ")],-1)])])):v("",!0)])])])])]),e("div",Il,[e("div",$l,[e("div",Ul,[e("div",Yl,[e("h6",Fl,i(Z.value),1),e("div",ql,[(u(),d("svg",Ql,[t[108]||(t[108]=e("line",{x1:"50",y1:"40",x2:"50",y2:"230",stroke:"#4b5563","stroke-width":"1"},null,-1)),t[109]||(t[109]=e("line",{x1:"50",y1:"230",x2:"820",y2:"230",stroke:"#4b5563","stroke-width":"1"},null,-1)),(u(),d(y,null,O(5,a=>e("g",{key:"grid"+a},[e("line",{x1:50,x2:820,y1:230-a*38,y2:230-a*38,stroke:"#374151","stroke-width":"0.5",opacity:"0.3"},null,8,El)])),64)),(u(!0),d(y,null,O(A.value.yLabels,(a,l)=>(u(),d("text",{key:"ylabel"+l,x:a.x,y:a.y+5,"text-anchor":"end",fill:"#9ca3af","font-size":"11"},i(a.text),9,zl))),128)),(u(!0),d(y,null,O(A.value.xLabels,(a,l)=>(u(),d("text",{key:"xlabel"+l,x:a.x,y:a.y,"text-anchor":"middle",fill:"#9ca3af","font-size":"11"},i(a.text),9,Jl))),128)),A.value.salesPath?(u(),d("path",{key:0,d:A.value.salesPath,fill:"none",stroke:"#10b981","stroke-width":"3","stroke-linecap":"round"},null,8,Bl)):v("",!0),s.value.type==="comparison"&&A.value.purchasePath?(u(),d("path",{key:1,d:A.value.purchasePath,fill:"none",stroke:"#ef4444","stroke-width":"3","stroke-linecap":"round"},null,8,Wl)):v("",!0),s.value.type==="comparison"?(u(),d("g",Gl,[...t[107]||(t[107]=[e("circle",{cx:"750",cy:"20",r:"5",fill:"#10b981"},null,-1),e("text",{x:"760",y:"25",fill:"#9ca3af","font-size":"12"},"Sales",-1),e("circle",{cx:"820",cy:"20",r:"5",fill:"#ef4444"},null,-1),e("text",{x:"830",y:"25",fill:"#9ca3af","font-size":"12"},"Purchase",-1)])])):v("",!0),q.value.length?v("",!0):(u(),d("text",Kl," No data available "))]))])])])]),e("div",Xl,[e("div",Hl,[e("div",Zl,[t[110]||(t[110]=e("h6",{class:"fw-semibold mb-3"},"Distribution",-1)),(u(!0),d(y,null,O(G.value,a=>(u(),d("div",{key:a.label,class:"stack"},[e("div",ea,[e("span",null,i(a.label),1),e("span",ta,i(a.value)+" ("+i(a.percentage)+"%)",1)]),e("div",sa,[e("div",{class:"progress-bar",style:B({width:a.percentage+"%",backgroundColor:a.color})},null,4)])]))),128))])]),e("div",la,[e("div",aa,[t[115]||(t[115]=e("h6",{class:"fw-semibold mb-3"},"Summary Info",-1)),e("div",oa,[e("div",na,[t[111]||(t[111]=e("span",null,"Period",-1)),e("span",ia,i(c(D)(ee.value)),1)]),e("div",da,[t[112]||(t[112]=e("span",null,"Data Points",-1)),e("span",ua,i(X.value),1)]),e("div",ra,[t[113]||(t[113]=e("span",null,"Last Updated",-1)),e("span",ca,i(K.value),1)]),e("div",ma,[t[114]||(t[114]=e("span",null,"Status",-1)),e("span",{class:"stack-val",style:B({color:C.value?"#f59e0b":"#10b981"})},i(C.value?"Loading...":"Active"),5)])])])])])])])]),_:1})],64))}},Aa=ke(va,[["__scopeId","data-v-1c29fa85"]]);export{Aa as default};
