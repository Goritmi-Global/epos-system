import{_ as tl,r as g,c as q,o as Oe,n as ll,I as al,y as pt,E as sl,a as Ne,b as r,w as Ee,d as x,e as t,u as w,h as ol,f as u,m as f,F as L,g as Z,t as p,i as h,j as nl,k as $,v as O,l as z,W as Be,T as il,Y as be,X as mt,ad as vt,K as rl,q as _,b4 as dl}from"./app-BHYyRJnL.js";import{_ as ul}from"./Master-CXzRQq-r.js";import{s as W}from"./index-CmEobXQy.js";import{s as fe}from"./index-bHJi427f.js";import{E as gt,a as bt,X as cl,u as Ce,w as pl}from"./xlsx-CpHCO-2F.js";import{u as ml}from"./useFormatters-wi1aVjp-.js";import{F as vl}from"./FilterModal-D0LkefGG.js";import{I as gl}from"./importFile-YYl72liC.js";import{P as bl}from"./package-Ly2dV6B8.js";import{C as fl}from"./circle-check-big-D0fL37vY.js";import{C as ft}from"./circle-x-Cr4_Uh6n.js";import{P as _t}from"./plus-DcH1IPmd.js";import{P as yt}from"./pencil-AO5bMxrJ.js";import"./index-B0N7947y.js";import"./createLucideIcon-DmJxs4Lg.js";import"./index-CpMR2yR9.js";import"./index-Bs9GfHmp.js";import"./sun-soDtTQcu.js";import"./index-ZEA6XP_E.js";import"./index-uhINJth7.js";import"./index-Cdn4Pgih.js";const _l={class:"page-wrapper"},yl={class:"row g-3"},hl={class:"card border-0 shadow-sm rounded-4"},xl={class:"card-body d-flex align-items-center justify-content-between"},wl={class:"fw-bold fs-4"},kl={class:"text-muted fs-6"},Cl={class:"card border-0 shadow-lg rounded-4 mt-0"},Sl={class:"card-body"},Ml={class:"d-flex flex-wrap gap-2 justify-content-between align-items-center mb-3"},Vl={class:"d-flex flex-wrap gap-2 align-items-center"},$l={class:"search-wrap"},Il={key:1,class:"form-control search-input",placeholder:"Search",disabled:"",type:"text"},Fl={class:"dropdown"},Al={class:"dropdown"},Nl={class:"dropdown-menu dropdown-menu-end shadow rounded-4 py-2"},El={class:"table-responsive"},Tl={class:"table table-hover"},Ul={key:0},Pl={class:"fw-semibold"},Ll={class:"text-truncate",style:{"max-width":"260px"}},jl={key:0,class:"badge bg-red-600 rounded-pill d-inline-block text-center px-3 py-1"},Dl={key:1,class:"badge bg-success rounded-pill d-inline-block text-center px-3 py-1"},ql={class:"text-center"},Ol={class:"d-inline-flex align-items-center gap-3"},Bl=["onClick"],Rl=["title"],Zl={key:0},zl={key:0,class:"mt-4 d-flex justify-between"},Wl={class:"text-center mt-3 text-sm text-gray-600"},Gl={class:"modal fade",id:"addItemModal",tabindex:"-1","aria-hidden":"true"},Xl={class:"modal-dialog modal-lg modal-dialog-centered",role:"document"},Hl={class:"modal-content rounded-4"},Yl={class:"modal-header"},Kl={class:"modal-title fw-semibold"},Jl={class:"modal-body"},Ql={class:"nav nav-tabs mb-4",role:"tablist"},ea={class:"nav-item",role:"presentation"},ta={class:"nav-item",role:"presentation"},la={class:"tab-content"},aa={class:"row g-3"},sa={class:"col-md-6"},oa={key:0,class:"text-danger"},na={class:"col-md-6"},ia={key:0,class:"text-danger"},ra={class:"col-md-6"},da={key:0,class:"text-danger"},ua={class:"col-md-6"},ca={class:"d-flex gap-3"},pa={class:"form-check"},ma=["checked"],va={class:"form-check"},ga=["checked"],ba={key:0,class:"col-md-6"},fa={key:0,class:"text-danger"},_a={key:1,class:"col-md-6"},ya={class:"form-label"},ha={class:"input-group"},xa=["step","placeholder"],wa={key:0,class:"input-group-text"},ka={key:1,class:"input-group-text"},Ca={key:0,class:"text-danger"},Sa={class:"col-md-6"},Ma={key:0,class:"text-danger"},Va={class:"col-md-6"},$a={key:0,class:"text-danger"},Ia={class:"col-md-6"},Fa={key:0,class:"text-danger"},Aa={key:2,class:"col-md-6"},Na={key:0,class:"text-danger"},Ea={class:"col-12"},Ta={key:0,class:"text-danger"},Ua={class:"row g-4 mt-1"},Pa={class:"col-md-6"},La={key:0,class:"text-muted"},ja={key:1},Da={key:0,class:"ms-1",style:{color:"#22c55e","font-weight":"bold"}},qa={key:1,class:"ms-1",style:{color:"#f97316","font-weight":"bold"}},Oa={class:"col-md-6"},Ba={key:0,class:"text-danger"},Ra={class:"col-md-12"},Za={key:0,class:"text-danger"},za={key:0,class:"col-md-12"},Wa={class:"d-flex justify-content-between align-items-center w-100"},Ga={class:"badge bg-primary"},Xa={key:0,class:"text-danger"},Ha={class:"row g-3 mt-2 align-items-center"},Ya={class:"col-md-4"},Ka=["src"],Ja={key:1,class:"placeholder"},Qa={class:"mt-4 col-sm-6 col-md-8"},es={key:0,class:"text-danger d-block mt-1"},ts={key:1,class:"mt-3"},ls={class:"card border rounded-4 mb-3"},as={class:"p-3 fw-semibold"},ss={class:"d-flex flex-wrap gap-2"},os={class:"badge bg-primary px-3 py-2 rounded-pill"},ns={class:"badge bg-success px-3 py-2 rounded-pill"},is={class:"badge bg-warning text-dark px-3 py-2 rounded-pill"},rs={class:"badge bg-danger px-3 py-2 rounded-pill"},ds={class:"card border rounded-4"},us={class:"table-responsive"},cs={class:"table align-middle mb-0"},ps={class:"row g-3"},ms={class:"col-md-6"},vs={key:0,class:"text-danger"},gs={class:"col-md-6"},bs={key:0,class:"text-danger"},fs={class:"col-md-6"},_s={key:0,class:"text-danger"},ys={class:"col-md-6"},hs={key:0,class:"text-danger"},xs={class:"col-md-6"},ws={key:0,class:"text-danger"},ks={class:"col-12"},Cs={class:"row g-4 mt-1"},Ss={class:"col-md-6"},Ms={key:0,class:"text-muted"},Vs={key:1},$s={key:0,class:"ms-1",style:{color:"#22c55e","font-weight":"bold"}},Is={key:1,class:"ms-1",style:{color:"#f97316","font-weight":"bold"}},Fs={class:"col-md-6"},As={key:0,class:"text-danger"},Ns={class:"col-md-12"},Es={key:0,class:"text-danger"},Ts={key:0,class:"col-md-12"},Us={class:"d-flex justify-content-between align-items-center w-100"},Ps={class:"badge bg-primary"},Ls={key:0,class:"text-danger"},js={class:"mt-4"},Ds={class:"row g-3 mb-3"},qs={class:"col-md-12"},Os={key:0},Bs={class:"row g-3"},Rs={class:"card border rounded-4 shadow-sm h-100"},Zs={class:"card-header custom-card-header bg-light"},zs={class:"d-flex justify-content-between align-items-center"},Ws={class:"d-flex gap-4"},Gs={class:"mb-0 fw-semibold"},Xs={class:"text-muted"},Hs={class:"d-flex gap-2"},Ys=["onClick"],Ks=["onClick"],Js={class:"card-body custom-card-body"},Qs={class:"mb-3"},eo={class:"d-flex flex-wrap gap-2"},to={class:"badge bg-primary px-1 py-1 rounded-pill small"},lo={class:"badge bg-success px-1 py-1 rounded-pill small"},ao={class:"badge bg-warning text-dark px-1 py-1 rounded-pill small"},so={class:"badge bg-danger px-1 py-1 rounded-pill small"},oo={class:"table-responsive"},no={class:"table table-sm align-middle mb-0"},io={class:"small"},ro={class:"small"},uo={class:"row g-3 mt-3 align-items-center"},co={class:"col-md-4"},po=["src"],mo={key:1,class:"placeholder"},vo={class:"mt-4"},go={key:0,class:"row g-3"},bo={class:"card border rounded-3 shadow-sm"},fo={class:"card-header bg-light py-2"},_o={class:"mb-0 fw-semibold small"},yo={class:"card-body"},ho={class:"mb-3"},xo={class:"d-flex gap-3"},wo={class:"form-check"},ko=["id","name","onUpdate:modelValue","checked"],Co=["for"],So={class:"form-check"},Mo=["id","name","onUpdate:modelValue","checked"],Vo=["for"],$o={key:0,class:"row g-2"},Io={class:"col-6"},Fo={class:"col-6"},Ao={class:"form-label small"},No={class:"input-group input-group-sm"},Eo=["onUpdate:modelValue","step","placeholder"],To={class:"input-group-text small"},Uo={key:1,class:"alert alert-info small",role:"alert"},Po={class:"mt-4"},Lo=["disabled"],jo={class:"modal-dialog modal-lg modal-dialog-centered"},Do={class:"modal-content rounded-4 shadow-lg border border-secondary"},qo={class:"modal-body p-4",style:{border:"2px solid #dee2e6","border-radius":"10px","background-color":"#f8f9fa"}},Oo={class:"table table-bordered text-center align-middle mb-0",style:{border:"1px solid #dee2e6"}},Bo={class:"text-start ps-4"},Ro=["name","onUpdate:modelValue"],Zo=["name","onUpdate:modelValue"],zo={key:1,class:"modal-backdrop fade show"},Wo={class:"modal fade",id:"addIngredientModal",tabindex:"-1","aria-hidden":"true"},Go={class:"modal-dialog modal-xl modal-dialog-centered"},Xo={class:"modal-content rounded-4"},Ho={class:"modal-header"},Yo={class:"modal-title fw-semibold"},Ko={key:0,class:"badge bg-primary ms-2"},Jo={class:"modal-body"},Qo={class:"row g-4"},en={key:0,class:"rounded-4 mb-3"},tn={class:"row g-3"},ln={class:"col-md-6"},an={class:"col-md-6"},sn={class:"col-lg-5"},on={class:"search-wrap mb-2"},nn={class:"card-body"},rn={class:"d-flex align-items-start gap-3"},dn=["src"],un={class:"flex-grow-1"},cn={class:"fw-semibold"},pn={class:"text-muted small"},mn={class:"text-muted small"},vn={class:"small mt-2 text-muted"},gn=["onClick"],bn={class:"row g-2 mt-3"},fn={class:"col-4"},_n=["onUpdate:modelValue"],yn={key:0,class:"text-danger"},hn={class:"col-lg-7"},xn={class:"card border rounded-4 mb-3"},wn={class:"p-3 fw-semibold"},kn={class:"card border rounded-4"},Cn={class:"table-responsive"},Sn={class:"table align-middle mb-0"},Mn={class:"text-end"},Vn=["onClick"],$n={key:0},In={__name:"Index",props:{allergies:{type:Array},tags:{type:Array},categories:{type:Array},meals:{type:Array},variantGroups:{type:Array,default:()=>[]},addonGroups:{type:Array,default:()=>[]}},setup(G){const{formatCurrencySymbol:Se}=ml(),Me=G,Re=g([{label:"Yes",value:1},{label:"No",value:0}]),Ze=g([]);g([]);const X=g([]);g(null);const H=g("simple"),ae=g(!1),J=g(null),I=g({}),S=g({}),Te=()=>{if(s.value.addon_group_id){const l=Me.addonGroups?.find(e=>e.id===s.value.addon_group_id);l?(X.value=l.addons||[],s.value.addon_group_constraints={min_select:l.min_select,max_select:l.max_select}):(X.value=[],s.value.addon_group_constraints=null),Array.isArray(s.value.addon_ids)||(s.value.addon_ids=[])}else X.value=[],s.value.addon_ids=[],s.value.addon_group_constraints=null},ze=[{name:"Meat",value:"#E74C3C"},{name:"Vegetables",value:"#27AE60"},{name:"Seafood",value:"#2980B9"},{name:"Drinks",value:"#8E44AD"},{name:"Staples",value:"#E67E22"}],re=g([]),se=g(!1),B=g({}),R=g([]),Ue=g(""),C=g([]),ht=async()=>{try{const l=await axios.get("/inventory/api-inventories");re.value=l.data.data}catch(l){console.error("Error fetching inventory:",l)}};function xt(){R.value=Object.keys(B.value).filter(l=>B.value[l]).map(l=>({id:parseInt(l),name:Me.allergies.find(e=>e.id==l)?.name,type:B.value[l]})),s.value.allergies=[...R.value],se.value=!1,setTimeout(()=>{new bootstrap.Modal(document.getElementById("addItemModal")).show()},300)}const We=()=>{se.value=!1,setTimeout(()=>{new bootstrap.Modal(document.getElementById("addItemModal")).show()},300)},wt=q(()=>{const l=Ue.value.trim().toLowerCase();return l?re.value.filter(e=>[e.name,e.category??"",e.subcategory??""].join(" ").toLowerCase().includes(l)):re.value}),Ge=()=>{const l=bootstrap.Modal.getInstance(document.getElementById("addItemModal"));l&&l.hide(),se.value=!0};function de(l){return Math.round(l*100)/100}function kt(l){const e=Number(l.qty||0),i=l.unitPrice!==""&&l.unitPrice!=null?Number(l.unitPrice):Number(l.defaultPrice||0);if(c.value[l.id]={},(!e||e<=0)&&(c.value[l.id].qty="Enter a valid quantity."),Object.keys(c.value[l.id]).length>0){const n=Object.values(c.value[l.id]).join(`
`);_.error(n,{style:{whiteSpace:"pre-line"}});return}const a=C.value.find(n=>n.id===l.id);a?(a.qty=e,a.unitPrice=i,a.cost=de(e*i)):C.value.push({id:l.id,name:l.name,category:l.category,qty:e,unitPrice:i,cost:de(e*i),nutrition:l.nutrition||{calories:0,protein:0,carbs:0,fat:0}}),ne.value||(l.qty=null,l.unitPrice=null)}function Ct(l){const e=C.value[l];if(!e)return;C.value.splice(l,1);const i=st.value.find(a=>a.id===e.id);i&&(i.qty=null,i.unitPrice=null,i.cost=null)}const T=q(()=>{const l=C.value.reduce((e,i)=>{const a=Number(i.qty)||0;return e.calories+=Number(i.nutrition?.calories||0)*a,e.protein+=Number(i.nutrition?.protein||0)*a,e.carbs+=Number(i.nutrition?.carbs||0)*a,e.fat+=Number(i.nutrition?.fat||0)*a,e},{calories:0,protein:0,carbs:0,fat:0});return{calories:de(l.calories),protein:de(l.protein),carbs:de(l.carbs),fat:de(l.fat)}}),St=()=>{new bootstrap.Modal(document.getElementById("addItemModal")).show()};Oe(async()=>{pe.value="",Ye.value=Date.now(),await ll(),setTimeout(()=>{Ke.value=!0;const e=document.getElementById(Le);e&&(e.value="",pe.value="")},100),ht();const l=document.getElementById("menuFilterModal");l&&l.addEventListener("hidden.bs.modal",()=>{M.value={...je.value}})});const Xe=g(Me.inventories?.data||[]);q(()=>Xe.value);const He=async()=>{try{const l=await axios.get("inventory/api-inventories");Xe.value=l.data.data}catch(l){console.error(l)}},ue=g([]),_e=g(1),Ve=g(10),$e=g(0),Pe=g([]),Y=g(!1),Ie=g({total:0,active:0,inactive:0}),ce=async(l=1)=>{Y.value=!0;try{const e=await axios.get("/api/menu/items",{params:{page:l,per_page:Ve.value,search:pe.value.trim()||null,category:M.value.category||null,status:M.value.status!==""?M.value.status:null,sort_by:M.value.sortBy||null,price_min:M.value.priceMin||null,price_max:M.value.priceMax||null,date_from:M.value.dateFrom||null,date_to:M.value.dateTo||null}});ue.value=e.data.data||[],e.data.pagination&&(_e.value=e.data.pagination.current_page,$e.value=e.data.pagination.total,Pe.value=e.data.pagination.links),e.data.counts&&(Ie.value=e.data.counts)}catch(e){console.error("âŒ Error fetching menus:",e),_.error("Failed to fetch menu items")}finally{Y.value=!1}},Mt=l=>{if(!l||Y.value)return;const i=new URLSearchParams(l.split("?")[1]).get("page");i&&ce(parseInt(i))};Oe(()=>{He(),ce()});const pe=g(""),Ye=g(Date.now()),Le=`search-${Math.random().toString(36).substr(2,9)}`,Ke=g(!1),Fe={sortBy:"",category:"",status:"",priceMin:null,priceMax:null,dateFrom:"",dateTo:""},M=g({...Fe}),je=g({...Fe}),Vt=q(()=>ue.value),Je=q(()=>Vt.value),De=q(()=>({sortOptions:[{value:"price_desc",label:"Price: High to Low"},{value:"price_asc",label:"Price: Low to High"},{value:"name_asc",label:"Name: A to Z"},{value:"name_desc",label:"Name: Z to A"}],categories:Me.categories||[],statusOptions:[{value:1,label:"Active"},{value:0,label:"Inactive"}]})),$t=()=>{M.value={...Fe},je.value={...Fe}},It=()=>{je.value={...M.value}},Ft=q(()=>Ie.value.total),At=q(()=>Ie.value.active),Nt=q(()=>Ie.value.inactive),Et=q(()=>[{label:"Total Menus",value:Ft.value??0,icon:bl,iconBg:"bg-soft-success",iconColor:"text-success"},{label:"Active Menus",value:At.value??0,icon:fl,iconBg:"bg-soft-danger",iconColor:"text-success"},{label:"Inactive Menus",value:Nt.value??0,icon:ft,iconBg:"bg-soft-warning",iconColor:"text-danger"}]);Oe(()=>window.feather?.replace()),al(()=>window.feather?.replace());const Tt=g({Poultry:["Chicken","Broiler","Wings","Breast"],Produce:["Tomatoes","Onions","Potatoes"],Grains:["Rice","Wheat","Oats"],Grocery:["Oil","Spices","Sugar"],Meat:["Beef","Mutton","Veal"]}),Qe=q(()=>(Tt.value[s.value.category]||[]).map(l=>({name:l,value:l}))),c=g({});function et(){c.value={}}const s=g({name:"",category_id:null,meals:[],label_color:null,subcategory:"",unit:[],price:"",supplier:[],sku:"",description:"",nutrition:{calories:"",fat:"",protein:"",carbs:""},allergies:[],tags:[],imageFile:null,imageUrl:null,is_taxable:null,variant_group_id:"",variant_prices:{},addon_group_id:"",addon_ids:[],addon_group_constraints:null,is_saleable:!1,resale_type:null,resale_value:null}),tt=g([{label:"Flat Amount",value:"flat"},{label:"Percentage",value:"percentage"}]),oe=g(!1),Q=g(!1),ye=g(null);function lt(l){ye.value=s.value.imageUrl,ye.value&&(Q.value=!0)}function at({file:l}){s.value.imageFile=l,s.value.imageUrl=URL.createObjectURL(l)}const me=g(!1),Ut=async()=>{me.value=!0,c.value={};try{const l=new FormData;if(l.append("name",s.value.name.trim()),s.value.category_id&&l.append("category_id",s.value.category_id),s.value.label_color&&l.append("label_color",s.value.label_color),l.append("description",s.value.description||""),l.append("is_taxable",String(s.value.is_taxable??0)),H.value==="variant"&&Object.keys(I.value).length>0){const e=Object.values(I.value).flat().reduce((a,n)=>{const d=Number(n.qty||0);return a.calories+=Number(n.nutrition?.calories||0)*d,a.protein+=Number(n.nutrition?.protein||0)*d,a.carbs+=Number(n.nutrition?.carbs||0)*d,a.fat+=Number(n.nutrition?.fat||0)*d,a},{calories:0,protein:0,carbs:0,fat:0});l.append("nutrition[calories]",e.calories),l.append("nutrition[fat]",e.fat),l.append("nutrition[protein]",e.protein),l.append("nutrition[carbs]",e.carbs);let i=0;Object.entries(E.value).forEach(([a,n])=>{l.append(`variant_metadata[${i}][name]`,n.name),l.append(`variant_metadata[${i}][price]`,n.price);const d=S.value[a];d&&d.is_saleable?(l.append(`variant_metadata[${i}][is_saleable]`,1),d.resale_type&&d.resale_type!=="null"&&l.append(`variant_metadata[${i}][resale_type]`,d.resale_type),d.resale_value!==null&&d.resale_value!==""&&!isNaN(d.resale_value)&&l.append(`variant_metadata[${i}][resale_value]`,parseFloat(d.resale_value))):l.append(`variant_metadata[${i}][is_saleable]`,0),(I.value[a]||[]).forEach((o,m)=>{l.append(`variant_ingredients[${i}][${m}][inventory_item_id]`,o.id),l.append(`variant_ingredients[${i}][${m}][qty]`,o.qty),l.append(`variant_ingredients[${i}][${m}][unit_price]`,o.unitPrice),l.append(`variant_ingredients[${i}][${m}][cost]`,o.cost)}),i++}),l.append("price",0)}else l.append("nutrition[calories]",T.value.calories),l.append("nutrition[fat]",T.value.fat),l.append("nutrition[protein]",T.value.protein),l.append("nutrition[carbs]",T.value.carbs),s.value.price!==""&&s.value.price!==null&&l.append("price",s.value.price),s.value.is_saleable?(l.append("is_saleable",1),s.value.resale_type&&s.value.resale_type!=="null"&&l.append("resale_type",s.value.resale_type),s.value.resale_value!==null&&s.value.resale_value!==""&&!isNaN(s.value.resale_value)&&l.append("resale_value",parseFloat(s.value.resale_value))):l.append("is_saleable",0),C.value.forEach((e,i)=>{l.append(`ingredients[${i}][inventory_item_id]`,e.id),l.append(`ingredients[${i}][qty]`,e.qty),l.append(`ingredients[${i}][unit_price]`,e.unitPrice),l.append(`ingredients[${i}][cost]`,e.cost)});s.value.allergies.forEach((e,i)=>{l.append(`allergies[${i}]`,e.id),l.append(`allergy_types[${i}]`,e.type==="Contain"?1:0)}),s.value.meals.forEach((e,i)=>{l.append(`meals[${i}]`,e)}),s.value.tags.forEach((e,i)=>l.append(`tags[${i}]`,e)),s.value.imageFile&&l.append("image",s.value.imageFile),s.value.addon_group_id&&(l.append("addon_group_id",s.value.addon_group_id),s.value.addon_ids.forEach((e,i)=>{l.append(`addon_ids[${i}]`,e)}));try{const e=await axios.post("/menu",l,{headers:{"Content-Type":"multipart/form-data"}});_.success("Menu created successfully"),he(),await ce(),bootstrap.Modal.getInstance(document.getElementById("addItemModal"))?.hide()}catch(e){if(console.error("âŒ Error saving:",e.response?.data),e?.response?.status===422&&e.response.data?.errors){c.value=e.response.data.errors;const i=Object.values(e.response.data.errors).flat().join(`
`);_.error(i||"Validation failed")}else _.error("Failed to save menu item: "+(e.response?.data?.message||e.message))}}catch(l){console.error("âŒ Error:",l),_.error("An error occurred: "+l.message)}finally{me.value=!1}};pt(s,l=>{Object.keys(c.value).forEach(e=>{if(e.includes(".")){const[i,a]=e.split(".");l[i]&&l[i][a]!==""&&delete c.value[e]}else{const i=l[e];i!=null&&i!==""&&(!Array.isArray(i)||i.length>0)&&delete c.value[e]}})},{deep:!0}),pt(I,l=>{Object.keys(l).forEach(e=>{S.value[e]||(S.value[e]={is_saleable:!1,resale_type:null,resale_value:null})})},{deep:!0});const Pt=g({calories:0,protein:0,carbs:0,fat:0}),ne=g(!1),st=q(()=>wt.value.map(l=>{const e=C.value.find(i=>i.id===l.id);return e?{...l,qty:e.qty,unitPrice:e.unitPrice,cost:e.cost}:{...l,qty:0,unitPrice:0,cost:0}})),Lt=l=>{s.value.imageUrl&&s.value.imageUrl.startsWith("blob:")&&URL.revokeObjectURL(s.value.imageUrl),ne.value=!0;const e=dl(l),i=e.variants&&Array.isArray(e.variants)&&e.variants.length>0;if(H.value=i?"variant":"simple",s.value={id:e.id,name:e.name,price:e.price,category_id:e.category?.id||null,meals:e.meals?.map(n=>n.id)||[],description:e.description,label_color:e.label_color,is_taxable:e.is_taxable??0,ingredients:e.ingredients||[],allergies:e.allergies?.map(n=>n.id)||[],tags:e.tags?.map(n=>n.id)||[],imageFile:null,imageUrl:e.image_url||null,addon_group_id:e.addon_group_id||"",addon_ids:e.addon_ids||e.addons?.map(n=>n.id)||[],is_saleable:e.is_saleable===1||e.is_saleable===!0,resale_type:e.resale_type||null,resale_value:e.resale_value||null},i){I.value={},E.value={},S.value={};let n=0;e.variants.forEach(d=>{const v=d.id;n=Math.max(n,v),E.value[v]={name:d.name,price:parseFloat(d.price||0)},S.value[v]={is_saleable:d.is_saleable===1||d.is_saleable===!0,resale_type:d.resale_type||null,resale_value:d.resale_value?parseFloat(d.resale_value):null},d.ingredients&&Array.isArray(d.ingredients)?I.value[v]=d.ingredients.map(o=>{const m=parseFloat(o.quantity||o.qty||0),k=parseFloat(o.cost||0),U=m>0?k/m:0,P=re.value.find(y=>y.id===(o.inventory_item_id||o.id));return{id:o.inventory_item_id||o.id,name:o.product_name||o.name||P?.name||"â€”",category:P?.category||o.category||{name:""},qty:m,unitPrice:U,cost:k,nutrition:o.nutrition||P?.nutrition||{calories:0,protein:0,carbs:0,fat:0}}}):I.value[v]=[]}),ot.value=n+1}e.addon_group_id&&Te(),Pt.value={calories:parseFloat(e.nutrition?.calories||0),protein:parseFloat(e.nutrition?.protein||0),carbs:parseFloat(e.nutrition?.carbs||0),fat:parseFloat(e.nutrition?.fat||0)},e.allergies&&e.allergies.length>0?(R.value=e.allergies.map(n=>{const d=n.pivot?.type??n.type??1;return{id:n.id,name:n.name,type:Number(d)===1?"Contain":"Trace"}}),B.value={},R.value.forEach(n=>{B.value[n.id]=n.type})):(R.value=[],B.value={}),i?C.value=[]:C.value=(e.ingredients||[]).map(n=>{const d=parseFloat(n.quantity||n.qty||0),v=parseFloat(n.cost||0),o=d>0?v/d:0,m=re.value.find(k=>k.id===(n.inventory_item_id||n.id));return{id:n.inventory_item_id||n.id,name:n.product_name||n.name||m?.name||"â€”",category:m?.category||n.category||{name:""},qty:d,unitPrice:o,cost:v,nutrition:n.nutrition?typeof n.nutrition=="string"?JSON.parse(n.nutrition):n.nutrition:m?.nutrition||{calories:0,protein:0,carbs:0,fat:0}}}),new bootstrap.Modal(document.getElementById("addItemModal")).show()},jt=async()=>{me.value=!0,c.value={};try{const l=new FormData;if(l.append("name",s.value.name.trim()),s.value.category_id&&l.append("category_id",s.value.category_id),l.append("description",s.value.description||""),l.append("label_color",s.value.label_color||""),l.append("is_taxable",String(s.value.is_taxable??0)),H.value==="variant"&&Object.keys(I.value).length>0){const e=Object.values(I.value).flat().reduce((a,n)=>{const d=Number(n.qty||0);return a.calories+=Number(n.nutrition?.calories||0)*d,a.protein+=Number(n.nutrition?.protein||0)*d,a.carbs+=Number(n.nutrition?.carbs||0)*d,a.fat+=Number(n.nutrition?.fat||0)*d,a},{calories:0,protein:0,carbs:0,fat:0});l.append("nutrition[calories]",e.calories),l.append("nutrition[fat]",e.fat),l.append("nutrition[protein]",e.protein),l.append("nutrition[carbs]",e.carbs);let i=0;Object.entries(E.value).forEach(([a,n])=>{l.append(`variant_metadata[${i}][id]`,a),l.append(`variant_metadata[${i}][name]`,n.name),l.append(`variant_metadata[${i}][price]`,n.price);const d=S.value[a];d&&d.is_saleable?(l.append(`variant_metadata[${i}][is_saleable]`,1),d.resale_type&&d.resale_type!=="null"&&l.append(`variant_metadata[${i}][resale_type]`,d.resale_type),d.resale_value!==null&&d.resale_value!==""&&!isNaN(d.resale_value)&&l.append(`variant_metadata[${i}][resale_value]`,parseFloat(d.resale_value))):l.append(`variant_metadata[${i}][is_saleable]`,0),(I.value[a]||[]).forEach((o,m)=>{l.append(`variant_ingredients[${i}][${m}][inventory_item_id]`,o.id),l.append(`variant_ingredients[${i}][${m}][qty]`,o.qty),l.append(`variant_ingredients[${i}][${m}][unit_price]`,o.unitPrice),l.append(`variant_ingredients[${i}][${m}][cost]`,o.cost)}),i++}),l.append("price",0)}else l.append("price",s.value.price||0),l.append("nutrition[calories]",T.value.calories),l.append("nutrition[fat]",T.value.fat),l.append("nutrition[protein]",T.value.protein),l.append("nutrition[carbs]",T.value.carbs),s.value.is_saleable?(l.append("is_saleable",1),s.value.resale_type&&s.value.resale_type!=="null"&&l.append("resale_type",s.value.resale_type),s.value.resale_value!==null&&s.value.resale_value!==""&&!isNaN(s.value.resale_value)&&l.append("resale_value",parseFloat(s.value.resale_value))):l.append("is_saleable",0),C.value.forEach((e,i)=>{l.append(`ingredients[${i}][inventory_item_id]`,e.id),l.append(`ingredients[${i}][qty]`,e.qty),l.append(`ingredients[${i}][unit_price]`,e.unitPrice),l.append(`ingredients[${i}][cost]`,e.cost)});R.value.forEach((e,i)=>{l.append(`allergies[${i}]`,e.id);const a=e.type==="Contain"?1:0;l.append(`allergy_types[${i}]`,a)}),s.value.tags.forEach((e,i)=>l.append(`tags[${i}]`,e)),s.value.meals.forEach((e,i)=>{l.append(`meals[${i}]`,e)}),s.value.imageFile&&l.append("image",s.value.imageFile),s.value.addon_group_id&&(l.append("addon_group_id",s.value.addon_group_id),s.value.addon_ids.forEach((e,i)=>{l.append(`addon_ids[${i}]`,e)})),l.append("_method","PUT");try{const e=await axios.post(`/menu/${s.value.id}`,l,{headers:{"Content-Type":"multipart/form-data"}});_.success("Menu updated successfully"),he(),await ce(),bootstrap.Modal.getInstance(document.getElementById("addItemModal"))?.hide()}catch(e){if(console.error("âŒ Update failed:",e.response?.data),e?.response?.status===422&&e.response.data?.errors){c.value=e.response.data.errors;const i=Object.values(e.response.data.errors).flat().join(`
`);_.error(i||"Validation failed")}else _.error("Failed to update menu item: "+(e.response?.data?.message||e.message))}}catch(l){console.error("âŒ Error:",l),_.error("An error occurred: "+l.message)}finally{me.value=!1}},Dt=async l=>{console.log(l);try{const e=l.status===1?0:1;await axios.patch(`/menu/${l.id}/status`,{status:e}),_.success(`Menu item is now ${e===1?"Active":"Inactive"}`),await ce(_e.value)}catch(e){console.error("Failed to toggle status",e),_.error("Failed to update status")}};function he(){s.value.imageUrl&&s.value.imageUrl.startsWith("blob:")&&URL.revokeObjectURL(s.value.imageUrl),s.value={name:"",category_id:null,meals:[],label_color:null,subcategory:"",unit:[],price:"",supplier:[],sku:"",description:"",nutrition:{calories:"",fat:"",protein:"",carbs:""},allergies:[],tags:[],imageFile:null,imageUrl:null,is_taxable:null,variant_group_id:"",variant_prices:{},addon_group_id:"",addon_ids:[],addon_group_constraints:null,is_saleable:!1,resale_type:null,resale_value:null},oe.value=!1,Q.value=!1,ye.value=null,c.value={},ne.value=!1,R.value=[],B.value={},C.value=[],H.value="simple",ae.value=!1,J.value=null,I.value={},E.value={},S.value={},N.value={name:"",price:null},Ze.value=[],X.value=[]}const qt=()=>{he(),et()},Ot=async()=>{try{Y.value=!0,console.log("ðŸ”„ Fetching all menu items for export...");const e=(await axios.get("/api/menu/items",{params:{export:"all",search:pe.value.trim()||null,category:M.value.category||null,status:M.value.status!==""?M.value.status:null,sort_by:M.value.sortBy||null,price_min:M.value.priceMin||null,price_max:M.value.priceMax||null,date_from:M.value.dateFrom||null,date_to:M.value.dateTo||null}})).data.data||[];return console.log(`âœ… Fetched ${e.length} menu items for export`),e}catch(l){return console.error("âŒ Error fetching export data:",l),_.error("Failed to load data for export"),[]}finally{Y.value=!1}},Ae=async l=>{if(console.log("ðŸ” Starting download process..."),console.log("ðŸ” Current menuItems.value length:",ue.value?.length),console.log("ðŸ” Total items in system:",$e.value),!ue.value||ue.value.length===0){_.error("No menu data to download");return}try{Y.value=!0,_.info("Fetching all menu items for export...",{autoClose:2e3});const e=await Ot();if(console.log("âœ… Data ready for export:",e.length,"items"),!e.length){_.error("No menu items found to download"),Y.value=!1;return}l==="pdf"?Rt(e):l==="excel"?Zt(e):l==="csv"?Bt(e):l==="allergens"?zt(e):_.error("Invalid download type")}catch(e){console.error("âŒ Download failed:",e),_.error(`Download failed: ${e.message}`)}finally{Y.value=!1}},Bt=l=>{try{const e=["Item Name","Category","Description","Price","Nutrition","Allergies","Tags"],i=l.map(o=>{let m="";o.nutrition&&typeof o.nutrition=="object"?m=["calories","protein","fat","carbs"].map(V=>o.nutrition[V]!==void 0?`${V}: ${o.nutrition[V]}`:null).filter(Boolean).join("; "):typeof o.nutrition=="string"&&(m=o.nutrition);const k=typeof o.category=="object"?o.category?.name||"":o.category||"",U=Array.isArray(o.allergies)?o.allergies.map(y=>{const V=y.name||y,F=y.pivot?.type??y.type??null;if(F!=null){const j=String(F)==="1"||F===1?"Contain":"Trace";return`${V} (${j})`}return V}).join(", "):o.allergies||"",P=Array.isArray(o.tags)?o.tags.map(y=>y.name||y).join(", "):o.tags||"";return[`"${(o.name||"").replace(/"/g,'""')}"`,`"${k.replace(/"/g,'""')}"`,`"${(o.description||"").replace(/"/g,'""')}"`,`"${o.price||""}"`,`"${m.replace(/"/g,'""')}"`,`"${U.replace(/"/g,'""')}"`,`"${P.replace(/"/g,'""')}"`]}),a=[e.join(","),...i.map(o=>o.join(","))].join(`
`),n=new Blob([a],{type:"text/csv;charset=utf-8;"}),d=URL.createObjectURL(n),v=document.createElement("a");v.setAttribute("href",d),v.setAttribute("download",`menu_items_${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(v),v.click(),document.body.removeChild(v),URL.revokeObjectURL(d),_.success(`CSV downloaded successfully (${l.length} items)`,{autoClose:2500})}catch(e){console.error("CSV generation error:",e),_.error(`CSV generation failed: ${e.message}`,{autoClose:5e3})}},Rt=l=>{try{const e=new gt("p","mm","a4");e.setFontSize(18),e.setFont("helvetica","bold"),e.text("Menu Items Report",65,20),e.setFontSize(10),e.setFont("helvetica","normal");const i=new Date().toLocaleString();e.text(`Generated on: ${i}`,14,28),e.text(`Total Menu Items: ${l.length}`,14,34);const a=["Item Name","Category","Description","Price","Nutrition","Allergies","Tags"],n=o=>{if(!o)return"";if(typeof o=="string")try{o=JSON.parse(o)}catch{return o}return typeof o=="object"?["calories","protein","fat","carbs"].map(k=>o[k]!==void 0?`${k}: ${o[k]}`:null).filter(Boolean).join("; "):String(o??"")},d=l.map(o=>{const m=typeof o.category=="object"?o.category?.name||"":o.category||"",k=Array.isArray(o.allergies)?o.allergies.map(y=>{const V=y.name||y,F=y.pivot?.type??y.type??null;if(F!=null){const j=String(F)==="1"||F===1?"Contain":"Trace";return`${V} (${j})`}return V}).join(", "):o.allergies||"",U=Array.isArray(o.tags)?o.tags.map(y=>y.name||y).join(", "):o.tags||"",P=n(o.nutrition);return[o.name||"",m,o.description||"",o.price||"",P,k,U]});bt(e,{head:[a],body:d,startY:40,styles:{fontSize:8,cellPadding:2,halign:"left",lineColor:[0,0,0],lineWidth:.1},headStyles:{fillColor:[41,128,185],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]},margin:{left:14,right:14},didDrawPage:o=>{const m=e.internal.getNumberOfPages(),k=e.internal.pageSize.height;e.setFontSize(8),e.text(`Page ${o.pageNumber} of ${m}`,o.settings.margin.left,k-10)}});const v=`menu_items_${new Date().toISOString().split("T")[0]}.pdf`;e.save(v),_.success(`PDF downloaded successfully (${l.length} items)`,{autoClose:2500})}catch(e){console.error("PDF generation error:",e),_.error(`PDF generation failed: ${e.message}`,{autoClose:5e3})}},Zt=l=>{try{if(typeof cl>"u")throw new Error("XLSX library is not loaded");const e=l.map(o=>{let m="";o.nutrition&&typeof o.nutrition=="object"?m=["calories","protein","fat","carbs"].map(V=>o.nutrition[V]!==void 0?`${V}: ${o.nutrition[V]}`:null).filter(Boolean).join("; "):typeof o.nutrition=="string"&&(m=o.nutrition);const k=typeof o.category=="object"?o.category?.name||"":o.category||"",U=Array.isArray(o.allergies)?o.allergies.map(y=>{const V=y.name||y,F=y.pivot?.type??y.type??null;if(F!=null){const j=String(F)==="1"||F===1?"Contain":"Trace";return`${V} (${j})`}return V}).join(", "):o.allergies||"",P=Array.isArray(o.tags)?o.tags.map(y=>y.name||y).join(", "):o.tags||"";return{"Item Name":o.name||"",Category:k,Description:o.description||"",Price:o.price||"",Nutrition:m,Allergies:U,Tags:P}}),i=Ce.book_new(),a=Ce.json_to_sheet(e);a["!cols"]=[{wch:20},{wch:20},{wch:30},{wch:10},{wch:30},{wch:25},{wch:25}],Ce.book_append_sheet(i,a,"Menu Items");const n=[{Info:"Generated On",Value:new Date().toLocaleString()},{Info:"Total Records",Value:l.length},{Info:"Exported By",Value:"Menu Management System"}],d=Ce.json_to_sheet(n);Ce.book_append_sheet(i,d,"Report Info");const v=`menu_items_${new Date().toISOString().split("T")[0]}.xlsx`;pl(i,v),_.success(`Excel file downloaded successfully (${l.length} items)`,{autoClose:2500})}catch(e){console.error("Excel generation error:",e),_.error(`Excel generation failed: ${e.message}`,{autoClose:5e3})}},zt=l=>{try{const e=new gt("l","mm","a4");e.setFontSize(20),e.setFont("helvetica","bold"),e.text("allergen",14,15),e.setFontSize(16),e.text("information",14,22),e.setFontSize(18),e.setFont("helvetica","bold"),e.setTextColor(0,102,204),e.text("10XGLOBAL",65,22),e.setTextColor(0,0,0);const i=e.internal.pageSize.width,a=i-125,n=8;e.setFillColor(240,240,240),e.rect(a-2,n,45,18,"F"),e.setFontSize(7),e.setFont("helvetica","bold"),e.text("SYMBOL",a,n+4),e.text("MEANING",a+12,n+4),e.setFont("helvetica","normal"),e.setFontSize(6);const d=a+1,v=n+7;e.setLineWidth(.5),e.setDrawColor(0,0,0),e.line(d,v,d+1,v+1.5),e.line(d+1,v+1.5,d+3,v-1),e.text("contains allergen",a+12,n+9),e.setFontSize(9),e.text("*",a+1,n+14),e.setFontSize(6),e.text("may contain traces of allergen",a+12,n+14);const o=a+48;e.setFontSize(6),e.text("â€¢ Always speak to a member of staff if you have any allergies",o,n+3),e.text("â€¢ Items are prepared in the same kitchen,",o,n+7),e.text("  therefore we cannot guarantee that products are",o,n+10),e.text("  free from allergen and cross-contamination",o,n+13);const m={};l.forEach(b=>{const A=typeof b.category=="object"?b.category?.name||"Other":b.category||"Other";m[A]||(m[A]=[]),m[A].push(b)});const k=new Set;l.forEach(b=>{Array.isArray(b.allergies)&&b.allergies.forEach(A=>{const D=A.name||A;k.add(D)})});const U=Array.from(k).sort(),P=14,y=14,V=i-P-y,F=30,j=45,ve=F+j,ge=(V-ve)/U.length,qe=Math.max(6,Math.min(ge,12)),ut=qe<8?6:7,Jt=qe<8?5:6,ct=[];Object.keys(m).sort().forEach((b,A)=>{const D=m[b];D.forEach((K,we)=>{const ee=[];we===0&&ee.push({content:b.toLowerCase(),rowSpan:D.length,styles:{fontStyle:"bold",fontSize:10,halign:"left",valign:"middle",fillColor:[255,255,255]}}),ee.push({content:K.name||"",styles:{fontStyle:"bold",fontSize:9}}),U.forEach(ke=>{let te="";if(Array.isArray(K.allergies)){const le=K.allergies.find(ie=>(ie.name||ie)===ke);if(le){const ie=le.pivot?.type??le.type??null;ie!=null?te=String(ie)==="1"||ie===1?"TICK":"STAR":te=""}}ee.push(te)}),ct.push(ee)})});const Qt=["","",...U];bt(e,{head:[Qt],body:ct,startY:35,styles:{fontSize:ut,cellPadding:1.5,halign:"center",valign:"middle",lineColor:[0,0,0],lineWidth:.1},columnStyles:{0:{halign:"left",cellWidth:F,fontStyle:"bold",fontSize:10},1:{halign:"left",cellWidth:j,fontStyle:"bold",fontSize:9},...Object.fromEntries(U.map((b,A)=>[A+2,{cellWidth:qe}]))},headStyles:{fillColor:[255,255,255],textColor:[0,0,0],fontStyle:"bold",fontSize:Jt,cellPadding:1},alternateRowStyles:{fillColor:[250,250,250]},margin:{left:P,right:y,top:28},didParseCell:function(b){b.section==="head"&&b.column.index>1&&(b.cell.styles.minCellHeight=45,b.cell.text=[]),b.section==="head"&&(b.column.index===0||b.column.index===1)&&(b.cell.text=[]),b.section==="body"&&(b.cell.raw==="TICK"||b.cell.raw==="STAR")&&(b.cell.text=[])},didDrawCell:function(b){if(b.section==="body"&&b.cell.raw==="TICK"){const{x:A,y:D,width:K,height:we}=b.cell,ee=A+K/2,ke=D+we/2,te=ee-1.5,le=ke-.5;e.setDrawColor(0,0,0),e.setLineWidth(.4),e.line(te,le,te+.8,le+1.2),e.line(te+.8,le+1.2,te+2.5,le-1)}if(b.section==="body"&&b.cell.raw==="STAR"){const{x:A,y:D,width:K,height:we}=b.cell,ee=A+K/2,ke=D+we/2;e.setFontSize(10),e.setFont("helvetica","bold"),e.setTextColor(0,0,0),e.text("*",ee,ke+1,{align:"center"})}if(b.section==="head"&&b.column.index>1){const A=U[b.column.index-2];if(A){const D=b.cell.x+b.cell.width/2,K=b.cell.y+b.cell.height-3;e.saveGraphicsState(),e.setFontSize(ut),e.setFont("helvetica","bold"),e.text(A,D,K,{angle:90,align:"left"}),e.restoreGraphicsState()}}},didDrawPage:b=>{const A=e.internal.getNumberOfPages(),D=e.internal.pageSize.height;e.setFontSize(7),e.text(`Page ${b.pageNumber} of ${A}`,14,D-8)}});const el=`allergen_information_${new Date().toISOString().split("T")[0]}.pdf`;e.save(el),_.success("PDF downloaded successfully",{autoClose:2500})}catch(e){console.error("PDF generation error:",e),_.error(`PDF generation failed: ${e.message}`,{autoClose:5e3})}},Wt=l=>{if(!l||l.length<=1){_.error("The imported file is empty.");return}l[0];const i=l.slice(1).map(o=>{let m=0,k=0,U=0,P=0;o[4]&&o[4].split(";").map(j=>j.trim()).forEach(j=>{const[ve,rt]=j.split(":").map(dt=>dt.trim()),ge=parseFloat(rt)||0;ve==="calories"?m=ge:ve==="protein"?k=ge:ve==="fat"?U=ge:ve==="carbs"&&(P=ge)});const y={name:o[0]||"",category:o[1]||"",description:o[2]||"",price:o[3]?parseFloat(o[3]):0,calories:m,protein:k,fat:U,carbs:P,allergies:o[5]?o[5].trim():"",tags:o[6]?o[6].trim():"",label_color:o[7]||null,is_taxable:o[8]?parseInt(o[8]):0,is_saleable:o[9]?parseInt(o[9]):0,resale_type:o[10]||null,resale_value:o[11]?parseFloat(o[11]):null,status:1};if(o[12]&&o[12].trim()!=="")try{y.variant_data=JSON.parse(o[12])}catch(V){console.error("Error parsing variant data:",V),y.variant_data=null}return y}),a=i.map(o=>o.name.trim().toLowerCase()),n=a.filter((o,m)=>a.indexOf(o)!==m);if(n.length>0){_.error(`Duplicate item names found in CSV: ${[...new Set(n)].join(", ")}`);return}const d=ue.value.map(o=>o.name.trim().toLowerCase()),v=i.filter(o=>d.includes(o.name.trim().toLowerCase()));if(v.length>0){const o=v.map(m=>m.name).join(", ");_.error(`Menu items already exist in the table: ${o}`);return}axios.post("/api/menu/menu_items/import",{items:i}).then(()=>{_.success("Items imported successfully");const o=document.querySelector(".modal.show");if(o){const m=bootstrap.Modal.getInstance(o);m&&m.hide()}setTimeout(()=>{document.querySelectorAll(".modal-backdrop").forEach(k=>k.remove()),document.body.classList.remove("modal-open"),document.body.style.overflow="",document.body.style.paddingRight=""},100),He(),ce()}).catch(o=>{console.error(o),_.error(o.response?.data?.message||"Import failed"),setTimeout(()=>{document.querySelectorAll(".modal-backdrop").forEach(k=>k.remove()),document.body.classList.remove("modal-open"),document.body.style.overflow="",document.body.style.paddingRight=""},100)})},N=g({name:"",price:null}),E=g({}),ot=g(1);function Gt(){if(et(),ae.value){if(!N.value.name||!N.value.name.trim()){_.error("Please enter a variant name");return}if(N.value.price===null||N.value.price===""||N.value.price<0){_.error("Please enter a valid variant price");return}if(C.value.length===0){_.error("Please add at least one ingredient");return}let e;J.value!==null?e=J.value:e=ot.value++,I.value[e]=[...C.value],E.value||(E.value={}),E.value[e]={name:N.value.name,price:N.value.price},S.value[e]||(S.value[e]={is_saleable:!1,resale_type:null,resale_value:null}),_.success(`Variant "${N.value.name}" ingredients saved!`),C.value=[],N.value={name:"",price:null},J.value=null}else s.value.ingredients=[...C.value];bootstrap.Modal.getInstance(document.getElementById("addIngredientModal")).hide(),setTimeout(()=>{new bootstrap.Modal(document.getElementById("addItemModal")).show()},300)}const nt=(l=!1)=>{ae.value=l,l?J.value||(N.value={name:"",price:null},C.value=[]):ne.value&&s.value.ingredients&&s.value.ingredients.length>0?C.value=s.value.ingredients.map(i=>{const a=parseFloat(i.quantity||i.qty||0),n=parseFloat(i.cost||0),d=a>0?n/a:0,v=re.value.find(o=>o.id===(i.inventory_item_id||i.id));return{id:i.inventory_item_id||i.id,name:i.product_name||i.name||v?.name||"â€”",category:v?.category||i.category||{name:""},qty:a,unitPrice:d,cost:n,nutrition:i.nutrition||v?.nutrition||{calories:0,protein:0,carbs:0,fat:0}}}):C.value=[];const e=bootstrap.Modal.getInstance(document.getElementById("addItemModal"));e&&e.hide(),setTimeout(()=>{new bootstrap.Modal(document.getElementById("addIngredientModal")).show()},300)},Xt=l=>{J.value=l,I.value[l]?C.value=[...I.value[l]]:C.value=[],E.value[l]?N.value={name:E.value[l].name||"",price:E.value[l].price||null}:N.value={name:xe(l),price:it(l)},ae.value=!0;const e=bootstrap.Modal.getInstance(document.getElementById("addItemModal"));e&&e.hide(),setTimeout(()=>{new bootstrap.Modal(document.getElementById("addIngredientModal")).show()},300)},xe=l=>{if(E.value[l])return E.value[l].name;const e=Ze.value.find(i=>i.id===l);return e?e.name:"Unknown Variant"},it=l=>E.value[l]?E.value[l].price||0:s.value.variant_prices&&s.value.variant_prices[l]?s.value.variant_prices[l]:0,Ht=l=>{const e=xe(l);confirm(`Are you sure you want to delete ingredients for "${e}"?`)&&(delete I.value[l],E.value[l]&&delete E.value[l],_.success("Variant ingredients deleted"))},Yt=["Item Name","Category","Description","Price","Nutrition","Allergies","Tags","Label Color","Is Taxable","Is Saleable","Resale Type","Resale Value","Variant Data"],Kt=[["Chicken Burger","Burgers","Delicious chicken burger","150","calories: 250.00; protein: 20.00; fat: 10.00; carbs: 30.00","Gluten","Halal","#E74C3C","1","0","","",""],["Grilled Chicken","Main Course","Grilled chicken with spices","0","calories: 300.00; protein: 35.00; fat: 15.00; carbs: 0.00","None","Halal","#27AE60","1","1","flat","50",JSON.stringify([{name:"Small",price:200,is_saleable:1,resale_type:"flat",resale_value:40,ingredients:[{inventory_item_id:1,product_name:"Chicken Breast",quantity:.5,cost:100}]},{name:"Large",price:300,is_saleable:1,resale_type:"percentage",resale_value:20,ingredients:[{inventory_item_id:1,product_name:"Chicken Breast",quantity:.75,cost:150}]}])]];return(l,e)=>{const i=sl("ConfirmModal");return r(),Ne(ul,null,{default:Ee(()=>[x(w(ol),{title:"Menus"}),t("div",_l,[e[108]||(e[108]=t("h4",{class:"mb-3"},"Menus",-1)),t("div",yl,[(r(!0),u(L,null,Z(Et.value,a=>(r(),u("div",{key:a.label,class:"col-md-6 col-xl-4"},[t("div",hl,[t("div",xl,[t("div",null,[t("div",wl,p(a.value),1),t("div",kl,p(a.label),1)]),t("div",{class:h(["icon-chip",a.iconBg])},[(r(),Ne(nl(a.icon),{class:h(a.iconColor),size:"26"},null,8,["class"]))],2)])])]))),128))]),t("div",Cl,[t("div",Sl,[t("div",Ml,[e[50]||(e[50]=t("h4",{class:"mb-0"},"Menu",-1)),t("div",Vl,[t("div",$l,[e[46]||(e[46]=t("i",{class:"bi bi-search"},null,-1)),e[47]||(e[47]=t("input",{type:"email",name:"email",autocomplete:"email",style:{position:"absolute",left:"-9999px",width:"1px",height:"1px"},tabindex:"-1","aria-hidden":"true"},null,-1)),Ke.value?$((r(),u("input",{id:Le,"onUpdate:modelValue":e[0]||(e[0]=a=>pe.value=a),key:Ye.value,class:"form-control search-input",placeholder:"Search",type:"search",autocomplete:"new-password",name:Le,role:"presentation",onFocus:e[1]||(e[1]=(...a)=>l.handleFocus&&l.handleFocus(...a))},null,32)),[[O,pe.value]]):(r(),u("input",Il))]),t("div",Fl,[x(vl,{modelValue:M.value,"onUpdate:modelValue":e[2]||(e[2]=a=>M.value=a),title:"Menu Items","modal-id":"menuFilterModal","modal-size":"modal-lg",categories:De.value.categories,"sort-options":De.value.sortOptions,"status-options":De.value.statusOptions,"show-price-range":!0,"show-date-range":!1,"show-category":!1,"show-stock-status":!1,onApply:It,onClear:$t},null,8,["modelValue","categories","sort-options","status-options"])]),t("button",{"data-bs-toggle":"modal",onClick:qt,"data-bs-target":"#addItemModal",class:"d-flex align-items-center gap-1 px-4 btn-sm py-2 rounded-pill btn btn-primary text-white"},[x(w(_t),{class:"w-4 h-4"}),e[48]||(e[48]=z(" Add Menu ",-1))]),x(gl,{label:"Import",sampleHeaders:Yt,sampleData:Kt,onOnImport:Wt}),t("div",Al,[e[49]||(e[49]=t("button",{class:"btn btn-outline-secondary btn-sm rounded-pill py-2 px-4 dropdown-toggle","data-bs-toggle":"dropdown"}," Export ",-1)),t("ul",Nl,[t("li",null,[t("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:e[3]||(e[3]=a=>Ae("allergens"))},"Export Allergen")]),t("li",null,[t("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:e[4]||(e[4]=a=>Ae("pdf"))},"Export as PDF")]),t("li",null,[t("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:e[5]||(e[5]=a=>Ae("excel"))},"Export as Excel")]),t("li",null,[t("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:e[6]||(e[6]=a=>Ae("csv"))}," Export as CSV ")])])])])]),t("div",El,[t("table",Tl,[e[53]||(e[53]=t("thead",{class:"border-top small text-muted"},[t("tr",null,[t("th",null,"S.#"),t("th",null,"Image"),t("th",null,"Menu Name"),t("th",null,"Category"),t("th",null,"Price"),t("th",null,"Status"),t("th",{class:"text-center"},"Action")])],-1)),t("tbody",null,[Y.value?(r(),u("tr",Ul,[...e[51]||(e[51]=[t("td",{colspan:"7",class:"text-center py-5"},[t("div",{class:"d-flex flex-column align-items-center justify-content-center"},[t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")]),t("p",{class:"text-muted mb-0"},"Loading menu items...")])],-1)])])):(r(),u(L,{key:1},[(r(!0),u(L,null,Z(Je.value,(a,n)=>(r(),u("tr",{key:a.id},[t("td",null,p((_e.value-1)*Ve.value+n+1),1),t("td",null,[x(Be,{file:a.image_url||"/assets/img/default.png",alt:a.name,width:50,height:50,custom_class:"cursor-pointer"},null,8,["file","alt"])]),t("td",Pl,p(a.name),1),t("td",Ll,p(a.category?.name||"â€”"),1),t("td",null,p(w(Se)(a.price||0,"GBP")),1),t("td",null,[a.status===0?(r(),u("span",jl,"Inactive")):(r(),u("span",Dl,"Active"))]),t("td",ql,[t("div",Ol,[t("button",{onClick:d=>Lt(a),"data-bs-toggle":"modal",title:"Edit",class:"p-2 rounded-full text-blue-600 hover:bg-blue-100"},[x(w(yt),{class:"w-4 h-4"})],8,Bl),x(i,{title:"Confirm Status Change",message:`Are you sure you want to ${a.status===1?"deactivate":"activate"} this item?`,showStatusButton:!0,status:a.status===1?"active":"inactive",onConfirm:()=>Dt(a)},{trigger:Ee(()=>[t("button",{class:h(["relative inline-flex items-center w-8 h-4 rounded-full transition-colors duration-300 focus:outline-none",a.status===1?"bg-green-500 hover:bg-green-600":"bg-red-400 hover:bg-red-500"]),title:a.status===1?"Set Inactive":"Set Active"},[t("span",{class:h(["absolute left-0.5 top-0.5 w-3 h-3 bg-white rounded-full shadow transform transition-transform duration-300",a.status===1?"translate-x-4":"translate-x-0"])},null,2)],10,Rl)]),_:2},1032,["message","status","onConfirm"])])])]))),128)),Je.value.length===0?(r(),u("tr",Zl,[...e[52]||(e[52]=[t("td",{colspan:"7",class:"text-center text-muted py-4"}," No Menu items found. ",-1)])])):f("",!0)],64))])])]),Pe.value.length>0&&!Y.value?(r(),u("div",zl,[t("div",Wl," Showing "+p((_e.value-1)*Ve.value+1)+" to "+p(Math.min(_e.value*Ve.value,$e.value))+" of "+p($e.value)+" results ",1),x(il,{pagination:Pe.value,isApiDriven:!0,onPageChanged:Mt},null,8,["pagination"])])):f("",!0)])]),t("div",Gl,[t("div",Xl,[t("div",Hl,[t("div",Yl,[t("h5",Kl,p(ne.value==!0?"Edit Menu":"Add Menu"),1),t("button",{onClick:he,class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[...e[54]||(e[54]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",Jl,[t("ul",Ql,[t("li",ea,[t("button",{class:h(["nav-link",{active:H.value==="simple"}]),onClick:e[7]||(e[7]=a=>H.value="simple"),type:"button"}," Simple Menu ",2)]),t("li",ta,[t("button",{class:h(["nav-link",{active:H.value==="variant"}]),onClick:e[8]||(e[8]=a=>H.value="variant"),type:"button"}," Variant Menu ",2)])]),t("div",la,[$(t("div",null,[t("div",aa,[t("div",sa,[e[55]||(e[55]=t("label",{class:"form-label"},"Menu Name",-1)),$(t("input",{"onUpdate:modelValue":e[9]||(e[9]=a=>s.value.name=a),type:"text",class:h(["form-control",{"is-invalid":c.value.name}]),placeholder:"e.g., Chicken Breast"},null,2),[[O,s.value.name]]),c.value.name?(r(),u("small",oa,p(c.value.name[0]),1)):f("",!0)]),t("div",na,[e[56]||(e[56]=t("label",{class:"form-label d-block"},"Base Price",-1)),$(t("input",{"onUpdate:modelValue":e[10]||(e[10]=a=>s.value.price=a),type:"number",min:"0",class:h(["form-control",{"is-invalid":c.value.price}]),placeholder:"e.g., 0.00"},null,2),[[O,s.value.price]]),c.value.price?(r(),u("small",ia,p(c.value.price[0]),1)):f("",!0)]),t("div",ra,[e[57]||(e[57]=t("label",{class:"form-label"},"Is this Taxable Menu?",-1)),x(w(W),{modelValue:s.value.is_taxable,"onUpdate:modelValue":e[11]||(e[11]=a=>s.value.is_taxable=a),options:Re.value,optionLabel:"label",optionValue:"value",placeholder:"Select Option",class:h(["w-100",{"is-invalid":c.value.is_taxable}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","class"]),c.value.is_taxable?(r(),u("small",da,p(c.value.is_taxable[0]),1)):f("",!0)]),t("div",ua,[e[60]||(e[60]=t("label",{class:"form-label"},"Is this Saleable Menu?",-1)),t("div",ca,[t("div",pa,[$(t("input",{"onUpdate:modelValue":e[12]||(e[12]=a=>s.value.is_saleable=a),value:!0,type:"radio",class:"form-check-input",id:"saleable_yes",name:"is_saleable",checked:s.value.is_saleable===!0},null,8,ma),[[be,s.value.is_saleable]]),e[58]||(e[58]=t("label",{class:"form-check-label",for:"saleable_yes"}," Yes ",-1))]),t("div",va,[$(t("input",{"onUpdate:modelValue":e[13]||(e[13]=a=>s.value.is_saleable=a),value:!1,type:"radio",class:"form-check-input",id:"saleable_no",name:"is_saleable",checked:s.value.is_saleable===!1},null,8,ga),[[be,s.value.is_saleable]]),e[59]||(e[59]=t("label",{class:"form-check-label",for:"saleable_no"}," No ",-1))])])]),s.value.is_saleable?(r(),u("div",ba,[e[61]||(e[61]=t("label",{class:"form-label"},"Sale Type",-1)),x(w(W),{modelValue:s.value.resale_type,"onUpdate:modelValue":e[14]||(e[14]=a=>s.value.resale_type=a),options:tt.value,optionLabel:"label",optionValue:"value",placeholder:"Select Resale Type",class:h(["w-100",{"is-invalid":c.value.resale_type}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","class"]),c.value.resale_type?(r(),u("small",fa,p(c.value.resale_type[0]),1)):f("",!0)])):f("",!0),s.value.is_saleable&&s.value.resale_type?(r(),u("div",_a,[t("label",ya,p(s.value.resale_type==="flat"?"Flat Amount":"Percentage"),1),t("div",ha,[$(t("input",{"onUpdate:modelValue":e[15]||(e[15]=a=>s.value.resale_value=a),type:"number",min:"0",step:s.value.resale_type==="flat"?"0.01":"0.1",class:h(["form-control",{"is-invalid":c.value.resale_value}]),placeholder:`Enter ${s.value.resale_type==="flat"?"flat amount":"percentage"}...`},null,10,xa),[[O,s.value.resale_value,void 0,{number:!0}]]),s.value.resale_type==="percentage"?(r(),u("span",wa," % ")):(r(),u("span",ka,p((s.value.price,"Â£")),1))]),c.value.resale_value?(r(),u("small",Ca,p(c.value.resale_value[0]),1)):f("",!0)])):f("",!0),t("div",Sa,[e[62]||(e[62]=t("label",{class:"form-label d-block"}," Label Color ",-1)),x(w(W),{modelValue:s.value.label_color,"onUpdate:modelValue":e[16]||(e[16]=a=>s.value.label_color=a),options:ze,optionLabel:"name",optionValue:"value",placeholder:"Select Label Color",class:h(["w-100",{"is-invalid":c.value.label_color}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","class"]),e[63]||(e[63]=t("br",null,null,-1)),c.value.label_color?(r(),u("small",Ma,p(c.value.label_color[0]),1)):f("",!0)]),t("div",Va,[e[64]||(e[64]=t("label",{class:"form-label"},"Category",-1)),x(w(W),{modelValue:s.value.category_id,"onUpdate:modelValue":[e[17]||(e[17]=a=>s.value.category_id=a),e[18]||(e[18]=a=>s.value.subcategory="")],options:G.categories,optionLabel:"name",optionValue:"id",placeholder:"Select Category",class:h(["w-100",{"is-invalid":c.value.category_id}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","class"]),c.value.category_id?(r(),u("small",$a,p(c.value.category_id[0]),1)):f("",!0)]),t("div",Ia,[e[65]||(e[65]=t("label",{class:"form-label d-block"},"Meals",-1)),x(w(fe),{modelValue:s.value.meals,"onUpdate:modelValue":e[19]||(e[19]=a=>s.value.meals=a),options:G.meals,optionLabel:"name",optionValue:"id",filter:"",placeholder:"Select Meals",class:h(["w-full md:w-80",{"is-invalid":c.value.meals}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","class"]),c.value.meals?(r(),u("small",Fa,p(c.value.meals[0]),1)):f("",!0)]),Qe.value.length?(r(),u("div",Aa,[e[66]||(e[66]=t("label",{class:"form-label"},"Subcategory",-1)),x(w(W),{modelValue:s.value.subcategory,"onUpdate:modelValue":e[20]||(e[20]=a=>s.value.subcategory=a),options:Qe.value,optionLabel:"name",optionValue:"value",placeholder:"Select Subcategory",class:h(["w-100",{"is-invalid":c.value.subcategory}]),appendTo:l.body,autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","appendTo","class"]),c.value.subcategory?(r(),u("small",Na,p(c.value.subcategory[0]),1)):f("",!0)])):f("",!0),t("div",Ea,[e[67]||(e[67]=t("label",{class:"form-label"},"Description",-1)),$(t("textarea",{"onUpdate:modelValue":e[21]||(e[21]=a=>s.value.description=a),rows:"4",class:h(["form-control",{"is-invalid":c.value.description}]),placeholder:"Notes about this product"},null,2),[[O,s.value.description]]),c.value.description?(r(),u("small",Ta,p(c.value.description[0]),1)):f("",!0)])]),t("div",Ua,[t("div",Pa,[e[68]||(e[68]=t("label",{class:"form-label d-block"},"Allergies",-1)),t("div",{onClick:Ge,class:"form-control py-2 px-3",style:{cursor:"pointer"}},[R.value.length===0?(r(),u("span",La," Select Allergies ")):(r(),u("span",ja,[(r(!0),u(L,null,Z(R.value,(a,n)=>(r(),u("span",{key:n,class:"badge text-dark mx-1 d-inline-flex align-items-center"},[z(p(a.name)+" ",1),a.type==="Contain"?(r(),u("span",Da," (âœ”ï¸) ")):(r(),u("span",qa," (*) "))]))),128))]))])]),t("div",Oa,[e[69]||(e[69]=t("label",{class:"form-label d-block"},"Tags (Halal, Haram, etc.)",-1)),x(w(fe),{modelValue:s.value.tags,"onUpdate:modelValue":e[22]||(e[22]=a=>s.value.tags=a),options:G.tags,optionLabel:"name",optionValue:"id",filter:"",placeholder:"Select Tags",class:h(["w-full md:w-80",{"is-invalid":c.value.tags}]),appendTo:"self"},null,8,["modelValue","options","class"]),e[70]||(e[70]=t("br",null,null,-1)),c.value.tags?(r(),u("small",Ba,p(c.value.tags[0]),1)):f("",!0)]),t("div",Ra,[e[71]||(e[71]=t("label",{class:"form-label"},"Addon Group",-1)),x(w(W),{modelValue:s.value.addon_group_id,"onUpdate:modelValue":[e[23]||(e[23]=a=>s.value.addon_group_id=a),Te],options:G.addonGroups,optionLabel:"name",optionValue:"id",placeholder:"Select Addon Group",class:h(["w-100",{"is-invalid":c.value.addon_group_id}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3,showClear:""},null,8,["modelValue","options","class"]),c.value.addon_group_id?(r(),u("small",Za,p(c.value.addon_group_id[0]),1)):f("",!0)]),X.value&&X.value.length>0?(r(),u("div",za,[e[72]||(e[72]=t("label",{class:"form-label"},"Select Addons",-1)),x(w(fe),{modelValue:s.value.addon_ids,"onUpdate:modelValue":e[24]||(e[24]=a=>s.value.addon_ids=a),options:X.value,optionLabel:"name",optionValue:"id",filter:"",placeholder:"Select Addons",class:h(["w-full",{"is-invalid":c.value.addon_ids}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},{option:Ee(a=>[t("div",Wa,[t("span",null,p(a.option.name),1),t("span",Ga,p(w(Se)(a.option.price)),1)])]),_:1},8,["modelValue","options","class"]),c.value.addon_ids?(r(),u("small",Xa,p(c.value.addon_ids[0]),1)):f("",!0)])):f("",!0)]),t("div",Ha,[t("div",Ya,[t("div",{class:h(["logo-card",{"is-invalid":c.value.image}])},[t("div",{class:"logo-frame",onClick:e[25]||(e[25]=a=>s.value.imageUrl?lt():oe.value=!0)},[s.value.imageUrl?(r(),u("img",{key:0,src:s.value.imageUrl,alt:"Menu Item Image"},null,8,Ka)):(r(),u("div",Ja,[...e[73]||(e[73]=[t("i",{class:"bi bi-image"},null,-1)])]))]),e[74]||(e[74]=t("small",{class:"text-muted mt-2 d-block"},"Upload Image",-1)),x(mt,{show:oe.value,onClose:e[26]||(e[26]=a=>oe.value=!1),onCropped:at},null,8,["show"]),Q.value?(r(),Ne(Be,{key:0,show:Q.value,image:ye.value,onClose:e[27]||(e[27]=a=>Q.value=!1)},null,8,["show","image"])):f("",!0)],2)]),t("div",Qa,[t("button",{class:h(["btn btn-primary rounded-pill px-4",{"is-invalid":c.value.ingredients}]),onClick:e[28]||(e[28]=a=>nt(!1))},p(ne.value==!0?"Ingredients":"+ Add Ingredients"),3),c.value.ingredients?(r(),u("small",es,p(c.value.ingredients[0]),1)):f("",!0),C.value.length>0?(r(),u("div",ts,[t("div",ls,[t("div",as,[e[75]||(e[75]=t("div",{class:"mb-2"}," Total Nutrition (Menu) ",-1)),t("div",ss,[t("span",os," Calories: "+p(T.value.calories),1),t("span",ns," Protein: "+p(T.value.protein)+" g ",1),t("span",is," Carbs: "+p(T.value.carbs)+" g ",1),t("span",rs," Fat: "+p(T.value.fat)+" g ",1)])])]),t("div",ds,[t("div",us,[t("table",cs,[e[76]||(e[76]=t("thead",null,[t("tr",null,[t("th",null,"Name"),t("th",null,"Qty")])],-1)),t("tbody",null,[(r(!0),u(L,null,Z(C.value,(a,n)=>(r(),u("tr",{key:n},[t("td",null,p(a.name),1),t("td",null,p(a.qty),1)]))),128))])])])])])):f("",!0)])])],512),[[vt,H.value==="simple"]]),$(t("div",null,[t("div",ps,[t("div",ms,[e[77]||(e[77]=t("label",{class:"form-label"},"Menu Name",-1)),$(t("input",{"onUpdate:modelValue":e[29]||(e[29]=a=>s.value.name=a),type:"text",class:h(["form-control",{"is-invalid":c.value.name}]),placeholder:"e.g., Chicken Breast"},null,2),[[O,s.value.name]]),c.value.name?(r(),u("small",vs,p(c.value.name[0]),1)):f("",!0)]),t("div",gs,[e[78]||(e[78]=t("label",{class:"form-label"},"Is this Taxable Menu?",-1)),x(w(W),{modelValue:s.value.is_taxable,"onUpdate:modelValue":e[30]||(e[30]=a=>s.value.is_taxable=a),options:Re.value,optionLabel:"label",optionValue:"value",placeholder:"Select Option",class:h(["w-100",{"is-invalid":c.value.is_taxable}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","class"]),c.value.is_taxable?(r(),u("small",bs,p(c.value.is_taxable[0]),1)):f("",!0)]),t("div",fs,[e[79]||(e[79]=t("label",{class:"form-label d-block"},"Label Color",-1)),x(w(W),{modelValue:s.value.label_color,"onUpdate:modelValue":e[31]||(e[31]=a=>s.value.label_color=a),options:ze,optionLabel:"name",optionValue:"value",placeholder:"Select Label Color",class:h(["w-100",{"is-invalid":c.value.label_color}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","class"]),c.value.label_color?(r(),u("small",_s,p(c.value.label_color[0]),1)):f("",!0)]),t("div",ys,[e[80]||(e[80]=t("label",{class:"form-label"},"Category",-1)),x(w(W),{modelValue:s.value.category_id,"onUpdate:modelValue":e[32]||(e[32]=a=>s.value.category_id=a),options:G.categories,optionLabel:"name",optionValue:"id",placeholder:"Select Category",class:h(["w-100",{"is-invalid":c.value.category_id}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","class"]),c.value.category_id?(r(),u("small",hs,p(c.value.category_id[0]),1)):f("",!0)]),t("div",xs,[e[81]||(e[81]=t("label",{class:"form-label d-block"},"Meals",-1)),x(w(fe),{modelValue:s.value.meals,"onUpdate:modelValue":e[33]||(e[33]=a=>s.value.meals=a),options:G.meals,optionLabel:"name",optionValue:"id",filter:"",placeholder:"Select Meals",class:h(["w-full md:w-80",{"is-invalid":c.value.meals}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","class"]),c.value.meals?(r(),u("small",ws,p(c.value.meals[0]),1)):f("",!0)]),t("div",ks,[e[82]||(e[82]=t("label",{class:"form-label"},"Description",-1)),$(t("textarea",{"onUpdate:modelValue":e[34]||(e[34]=a=>s.value.description=a),rows:"4",class:"form-control",placeholder:"Notes about this product"},null,512),[[O,s.value.description]])])]),t("div",Cs,[t("div",Ss,[e[83]||(e[83]=t("label",{class:"form-label d-block"},"Allergies",-1)),t("div",{onClick:Ge,class:"form-control py-2 px-3",style:{cursor:"pointer"}},[R.value.length===0?(r(),u("span",Ms," Select Allergies ")):(r(),u("span",Vs,[(r(!0),u(L,null,Z(R.value,(a,n)=>(r(),u("span",{key:n,class:"badge text-dark mx-1 d-inline-flex align-items-center"},[z(p(a.name)+" ",1),a.type==="Contain"?(r(),u("span",$s," (âœ”ï¸) ")):(r(),u("span",Is," (*) "))]))),128))]))])]),t("div",Fs,[e[84]||(e[84]=t("label",{class:"form-label d-block"},"Tags (Halal, Haram, etc.)",-1)),x(w(fe),{modelValue:s.value.tags,"onUpdate:modelValue":e[35]||(e[35]=a=>s.value.tags=a),options:G.tags,optionLabel:"name",optionValue:"id",filter:"",placeholder:"Select Tags",class:h(["w-full md:w-80",{"is-invalid":c.value.tags}]),appendTo:"self"},null,8,["modelValue","options","class"]),c.value.tags?(r(),u("small",As,p(c.value.tags[0]),1)):f("",!0)]),t("div",Ns,[e[85]||(e[85]=t("label",{class:"form-label"},"Addon Group",-1)),x(w(W),{modelValue:s.value.addon_group_id,"onUpdate:modelValue":[e[36]||(e[36]=a=>s.value.addon_group_id=a),Te],options:G.addonGroups,optionLabel:"name",optionValue:"id",placeholder:"Select Addon Group",class:h(["w-100",{"is-invalid":c.value.addon_group_id}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3,showClear:""},null,8,["modelValue","options","class"]),c.value.addon_group_id?(r(),u("small",Es,p(c.value.addon_group_id[0]),1)):f("",!0)]),X.value&&X.value.length>0?(r(),u("div",Ts,[e[86]||(e[86]=t("label",{class:"form-label"},"Select Addons",-1)),x(w(fe),{modelValue:s.value.addon_ids,"onUpdate:modelValue":e[37]||(e[37]=a=>s.value.addon_ids=a),options:X.value,optionLabel:"name",optionValue:"id",filter:"",placeholder:"Select Addons",class:h(["w-full",{"is-invalid":c.value.addon_ids}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},{option:Ee(a=>[t("div",Us,[t("span",null,p(a.option.name),1),t("span",Ps,p(w(Se)(a.option.price)),1)])]),_:1},8,["modelValue","options","class"]),c.value.addon_ids?(r(),u("small",Ls,p(c.value.addon_ids[0]),1)):f("",!0)])):f("",!0)]),t("div",js,[t("div",Ds,[t("div",qs,[t("button",{onClick:e[38]||(e[38]=a=>nt(!0)),class:"d-flex align-items-center gap-1 px-4 py-2 rounded-pill btn btn-primary text-white"},[x(w(_t),{class:"w-4 h-4 me-1"}),e[87]||(e[87]=z(" Add Variant Ingredients ",-1))])])]),Object.keys(I.value).length>0?(r(),u("div",Os,[e[90]||(e[90]=t("h6",{class:"fw-semibold mb-3"},[t("i",{class:"bi bi-card-list me-2"}),z("Saved Variant Ingredients ")],-1)),t("div",Bs,[(r(!0),u(L,null,Z(I.value,(a,n)=>(r(),u("div",{key:n,class:"col-lg-6 col-md-12"},[t("div",Rs,[t("div",Zs,[t("div",zs,[t("div",Ws,[t("h6",Gs,[e[88]||(e[88]=t("i",{class:"bi bi-tag me-2"},null,-1)),z(" "+p(xe(n)),1)]),t("small",Xs," Price: "+p(w(Se)(it(n))),1)]),t("div",Hs,[t("button",{onClick:d=>Xt(n),class:"btn btn-primary btn-sm",style:{height:"32px !important"},title:"Edit ingredients"},[x(w(yt),{class:"w-4 h-4"})],8,Ys),t("button",{onClick:d=>Ht(n),class:"btn btn-danger btn-sm",style:{height:"32px !important"},title:"Delete variant"},[x(w(ft),{class:"w-4 h-4"})],8,Ks)])])]),t("div",Js,[t("div",Qs,[t("div",eo,[t("span",to," Calories: "+p(a.reduce((d,v)=>d+Number(v.nutrition?.calories||0)*Number(v.qty||0),0).toFixed(2)),1),t("span",lo," Protein: "+p(a.reduce((d,v)=>d+Number(v.nutrition?.protein||0)*Number(v.qty||0),0).toFixed(2))+" g ",1),t("span",ao," Carbs: "+p(a.reduce((d,v)=>d+Number(v.nutrition?.carbs||0)*Number(v.qty||0),0).toFixed(2))+" g ",1),t("span",so," Fat: "+p(a.reduce((d,v)=>d+Number(v.nutrition?.fat||0)*Number(v.qty||0),0).toFixed(2))+" g ",1)])]),t("div",oo,[t("table",no,[e[89]||(e[89]=t("thead",{class:"table-light"},[t("tr",null,[t("th",{class:"small"},"Name"),t("th",{class:"small"},"Qty")])],-1)),t("tbody",null,[(r(!0),u(L,null,Z(a,(d,v)=>(r(),u("tr",{key:v},[t("td",io,p(d.name),1),t("td",ro,p(d.qty),1)]))),128))])])])])])]))),128))])])):f("",!0)]),t("div",uo,[t("div",co,[e[93]||(e[93]=t("label",{class:"form-label fw-semibold"},"Menu Image",-1)),t("div",{class:h(["logo-card",{"is-invalid":c.value.image}])},[t("div",{class:"logo-frame",onClick:e[39]||(e[39]=a=>s.value.imageUrl?lt():oe.value=!0)},[s.value.imageUrl?(r(),u("img",{key:0,src:s.value.imageUrl,alt:"Menu Item Image"},null,8,po)):(r(),u("div",mo,[...e[91]||(e[91]=[t("i",{class:"bi bi-image"},null,-1)])]))]),e[92]||(e[92]=t("small",{class:"text-muted mt-2 d-block"},"Upload Image",-1)),x(mt,{show:oe.value,onClose:e[40]||(e[40]=a=>oe.value=!1),onCropped:at},null,8,["show"]),Q.value?(r(),Ne(Be,{key:0,show:Q.value,image:ye.value,onClose:e[41]||(e[41]=a=>Q.value=!1)},null,8,["show","image"])):f("",!0)],2)])]),t("div",vo,[e[97]||(e[97]=t("h6",{class:"fw-semibold mb-3"},[t("i",{class:"bi bi-cash-coin me-2"}),z("Sale Settings ")],-1)),Object.keys(I.value).length>0?(r(),u("div",go,[(r(!0),u(L,null,Z(I.value,(a,n)=>(r(),u("div",{key:n,class:"col-md-6"},[t("div",bo,[t("div",fo,[t("h6",_o,p(xe(n)),1)]),t("div",yo,[t("div",ho,[e[94]||(e[94]=t("label",{class:"form-label small fw-semibold"},"Enable Sale?",-1)),t("div",xo,[t("div",wo,[$(t("input",{id:`variant_saleable_yes_${n}`,type:"radio",class:"form-check-input",value:!0,name:`variant_saleable_${n}`,"onUpdate:modelValue":d=>S.value[n].is_saleable=d,checked:S.value[n].is_saleable===!0},null,8,ko),[[be,S.value[n].is_saleable]]),t("label",{class:"form-check-label small",for:`variant_saleable_yes_${n}`}," Yes ",8,Co)]),t("div",So,[$(t("input",{id:`variant_saleable_no_${n}`,type:"radio",class:"form-check-input",value:!1,name:`variant_saleable_${n}`,"onUpdate:modelValue":d=>S.value[n].is_saleable=d,checked:S.value[n].is_saleable===!1},null,8,Mo),[[be,S.value[n].is_saleable]]),t("label",{class:"form-check-label small",for:`variant_saleable_no_${n}`}," No ",8,Vo)])])]),S.value[n].is_saleable?(r(),u("div",$o,[t("div",Io,[e[95]||(e[95]=t("label",{class:"form-label small"},"Sale Type",-1)),x(w(W),{modelValue:S.value[n].resale_type,"onUpdate:modelValue":d=>S.value[n].resale_type=d,options:tt.value,optionLabel:"label",optionValue:"value",placeholder:"Select",class:"w-100",style:{fontSize:"0.875rem"},appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","onUpdate:modelValue","options"])]),t("div",Fo,[t("label",Ao,p(S.value[n].resale_type==="flat"?"Flat Amount":"Percentage"),1),t("div",No,[$(t("input",{"onUpdate:modelValue":d=>S.value[n].resale_value=d,type:"number",min:"0",step:S.value[n].resale_type==="flat"?"0.01":"0.1",class:"form-control py-2",placeholder:`Enter ${S.value[n].resale_type==="flat"?"amount":"%"}`},null,8,Eo),[[O,S.value[n].resale_value,void 0,{number:!0}]]),t("span",To,p(S.value[n].resale_type==="percentage"?"%":"Â£"),1)])])])):f("",!0)])])]))),128))])):(r(),u("div",Uo,[...e[96]||(e[96]=[t("i",{class:"bi bi-info-circle me-2"},null,-1),z(" Add variant ingredients first to configure resale settings. ",-1)])]))])],512),[[vt,H.value==="variant"]])]),t("div",Po,[t("button",{class:"btn btn-primary rounded-pill btn-sm px-5 py-2",disabled:me.value,onClick:e[42]||(e[42]=a=>s.value.id?jt():Ut())},[me.value?(r(),u(L,{key:0},[e[98]||(e[98]=t("span",{class:"spinner-border spinner-border-sm me-2"},null,-1)),z(" "+p(s.value.id?"Saving...":"saving..."),1)],64)):(r(),u(L,{key:1},[z(p((s.value.id,"Save")),1)],64))],8,Lo),t("button",{class:"btn btn-secondary btn-sm rounded-pill py-2 px-4 ms-2","data-bs-dismiss":"modal",onClick:he}," Cancel ")])])])])]),se.value?(r(),u("div",{key:0,class:h(["modal fade",{show:se.value}]),id:"allergyModal",tabindex:"-1",style:rl({display:se.value?"block":"none"}),"aria-hidden":"true"},[t("div",jo,[t("div",Do,[t("div",{class:"modal-header bg-light border-bottom"},[e[100]||(e[100]=t("h5",{class:"modal-title fw-bold"},"Select Allergies",-1)),t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110",onClick:We,"data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[...e[99]||(e[99]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",qo,[t("table",Oo,[e[101]||(e[101]=t("thead",{class:"table-light"},[t("tr",null,[t("th",{class:"fw-semibold"},"Allergy"),t("th",{class:"fw-semibold"},"Contain"),t("th",{class:"fw-semibold"},"Trace")])],-1)),t("tbody",null,[(r(!0),u(L,null,Z(G.allergies,a=>(r(),u("tr",{key:a.id},[t("td",Bo,p(a.name),1),t("td",null,[$(t("input",{type:"radio",name:"allergy-"+a.id,value:"Contain","onUpdate:modelValue":n=>B.value[a.id]=n,class:"form-check-input",style:{width:"20px",height:"20px"}},null,8,Ro),[[be,B.value[a.id]]])]),t("td",null,[$(t("input",{type:"radio",name:"allergy-"+a.id,value:"Trace","onUpdate:modelValue":n=>B.value[a.id]=n,class:"form-check-input",style:{width:"20px",height:"20px"}},null,8,Zo),[[be,B.value[a.id]]])])]))),128))])])]),t("div",{class:"modal-footer bg-light border-top"},[t("button",{class:"btn btn-secondary px-2 py-2",onClick:We}," Cancel "),t("button",{class:"btn btn-primary px-2 py-2",onClick:xt}," Save ")])])])],6)):f("",!0),se.value?(r(),u("div",zo)):f("",!0),t("div",Wo,[t("div",Go,[t("div",Xo,[t("div",Ho,[t("h5",Yo,[z(p(ne.value==!0?"Edit Ingredients":"Add Ingredients")+" ",1),ae.value&&J.value?(r(),u("span",Ko,p(xe(J.value)),1)):f("",!0)]),t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",onClick:St,title:"Close"},[...e[102]||(e[102]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",Jo,[t("div",Qo,[ae.value?(r(),u("div",en,[t("div",tn,[t("div",ln,[e[103]||(e[103]=t("label",{class:"form-label"},"Variant Name",-1)),$(t("input",{"onUpdate:modelValue":e[43]||(e[43]=a=>N.value.name=a),type:"text",class:"form-control",placeholder:"Enter custom variant name"},null,512),[[O,N.value.name]])]),t("div",an,[e[104]||(e[104]=t("label",{class:"form-label"},"Variant Price",-1)),$(t("input",{"onUpdate:modelValue":e[44]||(e[44]=a=>N.value.price=a),type:"number",min:"0",step:"0.01",class:"form-control",placeholder:"Enter variant price"},null,512),[[O,N.value.price,void 0,{number:!0}]])])])])):f("",!0),t("div",sn,[t("div",on,[$(t("input",{"onUpdate:modelValue":e[45]||(e[45]=a=>Ue.value=a),type:"text",class:"form-control search-input",placeholder:"Search Items..."},null,512),[[O,Ue.value]])]),(r(!0),u(L,null,Z(st.value,a=>(r(),u("div",{key:a.id,class:"card shadow-sm border-0 rounded-4 mb-3"},[t("div",nn,[t("div",rn,[t("img",{src:a.image_url?`${a.image_url}`:"/assets/img/default.png",class:"rounded",style:{width:"56px",height:"56px","object-fit":"cover",border:"1px solid white"}},null,8,dn),t("div",un,[t("div",cn,p(a?.name),1),t("div",pn,"Category: "+p(a.category?.name),1),t("div",mn,"Unit: "+p(a?.unit_name),1),t("div",vn," Calories: "+p(a.nutrition?.calories||0)+", Protein: "+p(a.nutrition?.protein||0)+", Carbs: "+p(a.nutrition?.carbs||0)+", Fat: "+p(a.nutrition?.fat||0),1)]),t("button",{class:"btn btn-primary btn-sm py-2 px-4 rounded-pill",onClick:n=>kt(a)},p(C.value.some(n=>n.id===a.id)?"Update":"Add"),9,gn)]),t("div",bn,[t("div",fn,[e[105]||(e[105]=t("label",{class:"small text-muted"},"Quantity",-1)),$(t("input",{"onUpdate:modelValue":n=>a.qty=n,type:"number",min:"0",class:"form-control form-control-sm"},null,8,_n),[[O,a.qty,void 0,{number:!0}]]),c.value[a.id]?.qty?(r(),u("small",yn,p(c.value[a.id].qty),1)):f("",!0)])])])]))),128))]),t("div",hn,[t("div",xn,[t("div",wn,[t("div",null,"Total Nutrition ("+p(ae.value?"Variant":"Menu")+")",1),t("div",null,"Calories: "+p(T.value.calories),1),t("div",null,"Protein: "+p(T.value.protein)+" g",1),t("div",null,"Carbs: "+p(T.value.carbs)+" g",1),t("div",null,"Fat: "+p(T.value.fat)+" g",1)])]),t("div",kn,[t("div",Cn,[t("table",Sn,[e[107]||(e[107]=t("thead",null,[t("tr",null,[t("th",null,"Name"),t("th",null,"Qty"),t("th",{class:"text-end"},"Action")])],-1)),t("tbody",null,[(r(!0),u(L,null,Z(C.value,(a,n)=>(r(),u("tr",{key:n},[t("td",null,p(a.name),1),t("td",null,p(a.qty),1),t("td",Mn,[t("button",{class:"btn btn-sm btn-danger",onClick:d=>Ct(n)}," Remove ",8,Vn)])]))),128)),C.value.length===0?(r(),u("tr",$n,[...e[106]||(e[106]=[t("td",{colspan:"6",class:"text-center text-muted py-3"}," No ingredients added. ",-1)])])):f("",!0)])])])]),t("div",{class:"mt-3 text-center"},[t("button",{class:"btn btn-primary btn-sm py-2 px-5 rounded-pill",onClick:Gt}," Done ")])])])])])])])])]),_:1})}}},Qn=tl(In,[["__scopeId","data-v-800d64d1"]]);export{Qn as default};
