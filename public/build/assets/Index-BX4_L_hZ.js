import{_ as wa,r as b,c as D,o as Ke,n as xl,s as v,w as Pe,I as ka,E as Ca,a as Ve,b as d,d as $e,e as x,f as l,u as y,h as Ia,g as u,l as m,F as E,i as O,t as c,j as f,k as Ma,m as C,v as N,p as K,W as qe,P as Sa,Z as ke,X as He,ae as Qe,K as Va,Y as $a}from"./app-Cc-dChBz.js";import{_ as Aa}from"./Master-eAdtZlez.js";import{s as le}from"./index-BK43Mpbs.js";import{s as ae}from"./index-BOM48sd4.js";import{E as wl,a as kl,X as Ea,u as Ae,w as Fa}from"./xlsx-CS2n1QZs.js";import{u as Ta}from"./useFormatters-BFnLb0rR.js";import{F as Ua}from"./FilterModal-BdjIlKvy.js";import{I as Na}from"./importFile-D0bb1m2T.js";import{s as Pa}from"./index-D5eadvGB.js";import{P as qa}from"./package-NtCN3LEx.js";import{C as Da}from"./circle-check-big-DxQXGpH0.js";import{C as Cl}from"./circle-x-Bly4NCf4.js";import{P as Il}from"./plus-ChoKOJw5.js";import{P as Ml}from"./pencil-ugklGrYG.js";import"./index-7lFnmn3u.js";import"./createLucideIcon-gbYBBr64.js";import"./index-DZnH082G.js";import"./index-UELNzy9_.js";import"./sun-4gNgzfwy.js";import"./index-CBr-ZXxh.js";import"./index-Bf0AmDlV.js";import"./index-gfnLJ7EX.js";import"./index-CsaMXCuL.js";const La={class:"page-wrapper"},ja={class:"row g-3"},Ba={class:"card border-0 shadow-sm rounded-4"},Oa={class:"card-body d-flex align-items-center justify-content-between"},Za={class:"fw-bold fs-4"},Ra={class:"text-muted fs-6"},za={class:"card border-0 shadow-lg rounded-4 mt-0"},Wa={class:"card-body"},Ga={class:"d-flex flex-wrap gap-2 justify-content-between align-items-center mb-3"},Xa={class:"d-flex flex-wrap gap-2 align-items-center"},Ya={class:"search-wrap"},Ka={key:1,class:"form-control search-input",placeholder:"Search",disabled:"",type:"text"},Ha={class:"dropdown"},Qa={class:"table-responsive"},Ja={class:"table table-hover"},et={key:0},lt={class:"fw-semibold"},at={class:"text-truncate",style:{"max-width":"260px"}},tt={key:0,class:"badge bg-red-600 rounded-pill d-inline-block text-center px-3 py-1"},st={key:1,class:"badge bg-success rounded-pill d-inline-block text-center px-3 py-1"},ot={class:"text-center"},nt={class:"d-inline-flex align-items-center gap-3"},it=["onClick"],rt=["title"],dt={key:0},ut={key:0,class:"mt-4 d-flex justify-between"},ct={class:"text-center mt-3 text-sm"},pt={class:"modal fade",id:"addItemModal",tabindex:"-1","aria-hidden":"true"},mt={class:"modal-dialog modal-lg modal-dialog-centered",role:"document"},vt={class:"modal-content rounded-4"},gt={class:"modal-header"},_t={class:"modal-title fw-semibold"},bt={class:"modal-body"},ft={class:"nav nav-tabs mb-4",role:"tablist"},yt={class:"nav-item",role:"presentation"},ht={class:"nav-item",role:"presentation"},xt={class:"nav-item",role:"presentation"},wt={class:"tab-content"},kt={class:"row g-3"},Ct={class:"col-md-6"},It={key:0,class:"text-danger"},Mt={class:"col-md-6"},St={key:0,class:"text-danger"},Vt={class:"col-md-6"},$t={key:0,class:"text-danger"},At={class:"col-md-6"},Et={class:"d-flex gap-3"},Ft={class:"form-check"},Tt=["checked"],Ut={class:"form-check"},Nt=["checked"],Pt={key:0,class:"col-md-6"},qt={key:0,class:"text-danger"},Dt={key:1,class:"col-md-6"},Lt={class:"form-label"},jt={class:"input-group"},Bt=["step","placeholder"],Ot={key:0,class:"input-group-text"},Zt={key:1,class:"input-group-text"},Rt={key:0,class:"text-danger"},zt={class:"col-md-6"},Wt={key:0,class:"text-danger"},Gt={class:"col-md-6"},Xt={key:0,class:"text-danger"},Yt={class:"col-md-6"},Kt={key:0,class:"text-danger"},Ht={key:2,class:"col-md-6"},Qt={key:0,class:"text-danger"},Jt={class:"col-12"},es={key:0,class:"text-danger"},ls={class:"row g-4 mt-1"},as={class:"col-md-6"},ts={key:0,class:"text-muted"},ss={key:1},os={key:0,class:"ms-1",style:{color:"#22c55e","font-weight":"bold"}},ns={key:1,class:"ms-1",style:{color:"#f97316","font-weight":"bold"}},is={class:"col-md-6"},rs={key:0,class:"text-danger"},ds={class:"col-md-12"},us={key:0,class:"text-danger"},cs={key:0,class:"col-md-12"},ps={class:"d-flex justify-content-between align-items-center w-100"},ms={class:"badge bg-primary"},vs={key:0,class:"text-danger"},gs={class:"row g-3 mt-2 align-items-center"},_s={class:"col-md-4"},bs=["src"],fs={key:1,class:"placeholder"},ys={class:"mt-4 col-sm-6 col-md-8"},hs={key:0,class:"text-danger d-block mt-1"},xs={key:1,class:"mt-3"},ws={class:"card border rounded-4 mb-3"},ks={class:"p-3 fw-semibold"},Cs={class:"d-flex flex-wrap gap-2"},Is={class:"badge bg-primary px-3 py-2 rounded-pill"},Ms={class:"badge bg-success px-3 py-2 rounded-pill"},Ss={class:"badge bg-warning text-dark px-3 py-2 rounded-pill"},Vs={class:"badge bg-danger px-3 py-2 rounded-pill"},$s={class:"card border rounded-4"},As={class:"table-responsive"},Es={class:"table align-middle mb-0"},Fs={class:"row g-3"},Ts={class:"col-md-6"},Us={key:0,class:"text-danger"},Ns={class:"col-md-6"},Ps={key:0,class:"text-danger"},qs={class:"col-md-6"},Ds={key:0,class:"text-danger"},Ls={class:"col-md-6"},js={key:0,class:"text-danger"},Bs={class:"col-md-6"},Os={key:0,class:"text-danger"},Zs={class:"col-12"},Rs={class:"row g-4 mt-1"},zs={class:"col-md-6"},Ws={key:0,class:"text-muted"},Gs={key:1},Xs={key:0,class:"ms-1",style:{color:"#22c55e","font-weight":"bold"}},Ys={key:1,class:"ms-1",style:{color:"#f97316","font-weight":"bold"}},Ks={class:"col-md-6"},Hs={key:0,class:"text-danger"},Qs={class:"col-md-12"},Js={key:0,class:"text-danger"},eo={key:0,class:"col-md-12"},lo={class:"d-flex justify-content-between align-items-center w-100"},ao={class:"badge bg-primary"},to={key:0,class:"text-danger"},so={class:"mt-4"},oo={class:"row g-3 mb-3"},no={class:"col-md-12"},io={key:0},ro={class:"row g-3"},uo={class:"card border rounded-4 shadow-sm h-100"},co={class:"card-header custom-card-header bg-light"},po={class:"d-flex justify-content-between align-items-center"},mo={class:"d-flex gap-4"},vo={class:"mb-0 fw-semibold"},go={class:"text-muted"},_o={class:"d-flex gap-2"},bo=["onClick"],fo=["onClick"],yo={class:"card-body custom-card-body"},ho={class:"mb-3"},xo={class:"d-flex flex-wrap gap-2"},wo={class:"badge bg-primary px-1 py-1 rounded-pill small"},ko={class:"badge bg-success px-1 py-1 rounded-pill small"},Co={class:"badge bg-warning text-dark px-1 py-1 rounded-pill small"},Io={class:"badge bg-danger px-1 py-1 rounded-pill small"},Mo={class:"table-responsive"},So={class:"table table-sm align-middle mb-0"},Vo={class:"small"},$o={class:"small"},Ao={class:"row g-3 mt-3 align-items-center"},Eo={class:"col-md-4"},Fo=["src"],To={key:1,class:"placeholder"},Uo={class:"mt-4"},No={key:0,class:"row g-3"},Po={class:"card border rounded-3 shadow-sm"},qo={class:"card-header bg-light py-2"},Do={class:"mb-0 fw-semibold small"},Lo={class:"card-body"},jo={class:"mb-3"},Bo={class:"d-flex gap-3"},Oo={class:"form-check"},Zo=["id","name","onUpdate:modelValue","checked"],Ro=["for"],zo={class:"form-check"},Wo=["id","name","onUpdate:modelValue","checked"],Go=["for"],Xo={key:0,class:"row g-2"},Yo={class:"col-6"},Ko={class:"col-6"},Ho={class:"form-label small"},Qo={class:"input-group input-group-sm"},Jo=["onUpdate:modelValue","step","placeholder"],en={class:"input-group-text small"},ln={key:1,class:"alert alert-info small",role:"alert"},an={class:"row g-3"},tn={class:"col-md-6"},sn={key:0,class:"text-danger"},on={class:"col-md-6"},nn={key:0,class:"text-danger"},rn={class:"col-md-6"},dn={key:0,class:"text-danger"},un={class:"col-md-6"},cn={key:0,class:"text-danger"},pn={class:"col-md-6"},mn={key:0,class:"text-danger"},vn={class:"col-md-6"},gn={key:0,class:"text-danger"},_n={class:"col-12"},bn={key:0,class:"text-danger"},fn={class:"row g-4 mt-1"},yn={class:"col-md-6"},hn={key:0,class:"text-muted"},xn={key:1},wn={key:0,class:"ms-1",style:{color:"#22c55e","font-weight":"bold"}},kn={key:1,class:"ms-1",style:{color:"#f97316","font-weight":"bold"}},Cn={class:"col-md-6"},In={key:0,class:"text-danger"},Mn={class:"col-md-12"},Sn={key:0,class:"text-danger"},Vn={key:0,class:"col-md-12"},$n={class:"d-flex justify-content-between align-items-center w-100"},An={class:"badge bg-primary"},En={key:0,class:"text-danger"},Fn={class:"row g-3 mt-2 align-items-center"},Tn={class:"col-md-4"},Un=["src"],Nn={key:1,class:"placeholder"},Pn={class:"mt-4 col-sm-6 col-md-8"},qn={key:0,class:"text-danger d-block mt-1"},Dn={key:1,class:"mt-3"},Ln={class:"card border rounded-4 mb-3"},jn={class:"p-3 fw-semibold"},Bn={class:"d-flex flex-wrap gap-2"},On={class:"badge bg-primary px-3 py-2 rounded-pill"},Zn={class:"badge bg-success px-3 py-2 rounded-pill"},Rn={key:0,class:"badge bg-warning text-dark px-3 py-2 rounded-pill"},zn={class:"card border rounded-4"},Wn={class:"table-responsive"},Gn={class:"table align-middle mb-0"},Xn={class:"mt-4"},Yn=["disabled"],Kn={class:"modal-dialog modal-lg modal-dialog-centered"},Hn={class:"modal-content rounded-4 shadow-lg border border-secondary"},Qn={class:"modal-body p-4",style:{border:"2px solid #dee2e6","border-radius":"10px","background-color":"#f8f9fa"}},Jn={class:"table table-bordered text-center align-middle mb-0",style:{border:"1px solid #dee2e6"}},ei={class:"text-start ps-4"},li=["name","onUpdate:modelValue"],ai=["name","onUpdate:modelValue"],ti={key:1,class:"modal-backdrop fade show"},si={class:"modal fade",id:"addIngredientModal",tabindex:"-1","aria-hidden":"true"},oi={class:"modal-dialog modal-xl modal-dialog-centered"},ni={class:"modal-content rounded-4"},ii={class:"modal-header"},ri={class:"modal-title fw-semibold"},di={key:0,class:"badge bg-primary ms-2"},ui={class:"modal-body"},ci={class:"row g-4"},pi={key:0,class:"rounded-4 mb-3"},mi={class:"row g-3"},vi={class:"col-md-6"},gi={class:"col-md-6"},_i={class:"col-lg-5"},bi={class:"search-wrap mb-2"},fi={class:"card-body"},yi={class:"d-flex align-items-start gap-3"},hi=["src"],xi={class:"flex-grow-1"},wi={class:"fw-semibold"},ki={class:"text-muted small"},Ci={class:"text-muted small"},Ii={class:"small mt-2 text-muted"},Mi=["onClick"],Si={class:"row g-2 mt-3"},Vi={class:"col-4"},$i=["onUpdate:modelValue"],Ai={key:0,class:"text-danger"},Ei={class:"col-lg-7"},Fi={class:"card border rounded-4 mb-3"},Ti={class:"p-3 fw-semibold"},Ui={class:"card border rounded-4"},Ni={class:"table-responsive"},Pi={class:"table align-middle mb-0"},qi={class:"text-end"},Di=["onClick"],Li={key:0},ji={class:"modal fade",id:"addMenuSelectionModal",tabindex:"-1","aria-hidden":"true"},Bi={class:"modal-dialog modal-xl modal-dialog-centered"},Oi={class:"modal-content rounded-4"},Zi={class:"modal-header"},Ri={class:"modal-title fw-semibold"},zi={class:"modal-body"},Wi={class:"row g-4"},Gi={class:"col-lg-5"},Xi={class:"search-wrap mb-2"},Yi={class:"card-body"},Ki={class:"d-flex align-items-start gap-3"},Hi=["src"],Qi={class:"flex-grow-1"},Ji={class:"fw-semibold"},er={class:"text-muted small"},lr={class:"text-muted small"},ar=["onClick"],tr={class:"row g-2 mt-3"},sr={class:"col-6"},or=["onUpdate:modelValue"],nr={class:"col-lg-7"},ir={class:"card border rounded-4 mb-3"},rr={class:"p-3 fw-semibold"},dr={class:"card border rounded-4"},ur={class:"table-responsive"},cr={class:"table align-middle mb-0"},pr={class:"text-end"},mr=["onClick"],vr={key:0},gr={__name:"Index",props:{allergies:{type:Array},tags:{type:Array},categories:{type:Array},meals:{type:Array},variantGroups:{type:Array,default:()=>[]},addonGroups:{type:Array,default:()=>[]},menuItems:{type:Array,default:()=>[]}},setup(Z){const{formatCurrencySymbol:W}=Ta(),Ee=Z,De=b([{label:"Yes",value:1},{label:"No",value:0}]),Je=b([]);b([]);const G=b([]);b(null);const L=b("simple"),me=b(!1),re=b(null),V=b({}),M=b({}),Le=b(null),Sl=[{label:"PDF",value:"pdf"},{label:"Excel",value:"excel"},{label:"CSV",value:"csv"},{label:"Allergen PDF",value:"allergens"}],Vl=a=>{a.value&&(la(a.value),Le.value=null)},Ce=()=>{if(s.value.addon_group_ids&&s.value.addon_group_ids.length>0){const a=[];s.value.addon_group_ids.forEach(e=>{const o=Ee.addonGroups?.find(t=>t.id===e);o&&o.addons&&a.push(...o.addons)}),G.value=a.filter((e,o,t)=>o===t.findIndex(n=>n.id===e.id)),Array.isArray(s.value.addon_ids)||(s.value.addon_ids=[])}else G.value=[],s.value.addon_ids=[]};D(()=>G.value);const je=[{name:"Meat",value:"#E74C3C"},{name:"Vegetables",value:"#27AE60"},{name:"Seafood",value:"#2980B9"},{name:"Drinks",value:"#8E44AD"},{name:"Staples",value:"#E67E22"}],fe=b([]),ve=b(!1),R=b({}),F=b([]),Be=b(""),I=b([]),$l=async()=>{try{const a=await axios.get("/inventory/api-inventories?all=1");fe.value=a.data.data}catch(a){console.error("Error fetching inventory:",a)}};function Al(){F.value=Object.keys(R.value).filter(a=>R.value[a]).map(a=>({id:parseInt(a),name:Ee.allergies.find(e=>e.id==a)?.name,type:R.value[a]})),s.value.allergies=[...F.value],ve.value=!1,setTimeout(()=>{new bootstrap.Modal(document.getElementById("addItemModal")).show()},300)}const el=()=>{ve.value=!1,setTimeout(()=>{new bootstrap.Modal(document.getElementById("addItemModal")).show()},300)},El=D(()=>{const a=Be.value.trim().toLowerCase();return a?fe.value.filter(e=>[e.name,e.category??"",e.subcategory??""].join(" ").toLowerCase().includes(a)):fe.value}),Oe=()=>{const a=bootstrap.Modal.getInstance(document.getElementById("addItemModal"));a&&a.hide(),ve.value=!0};function ye(a){return Math.round(a*100)/100}function Fl(a){const e=Number(a.qty||0),o=a.unitPrice!==""&&a.unitPrice!=null?Number(a.unitPrice):Number(a.defaultPrice||0);if(r.value[a.id]={},(!e||e<=0)&&(r.value[a.id].qty="Enter a valid quantity."),Object.keys(r.value[a.id]).length>0){const n=Object.values(r.value[a.id]).join(`
`);v.error(n,{style:{whiteSpace:"pre-line"}});return}const t=I.value.find(n=>n.id===a.id);t?(t.qty=e,t.unitPrice=o,t.cost=ye(e*o)):I.value.push({id:a.id,name:a.name,category:a.category,qty:e,unitPrice:o,cost:ye(e*o),nutrition:a.nutrition||{calories:0,protein:0,carbs:0,fat:0}}),Q.value||(a.qty=null,a.unitPrice=null)}function Tl(a){const e=I.value[a];if(!e)return;I.value.splice(a,1);const o=pl.value.find(t=>t.id===e.id);o&&(o.qty=null,o.unitPrice=null,o.cost=null)}const P=D(()=>{const a=I.value.reduce((e,o)=>{const t=Number(o.qty)||0;return e.calories+=Number(o.nutrition?.calories||0)*t,e.protein+=Number(o.nutrition?.protein||0)*t,e.carbs+=Number(o.nutrition?.carbs||0)*t,e.fat+=Number(o.nutrition?.fat||0)*t,e},{calories:0,protein:0,carbs:0,fat:0});return{calories:ye(a.calories),protein:ye(a.protein),carbs:ye(a.carbs),fat:ye(a.fat)}}),ll=()=>{new bootstrap.Modal(document.getElementById("addItemModal")).show()};Ke(async()=>{ge.value="",sl.value=Date.now(),await xl(),setTimeout(()=>{ol.value=!0;const e=document.getElementById(Re);e&&(e.value="",ge.value="")},100),$l(),X(1);const a=document.getElementById("menuFilterModal");a&&a.addEventListener("hidden.bs.modal",()=>{Y.value={...H.value}})});const al=b(Ee.inventories?.data||[]);D(()=>al.value);const tl=async()=>{try{const a=await axios.get("inventory/api-inventories");al.value=a.data.data}catch(a){console.error(a)}},j=b([]),de=b(1),Fe=b(10),Te=b(0),Ze=b([]),se=b(!1),Ue=b({total:0,active:0,inactive:0}),X=async(a=1)=>{se.value=!0;try{const e=await axios.get("/api/menu/items",{params:{page:a,per_page:Fe.value,search:ge.value.trim()||null,category:Y.value.category||null,status:Y.value.status!==""?Y.value.status:null,sort_by:Y.value.sortBy||null,price_min:Y.value.priceMin||null,price_max:Y.value.priceMax||null,date_from:Y.value.dateFrom||null,date_to:Y.value.dateTo||null}});j.value=e.data.data||[],e.data.pagination&&(de.value=e.data.pagination.current_page,Te.value=e.data.pagination.total,Ze.value=e.data.pagination.links),e.data.counts&&(Ue.value=e.data.counts)}catch(e){console.error("âŒ Error fetching items:",e),v.error("Failed to fetch items")}finally{se.value=!1}},Ul=a=>{if(!a||se.value)return;const o=new URLSearchParams(a.split("?")[1]).get("page");o&&X(parseInt(o))};Ke(()=>{tl(),X()});const ge=b(""),sl=b(Date.now()),Re=`search-${Math.random().toString(36).substr(2,9)}`,ol=b(!1),Ne={sortBy:"",category:"",status:"",priceMin:null,priceMax:null,dateFrom:"",dateTo:""},Y=b({...Ne}),H=b({...Ne}),Nl=D(()=>j.value);let nl=null;Pe(ge,()=>{clearTimeout(nl),nl=setTimeout(()=>{de.value=1,X(1)},500)}),Pe(()=>H.value,()=>{X(1)},{deep:!0});const il=D(()=>Nl.value),ze=D(()=>({sortOptions:[{value:"price_desc",label:"Price: High to Low"},{value:"price_asc",label:"Price: Low to High"},{value:"name_asc",label:"Name: A to Z"},{value:"name_desc",label:"Name: Z to A"}],categories:Ee.categories||[],statusOptions:[{value:1,label:"Active"},{value:0,label:"Inactive"}]})),Pl=()=>{H.value={...Y.value},de.value=1,X(1),bootstrap.Modal.getInstance(document.getElementById("menuFilterModal"))?.hide()},ql=()=>{Y.value={...Ne},H.value={...Ne},de.value=1,X(1)},Dl=D(()=>Ue.value.total),Ll=D(()=>Ue.value.active),jl=D(()=>Ue.value.inactive),Bl=D(()=>[{label:"Total Items",value:Dl.value??0,icon:qa,iconBg:"bg-soft-success",iconColor:"text-success"},{label:"Active Items",value:Ll.value??0,icon:Da,iconBg:"bg-soft-danger",iconColor:"text-success"},{label:"Inactive Items",value:jl.value??0,icon:Cl,iconBg:"bg-soft-warning",iconColor:"text-danger"}]);Ke(()=>window.feather?.replace()),ka(()=>window.feather?.replace());const Ol=b({Poultry:["Chicken","Broiler","Wings","Breast"],Produce:["Tomatoes","Onions","Potatoes"],Grains:["Rice","Wheat","Oats"],Grocery:["Oil","Spices","Sugar"],Meat:["Beef","Mutton","Veal"]}),rl=D(()=>(Ol.value[s.value.category]||[]).map(a=>({name:a,value:a}))),r=b({});function dl(){r.value={}}const ul=b([]),s=b({name:"",category_id:null,meals:[],label_color:null,subcategory:"",unit:[],price:"",supplier:[],sku:"",description:"",nutrition:{calories:"",fat:"",protein:"",carbs:""},allergies:[],tags:[],imageFile:null,imageUrl:null,is_taxable:null,variant_group_id:"",variant_prices:{},addon_group_ids:[],addon_ids:[],addon_group_constraints:null,is_saleable:!1,resale_type:null,resale_value:null,deal_name:"",deal_price:"",menu_item_ids:[]}),cl=b([{label:"Flat Amount",value:"flat"},{label:"Percentage",value:"percentage"}]),oe=b(!1),te=b(!1),he=b(null);function We(a){he.value=s.value.imageUrl,he.value&&(te.value=!0)}function Ge({file:a}){s.value.imageFile=a,s.value.imageUrl=URL.createObjectURL(a)}const ne=b(!1),Zl=()=>{L.value==="deals"?s.value.id?Wl():Rl():s.value.id?Hl():Xl()},Rl=async()=>{ne.value=!0,r.value={};try{const a=new FormData;a.append("name",s.value.deal_name.trim()),a.append("price",s.value.deal_price),a.append("description",s.value.description||""),a.append("status",1),s.value.is_taxable!==null&&a.append("is_taxable",String(s.value.is_taxable)),s.value.label_color&&a.append("label_color",s.value.label_color),s.value.category_id&&a.append("category_id",s.value.category_id),s.value.meals.forEach((e,o)=>{a.append(`meals[${o}]`,e)}),s.value.allergies.forEach((e,o)=>{a.append(`allergies[${o}]`,e.id),a.append(`allergy_types[${o}]`,e.type==="Contain"?1:0)}),s.value.tags.forEach((e,o)=>a.append(`tags[${o}]`,e)),s.value.addon_group_ids&&s.value.addon_group_ids.length>0&&s.value.addon_group_ids.forEach((e,o)=>{a.append(`addon_group_ids[${o}]`,e)}),s.value.addon_ids&&s.value.addon_ids.length>0&&s.value.addon_ids.forEach((e,o)=>{a.append(`addon_ids[${o}]`,e)}),Array.isArray(s.value.menu_item_ids)&&s.value.menu_item_ids.forEach((e,o)=>{typeof e=="object"?(a.append(`menu_item_ids[${o}][id]`,e.id),a.append(`menu_item_ids[${o}][qty]`,e.qty)):(a.append(`menu_item_ids[${o}][id]`,e),a.append(`menu_item_ids[${o}][qty]`,1))}),s.value.imageFile&&a.append("image",s.value.imageFile),await axios.post("/deals",a,{headers:{"Content-Type":"multipart/form-data"}}),v.success("Deal created successfully"),_e(),await X(),bootstrap.Modal.getInstance(document.getElementById("addItemModal"))?.hide()}catch(a){if(console.error("âŒ Error saving:",a.response?.data),a?.response?.status===422&&a.response.data?.errors){r.value=a.response.data.errors;const e=Object.values(a.response.data.errors).flat().join(`
`);v.error(e||"Validation failed")}else v.error("Failed to save deal: "+(a.response?.data?.message||a.message))}finally{ne.value=!1}},zl=a=>{console.log("Edit Deals",a),s.value.imageUrl&&s.value.imageUrl.startsWith("blob:")&&URL.revokeObjectURL(s.value.imageUrl),Q.value=!0,L.value="deals";const e=a.deal_addon_groups?.map(n=>n.group_id)||[],o=[];a.deal_addon_groups?.forEach(n=>{n.addons&&o.push(...n.addons.map(p=>p.id))}),s.value={id:a.id,deal_name:a.name,deal_price:a.price,description:a.description||"",menu_item_ids:a.menu_items?.map(n=>({id:n.id,qty:n.qty??0}))||[],imageFile:null,imageUrl:a.image_url||null,is_taxable:a.is_taxable??0,label_color:a.label_color||null,category_id:a.category_id||null,meals:a.meals?.map(n=>n.id)||[],allergies:a.allergies?.map(n=>n.id)||[],tags:a.tags?.map(n=>n.id)||[],addon_group_ids:e,addon_ids:o,addon_group_constraints:null,variant_group_id:"",variant_prices:{},is_saleable:!1,resale_type:null,resale_value:null,name:"",price:""},a.allergies&&a.allergies.length>0?(F.value=a.allergies.map(n=>{const p=n.pivot?.type??n.type??1;return{id:n.id,name:n.name,type:Number(p)===1?"Contain":"Trace"}}),R.value={},F.value.forEach(n=>{R.value[n.id]=n.type}),s.value.allergies=F.value):(F.value=[],R.value={}),s.value.addon_group_ids&&s.value.addon_group_ids.length>0&&xl(()=>{Ce()}),new bootstrap.Modal(document.getElementById("addItemModal")).show()},Wl=async()=>{ne.value=!0,r.value={};try{const a=new FormData;a.append("name",s.value.deal_name.trim()),a.append("price",s.value.deal_price),a.append("description",s.value.description||""),a.append("is_taxable",String(s.value.is_taxable??0)),s.value.label_color&&a.append("label_color",s.value.label_color),s.value.category_id&&a.append("category_id",s.value.category_id),s.value.meals.forEach((o,t)=>{a.append(`meals[${t}]`,o)}),s.value.allergies.forEach((o,t)=>{a.append(`allergies[${t}]`,o.id),a.append(`allergy_types[${t}]`,o.type==="Contain"?1:0)}),s.value.tags.forEach((o,t)=>a.append(`tags[${t}]`,o)),s.value.addon_group_ids&&s.value.addon_group_ids.length>0&&s.value.addon_group_ids.forEach((o,t)=>{a.append(`addon_group_ids[${t}]`,o)}),s.value.addon_ids&&s.value.addon_ids.length>0&&s.value.addon_ids.forEach((o,t)=>{a.append(`addon_ids[${t}]`,o)}),Array.isArray(s.value.menu_item_ids)&&s.value.menu_item_ids.forEach((o,t)=>{typeof o=="object"?(a.append(`menu_item_ids[${t}][id]`,o.id),a.append(`menu_item_ids[${t}][qty]`,o.qty)):(a.append(`menu_item_ids[${t}][id]`,o),a.append(`menu_item_ids[${t}][qty]`,1))}),s.value.imageFile&&a.append("image",s.value.imageFile),a.append("_method","PUT"),await axios.post(`/deals/${s.value.id}`,a,{headers:{"Content-Type":"multipart/form-data"}}),v.success("Deal updated successfully"),_e(),await X(),bootstrap.Modal.getInstance(document.getElementById("addItemModal"))?.hide()}catch(a){if(console.error("âŒ Update failed:",a.response?.data),a?.response?.status===422&&a.response.data?.errors){r.value=a.response.data.errors;const e=Object.values(a.response.data.errors).flat().join(`
`);v.error(e||"Validation failed")}else v.error("Failed to update deal: "+(a.response?.data?.message||a.message))}finally{ne.value=!1}},Gl=async a=>{try{console.log("Toggling status for deal:",a);const e=a.status===1?0:1;await axios.patch(`/deals/${a.id}/status`,{status:e});const o=ul.value.findIndex(t=>t.id===a.id);o!==-1&&(ul.value[o].status=e),v.success(`Deal is now ${e===1?"Active":"Inactive"}`)}catch(e){console.error("Failed to toggle status",e),v.error("Failed to update status")}},Xl=async()=>{ne.value=!0,r.value={};try{const a=new FormData;if(a.append("name",s.value.name.trim()),s.value.category_id&&a.append("category_id",s.value.category_id),s.value.label_color&&a.append("label_color",s.value.label_color),a.append("description",s.value.description||""),a.append("is_taxable",String(s.value.is_taxable??0)),L.value==="variant"&&Object.keys(V.value).length>0){const e=Object.values(V.value).flat().reduce((t,n)=>{const p=Number(n.qty||0);return t.calories+=Number(n.nutrition?.calories||0)*p,t.protein+=Number(n.nutrition?.protein||0)*p,t.carbs+=Number(n.nutrition?.carbs||0)*p,t.fat+=Number(n.nutrition?.fat||0)*p,t},{calories:0,protein:0,carbs:0,fat:0});a.append("nutrition[calories]",e.calories),a.append("nutrition[fat]",e.fat),a.append("nutrition[protein]",e.protein),a.append("nutrition[carbs]",e.carbs);let o=0;Object.entries(U.value).forEach(([t,n])=>{a.append(`variant_metadata[${o}][name]`,n.name),a.append(`variant_metadata[${o}][price]`,n.price);const p=M.value[t];p&&p.is_saleable?(a.append(`variant_metadata[${o}][is_saleable]`,1),p.resale_type&&p.resale_type!=="null"&&a.append(`variant_metadata[${o}][resale_type]`,p.resale_type),p.resale_value!==null&&p.resale_value!==""&&!isNaN(p.resale_value)&&a.append(`variant_metadata[${o}][resale_value]`,parseFloat(p.resale_value))):a.append(`variant_metadata[${o}][is_saleable]`,0),(V.value[t]||[]).forEach((i,_)=>{a.append(`variant_ingredients[${o}][${_}][inventory_item_id]`,i.id),a.append(`variant_ingredients[${o}][${_}][qty]`,i.qty),a.append(`variant_ingredients[${o}][${_}][unit_price]`,i.unitPrice),a.append(`variant_ingredients[${o}][${_}][cost]`,i.cost)}),o++}),a.append("price",0)}else a.append("nutrition[calories]",P.value.calories),a.append("nutrition[fat]",P.value.fat),a.append("nutrition[protein]",P.value.protein),a.append("nutrition[carbs]",P.value.carbs),s.value.price!==""&&s.value.price!==null&&a.append("price",s.value.price),s.value.is_saleable?(a.append("is_saleable",1),s.value.resale_type&&s.value.resale_type!=="null"&&a.append("resale_type",s.value.resale_type),s.value.resale_value!==null&&s.value.resale_value!==""&&!isNaN(s.value.resale_value)&&a.append("resale_value",parseFloat(s.value.resale_value))):a.append("is_saleable",0),I.value.forEach((e,o)=>{a.append(`ingredients[${o}][inventory_item_id]`,e.id),a.append(`ingredients[${o}][qty]`,e.qty),a.append(`ingredients[${o}][unit_price]`,e.unitPrice),a.append(`ingredients[${o}][cost]`,e.cost)});s.value.allergies.forEach((e,o)=>{a.append(`allergies[${o}]`,e.id),a.append(`allergy_types[${o}]`,e.type==="Contain"?1:0)}),s.value.meals.forEach((e,o)=>{a.append(`meals[${o}]`,e)}),s.value.tags.forEach((e,o)=>a.append(`tags[${o}]`,e)),s.value.imageFile&&a.append("image",s.value.imageFile),s.value.addon_group_ids&&s.value.addon_group_ids.length>0&&s.value.addon_group_ids.forEach((e,o)=>{a.append(`addon_group_ids[${o}]`,e)}),s.value.addon_ids&&s.value.addon_ids.length>0&&s.value.addon_ids.forEach((e,o)=>{a.append(`addon_ids[${o}]`,e)});try{const e=await axios.post("/menu",a,{headers:{"Content-Type":"multipart/form-data"}});v.success("Menu created successfully"),_e(),await X(),bootstrap.Modal.getInstance(document.getElementById("addItemModal"))?.hide()}catch(e){if(console.error("âŒ Error saving:",e.response?.data),e?.response?.status===422&&e.response.data?.errors){r.value=e.response.data.errors;const o=Object.values(e.response.data.errors).flat().join(`
`);v.error(o||"Validation failed")}else v.error("Failed to save menu item: "+(e.response?.data?.message||e.message))}}catch(a){console.error("âŒ Error:",a),v.error("An error occurred: "+a.message)}finally{ne.value=!1}};Pe(s,a=>{Object.keys(r.value).forEach(e=>{if(e.includes(".")){const[o,t]=e.split(".");a[o]&&a[o][t]!==""&&delete r.value[e]}else{const o=a[e];o!=null&&o!==""&&(!Array.isArray(o)||o.length>0)&&delete r.value[e]}})},{deep:!0}),Pe(V,a=>{Object.keys(a).forEach(e=>{M.value[e]||(M.value[e]={is_saleable:!1,resale_type:null,resale_value:null})})},{deep:!0});const Yl=b({calories:0,protein:0,carbs:0,fat:0}),Q=b(!1),pl=D(()=>El.value.map(a=>{const e=I.value.find(o=>o.id===a.id);return e?{...a,qty:e.qty,unitPrice:e.unitPrice,cost:e.cost}:{...a,qty:0,unitPrice:0,cost:0}})),Kl=a=>{console.log("Edit Item",a),s.value.imageUrl&&s.value.imageUrl.startsWith("blob:")&&URL.revokeObjectURL(s.value.imageUrl),Q.value=!0;const e=$a(a),o=e.variants&&Array.isArray(e.variants)&&e.variants.length>0;if(L.value=o?"variant":"simple",console.log("Item data: ",e),s.value={id:e.id,name:e.name,price:e.price,category_id:e.category?.id||null,meals:e.meals?.map(n=>n.id)||[],description:e.description,label_color:e.label_color,is_taxable:e.is_taxable??0,ingredients:e.ingredients||[],allergies:e.allergies?.map(n=>n.id)||[],tags:e.tags?.map(n=>n.id)||[],imageFile:null,imageUrl:e.image_url||null,addon_group_ids:e.addon_group_relations?.map(n=>Number(n.addon_group_id))||[],addon_ids:e.addons?.map(n=>n.id)||[],is_saleable:e.is_saleable===1||e.is_saleable===!0,resale_type:e.resale_type||null,resale_value:e.resale_value||null},o){V.value={},U.value={},M.value={};let n=0;e.variants.forEach(p=>{const g=p.id;n=Math.max(n,g),U.value[g]={name:p.name,price:parseFloat(p.price||0)},M.value[g]={is_saleable:p.is_saleable===1||p.is_saleable===!0,resale_type:p.resale_type||null,resale_value:p.resale_value?parseFloat(p.resale_value):null},p.ingredients&&Array.isArray(p.ingredients)?V.value[g]=p.ingredients.map(i=>{const _=parseFloat(i.quantity||i.qty||0),k=parseFloat(i.cost||0),q=_>0?k/_:0,B=fe.value.find(w=>w.id===(i.inventory_item_id||i.id));return{id:i.inventory_item_id||i.id,name:i.product_name||i.name||B?.name||"â€”",category:B?.category||i.category||{name:""},qty:_,unitPrice:q,cost:k,nutrition:i.nutrition||B?.nutrition||{calories:0,protein:0,carbs:0,fat:0}}}):V.value[g]=[]}),ml.value=n+1}e.addon_group_ids&&e.addon_group_ids.length>0&&Ce(),Yl.value={calories:parseFloat(e.nutrition?.calories||0),protein:parseFloat(e.nutrition?.protein||0),carbs:parseFloat(e.nutrition?.carbs||0),fat:parseFloat(e.nutrition?.fat||0)},e.allergies&&e.allergies.length>0?(F.value=e.allergies.map(n=>{const p=n.pivot?.type??n.type??1;return{id:n.id,name:n.name,type:Number(p)===1?"Contain":"Trace"}}),R.value={},F.value.forEach(n=>{R.value[n.id]=n.type})):(F.value=[],R.value={}),o?I.value=[]:I.value=(e.ingredients||[]).map(n=>{const p=parseFloat(n.quantity||n.qty||0),g=parseFloat(n.cost||0),i=p>0?g/p:0,_=fe.value.find(k=>k.id===(n.inventory_item_id||n.id));return{id:n.inventory_item_id||n.id,name:n.product_name||n.name||_?.name||"â€”",category:_?.category||n.category||{name:""},qty:p,unitPrice:i,cost:g,nutrition:n.nutrition?typeof n.nutrition=="string"?JSON.parse(n.nutrition):n.nutrition:_?.nutrition||{calories:0,protein:0,carbs:0,fat:0}}}),new bootstrap.Modal(document.getElementById("addItemModal")).show()},Hl=async()=>{ne.value=!0,r.value={};try{const a=new FormData;if(a.append("name",s.value.name.trim()),s.value.category_id&&a.append("category_id",s.value.category_id),a.append("description",s.value.description||""),a.append("label_color",s.value.label_color||""),a.append("is_taxable",String(s.value.is_taxable??0)),L.value==="variant"&&Object.keys(V.value).length>0){const e=Object.values(V.value).flat().reduce((t,n)=>{const p=Number(n.qty||0);return t.calories+=Number(n.nutrition?.calories||0)*p,t.protein+=Number(n.nutrition?.protein||0)*p,t.carbs+=Number(n.nutrition?.carbs||0)*p,t.fat+=Number(n.nutrition?.fat||0)*p,t},{calories:0,protein:0,carbs:0,fat:0});a.append("nutrition[calories]",e.calories),a.append("nutrition[fat]",e.fat),a.append("nutrition[protein]",e.protein),a.append("nutrition[carbs]",e.carbs);let o=0;Object.entries(U.value).forEach(([t,n])=>{a.append(`variant_metadata[${o}][id]`,t),a.append(`variant_metadata[${o}][name]`,n.name),a.append(`variant_metadata[${o}][price]`,n.price);const p=M.value[t];p&&p.is_saleable?(a.append(`variant_metadata[${o}][is_saleable]`,1),p.resale_type&&p.resale_type!=="null"&&a.append(`variant_metadata[${o}][resale_type]`,p.resale_type),p.resale_value!==null&&p.resale_value!==""&&!isNaN(p.resale_value)&&a.append(`variant_metadata[${o}][resale_value]`,parseFloat(p.resale_value))):a.append(`variant_metadata[${o}][is_saleable]`,0),(V.value[t]||[]).forEach((i,_)=>{a.append(`variant_ingredients[${o}][${_}][inventory_item_id]`,i.id),a.append(`variant_ingredients[${o}][${_}][qty]`,i.qty),a.append(`variant_ingredients[${o}][${_}][unit_price]`,i.unitPrice),a.append(`variant_ingredients[${o}][${_}][cost]`,i.cost)}),o++}),a.append("price",0)}else a.append("price",s.value.price||0),a.append("nutrition[calories]",P.value.calories),a.append("nutrition[fat]",P.value.fat),a.append("nutrition[protein]",P.value.protein),a.append("nutrition[carbs]",P.value.carbs),s.value.is_saleable?(a.append("is_saleable",1),s.value.resale_type&&s.value.resale_type!=="null"&&a.append("resale_type",s.value.resale_type),s.value.resale_value!==null&&s.value.resale_value!==""&&!isNaN(s.value.resale_value)&&a.append("resale_value",parseFloat(s.value.resale_value))):a.append("is_saleable",0),I.value.forEach((e,o)=>{a.append(`ingredients[${o}][inventory_item_id]`,e.id),a.append(`ingredients[${o}][qty]`,e.qty),a.append(`ingredients[${o}][unit_price]`,e.unitPrice),a.append(`ingredients[${o}][cost]`,e.cost)});F.value.forEach((e,o)=>{a.append(`allergies[${o}]`,e.id);const t=e.type==="Contain"?1:0;a.append(`allergy_types[${o}]`,t)}),s.value.tags.forEach((e,o)=>a.append(`tags[${o}]`,e)),s.value.meals.forEach((e,o)=>{a.append(`meals[${o}]`,e)}),s.value.imageFile&&a.append("image",s.value.imageFile),s.value.addon_group_ids&&s.value.addon_group_ids.length>0&&s.value.addon_group_ids.forEach((e,o)=>{a.append(`addon_group_ids[${o}]`,e)}),s.value.addon_ids&&s.value.addon_ids.length>0&&s.value.addon_ids.forEach((e,o)=>{a.append(`addon_ids[${o}]`,e)}),a.append("_method","PUT");try{const e=await axios.post(`/menu/${s.value.id}`,a,{headers:{"Content-Type":"multipart/form-data"}});v.success("Menu updated successfully"),_e(),await X(),bootstrap.Modal.getInstance(document.getElementById("addItemModal"))?.hide()}catch(e){if(console.error("âŒ Update failed:",e.response?.data),e?.response?.status===422&&e.response.data?.errors){r.value=e.response.data.errors;const o=Object.values(e.response.data.errors).flat().join(`
`);v.error(o||"Validation failed")}else v.error("Failed to update menu item: "+(e.response?.data?.message||e.message))}}catch(a){console.error("âŒ Error:",a),v.error("An error occurred: "+a.message)}finally{ne.value=!1}},Ql=async a=>{try{const e=a.status===1?0:1;await axios.patch(`/menu/${a.id}/status`,{status:e}),v.success(`Menu item is now ${e===1?"Active":"Inactive"}`),await X(de.value)}catch(e){console.error("Failed to toggle status",e),v.error("Failed to update status")}};function _e(){s.value.imageUrl&&s.value.imageUrl.startsWith("blob:")&&URL.revokeObjectURL(s.value.imageUrl),s.value={name:"",category_id:null,meals:[],label_color:null,subcategory:"",unit:[],price:"",supplier:[],sku:"",description:"",nutrition:{calories:"",fat:"",protein:"",carbs:""},allergies:[],tags:[],imageFile:null,imageUrl:null,is_taxable:null,variant_group_id:"",variant_prices:{},addon_group_ids:[],addon_ids:[],addon_group_constraints:null,is_saleable:!1,resale_type:null,resale_value:null,deal_name:"",deal_price:"",menu_item_ids:[]},oe.value=!1,te.value=!1,he.value=null,r.value={},Q.value=!1,F.value=[],R.value={},I.value=[],L.value="simple",me.value=!1,re.value=null,V.value={},U.value={},M.value={},T.value={name:"",price:null},Je.value=[],G.value=[],z.value=[]}const Jl=()=>{_e(),dl()},ea=async()=>{try{se.value=!0;let a=[],e=1,o=1;console.log("ðŸ”„ Fetching all menu items and deals for export...");do{const t=await axios.get("/api/menu/items",{params:{page:e,per_page:999999,search:ge.value.trim()||null,category:H.value.category||null,status:H.value.status!==""?H.value.status:null,sort_by:H.value.sortBy||null,price_min:H.value.priceMin||null,price_max:H.value.priceMax||null,date_from:H.value.dateFrom||null,date_to:H.value.dateTo||null}}),n=t.data.data||[];a=[...a,...n],t.data.pagination&&(o=t.data.pagination.last_page),e++}while(e<=o);return console.log(`âœ… Fetched ${a.length} items (menu + deals) for export`),a}catch(a){return console.error("âŒ Error fetching export data:",a),v.error("Failed to load data for export"),[]}finally{se.value=!1}},la=async a=>{if(console.log("ðŸ” Starting download process..."),console.log("ðŸ” Current menuItems.value length:",j.value?.length),console.log("ðŸ” Total items in system:",Te.value),!j.value||j.value.length===0){v.error("No menu data to download");return}try{se.value=!0,v.info("Fetching all menu items for export...",{autoClose:2e3});const e=await ea();if(console.log("âœ… Data ready for export:",e.length,"items"),!e.length){v.error("No menu items found to download"),se.value=!1;return}a==="pdf"?ta(e):a==="excel"?sa(e):a==="csv"?aa(e):a==="allergens"?oa(e):v.error("Invalid download type")}catch(e){console.error("âŒ Download failed:",e),v.error(`Download failed: ${e.message}`)}finally{se.value=!1}},aa=a=>{try{const e=["Item Name","Category","Description","Price","Nutrition","Allergies","Tags"],o=a.map(i=>{let _="";i.nutrition&&typeof i.nutrition=="object"?_=["calories","protein","fat","carbs"].map(S=>i.nutrition[S]!==void 0?`${S}: ${i.nutrition[S]}`:null).filter(Boolean).join("; "):typeof i.nutrition=="string"&&(_=i.nutrition);const k=typeof i.category=="object"?i.category?.name||"":i.category||"",q=Array.isArray(i.allergies)?i.allergies.map(w=>{const S=w.name||w,$=w.pivot?.type??w.type??null;if($!=null){const J=String($)==="1"||$===1?"Contain":"Trace";return`${S} (${J})`}return S}).join(", "):i.allergies||"",B=Array.isArray(i.tags)?i.tags.map(w=>w.name||w).join(", "):i.tags||"";return[`"${(i.name||"").replace(/"/g,'""')}"`,`"${k.replace(/"/g,'""')}"`,`"${(i.description||"").replace(/"/g,'""')}"`,`"${i.price||""}"`,`"${_.replace(/"/g,'""')}"`,`"${q.replace(/"/g,'""')}"`,`"${B.replace(/"/g,'""')}"`]}),t=[e.join(","),...o.map(i=>i.join(","))].join(`
`),n=new Blob([t],{type:"text/csv;charset=utf-8;"}),p=URL.createObjectURL(n),g=document.createElement("a");g.setAttribute("href",p),g.setAttribute("download",`menu_items_${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(g),g.click(),document.body.removeChild(g),URL.revokeObjectURL(p),v.success(`CSV downloaded successfully (${a.length} items)`,{autoClose:2500})}catch(e){console.error("CSV generation error:",e),v.error(`CSV generation failed: ${e.message}`,{autoClose:5e3})}},ta=a=>{try{const e=new wl("p","mm","a4");e.setFontSize(18),e.setFont("helvetica","bold"),e.text("Menu Items Report",65,20),e.setFontSize(10),e.setFont("helvetica","normal");const o=new Date().toLocaleString();e.text(`Generated on: ${o}`,14,28),e.text(`Total Menu Items: ${a.length}`,14,34);const t=["Item Name","Category","Description","Price","Nutrition","Allergies","Tags"],n=i=>{if(!i)return"";if(typeof i=="string")try{i=JSON.parse(i)}catch{return i}return typeof i=="object"?["calories","protein","fat","carbs"].map(k=>i[k]!==void 0?`${k}: ${i[k]}`:null).filter(Boolean).join("; "):String(i??"")},p=a.map(i=>{const _=typeof i.category=="object"?i.category?.name||"":i.category||"",k=Array.isArray(i.allergies)?i.allergies.map(w=>{const S=w.name||w,$=w.pivot?.type??w.type??null;if($!=null){const J=String($)==="1"||$===1?"Contain":"Trace";return`${S} (${J})`}return S}).join(", "):i.allergies||"",q=Array.isArray(i.tags)?i.tags.map(w=>w.name||w).join(", "):i.tags||"",B=n(i.nutrition);return[i.name||"",_,i.description||"",i.price||"",B,k,q]});kl(e,{head:[t],body:p,startY:40,styles:{fontSize:8,cellPadding:2,halign:"left",lineColor:[0,0,0],lineWidth:.1},headStyles:{fillColor:[41,128,185],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]},margin:{left:14,right:14},didDrawPage:i=>{const _=e.internal.getNumberOfPages(),k=e.internal.pageSize.height;e.setFontSize(8),e.text(`Page ${i.pageNumber} of ${_}`,i.settings.margin.left,k-10)}});const g=`menu_items_${new Date().toISOString().split("T")[0]}.pdf`;e.save(g),v.success(`PDF downloaded successfully (${a.length} items)`,{autoClose:2500})}catch(e){console.error("PDF generation error:",e),v.error(`PDF generation failed: ${e.message}`,{autoClose:5e3})}},sa=a=>{try{if(typeof Ea>"u")throw new Error("XLSX library is not loaded");const e=a.map(i=>{let _="";i.nutrition&&typeof i.nutrition=="object"?_=["calories","protein","fat","carbs"].map(S=>i.nutrition[S]!==void 0?`${S}: ${i.nutrition[S]}`:null).filter(Boolean).join("; "):typeof i.nutrition=="string"&&(_=i.nutrition);const k=typeof i.category=="object"?i.category?.name||"":i.category||"",q=Array.isArray(i.allergies)?i.allergies.map(w=>{const S=w.name||w,$=w.pivot?.type??w.type??null;if($!=null){const J=String($)==="1"||$===1?"Contain":"Trace";return`${S} (${J})`}return S}).join(", "):i.allergies||"",B=Array.isArray(i.tags)?i.tags.map(w=>w.name||w).join(", "):i.tags||"";return{"Item Name":i.name||"",Category:k,Description:i.description||"",Price:i.price||"",Nutrition:_,Allergies:q,Tags:B}}),o=Ae.book_new(),t=Ae.json_to_sheet(e);t["!cols"]=[{wch:20},{wch:20},{wch:30},{wch:10},{wch:30},{wch:25},{wch:25}],Ae.book_append_sheet(o,t,"Menu Items");const n=[{Info:"Generated On",Value:new Date().toLocaleString()},{Info:"Total Records",Value:a.length},{Info:"Exported By",Value:"Menu Management System"}],p=Ae.json_to_sheet(n);Ae.book_append_sheet(o,p,"Report Info");const g=`menu_items_${new Date().toISOString().split("T")[0]}.xlsx`;Fa(o,g),v.success(`Excel file downloaded successfully (${a.length} items)`,{autoClose:2500})}catch(e){console.error("Excel generation error:",e),v.error(`Excel generation failed: ${e.message}`,{autoClose:5e3})}},oa=a=>{try{const e=new wl("l","mm","a4");e.setFontSize(20),e.setFont("helvetica","bold"),e.text("allergen",14,15),e.setFontSize(16),e.text("information",14,22),e.setFontSize(18),e.setFont("helvetica","bold"),e.setTextColor(0,102,204),e.text("10XGLOBAL",65,22),e.setTextColor(0,0,0);const o=e.internal.pageSize.width,t=o-125,n=8;e.setFillColor(240,240,240),e.rect(t-2,n,45,18,"F"),e.setFontSize(7),e.setFont("helvetica","bold"),e.text("SYMBOL",t,n+4),e.text("MEANING",t+12,n+4),e.setFont("helvetica","normal"),e.setFontSize(6);const p=t+1,g=n+7;e.setLineWidth(.5),e.setDrawColor(0,0,0),e.line(p,g,p+1,g+1.5),e.line(p+1,g+1.5,p+3,g-1),e.text("contains allergen",t+12,n+9),e.setFontSize(9),e.text("*",t+1,n+14),e.setFontSize(6),e.text("may contain traces of allergen",t+12,n+14);const i=t+48;e.setFontSize(6),e.text("â€¢ Always speak to a member of staff if you have any allergies",i,n+3),e.text("â€¢ Items are prepared in the same kitchen,",i,n+7),e.text("  therefore we cannot guarantee that products are",i,n+10),e.text("  free from allergen and cross-contamination",i,n+13);const _={};a.forEach(h=>{const A=typeof h.category=="object"?h.category?.name||"Other":h.category||"Other";_[A]||(_[A]=[]),_[A].push(h)});const k=new Set;a.forEach(h=>{Array.isArray(h.allergies)&&h.allergies.forEach(A=>{const ee=A.name||A;k.add(ee)})});const q=Array.from(k).sort(),B=14,w=14,S=o-B-w,$=30,J=45,xe=$+J,we=(S-xe)/q.length,Ye=Math.max(6,Math.min(we,12)),yl=Ye<8?6:7,ya=Ye<8?5:6,hl=[];Object.keys(_).sort().forEach((h,A)=>{const ee=_[h];ee.forEach((ie,Me)=>{const ue=[];Me===0&&ue.push({content:h.toLowerCase(),rowSpan:ee.length,styles:{fontStyle:"bold",fontSize:10,halign:"left",valign:"middle",fillColor:[255,255,255]}}),ue.push({content:ie.name||"",styles:{fontStyle:"bold",fontSize:9}}),q.forEach(Se=>{let ce="";if(Array.isArray(ie.allergies)){const pe=ie.allergies.find(be=>(be.name||be)===Se);if(pe){const be=pe.pivot?.type??pe.type??null;be!=null?ce=String(be)==="1"||be===1?"TICK":"STAR":ce=""}}ue.push(ce)}),hl.push(ue)})});const ha=["","",...q];kl(e,{head:[ha],body:hl,startY:35,styles:{fontSize:yl,cellPadding:1.5,halign:"center",valign:"middle",lineColor:[0,0,0],lineWidth:.1},columnStyles:{0:{halign:"left",cellWidth:$,fontStyle:"bold",fontSize:10},1:{halign:"left",cellWidth:J,fontStyle:"bold",fontSize:9},...Object.fromEntries(q.map((h,A)=>[A+2,{cellWidth:Ye}]))},headStyles:{fillColor:[255,255,255],textColor:[0,0,0],fontStyle:"bold",fontSize:ya,cellPadding:1},alternateRowStyles:{fillColor:[250,250,250]},margin:{left:B,right:w,top:28},didParseCell:function(h){h.section==="head"&&h.column.index>1&&(h.cell.styles.minCellHeight=45,h.cell.text=[]),h.section==="head"&&(h.column.index===0||h.column.index===1)&&(h.cell.text=[]),h.section==="body"&&(h.cell.raw==="TICK"||h.cell.raw==="STAR")&&(h.cell.text=[])},didDrawCell:function(h){if(h.section==="body"&&h.cell.raw==="TICK"){const{x:A,y:ee,width:ie,height:Me}=h.cell,ue=A+ie/2,Se=ee+Me/2,ce=ue-1.5,pe=Se-.5;e.setDrawColor(0,0,0),e.setLineWidth(.4),e.line(ce,pe,ce+.8,pe+1.2),e.line(ce+.8,pe+1.2,ce+2.5,pe-1)}if(h.section==="body"&&h.cell.raw==="STAR"){const{x:A,y:ee,width:ie,height:Me}=h.cell,ue=A+ie/2,Se=ee+Me/2;e.setFontSize(10),e.setFont("helvetica","bold"),e.setTextColor(0,0,0),e.text("*",ue,Se+1,{align:"center"})}if(h.section==="head"&&h.column.index>1){const A=q[h.column.index-2];if(A){const ee=h.cell.x+h.cell.width/2,ie=h.cell.y+h.cell.height-3;e.saveGraphicsState(),e.setFontSize(yl),e.setFont("helvetica","bold"),e.text(A,ee,ie,{angle:90,align:"left"}),e.restoreGraphicsState()}}},didDrawPage:h=>{const A=e.internal.getNumberOfPages(),ee=e.internal.pageSize.height;e.setFontSize(7),e.text(`Page ${h.pageNumber} of ${A}`,14,ee-8)}});const xa=`allergen_information_${new Date().toISOString().split("T")[0]}.pdf`;e.save(xa),v.success("PDF downloaded successfully",{autoClose:2500})}catch(e){console.error("PDF generation error:",e),v.error(`PDF generation failed: ${e.message}`,{autoClose:5e3})}},na=a=>{if(!a||a.length<=1){v.error("The imported file is empty.");return}a[0];const o=a.slice(1).map(i=>{let _=0,k=0,q=0,B=0;i[4]&&i[4].split(";").map(J=>J.trim()).forEach(J=>{const[xe,bl]=J.split(":").map(fl=>fl.trim()),we=parseFloat(bl)||0;xe==="calories"?_=we:xe==="protein"?k=we:xe==="fat"?q=we:xe==="carbs"&&(B=we)});const w={name:i[0]||"",category:i[1]||"",description:i[2]||"",price:i[3]?parseFloat(i[3]):0,calories:_,protein:k,fat:q,carbs:B,allergies:i[5]?i[5].trim():"",tags:i[6]?i[6].trim():"",label_color:i[7]||null,is_taxable:i[8]?parseInt(i[8]):0,is_saleable:i[9]?parseInt(i[9]):0,resale_type:i[10]||null,resale_value:i[11]?parseFloat(i[11]):null,status:1};if(i[12]&&i[12].trim()!=="")try{w.variant_data=JSON.parse(i[12])}catch(S){console.error("Error parsing variant data:",S),w.variant_data=null}return w}),t=o.map(i=>i.name.trim().toLowerCase()),n=t.filter((i,_)=>t.indexOf(i)!==_);if(n.length>0){v.error(`Duplicate item names found in CSV: ${[...new Set(n)].join(", ")}`);return}const p=j.value.map(i=>i.name.trim().toLowerCase()),g=o.filter(i=>p.includes(i.name.trim().toLowerCase()));if(g.length>0){const i=g.map(_=>_.name).join(", ");v.error(`Menu items already exist in the table: ${i}`);return}axios.post("/api/menu/menu_items/import",{items:o}).then(()=>{v.success("Items imported successfully");const i=document.querySelector(".modal.show");if(i){const _=bootstrap.Modal.getInstance(i);_&&_.hide()}setTimeout(()=>{document.querySelectorAll(".modal-backdrop").forEach(k=>k.remove()),document.body.classList.remove("modal-open"),document.body.style.overflow="",document.body.style.paddingRight=""},100),tl(),X()}).catch(i=>{console.error(i),v.error(i.response?.data?.message||"Import failed"),setTimeout(()=>{document.querySelectorAll(".modal-backdrop").forEach(k=>k.remove()),document.body.classList.remove("modal-open"),document.body.style.overflow="",document.body.style.paddingRight=""},100)})},T=b({name:"",price:null}),U=b({}),ml=b(1);function ia(){if(dl(),me.value){if(!T.value.name||!T.value.name.trim()){v.error("Please enter a variant name");return}if(T.value.price===null||T.value.price===""||T.value.price<0){v.error("Please enter a valid variant price");return}if(I.value.length===0){v.error("Please add at least one ingredient");return}let e;re.value!==null?e=re.value:e=ml.value++,V.value[e]=[...I.value],U.value||(U.value={}),U.value[e]={name:T.value.name,price:T.value.price},M.value[e]||(M.value[e]={is_saleable:!1,resale_type:null,resale_value:null}),v.success(`Variant "${T.value.name}" ingredients saved!`),I.value=[],T.value={name:"",price:null},re.value=null}else s.value.ingredients=[...I.value];bootstrap.Modal.getInstance(document.getElementById("addIngredientModal")).hide(),setTimeout(()=>{new bootstrap.Modal(document.getElementById("addItemModal")).show()},300)}const vl=(a=!1)=>{me.value=a,a?re.value||(T.value={name:"",price:null},I.value=[]):Q.value&&s.value.ingredients&&s.value.ingredients.length>0?I.value=s.value.ingredients.map(o=>{const t=parseFloat(o.quantity||o.qty||0),n=parseFloat(o.cost||0),p=t>0?n/t:0,g=fe.value.find(i=>i.id===(o.inventory_item_id||o.id));return{id:o.inventory_item_id||o.id,name:o.product_name||o.name||g?.name||"â€”",category:g?.category||o.category||{name:""},qty:t,unitPrice:p,cost:n,nutrition:o.nutrition||g?.nutrition||{calories:0,protein:0,carbs:0,fat:0}}}):I.value=[];const e=bootstrap.Modal.getInstance(document.getElementById("addItemModal"));e&&e.hide(),setTimeout(()=>{new bootstrap.Modal(document.getElementById("addIngredientModal")).show()},300)},ra=a=>{re.value=a,V.value[a]?I.value=[...V.value[a]]:I.value=[],U.value[a]?T.value={name:U.value[a].name||"",price:U.value[a].price||null}:T.value={name:Ie(a),price:gl(a)},me.value=!0;const e=bootstrap.Modal.getInstance(document.getElementById("addItemModal"));e&&e.hide(),setTimeout(()=>{new bootstrap.Modal(document.getElementById("addIngredientModal")).show()},300)},Ie=a=>{if(U.value[a])return U.value[a].name;const e=Je.value.find(o=>o.id===a);return e?e.name:"Unknown Variant"},gl=a=>U.value[a]?U.value[a].price||0:s.value.variant_prices&&s.value.variant_prices[a]?s.value.variant_prices[a]:0,da=a=>{const e=Ie(a);confirm(`Are you sure you want to delete ingredients for "${e}"?`)&&(delete V.value[a],U.value[a]&&delete U.value[a],v.success("Variant ingredients deleted"))},ua=["Item Name","Category","Description","Price","Nutrition","Allergies","Tags","Label Color","Is Taxable","Is Saleable","Resale Type","Resale Value","Variant Data"],ca=[["Chicken Burger","Burgers","Delicious chicken burger","150","calories: 250.00; protein: 20.00; fat: 10.00; carbs: 30.00","Gluten","Halal","#E74C3C","1","0","","",""],["Grilled Chicken","Main Course","Grilled chicken with spices","0","calories: 300.00; protein: 35.00; fat: 15.00; carbs: 0.00","None","Halal","#27AE60","1","1","flat","50",JSON.stringify([{name:"Small",price:200,is_saleable:1,resale_type:"flat",resale_value:40,ingredients:[{inventory_item_id:1,product_name:"Chicken Breast",quantity:.5,cost:100}]},{name:"Large",price:300,is_saleable:1,resale_type:"percentage",resale_value:20,ingredients:[{inventory_item_id:1,product_name:"Chicken Breast",quantity:.75,cost:150}]}])]],Xe=b(""),z=b([]),pa=D(()=>{const a=Xe.value.trim().toLowerCase();return a?j.value.filter(e=>[e.name,e.category?.name??""].join(" ").toLowerCase().includes(a)):j.value}),_l=D(()=>pa.value.map(a=>{const e=z.value.find(o=>o.id===a.id);return e?{...a,qty:e.qty}:{...a,qty:0}})),ma=D(()=>z.value.reduce((a,e)=>a+Number(e.price)*Number(e.qty),0));function va(a){const e=Number(a.qty||0);if(r.value[a.id]={},!e||e<=0){r.value[a.id].qty="Enter a valid quantity.",v.error("Enter a valid quantity.");return}const o=z.value.find(t=>t.id===a.id);o?o.qty=e:z.value.push({id:a.id,name:a.name,category:a.category,price:a.price,qty:e}),Q.value||(a.qty=null),v.success(`${a.name} added to deal!`)}function ga(a){const e=z.value[a];if(!e)return;z.value.splice(a,1);const o=_l.value.find(t=>t.id===e.id);o&&(o.qty=null)}const _a=async()=>{try{const a=await axios.get("/api/menu/items",{params:{per_page:99999,status:1}});j.value=(a.data.data||[]).filter(e=>e.type!=="deal")}catch(a){console.error("âŒ Error fetching all menus:",a),v.error("Failed to fetch menu items")}},ba=()=>{const a=bootstrap.Modal.getInstance(document.getElementById("addItemModal"));a&&a.hide(),_a(),console.log("menuItems",j.value),console.log("menu_item_ids",s.value.menu_item_ids),Q.value&&Array.isArray(s.value.menu_item_ids)&&s.value.menu_item_ids.length>0&&(z.value=s.value.menu_item_ids.map(e=>{const o=typeof e=="object"?e.id:e,t=typeof e=="object"&&e.qty||1,n=j.value.find(p=>p.id===o);return n?{id:n.id,name:n.name,category:n.category,price:n.price,qty:t}:null}).filter(Boolean)),setTimeout(()=>{const e=document.getElementById("addMenuSelectionModal");if(!e){console.error("Menu modal element not found");return}new bootstrap.Modal(e).show()},300)};function fa(){if(z.value.length===0){v.error("Please add at least one menu item");return}s.value.menu_item_ids=z.value.map(e=>({id:e.id,qty:e.qty})),v.success("Menu items saved successfully!"),bootstrap.Modal.getInstance(document.getElementById("addMenuSelectionModal")).hide(),setTimeout(()=>{new bootstrap.Modal(document.getElementById("addItemModal")).show()},300)}return(a,e)=>{const o=Ca("ConfirmModal");return d(),Ve(Aa,null,{default:$e(()=>[x(y(Ia),{title:"Menus"}),l("div",La,[e[140]||(e[140]=l("h4",{class:"mb-3"},"Items",-1)),l("div",ja,[(d(!0),u(E,null,O(Bl.value,t=>(d(),u("div",{key:t.label,class:"col-md-6 col-xl-4"},[l("div",Ba,[l("div",Oa,[l("div",null,[l("div",Za,c(t.value),1),l("div",Ra,c(t.label),1)]),l("div",{class:f(["icon-chip",t.iconBg])},[(d(),Ve(Ma(t.icon),{class:f(t.iconColor),size:"26"},null,8,["class"]))],2)])])]))),128))]),l("div",za,[l("div",Wa,[l("div",Ga,[e[61]||(e[61]=l("h4",{class:"mb-0"},"Items",-1)),l("div",Xa,[l("div",Ya,[e[58]||(e[58]=l("i",{class:"bi bi-search"},null,-1)),e[59]||(e[59]=l("input",{type:"email",name:"email",autocomplete:"email",style:{position:"absolute",left:"-9999px",width:"1px",height:"1px"},tabindex:"-1","aria-hidden":"true"},null,-1)),ol.value?C((d(),u("input",{id:Re,"onUpdate:modelValue":e[0]||(e[0]=t=>ge.value=t),key:sl.value,class:"form-control search-input",placeholder:"Search",type:"search",autocomplete:"new-password",name:Re,role:"presentation",onFocus:e[1]||(e[1]=(...t)=>a.handleFocus&&a.handleFocus(...t))},null,32)),[[N,ge.value]]):(d(),u("input",Ka))]),l("div",Ha,[x(Ua,{modelValue:Y.value,"onUpdate:modelValue":e[2]||(e[2]=t=>Y.value=t),title:"Menu Items","modal-id":"menuFilterModal","modal-size":"modal-lg",categories:ze.value.categories,"sort-options":ze.value.sortOptions,"status-options":ze.value.statusOptions,"show-price-range":!0,"show-date-range":!1,"show-category":!1,"show-stock-status":!1,onApply:Pl,onClear:ql},null,8,["modelValue","categories","sort-options","status-options"])]),l("button",{"data-bs-toggle":"modal",onClick:Jl,"data-bs-target":"#addItemModal",class:"d-flex align-items-center gap-1 px-4 btn-sm py-2 rounded-pill btn btn-primary text-white"},[x(y(Il),{class:"w-4 h-4"}),e[60]||(e[60]=K(" Add Item ",-1))]),x(Na,{label:"Import",sampleHeaders:ua,sampleData:ca,onOnImport:na}),x(y(Pa),{modelValue:Le.value,"onUpdate:modelValue":e[3]||(e[3]=t=>Le.value=t),options:Sl,optionLabel:"label",optionValue:"value",placeholder:"Export",class:"export-dropdown",onChange:Vl},null,8,["modelValue"])])]),l("div",Qa,[l("table",Ja,[e[64]||(e[64]=l("thead",{class:"border-top small text-muted"},[l("tr",null,[l("th",null,"S.#"),l("th",null,"Image"),l("th",null,"Item Name"),l("th",null,"Category"),l("th",null,"Price"),l("th",null,"Status"),l("th",{class:"text-center"},"Action")])],-1)),l("tbody",null,[se.value?(d(),u("tr",et,[...e[62]||(e[62]=[l("td",{colspan:"8",class:"text-center py-5"},[l("div",{class:"d-flex flex-column align-items-center justify-content-center"},[l("div",{class:"spinner-border text-primary mb-3",role:"status"},[l("span",{class:"visually-hidden"},"Loading...")]),l("p",{class:"text-muted mb-0"},"Loading Items...")])],-1)])])):(d(),u(E,{key:1},[(d(!0),u(E,null,O(il.value,(t,n)=>(d(),u("tr",{key:`${t.type}-${t.id}`},[l("td",null,c((de.value-1)*Fe.value+n+1),1),l("td",null,[x(qe,{file:t.image_url||"/assets/img/default.png",alt:t.name,width:50,height:50,custom_class:"cursor-pointer"},null,8,["file","alt"])]),l("td",lt,[K(c(t.name)+" ",1),l("span",{class:f(["badge ms-2",t.type==="deal"?"bg-info":"bg-secondary"])},c(t.type==="deal"?"Deal":"Menu"),3)]),l("td",at,c(t.category?.name||"â€”"),1),l("td",null,c(y(W)(t.price||0,"GBP")),1),l("td",null,[t.status===0?(d(),u("span",tt," Inactive ")):(d(),u("span",st," Active "))]),l("td",ot,[l("div",nt,[l("button",{onClick:p=>t.type==="deal"?zl(t):Kl(t),"data-bs-toggle":"modal",title:"Edit",class:"p-2 rounded-full text-blue-600 hover:bg-blue-100"},[x(y(Ml),{class:"w-4 h-4"})],8,it),x(o,{title:"Confirm Status Change",message:`Are you sure you want to ${t.status===1?"deactivate":"activate"} this ${t.type}?`,showStatusButton:!0,status:t.status===1?"active":"inactive",onConfirm:()=>t.type==="deal"?Gl(t):Ql(t)},{trigger:$e(()=>[l("button",{class:f(["relative inline-flex items-center w-8 h-4 rounded-full transition-colors duration-300 focus:outline-none",t.status===1?"bg-green-500 hover:bg-green-600":"bg-red-400 hover:bg-red-500"]),title:t.status===1?"Set Inactive":"Set Active"},[l("span",{class:f(["absolute left-0.5 top-0.5 w-3 h-3 bg-white rounded-full shadow transform transition-transform duration-300",t.status===1?"translate-x-4":"translate-x-0"])},null,2)],10,rt)]),_:2},1032,["message","status","onConfirm"])])])]))),128)),il.value.length===0?(d(),u("tr",dt,[...e[63]||(e[63]=[l("td",{colspan:"8",class:"text-center text-muted py-4"}," No items found. ",-1)])])):m("",!0)],64))])])]),Ze.value.length>0&&!se.value?(d(),u("div",ut,[l("div",ct," Showing "+c((de.value-1)*Fe.value+1)+" to "+c(Math.min(de.value*Fe.value,Te.value))+" of "+c(Te.value)+" results ",1),x(Sa,{pagination:Ze.value,isApiDriven:!0,onPageChanged:Ul},null,8,["pagination"])])):m("",!0)])]),l("div",pt,[l("div",mt,[l("div",vt,[l("div",gt,[l("h5",_t,c(Q.value==!0?"Edit Item":"Add Item"),1),l("button",{onClick:_e,class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[...e[65]||(e[65]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),l("div",bt,[l("ul",ft,[l("li",yt,[l("button",{class:f(["nav-link",{active:L.value==="simple"}]),onClick:e[4]||(e[4]=t=>L.value="simple"),type:"button"}," Simple Item ",2)]),l("li",ht,[l("button",{class:f(["nav-link",{active:L.value==="variant"}]),onClick:e[5]||(e[5]=t=>L.value="variant"),type:"button"}," Variant Item ",2)]),l("li",xt,[l("button",{class:f(["nav-link",{active:L.value==="deals"}]),onClick:e[6]||(e[6]=t=>L.value="deals"),type:"button"}," Deals ",2)])]),l("div",wt,[C(l("div",null,[l("div",kt,[l("div",Ct,[e[66]||(e[66]=l("label",{class:"form-label"},"Item Name",-1)),C(l("input",{"onUpdate:modelValue":e[7]||(e[7]=t=>s.value.name=t),type:"text",class:f(["form-control",{"is-invalid":r.value.name}]),placeholder:"e.g., Chicken Breast"},null,2),[[N,s.value.name]]),r.value.name?(d(),u("small",It,c(r.value.name[0]),1)):m("",!0)]),l("div",Mt,[e[67]||(e[67]=l("label",{class:"form-label d-block"},"Base Price",-1)),C(l("input",{"onUpdate:modelValue":e[8]||(e[8]=t=>s.value.price=t),type:"number",min:"0",class:f(["form-control",{"is-invalid":r.value.price}]),placeholder:"e.g., 0.00"},null,2),[[N,s.value.price]]),r.value.price?(d(),u("small",St,c(r.value.price[0]),1)):m("",!0)]),l("div",Vt,[e[68]||(e[68]=l("label",{class:"form-label"},"Is this Taxable Item?",-1)),x(y(le),{modelValue:s.value.is_taxable,"onUpdate:modelValue":e[9]||(e[9]=t=>s.value.is_taxable=t),options:De.value,optionLabel:"label",optionValue:"value",placeholder:"Select Option",class:f(["w-100",{"is-invalid":r.value.is_taxable}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","class"]),r.value.is_taxable?(d(),u("small",$t,c(r.value.is_taxable[0]),1)):m("",!0)]),l("div",At,[e[71]||(e[71]=l("label",{class:"form-label"},"Is this Saleable Item?",-1)),l("div",Et,[l("div",Ft,[C(l("input",{"onUpdate:modelValue":e[10]||(e[10]=t=>s.value.is_saleable=t),value:!0,type:"radio",class:"form-check-input",id:"saleable_yes",name:"is_saleable",checked:s.value.is_saleable===!0},null,8,Tt),[[ke,s.value.is_saleable]]),e[69]||(e[69]=l("label",{class:"form-check-label",for:"saleable_yes"}," Yes ",-1))]),l("div",Ut,[C(l("input",{"onUpdate:modelValue":e[11]||(e[11]=t=>s.value.is_saleable=t),value:!1,type:"radio",class:"form-check-input",id:"saleable_no",name:"is_saleable",checked:s.value.is_saleable===!1},null,8,Nt),[[ke,s.value.is_saleable]]),e[70]||(e[70]=l("label",{class:"form-check-label",for:"saleable_no"}," No ",-1))])])]),s.value.is_saleable?(d(),u("div",Pt,[e[72]||(e[72]=l("label",{class:"form-label"},"Sale Type",-1)),x(y(le),{modelValue:s.value.resale_type,"onUpdate:modelValue":e[12]||(e[12]=t=>s.value.resale_type=t),options:cl.value,optionLabel:"label",optionValue:"value",placeholder:"Select Resale Type",class:f(["w-100",{"is-invalid":r.value.resale_type}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","class"]),r.value.resale_type?(d(),u("small",qt,c(r.value.resale_type[0]),1)):m("",!0)])):m("",!0),s.value.is_saleable&&s.value.resale_type?(d(),u("div",Dt,[l("label",Lt,c(s.value.resale_type==="flat"?"Flat Amount":"Percentage"),1),l("div",jt,[C(l("input",{"onUpdate:modelValue":e[13]||(e[13]=t=>s.value.resale_value=t),type:"number",min:"0",step:s.value.resale_type==="flat"?"0.01":"0.1",class:f(["form-control",{"is-invalid":r.value.resale_value}]),placeholder:`Enter ${s.value.resale_type==="flat"?"flat amount":"percentage"}...`},null,10,Bt),[[N,s.value.resale_value,void 0,{number:!0}]]),s.value.resale_type==="percentage"?(d(),u("span",Ot," % ")):(d(),u("span",Zt,c((s.value.price,"Â£")),1))]),r.value.resale_value?(d(),u("small",Rt,c(r.value.resale_value[0]),1)):m("",!0)])):m("",!0),l("div",zt,[e[73]||(e[73]=l("label",{class:"form-label d-block"}," Label Color ",-1)),x(y(le),{modelValue:s.value.label_color,"onUpdate:modelValue":e[14]||(e[14]=t=>s.value.label_color=t),options:je,optionLabel:"name",optionValue:"value",placeholder:"Select Label Color",class:f(["w-100",{"is-invalid":r.value.label_color}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","class"]),e[74]||(e[74]=l("br",null,null,-1)),r.value.label_color?(d(),u("small",Wt,c(r.value.label_color[0]),1)):m("",!0)]),l("div",Gt,[e[75]||(e[75]=l("label",{class:"form-label"},"Category",-1)),x(y(le),{modelValue:s.value.category_id,"onUpdate:modelValue":[e[15]||(e[15]=t=>s.value.category_id=t),e[16]||(e[16]=t=>s.value.subcategory="")],options:Z.categories,optionLabel:"name",optionValue:"id",placeholder:"Select Category",class:f(["w-100",{"is-invalid":r.value.category_id}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","class"]),r.value.category_id?(d(),u("small",Xt,c(r.value.category_id[0]),1)):m("",!0)]),l("div",Yt,[e[76]||(e[76]=l("label",{class:"form-label d-block"},"Meals",-1)),x(y(ae),{modelValue:s.value.meals,"onUpdate:modelValue":e[17]||(e[17]=t=>s.value.meals=t),options:Z.meals,optionLabel:"name",optionValue:"id",filter:"",placeholder:"Select Meals",class:f(["w-full md:w-80",{"is-invalid":r.value.meals}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","class"]),r.value.meals?(d(),u("small",Kt,c(r.value.meals[0]),1)):m("",!0)]),rl.value.length?(d(),u("div",Ht,[e[77]||(e[77]=l("label",{class:"form-label"},"Subcategory",-1)),x(y(le),{modelValue:s.value.subcategory,"onUpdate:modelValue":e[18]||(e[18]=t=>s.value.subcategory=t),options:rl.value,optionLabel:"name",optionValue:"value",placeholder:"Select Subcategory",class:f(["w-100",{"is-invalid":r.value.subcategory}]),appendTo:a.body,autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","appendTo","class"]),r.value.subcategory?(d(),u("small",Qt,c(r.value.subcategory[0]),1)):m("",!0)])):m("",!0),l("div",Jt,[e[78]||(e[78]=l("label",{class:"form-label"},"Description",-1)),C(l("textarea",{"onUpdate:modelValue":e[19]||(e[19]=t=>s.value.description=t),rows:"4",class:f(["form-control",{"is-invalid":r.value.description}]),placeholder:"Notes about this product"},null,2),[[N,s.value.description]]),r.value.description?(d(),u("small",es,c(r.value.description[0]),1)):m("",!0)])]),l("div",ls,[l("div",as,[e[79]||(e[79]=l("label",{class:"form-label d-block"},"Allergies",-1)),l("div",{onClick:Oe,class:"form-control py-2 px-3",style:{cursor:"pointer"}},[F.value.length===0?(d(),u("span",ts," Select Allergies ")):(d(),u("span",ss,[(d(!0),u(E,null,O(F.value,(t,n)=>(d(),u("span",{key:n,class:"badge text-dark mx-1 d-inline-flex align-items-center"},[K(c(t.name)+" ",1),t.type==="Contain"?(d(),u("span",os," (âœ”ï¸) ")):(d(),u("span",ns," (*) "))]))),128))]))])]),l("div",is,[e[80]||(e[80]=l("label",{class:"form-label d-block"},"Tags",-1)),x(y(ae),{modelValue:s.value.tags,"onUpdate:modelValue":e[20]||(e[20]=t=>s.value.tags=t),options:Z.tags,optionLabel:"name",optionValue:"id",filter:"",placeholder:"Select Tags",class:f(["w-full md:w-80",{"is-invalid":r.value.tags}]),appendTo:"self"},null,8,["modelValue","options","class"]),e[81]||(e[81]=l("br",null,null,-1)),r.value.tags?(d(),u("small",rs,c(r.value.tags[0]),1)):m("",!0)]),l("div",ds,[e[82]||(e[82]=l("label",{class:"form-label"},"Addon Groups",-1)),x(y(ae),{modelValue:s.value.addon_group_ids,"onUpdate:modelValue":[e[21]||(e[21]=t=>s.value.addon_group_ids=t),Ce],options:Z.addonGroups,optionLabel:"name",optionValue:"id",filter:"",placeholder:"Select Addon Groups",class:f(["w-100",{"is-invalid":r.value.addon_group_ids}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","class"]),r.value.addon_group_ids?(d(),u("small",us,c(r.value.addon_group_ids[0]),1)):m("",!0)]),G.value&&G.value.length>0?(d(),u("div",cs,[e[83]||(e[83]=l("label",{class:"form-label"},"Select Addons",-1)),x(y(ae),{modelValue:s.value.addon_ids,"onUpdate:modelValue":e[22]||(e[22]=t=>s.value.addon_ids=t),options:G.value,optionLabel:"name",optionValue:"id",filter:"",placeholder:"Select Addons",class:f(["w-full",{"is-invalid":r.value.addon_ids}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},{option:$e(t=>[l("div",ps,[l("span",null,c(t.option.name),1),l("span",ms,c(y(W)(t.option.price)),1)])]),_:1},8,["modelValue","options","class"]),r.value.addon_ids?(d(),u("small",vs,c(r.value.addon_ids[0]),1)):m("",!0)])):m("",!0)]),l("div",gs,[l("div",_s,[l("div",{class:f(["logo-card",{"is-invalid":r.value.image}])},[l("div",{class:"logo-frame",onClick:e[23]||(e[23]=t=>s.value.imageUrl?We():oe.value=!0)},[s.value.imageUrl?(d(),u("img",{key:0,src:s.value.imageUrl,alt:"Menu Item Image"},null,8,bs)):(d(),u("div",fs,[...e[84]||(e[84]=[l("i",{class:"bi bi-image"},null,-1)])]))]),e[85]||(e[85]=l("small",{class:"text-muted mt-2 d-block"},"Upload Image",-1)),x(He,{show:oe.value,onClose:e[24]||(e[24]=t=>oe.value=!1),onCropped:Ge},null,8,["show"]),te.value?(d(),Ve(qe,{key:0,show:te.value,image:he.value,onClose:e[25]||(e[25]=t=>te.value=!1)},null,8,["show","image"])):m("",!0)],2)]),l("div",ys,[l("button",{class:f(["btn btn-primary rounded-pill px-4",{"is-invalid":r.value.ingredients}]),onClick:e[26]||(e[26]=t=>vl(!1))},c(Q.value==!0?"Ingredients":"+ Add Ingredients"),3),r.value.ingredients?(d(),u("small",hs,c(r.value.ingredients[0]),1)):m("",!0),I.value.length>0?(d(),u("div",xs,[l("div",ws,[l("div",ks,[e[86]||(e[86]=l("div",{class:"mb-2"}," Total Nutrition (Item) ",-1)),l("div",Cs,[l("span",Is," Calories: "+c(P.value.calories),1),l("span",Ms," Protein: "+c(P.value.protein)+" g ",1),l("span",Ss," Carbs: "+c(P.value.carbs)+" g ",1),l("span",Vs," Fat: "+c(P.value.fat)+" g ",1)])])]),l("div",$s,[l("div",As,[l("table",Es,[e[87]||(e[87]=l("thead",null,[l("tr",null,[l("th",null,"Name"),l("th",null,"Qty")])],-1)),l("tbody",null,[(d(!0),u(E,null,O(I.value,(t,n)=>(d(),u("tr",{key:n},[l("td",null,c(t.name),1),l("td",null,c(t.qty),1)]))),128))])])])])])):m("",!0)])])],512),[[Qe,L.value==="simple"]]),C(l("div",null,[l("div",Fs,[l("div",Ts,[e[88]||(e[88]=l("label",{class:"form-label"},"Item Name",-1)),C(l("input",{"onUpdate:modelValue":e[27]||(e[27]=t=>s.value.name=t),type:"text",class:f(["form-control",{"is-invalid":r.value.name}]),placeholder:"e.g., Chicken Breast"},null,2),[[N,s.value.name]]),r.value.name?(d(),u("small",Us,c(r.value.name[0]),1)):m("",!0)]),l("div",Ns,[e[89]||(e[89]=l("label",{class:"form-label"},"Is this Taxable Item?",-1)),x(y(le),{modelValue:s.value.is_taxable,"onUpdate:modelValue":e[28]||(e[28]=t=>s.value.is_taxable=t),options:De.value,optionLabel:"label",optionValue:"value",placeholder:"Select Option",class:f(["w-100",{"is-invalid":r.value.is_taxable}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","class"]),r.value.is_taxable?(d(),u("small",Ps,c(r.value.is_taxable[0]),1)):m("",!0)]),l("div",qs,[e[90]||(e[90]=l("label",{class:"form-label d-block"},"Label Color",-1)),x(y(le),{modelValue:s.value.label_color,"onUpdate:modelValue":e[29]||(e[29]=t=>s.value.label_color=t),options:je,optionLabel:"name",optionValue:"value",placeholder:"Select Label Color",class:f(["w-100",{"is-invalid":r.value.label_color}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","class"]),r.value.label_color?(d(),u("small",Ds,c(r.value.label_color[0]),1)):m("",!0)]),l("div",Ls,[e[91]||(e[91]=l("label",{class:"form-label"},"Category",-1)),x(y(le),{modelValue:s.value.category_id,"onUpdate:modelValue":e[30]||(e[30]=t=>s.value.category_id=t),options:Z.categories,optionLabel:"name",optionValue:"id",placeholder:"Select Category",class:f(["w-100",{"is-invalid":r.value.category_id}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","class"]),r.value.category_id?(d(),u("small",js,c(r.value.category_id[0]),1)):m("",!0)]),l("div",Bs,[e[92]||(e[92]=l("label",{class:"form-label d-block"},"Meals",-1)),x(y(ae),{modelValue:s.value.meals,"onUpdate:modelValue":e[31]||(e[31]=t=>s.value.meals=t),options:Z.meals,optionLabel:"name",optionValue:"id",filter:"",placeholder:"Select Meals",class:f(["w-full md:w-80",{"is-invalid":r.value.meals}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","class"]),r.value.meals?(d(),u("small",Os,c(r.value.meals[0]),1)):m("",!0)]),l("div",Zs,[e[93]||(e[93]=l("label",{class:"form-label"},"Description",-1)),C(l("textarea",{"onUpdate:modelValue":e[32]||(e[32]=t=>s.value.description=t),rows:"4",class:"form-control",placeholder:"Notes about this product"},null,512),[[N,s.value.description]])])]),l("div",Rs,[l("div",zs,[e[94]||(e[94]=l("label",{class:"form-label d-block"},"Allergies",-1)),l("div",{onClick:Oe,class:"form-control py-2 px-3",style:{cursor:"pointer"}},[F.value.length===0?(d(),u("span",Ws," Select Allergies ")):(d(),u("span",Gs,[(d(!0),u(E,null,O(F.value,(t,n)=>(d(),u("span",{key:n,class:"badge text-dark mx-1 d-inline-flex align-items-center"},[K(c(t.name)+" ",1),t.type==="Contain"?(d(),u("span",Xs," (âœ”ï¸) ")):(d(),u("span",Ys," (*) "))]))),128))]))])]),l("div",Ks,[e[95]||(e[95]=l("label",{class:"form-label d-block"},"Tags",-1)),x(y(ae),{modelValue:s.value.tags,"onUpdate:modelValue":e[33]||(e[33]=t=>s.value.tags=t),options:Z.tags,optionLabel:"name",optionValue:"id",filter:"",placeholder:"Select Tags",class:f(["w-full md:w-80",{"is-invalid":r.value.tags}]),appendTo:"self"},null,8,["modelValue","options","class"]),r.value.tags?(d(),u("small",Hs,c(r.value.tags[0]),1)):m("",!0)]),l("div",Qs,[e[96]||(e[96]=l("label",{class:"form-label"},"Addon Groups",-1)),x(y(ae),{modelValue:s.value.addon_group_ids,"onUpdate:modelValue":[e[34]||(e[34]=t=>s.value.addon_group_ids=t),Ce],options:Z.addonGroups,optionLabel:"name",optionValue:"id",filter:"",placeholder:"Select Addon Groups",class:f(["w-100",{"is-invalid":r.value.addon_group_ids}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","class"]),r.value.addon_group_ids?(d(),u("small",Js,c(r.value.addon_group_ids[0]),1)):m("",!0)]),G.value&&G.value.length>0?(d(),u("div",eo,[e[97]||(e[97]=l("label",{class:"form-label"},"Select Addons",-1)),x(y(ae),{modelValue:s.value.addon_ids,"onUpdate:modelValue":e[35]||(e[35]=t=>s.value.addon_ids=t),options:G.value,optionLabel:"name",optionValue:"id",filter:"",placeholder:"Select Addons",class:f(["w-full",{"is-invalid":r.value.addon_ids}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},{option:$e(t=>[l("div",lo,[l("span",null,c(t.option.name),1),l("span",ao,c(y(W)(t.option.price)),1)])]),_:1},8,["modelValue","options","class"]),r.value.addon_ids?(d(),u("small",to,c(r.value.addon_ids[0]),1)):m("",!0)])):m("",!0)]),l("div",so,[l("div",oo,[l("div",no,[l("button",{onClick:e[36]||(e[36]=t=>vl(!0)),class:"d-flex align-items-center gap-1 px-4 py-2 rounded-pill btn btn-primary text-white"},[x(y(Il),{class:"w-4 h-4 me-1"}),e[98]||(e[98]=K(" Add Variant Ingredients ",-1))])])]),Object.keys(V.value).length>0?(d(),u("div",io,[e[101]||(e[101]=l("h6",{class:"fw-semibold mb-3"},[l("i",{class:"bi bi-card-list me-2"}),K("Saved Variant Ingredients ")],-1)),l("div",ro,[(d(!0),u(E,null,O(V.value,(t,n)=>(d(),u("div",{key:n,class:"col-lg-6 col-md-12"},[l("div",uo,[l("div",co,[l("div",po,[l("div",mo,[l("h6",vo,[e[99]||(e[99]=l("i",{class:"bi bi-tag me-2"},null,-1)),K(" "+c(Ie(n)),1)]),l("small",go," Price: "+c(y(W)(gl(n))),1)]),l("div",_o,[l("button",{onClick:p=>ra(n),class:"btn btn-primary btn-sm",style:{height:"32px !important"},title:"Edit ingredients"},[x(y(Ml),{class:"w-4 h-4"})],8,bo),l("button",{onClick:p=>da(n),class:"btn btn-danger btn-sm",style:{height:"32px !important"},title:"Delete variant"},[x(y(Cl),{class:"w-4 h-4"})],8,fo)])])]),l("div",yo,[l("div",ho,[l("div",xo,[l("span",wo," Calories: "+c(t.reduce((p,g)=>p+Number(g.nutrition?.calories||0)*Number(g.qty||0),0).toFixed(2)),1),l("span",ko," Protein: "+c(t.reduce((p,g)=>p+Number(g.nutrition?.protein||0)*Number(g.qty||0),0).toFixed(2))+" g ",1),l("span",Co," Carbs: "+c(t.reduce((p,g)=>p+Number(g.nutrition?.carbs||0)*Number(g.qty||0),0).toFixed(2))+" g ",1),l("span",Io," Fat: "+c(t.reduce((p,g)=>p+Number(g.nutrition?.fat||0)*Number(g.qty||0),0).toFixed(2))+" g ",1)])]),l("div",Mo,[l("table",So,[e[100]||(e[100]=l("thead",{class:"table-light"},[l("tr",null,[l("th",{class:"small"},"Name"),l("th",{class:"small"},"Qty")])],-1)),l("tbody",null,[(d(!0),u(E,null,O(t,(p,g)=>(d(),u("tr",{key:g},[l("td",Vo,c(p.name),1),l("td",$o,c(p.qty),1)]))),128))])])])])])]))),128))])])):m("",!0)]),l("div",Ao,[l("div",Eo,[e[104]||(e[104]=l("label",{class:"form-label fw-semibold"},"Item Image",-1)),l("div",{class:f(["logo-card",{"is-invalid":r.value.image}])},[l("div",{class:"logo-frame",onClick:e[37]||(e[37]=t=>s.value.imageUrl?We():oe.value=!0)},[s.value.imageUrl?(d(),u("img",{key:0,src:s.value.imageUrl,alt:"Menu Item Image"},null,8,Fo)):(d(),u("div",To,[...e[102]||(e[102]=[l("i",{class:"bi bi-image"},null,-1)])]))]),e[103]||(e[103]=l("small",{class:"text-muted mt-2 d-block"},"Upload Image",-1)),x(He,{show:oe.value,onClose:e[38]||(e[38]=t=>oe.value=!1),onCropped:Ge},null,8,["show"]),te.value?(d(),Ve(qe,{key:0,show:te.value,image:he.value,onClose:e[39]||(e[39]=t=>te.value=!1)},null,8,["show","image"])):m("",!0)],2)])]),l("div",Uo,[e[108]||(e[108]=l("h6",{class:"fw-semibold mb-3"},[l("i",{class:"bi bi-cash-coin me-2"}),K("Sale Settings ")],-1)),Object.keys(V.value).length>0?(d(),u("div",No,[(d(!0),u(E,null,O(V.value,(t,n)=>(d(),u("div",{key:n,class:"col-md-6"},[l("div",Po,[l("div",qo,[l("h6",Do,c(Ie(n)),1)]),l("div",Lo,[l("div",jo,[e[105]||(e[105]=l("label",{class:"form-label small fw-semibold"},"Enable Sale?",-1)),l("div",Bo,[l("div",Oo,[C(l("input",{id:`variant_saleable_yes_${n}`,type:"radio",class:"form-check-input",value:!0,name:`variant_saleable_${n}`,"onUpdate:modelValue":p=>M.value[n].is_saleable=p,checked:M.value[n].is_saleable===!0},null,8,Zo),[[ke,M.value[n].is_saleable]]),l("label",{class:"form-check-label small",for:`variant_saleable_yes_${n}`}," Yes ",8,Ro)]),l("div",zo,[C(l("input",{id:`variant_saleable_no_${n}`,type:"radio",class:"form-check-input",value:!1,name:`variant_saleable_${n}`,"onUpdate:modelValue":p=>M.value[n].is_saleable=p,checked:M.value[n].is_saleable===!1},null,8,Wo),[[ke,M.value[n].is_saleable]]),l("label",{class:"form-check-label small",for:`variant_saleable_no_${n}`}," No ",8,Go)])])]),M.value[n].is_saleable?(d(),u("div",Xo,[l("div",Yo,[e[106]||(e[106]=l("label",{class:"form-label small"},"Sale Type",-1)),x(y(le),{modelValue:M.value[n].resale_type,"onUpdate:modelValue":p=>M.value[n].resale_type=p,options:cl.value,optionLabel:"label",optionValue:"value",placeholder:"Select",class:"w-100",style:{fontSize:"0.875rem"},appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","onUpdate:modelValue","options"])]),l("div",Ko,[l("label",Ho,c(M.value[n].resale_type==="flat"?"Flat Amount":"Percentage"),1),l("div",Qo,[C(l("input",{"onUpdate:modelValue":p=>M.value[n].resale_value=p,type:"number",min:"0",step:M.value[n].resale_type==="flat"?"0.01":"0.1",class:"form-control py-2",placeholder:`Enter ${M.value[n].resale_type==="flat"?"amount":"%"}`},null,8,Jo),[[N,M.value[n].resale_value,void 0,{number:!0}]]),l("span",en,c(M.value[n].resale_type==="percentage"?"%":"Â£"),1)])])])):m("",!0)])])]))),128))])):(d(),u("div",ln,[...e[107]||(e[107]=[l("i",{class:"bi bi-info-circle me-2"},null,-1),K(" Add variant ingredients first to configure resale settings. ",-1)])]))])],512),[[Qe,L.value==="variant"]]),C(l("div",null,[l("div",an,[l("div",tn,[e[109]||(e[109]=l("label",{class:"form-label"},"Deal Name",-1)),C(l("input",{"onUpdate:modelValue":e[40]||(e[40]=t=>s.value.deal_name=t),type:"text",class:f(["form-control",{"is-invalid":r.value.deal_name||r.value.name}]),placeholder:"e.g., Family Deal"},null,2),[[N,s.value.deal_name]]),r.value.deal_name||r.value.name?(d(),u("small",sn,c(r.value.deal_name?.[0]||r.value.name?.[0]),1)):m("",!0)]),l("div",on,[e[110]||(e[110]=l("label",{class:"form-label"},"Deal Price",-1)),C(l("input",{"onUpdate:modelValue":e[41]||(e[41]=t=>s.value.deal_price=t),type:"number",min:"0",step:"0.01",class:f(["form-control",{"is-invalid":r.value.deal_price||r.value.price}]),placeholder:"e.g., 29.99"},null,2),[[N,s.value.deal_price]]),r.value.deal_price||r.value.price?(d(),u("small",nn,c(r.value.deal_price?.[0]||r.value.price?.[0]),1)):m("",!0)]),l("div",rn,[e[111]||(e[111]=l("label",{class:"form-label"},"Is this Taxable Deal?",-1)),x(y(le),{modelValue:s.value.is_taxable,"onUpdate:modelValue":e[42]||(e[42]=t=>s.value.is_taxable=t),options:De.value,optionLabel:"label",optionValue:"value",placeholder:"Select Option",class:f(["w-100",{"is-invalid":r.value.is_taxable}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","class"]),r.value.is_taxable?(d(),u("small",dn,c(r.value.is_taxable[0]),1)):m("",!0)]),l("div",un,[e[112]||(e[112]=l("label",{class:"form-label d-block"},"Label Color",-1)),x(y(le),{modelValue:s.value.label_color,"onUpdate:modelValue":e[43]||(e[43]=t=>s.value.label_color=t),options:je,optionLabel:"name",optionValue:"value",placeholder:"Select Label Color",class:f(["w-100",{"is-invalid":r.value.label_color}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","class"]),r.value.label_color?(d(),u("small",cn,c(r.value.label_color[0]),1)):m("",!0)]),l("div",pn,[e[113]||(e[113]=l("label",{class:"form-label"},"Category",-1)),x(y(le),{modelValue:s.value.category_id,"onUpdate:modelValue":[e[44]||(e[44]=t=>s.value.category_id=t),e[45]||(e[45]=t=>s.value.subcategory="")],options:Z.categories,optionLabel:"name",optionValue:"id",placeholder:"Select Category",class:f(["w-100",{"is-invalid":r.value.category_id}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","class"]),r.value.category_id?(d(),u("small",mn,c(r.value.category_id[0]),1)):m("",!0)]),l("div",vn,[e[114]||(e[114]=l("label",{class:"form-label d-block"},"Meals",-1)),x(y(ae),{modelValue:s.value.meals,"onUpdate:modelValue":e[46]||(e[46]=t=>s.value.meals=t),options:Z.meals,optionLabel:"name",optionValue:"id",filter:"",placeholder:"Select Meals",class:f(["w-full md:w-80",{"is-invalid":r.value.meals}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","class"]),r.value.meals?(d(),u("small",gn,c(r.value.meals[0]),1)):m("",!0)]),l("div",_n,[e[115]||(e[115]=l("label",{class:"form-label"},"Description",-1)),C(l("textarea",{"onUpdate:modelValue":e[47]||(e[47]=t=>s.value.description=t),rows:"4",class:f(["form-control",{"is-invalid":r.value.description}]),placeholder:"Deal description"},null,2),[[N,s.value.description]]),r.value.description?(d(),u("small",bn,c(r.value.description[0]),1)):m("",!0)])]),l("div",fn,[l("div",yn,[e[116]||(e[116]=l("label",{class:"form-label d-block"},"Allergies",-1)),l("div",{onClick:Oe,class:"form-control py-2 px-3",style:{cursor:"pointer"}},[F.value.length===0?(d(),u("span",hn," Select Allergies ")):(d(),u("span",xn,[(d(!0),u(E,null,O(F.value,(t,n)=>(d(),u("span",{key:n,class:"badge text-dark mx-1 d-inline-flex align-items-center"},[K(c(t.name)+" ",1),t.type==="Contain"?(d(),u("span",wn,"(âœ”ï¸)")):(d(),u("span",kn,"(*)"))]))),128))]))])]),l("div",Cn,[e[117]||(e[117]=l("label",{class:"form-label d-block"},"Tags",-1)),x(y(ae),{modelValue:s.value.tags,"onUpdate:modelValue":e[48]||(e[48]=t=>s.value.tags=t),options:Z.tags,optionLabel:"name",optionValue:"id",filter:"",placeholder:"Select Tags",class:f(["w-full md:w-80",{"is-invalid":r.value.tags}]),appendTo:"self"},null,8,["modelValue","options","class"]),r.value.tags?(d(),u("small",In,c(r.value.tags[0]),1)):m("",!0)]),l("div",Mn,[e[118]||(e[118]=l("label",{class:"form-label"},"Addon Groups",-1)),x(y(ae),{modelValue:s.value.addon_group_ids,"onUpdate:modelValue":[e[49]||(e[49]=t=>s.value.addon_group_ids=t),Ce],options:Z.addonGroups,optionLabel:"name",optionValue:"id",filter:"",placeholder:"Select Addon Groups",class:f(["w-100",{"is-invalid":r.value.addon_group_ids}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","class"]),r.value.addon_group_ids?(d(),u("small",Sn,c(r.value.addon_group_ids[0]),1)):m("",!0)]),G.value&&G.value.length>0?(d(),u("div",Vn,[e[119]||(e[119]=l("label",{class:"form-label"},"Select Addons",-1)),x(y(ae),{modelValue:s.value.addon_ids,"onUpdate:modelValue":e[50]||(e[50]=t=>s.value.addon_ids=t),options:G.value,optionLabel:"name",optionValue:"id",filter:"",placeholder:"Select Addons",class:f(["w-full",{"is-invalid":r.value.addon_ids}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},{option:$e(t=>[l("div",$n,[l("span",null,c(t.option.name),1),l("span",An,c(y(W)(t.option.price)),1)])]),_:1},8,["modelValue","options","class"]),r.value.addon_ids?(d(),u("small",En,c(r.value.addon_ids[0]),1)):m("",!0)])):m("",!0)]),l("div",Fn,[l("div",Tn,[l("div",{class:f(["logo-card",{"is-invalid":r.value.image}])},[l("div",{class:"logo-frame",onClick:e[51]||(e[51]=t=>s.value.imageUrl?We():oe.value=!0)},[s.value.imageUrl?(d(),u("img",{key:0,src:s.value.imageUrl,alt:"Deal Image"},null,8,Un)):(d(),u("div",Nn,[...e[120]||(e[120]=[l("i",{class:"bi bi-image"},null,-1)])]))]),e[121]||(e[121]=l("small",{class:"text-muted mt-2 d-block"},"Upload Image",-1)),x(He,{show:oe.value,onClose:e[52]||(e[52]=t=>oe.value=!1),onCropped:Ge},null,8,["show"]),te.value?(d(),Ve(qe,{key:0,show:te.value,image:he.value,onClose:e[53]||(e[53]=t=>te.value=!1)},null,8,["show","image"])):m("",!0)],2)]),l("div",Pn,[l("button",{class:f(["btn btn-primary rounded-pill px-4",{"is-invalid":r.value.menu_item_ids}]),onClick:ba},c(Q.value?"Menu Items":"+ Add Menu Items"),3),r.value.menu_item_ids?(d(),u("small",qn,c(r.value.menu_item_ids[0]),1)):m("",!0),Array.isArray(s.value.menu_item_ids)&&s.value.menu_item_ids.length>0?(d(),u("div",Dn,[l("div",Ln,[l("div",jn,[e[122]||(e[122]=l("div",{class:"mb-2"},"Deal Summary",-1)),l("div",Bn,[l("span",On," Items: "+c(s.value.menu_item_ids.length),1),l("span",Zn," Total: "+c(y(W)(s.value.menu_item_ids.reduce((t,n)=>{const p=j.value.find(i=>i.id===(n.id||n)),g=n.qty||1;return t+(p?.price||0)*g},0))),1),s.value.deal_price?(d(),u("span",Rn," Deal: "+c(y(W)(s.value.deal_price)),1)):m("",!0)])])]),l("div",zn,[l("div",Wn,[l("table",Gn,[e[123]||(e[123]=l("thead",null,[l("tr",null,[l("th",null,"Item Name"),l("th",null,"Qty"),l("th",null,"Price"),l("th",null,"Total")])],-1)),l("tbody",null,[(d(!0),u(E,null,O(s.value.menu_item_ids,(t,n)=>(d(),u("tr",{key:n},[l("td",null,c(j.value.find(p=>p.id===(t.id||t))?.name),1),l("td",null,c(t.qty||1),1),l("td",null,c(y(W)(j.value.find(p=>p.id===(t.id||t))?.price||0)),1),l("td",null,c(y(W)((j.value.find(p=>p.id===(t.id||t))?.price||0)*(t.qty||1))),1)]))),128))])])])])])):m("",!0)])])],512),[[Qe,L.value==="deals"]])]),l("div",Xn,[l("button",{class:"btn btn-primary rounded-pill btn-sm px-5 py-2",disabled:ne.value,onClick:Zl},[ne.value?(d(),u(E,{key:0},[e[124]||(e[124]=l("span",{class:"spinner-border spinner-border-sm me-2"},null,-1)),e[125]||(e[125]=K(" Saving... ",-1))],64)):(d(),u(E,{key:1},[K(" Save ")],64))],8,Yn),l("button",{class:"btn btn-secondary btn-sm rounded-pill py-2 px-4 ms-2","data-bs-dismiss":"modal",onClick:_e}," Cancel ")])])])])]),ve.value?(d(),u("div",{key:0,class:f(["modal fade",{show:ve.value}]),id:"allergyModal",tabindex:"-1",style:Va({display:ve.value?"block":"none"}),"aria-hidden":"true"},[l("div",Kn,[l("div",Hn,[l("div",{class:"modal-header bg-light border-bottom"},[e[127]||(e[127]=l("h5",{class:"modal-title fw-bold"},"Select Allergies",-1)),l("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110",onClick:el,"data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[...e[126]||(e[126]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),l("div",Qn,[l("table",Jn,[e[128]||(e[128]=l("thead",{class:"table-light"},[l("tr",null,[l("th",{class:"fw-semibold"},"Allergy"),l("th",{class:"fw-semibold"},"Contain"),l("th",{class:"fw-semibold"},"Trace")])],-1)),l("tbody",null,[(d(!0),u(E,null,O(Z.allergies,t=>(d(),u("tr",{key:t.id},[l("td",ei,c(t.name),1),l("td",null,[C(l("input",{type:"radio",name:"allergy-"+t.id,value:"Contain","onUpdate:modelValue":n=>R.value[t.id]=n,class:"form-check-input",style:{width:"20px",height:"20px"}},null,8,li),[[ke,R.value[t.id]]])]),l("td",null,[C(l("input",{type:"radio",name:"allergy-"+t.id,value:"Trace","onUpdate:modelValue":n=>R.value[t.id]=n,class:"form-check-input",style:{width:"20px",height:"20px"}},null,8,ai),[[ke,R.value[t.id]]])])]))),128))])])]),l("div",{class:"modal-footer bg-light border-top"},[l("button",{class:"btn btn-secondary px-2 py-2",onClick:el}," Cancel "),l("button",{class:"btn btn-primary px-2 py-2",onClick:Al}," Save ")])])])],6)):m("",!0),ve.value?(d(),u("div",ti)):m("",!0),l("div",si,[l("div",oi,[l("div",ni,[l("div",ii,[l("h5",ri,[K(c(Q.value==!0?"Edit Ingredients":"Add Ingredients")+" ",1),me.value&&re.value?(d(),u("span",di,c(Ie(re.value)),1)):m("",!0)]),l("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",onClick:ll,title:"Close"},[...e[129]||(e[129]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),l("div",ui,[l("div",ci,[me.value?(d(),u("div",pi,[l("div",mi,[l("div",vi,[e[130]||(e[130]=l("label",{class:"form-label"},"Variant Name",-1)),C(l("input",{"onUpdate:modelValue":e[54]||(e[54]=t=>T.value.name=t),type:"text",class:"form-control",placeholder:"Enter custom variant name"},null,512),[[N,T.value.name]])]),l("div",gi,[e[131]||(e[131]=l("label",{class:"form-label"},"Variant Price",-1)),C(l("input",{"onUpdate:modelValue":e[55]||(e[55]=t=>T.value.price=t),type:"number",min:"0",step:"0.01",class:"form-control",placeholder:"Enter variant price"},null,512),[[N,T.value.price,void 0,{number:!0}]])])])])):m("",!0),l("div",_i,[l("div",bi,[C(l("input",{"onUpdate:modelValue":e[56]||(e[56]=t=>Be.value=t),type:"text",class:"form-control search-input",placeholder:"Search Items..."},null,512),[[N,Be.value]])]),(d(!0),u(E,null,O(pl.value,t=>(d(),u("div",{key:t.id,class:"card shadow-sm border-0 rounded-4 mb-3"},[l("div",fi,[l("div",yi,[l("img",{src:t.image_url?`${t.image_url}`:"/assets/img/default.png",class:"rounded",style:{width:"56px",height:"56px","object-fit":"cover",border:"1px solid white"}},null,8,hi),l("div",xi,[l("div",wi,c(t?.name),1),l("div",ki,"Category: "+c(t.category?.name),1),l("div",Ci,"Unit: "+c(t?.unit_name),1),l("div",Ii," Calories: "+c(t.nutrition?.calories||0)+", Protein: "+c(t.nutrition?.protein||0)+", Carbs: "+c(t.nutrition?.carbs||0)+", Fat: "+c(t.nutrition?.fat||0),1)]),l("button",{class:"btn btn-primary btn-sm py-2 px-4 rounded-pill",onClick:n=>Fl(t)},c(I.value.some(n=>n.id===t.id)?"Update":"Add"),9,Mi)]),l("div",Si,[l("div",Vi,[e[132]||(e[132]=l("label",{class:"small text-muted"},"Quantity",-1)),C(l("input",{"onUpdate:modelValue":n=>t.qty=n,type:"number",min:"0",class:"form-control form-control-sm"},null,8,$i),[[N,t.qty,void 0,{number:!0}]]),r.value[t.id]?.qty?(d(),u("small",Ai,c(r.value[t.id].qty),1)):m("",!0)])])])]))),128))]),l("div",Ei,[l("div",Fi,[l("div",Ti,[l("div",null,"Total Nutrition ("+c(me.value?"Variant":"Menu")+")",1),l("div",null,"Calories: "+c(P.value.calories),1),l("div",null,"Protein: "+c(P.value.protein)+" g",1),l("div",null,"Carbs: "+c(P.value.carbs)+" g",1),l("div",null,"Fat: "+c(P.value.fat)+" g",1)])]),l("div",Ui,[l("div",Ni,[l("table",Pi,[e[134]||(e[134]=l("thead",null,[l("tr",null,[l("th",null,"Name"),l("th",null,"Qty"),l("th",{class:"text-end"},"Action")])],-1)),l("tbody",null,[(d(!0),u(E,null,O(I.value,(t,n)=>(d(),u("tr",{key:n},[l("td",null,c(t.name),1),l("td",null,c(t.qty),1),l("td",qi,[l("button",{class:"btn btn-sm btn-danger",onClick:p=>Tl(n)}," Remove ",8,Di)])]))),128)),I.value.length===0?(d(),u("tr",Li,[...e[133]||(e[133]=[l("td",{colspan:"6",class:"text-center text-muted py-3"}," No ingredients added. ",-1)])])):m("",!0)])])])]),l("div",{class:"mt-3 text-center"},[l("button",{class:"btn btn-primary btn-sm py-2 px-5 rounded-pill",onClick:ia}," Done ")])])])])])])]),l("div",ji,[l("div",Bi,[l("div",Oi,[l("div",Zi,[l("h5",Ri,c(Q.value?"Edit Menu Items":"Add Menu Items"),1),l("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",onClick:ll,title:"Close"},[...e[135]||(e[135]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),l("div",zi,[l("div",Wi,[l("div",Gi,[l("div",Xi,[C(l("input",{"onUpdate:modelValue":e[57]||(e[57]=t=>Xe.value=t),type:"text",class:"form-control search-input",placeholder:"Search Menus..."},null,512),[[N,Xe.value]])]),(d(!0),u(E,null,O(_l.value,t=>(d(),u("div",{key:t.id,class:"card shadow-sm border-0 rounded-4 mb-3"},[l("div",Yi,[l("div",Ki,[l("img",{src:t.image_url?t.image_url:"/assets/img/default.png",class:"rounded",style:{width:"56px",height:"56px","object-fit":"cover",border:"1px solid white"}},null,8,Hi),l("div",Qi,[l("div",Ji,c(t.name),1),l("div",er,"Category: "+c(t.category?.name),1),l("div",lr,"Price: "+c(y(W)(t.price)),1)]),l("button",{class:"btn btn-primary btn-sm py-2 px-4 rounded-pill",onClick:n=>va(t)},c(z.value.some(n=>n.id===t.id)?"Update":"Add"),9,ar)]),l("div",tr,[l("div",sr,[e[136]||(e[136]=l("label",{class:"small text-muted"},"Quantity",-1)),C(l("input",{"onUpdate:modelValue":n=>t.qty=n,type:"number",min:"1",class:"form-control form-control-sm",placeholder:"Enter qty"},null,8,or),[[N,t.qty,void 0,{number:!0}]])])])])]))),128))]),l("div",nr,[l("div",ir,[l("div",rr,[e[137]||(e[137]=l("div",null,"Deal Summary",-1)),l("div",null,"Total Menu Items: "+c(z.value.length),1),l("div",null,"Total Price: "+c(y(W)(ma.value)),1)])]),l("div",dr,[l("div",ur,[l("table",cr,[e[139]||(e[139]=l("thead",null,[l("tr",null,[l("th",null,"Name"),l("th",null,"Qty"),l("th",null,"Price"),l("th",null,"Total"),l("th",{class:"text-end"},"Action")])],-1)),l("tbody",null,[(d(!0),u(E,null,O(z.value,(t,n)=>(d(),u("tr",{key:n},[l("td",null,c(t.name),1),l("td",null,c(t.qty),1),l("td",null,c(y(W)(t.price)),1),l("td",null,c(y(W)(t.price*t.qty)),1),l("td",pr,[l("button",{class:"btn btn-sm btn-danger",onClick:p=>ga(n)}," Remove ",8,mr)])]))),128)),z.value.length===0?(d(),u("tr",vr,[...e[138]||(e[138]=[l("td",{colspan:"5",class:"text-center text-muted py-3"}," No menu items added. ",-1)])])):m("",!0)])])])]),l("div",{class:"mt-3 text-center"},[l("button",{class:"btn btn-primary btn-sm py-2 px-5 rounded-pill",onClick:fa}," Done ")])])])])])])])])]),_:1})}}},Br=wa(gr,[["__scopeId","data-v-171641d0"]]);export{Br as default};
