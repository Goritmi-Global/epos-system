import{_ as ce,r as v,y as Ae,a as Ie,b as d,w as Z,f as r,m as p,e,t as o,k as A,v as X,l as T,V as Le,o as ie,n as Re,c as j,d as N,u as y,h as Ee,F as R,g as G,S as ue,i as Be,q as _}from"./app-TGxiLcAW.js";import{_ as Ve}from"./Master-J2bJ-NOm.js";import{u as ze}from"./useFormatters-C4x7YHWO.js";import{F as qe}from"./FilterModal-CczHNVxc.js";import{E as Ue,a as Ge,X as Xe,u as E,w as He}from"./xlsx-CYRbBo-W.js";import{E as We}from"./eye-BTecsPlp.js";import{C as Ke}from"./circle-x-D6ORGgFG.js";import"./index-DCqcadVw.js";import"./createLucideIcon-Bh-SXUX4.js";import"./index-2u1IeWL4.js";import"./index-C29vjDIk.js";import"./sun-C9h6XzSk.js";const Ye={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},Qe={class:"bg-white rounded-xl shadow-xl w-full max-w-md p-6 animate-drop-in relative"},Ze={class:"text-center text-lg font-medium text-gray-800 mb-2"},Je={class:"bg-gray-50 rounded-lg p-4 mb-4 space-y-2"},et={class:"flex justify-between text-sm"},tt={class:"font-medium text-gray-800"},st={class:"flex justify-between text-sm"},lt={class:"font-medium text-gray-800"},at={class:"flex justify-between text-sm"},ot={class:"font-medium text-gray-800"},nt={class:"mb-4"},dt={class:"flex justify-center gap-3"},rt=["disabled"],it={key:0,class:"spinner-border spinner-border-sm",role:"status"},ut=["disabled"],ct={__name:"OrderCancellationModal",props:{show:{type:Boolean,default:!1},order:{type:Object,default:null},loading:{type:Boolean,default:!1}},emits:["confirm","cancel"],setup(k,{emit:f}){const B=k,F=f,$=v("");Ae(()=>B.show,w=>{w||($.value="")});const D=()=>{F("confirm",$.value||"Cancelled by admin from orders page")},S=()=>{F("cancel")},c=w=>new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP"}).format(w||0);return(w,b)=>(d(),Ie(Le,{name:"fade-slide"},{default:Z(()=>[k.show?(d(),r("div",Ye,[e("div",Qe,[e("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110",onClick:S,"data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[...b[1]||(b[1]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])]),b[6]||(b[6]=e("div",{class:"flex justify-center mb-4"},[e("div",{class:"bg-red-100 p-3 rounded-full"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-8 h-8 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})])])],-1)),e("h3",Ze," Cancel Order #"+o(k.order?.id)+"? ",1),b[7]||(b[7]=e("p",{class:"text-center text-sm text-gray-500 mb-4"}," This action will cancel the order and cannot be undone. ",-1)),e("div",Je,[e("div",et,[b[2]||(b[2]=e("span",{class:"text-gray-600"},"Customer:",-1)),e("span",tt,o(k.order?.customer_name||"Walk In"),1)]),e("div",st,[b[3]||(b[3]=e("span",{class:"text-gray-600"},"Total Amount:",-1)),e("span",lt,o(c(k.order?.total_amount)),1)]),e("div",at,[b[4]||(b[4]=e("span",{class:"text-gray-600"},"Payment Type:",-1)),e("span",ot,o(k.order?.payment?.payment_type||"N/A"),1)])]),e("div",nt,[b[5]||(b[5]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Reason for Cancellation (Optional) ",-1)),A(e("textarea",{"onUpdate:modelValue":b[0]||(b[0]=O=>$.value=O),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-1 focus:ring-white focus:border-transparent resize-none",rows:"3",placeholder:"Enter reason for cancelling this order..."},null,512),[[X,$.value]])]),e("div",dt,[e("button",{onClick:D,disabled:k.loading,class:"btn btn-danger d-flex align-items-center gap-2 px-4 py-2 rounded-pill text-white"},[k.loading?(d(),r("span",it)):p("",!0),T(" "+o(k.loading?"Cancelling...":"Cancel Order"),1)],8,rt),e("button",{onClick:S,disabled:k.loading,class:"btn btn-secondary d-flex align-items-center gap-2 px-4 py-2 rounded-pill text-white"}," Keep Order ",8,ut)])])])):p("",!0)]),_:1}))}},mt=ce(ct,[["__scopeId","data-v-828b9886"]]),pt={class:"page-wrapper"},vt={class:"row g-3"},bt={class:"col-md-6 col-xl-4"},yt={class:"card border-0 shadow-sm rounded-4"},ft={class:"card-body d-flex align-items-center justify-content-between"},wt={class:"mb-0 fw-bold"},gt={class:"col-md-6 col-xl-4"},ht={class:"card border-0 shadow-sm rounded-4"},_t={class:"card-body d-flex align-items-center justify-content-between"},xt={class:"mb-0 fw-bold"},Ct={class:"col-md-6 col-xl-4"},kt={class:"card border-0 shadow-sm rounded-4"},$t={class:"card-body d-flex align-items-center justify-content-between"},Tt={class:"mb-0 fw-bold"},Dt={class:"card border-0 shadow-lg rounded-4 mt-0"},St={class:"card-body"},Ot={class:"d-flex flex-wrap gap-2 justify-content-between align-items-center mb-3"},Pt={class:"d-flex flex-wrap gap-2 align-items-center"},Ft={class:"search-wrap"},Mt={key:1,class:"form-control search-input",placeholder:"Search",disabled:"",type:"text"},jt={class:"col-md-6"},Nt=["onUpdate:modelValue"],At=["value"],It={class:"col-md-6 mt-3"},Lt=["onUpdate:modelValue"],Rt=["value"],Et={class:"dropdown"},Bt={class:"dropdown-menu dropdown-menu-end shadow rounded-4 py-2"},Vt={class:"table-responsive"},zt={class:"table table-hover align-middle mb-0",style:{"min-height":"320px"}},qt=["onClick"],Ut={style:{"font-size":"14px"}},Gt={class:"text-muted small"},Xt={class:"text-left"},Ht={class:"d-flex gap-2 justify-content-center align-items-center"},Wt=["onClick"],Kt=["onClick","disabled"],Yt=["onClick","disabled"],Qt={key:0},Zt={class:"modal fade",id:"paymentDetailsModal",tabindex:"-1","aria-hidden":"true"},Jt={class:"modal-dialog modal-md modal-dialog-centered"},es={class:"modal-content border-0 shadow-lg rounded-4 overflow-hidden"},ts={class:"modal-body p-4"},ss={class:"payment-info"},ls={class:"row g-3"},as={class:"col-6"},os={class:"info-card"},ns={class:"value"},ds={class:"col-6"},rs={class:"info-card"},is={class:"value"},us={key:0,class:"col-6"},cs={class:"info-card"},ms={class:"value"},ps={key:1,class:"col-6"},vs={class:"info-card"},bs={class:"value"},ys={class:"col-6"},fs={class:"info-card"},ws={class:"value"},gs={key:2,class:"col-6"},hs={class:"info-card"},_s={class:"value text-capitalize"},xs={key:3,class:"col-6"},Cs={class:"info-card"},ks={class:"value"},$s={key:4,class:"col-6"},Ts={class:"info-card"},Ds={class:"value"},Ss={key:5,class:"col-6"},Os={class:"info-card"},Ps={class:"value"},Fs={class:"modal fade",id:"orderDetailsModal",tabindex:"-1","aria-hidden":"true"},Ms={class:"modal-dialog modal-lg modal-dialog-centered"},js={class:"modal-content rounded-4 shadow border-0"},Ns={class:"modal-header bg-white border-0 position-relative px-4 pt-4"},As={class:"d-flex align-items-center gap-3"},Is={class:"d-flex flex-column"},Ls={class:"modal-title fw-bold mb-0"},Rs={class:"text-muted"},Es={class:"modal-body bg-light px-4 pb-4"},Bs={key:0,class:"rounded-3 bg-white shadow-sm p-4"},Vs={class:"mb-4"},zs={class:"row text-muted small"},qs={class:"col-md-4 mb-2"},Us={class:"col-md-4 mb-2"},Gs={class:"table-responsive"},Xs={class:"table align-middle table-striped table-hover border rounded-3 overflow-hidden shadow-sm"},Hs={class:"px-3"},Ws={class:"fw-semibold"},Ks={class:"fw-bold text-success"},Ys={key:0,class:"no-border"},Qs={class:"text-success fw-semibold",colspan:"3"},Zs={key:1,class:"no-border"},Js={class:"text-success fw-semibold",colspan:"3"},el={key:2,class:"no-border"},tl={class:"text-success fw-semibold",colspan:"3"},sl={key:3,class:"no-border"},ll={class:"text-success fw-semibold",colspan:"3"},al={key:4,class:"no-border"},ol={class:"text-success fw-semibold",colspan:"3"},nl={key:5,class:"no-border"},dl={class:"text-success fw-semibold",colspan:"3"},rl={class:"border-top-thick"},il={class:"fw-bold text-success"},ul={key:6},cl={class:"modal-footer bg-white border-0 shadow-sm px-4 py-3"},ml={class:"modal fade",id:"refundModal",tabindex:"-1","aria-hidden":"true"},pl={class:"modal-dialog modal-dialog-centered"},vl={class:"modal-content rounded-4 shadow border-0"},bl={class:"modal-body"},yl={class:"mb-3"},fl={class:"bg-light p-3 rounded-3"},wl={class:"d-flex justify-content-between mb-2"},gl={class:"fw-semibold"},hl={class:"d-flex justify-content-between mb-2"},_l={class:"fw-semibold"},xl={class:"d-flex justify-content-between mb-2"},Cl={class:"fw-semibold"},kl={class:"d-flex justify-content-between mb-2"},$l={class:"fw-semibold text-capitalize"},Tl={key:0,class:"d-flex justify-content-between mb-2"},Dl={class:"fw-semibold text-success"},Sl={key:1,class:"d-flex justify-content-between"},Ol={class:"fw-semibold"},Pl={class:"mb-3"},Fl={class:"input-group"},Ml=["max"],jl={class:"text-muted"},Nl={class:"mb-3"},Al={class:"text-muted"},Il={class:"modal-footer border-0"},Ll=["disabled"],Rl=["disabled"],El={key:0},Bl={key:1},Vl={__name:"Order",setup(k){const{formatCurrencySymbol:f,dateFmt:B}=ze(),F=v(null),$=v(null),D=v(0),S=v(""),c=v(null),w=v([]),b=async()=>{try{const l=await axios.get("/api/orders/all");w.value=l.data.data}catch(l){console.error("Error fetching inventory:",l)}};ie(async()=>{O.value="",J.value=Date.now(),await Re(),setTimeout(()=>{ee.value=!0;const l=document.getElementById(H);l&&(l.value="",O.value="")},100),b()});const O=v(""),J=v(Date.now()),H=`search-${Math.random().toString(36).substr(2,9)}`,ee=v(!1),g=v({sortBy:"",orderType:"",paymentType:"",status:"",priceMin:null,priceMax:null,dateFrom:"",dateTo:""});v(["All","Dine In","Delivery","Takeaway"]),v(["All","Cash","Card","Split"]);const W=j(()=>{const l=O.value.trim().toLowerCase();let t=[...w.value];return l&&(t=t.filter(s=>[String(s.id),s.type?.table_number??"",s.type?.order_type??"",s.customer_name??"",s.payment?.payment_type??"",s.status??"",String(s.total_amount??""),I(s.created_at),te(s.created_at)].join(" ").toLowerCase().includes(l))),g.value.orderType&&(t=t.filter(s=>(s.type?.order_type??"").toLowerCase()===g.value.orderType.toLowerCase())),g.value.paymentType&&(t=t.filter(s=>(s.payment?.payment_type??"").toLowerCase()===g.value.paymentType.toLowerCase())),g.value.status&&(t=t.filter(s=>s.status?.toLowerCase()===g.value.status.toLowerCase())),(g.value.priceMin!==null||g.value.priceMax!==null)&&(t=t.filter(s=>{const a=s.total_amount||0,i=g.value.priceMin||0,x=g.value.priceMax||1/0;return a>=i&&a<=x})),g.value.dateFrom&&(t=t.filter(s=>{const a=new Date(s.created_at),i=new Date(g.value.dateFrom);return a>=i})),g.value.dateTo&&(t=t.filter(s=>{const a=new Date(s.created_at),i=new Date(g.value.dateTo);return i.setHours(23,59,59,999),a<=i})),t}),me=j(()=>{const l=[...W.value];switch(g.value.sortBy){case"date_desc":return l.sort((s,a)=>new Date(a.created_at)-new Date(s.created_at));case"date_asc":return l.sort((s,a)=>new Date(s.created_at)-new Date(a.created_at));case"price_desc":return l.sort((s,a)=>(a.total_amount||0)-(s.total_amount||0));case"price_asc":return l.sort((s,a)=>(s.total_amount||0)-(a.total_amount||0));case"customer_asc":return l.sort((s,a)=>(s.customer_name||"").localeCompare(a.customer_name||""));case"customer_desc":return l.sort((s,a)=>(a.customer_name||"").localeCompare(s.customer_name||""));default:return l.sort((s,a)=>new Date(a.created_at)-new Date(s.created_at))}}),V=j(()=>({sortOptions:[{value:"date_desc",label:"Date: Newest First"},{value:"date_asc",label:"Date: Oldest First"},{value:"price_desc",label:"Price: High to Low"},{value:"price_asc",label:"Price: Low to High"},{value:"customer_asc",label:"Customer: A to Z"},{value:"customer_desc",label:"Customer: Z to A"}],orderTypeOptions:[{value:"Dine In",label:"Dine In"},{value:"Delivery",label:"Delivery"},{value:"Takeaway",label:"Takeaway"},{value:"Collection",label:"Collection"}],paymentTypeOptions:[{value:"Cash",label:"Cash"},{value:"Card",label:"Card"},{value:"Split",label:"Split"}],statusOptions:[{value:"paid",label:"Paid"},{value:"pending",label:"Pending"},{value:"cancelled",label:"Cancelled"}]})),pe=j(()=>w.value.length),ve=j(()=>w.value.filter(l=>l.status==="paid").length),be=j(()=>w.value.filter(l=>l.status!=="paid").length);function I(l){const t=new Date(l),s=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0");return`${s}-${a}-${i}`}function te(l){const t=Date.now()-new Date(l).getTime(),s=Math.floor(t/6e4);if(s<60)return`${s} minute${s===1?"":"s"} ago`;const a=Math.floor(s/60);if(a<24)return`${a} hour${a===1?"":"s"} ago`;const i=Math.floor(a/24);return`${i} day${i===1?"":"s"} ago`}function K(l){const t=Number(l??0);return`£${Number.isInteger(t)?t.toFixed(0):t.toFixed(1)}`}const ye=v(!1),h=v(null),m=v(null);function fe(l){h.value=l,ye.value=!0,new bootstrap.Modal(document.getElementById("paymentDetailsModal")).show()}const we=l=>{m.value=l,new bootstrap.Modal(document.getElementById("orderDetailsModal")).show()};function ge(l){const t=C=>`£${Number(C??0).toFixed(2)}`,s=C=>(C??"").toString(),a=l?.payment??{},i=(a.payment_type??l?.payment_method??"Cash").toLowerCase(),x=a.cash_amount??l?.cash_amount??l?.cash_received??0,u=a.card_amount??l?.card_amount??0,n=a.brand??l?.card_brand??"",M=a.last_digits??l?.last4??l?.last_digits??"";let z="";if(i==="split")z=`Payment: Split (Cash: ${t(x)}, Card: ${t(u)})`;else if(i==="card"||i==="stripe"){const C=n?` (${n})`:"",U=M?` •••• ${M}`:"";z=`Payment: Card${C}${U}`}else z=`Payment: ${s(l?.payment_method)||"Cash"}`;const Se=l?.id??"N/A",Oe=l?.type?.order_type??l?.order_type??"N/A",ne=l?.type?.table_number??l?.table_number??null,Pe=l?.customer_name||"Walk In",L=l?.created_at?new Date(l.created_at):new Date,Fe=`${L.getFullYear()}-${String(L.getMonth()+1).padStart(2,"0")}-${String(L.getDate()).padStart(2,"0")} ${String(L.getHours()).padStart(2,"0")}:${String(L.getMinutes()).padStart(2,"0")}`,de=Array.isArray(l?.items)?l.items:[],re=l?.sub_total??de.reduce((C,U)=>C+Number(U.price??0)*Number(U.quantity??0),0),Me=l?.total_amount??re,je=de.map(C=>`
    <div class="row">
      <span class="w-50 ellips">${s(C.title)}</span>
      <span class="w-20 right">x${Number(C.quantity??0)}</span>
      <span class="w-30 right">${t(C.price)}</span>
    </div>
  `).join(""),Ne=`
<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Receipt</title>
<style>
  :root { --w: 58mm; }
  html, body { margin:0; padding:0; }
  body { width: var(--w); font-family: monospace; font-size: 12px; line-height: 1.3; color:#000; }
  .center { text-align:center; }
  .right { text-align:right; }
  .row { display:flex; justify-content:space-between; gap:4px; }
  .w-50 { width:50%; } .w-20 { width:20%; } .w-30 { width:30%; }
  .ellips { white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
  hr { border:0; border-top:1px dashed #000; margin:4px 0; }
  h3 { margin:0 0 2px 0; font-size: 14px; }
  small { font-size:11px; }
  .mt-4 { margin-top:4px; }
  .mb-4 { margin-bottom:4px; }
  .bold { font-weight:bold; }
  @page { size: var(--w) auto; margin: 3mm; }
  @media print { body { -webkit-print-color-adjust: exact; print-color-adjust: exact; } }
</style>
</head>
<body>
  <div class="center">
    <h3>Goritmi</h3>
    <small>Order #${Se}</small><br/>
    <small>${Fe}</small>
  </div>

  <hr/>
  <div><small>Customer: ${s(Pe)}</small></div>
  <div><small>Order Type: ${s(Oe)}${ne?` | Table: ${s(ne)}`:""}</small></div>
  <div><small>${z}</small></div>

  <hr/>
  <div class="row bold"><span class="w-50">Item</span><span class="w-20 right">Qty</span><span class="w-30 right">Price</span></div>
  ${je}
  <hr/>

  <div class="row"><span>Subtotal:</span><span class="right">${t(re)}</span></div>
  ${Number(l?.tax??0)?`<div class="row"><span>Tax:</span><span class="right">${t(l.tax)}</span></div>`:""}
  ${Number(l?.service_charges??0)?`<div class="row"><span>Service:</span><span class="right">${t(l.service_charges)}</span></div>`:""}
  ${Number(l?.delivery_charges??0)?`<div class="row"><span>Delivery:</span><span class="right">${t(l.delivery_charges)}</span></div>`:""}

  <div class="row bold mt-4"><span>Total:</span><span class="right">${t(Me)}</span></div>

  ${i==="cash"||!i?`<div class="row"><span>Cash Received:</span><span class="right">${t(l?.cash_received??a?.amount_received??0)}</span></div>
       <div class="row"><span>Change:</span><span class="right">${t(l?.change??0)}</span></div>`:""}

  <hr/>
  <div class="center">
    <small>Abdara Road, Peshawar</small><br/>
    <small>info@goritmi.com</small><br/>
    <small>Thank you for your visit!</small>
  </div>

<script>
  async function ready() {
    try { if (document.fonts && document.fonts.ready) { await document.fonts.ready; } } catch(e){}
    window.focus();
    const mq = window.matchMedia && window.matchMedia('print');
    if (mq && mq.addEventListener) {
      mq.addEventListener('change', function(e){ if(!e.matches) setTimeout(function(){ window.close(); }, 300); });
    } else if (mq && mq.addListener) { // older browsers
      mq.addListener(function(mql){ if(!mql.matches) setTimeout(function(){ window.close(); }, 300); });
    }
    window.onafterprint = function(){ setTimeout(function(){ window.close(); }, 300); };
    setTimeout(function(){ window.print(); }, 200);
  }
  if (document.readyState === 'complete') ready();
  else window.addEventListener('load', ready);
<\/script>
</body>
</html>
`,q=window.open("","","width=420,height=640");if(!q){console.error("Popup blocked or failed to open"),alert("Please allow popups for this site to print receipts");return}q.document.open(),q.document.write(Ne),q.document.close()}const se=v([]),le=v(!1);ie(async()=>{le.value=!0;try{const l=await axios.get("/api/printers");se.value=l.data.data.filter(t=>t.is_connected===!0||t.status==="OK").map(t=>({label:`${t.name}`,value:t.name,driver:t.driver,port:t.port}))}catch(l){console.error("Failed to fetch printers:",l)}finally{le.value=!1}});const he=l=>{if(!l||!l.payment)return!1;const t=l.payment.payment_type?.toLowerCase(),s=l.status?.toLowerCase(),a=l.payment.refund_status?.toLowerCase();return(s==="paid"||s==="cancelled")&&(t==="card"||t==="split")&&(!a||a==="none")},_e=async l=>{if(!l)return;l.payment?.payment_type?.toLowerCase();const t=l.total_amount,s=l.payment?.card_amount||t;c.value=l,D.value=Number(s).toFixed(2),S.value="";const a=document.getElementById("refundModal");a&&new bootstrap.Modal(a).show()},xe=async()=>{if(!c.value)return;const l=Number(D.value);if(l<=0){_.error("Refund amount must be greater than 0");return}const t=c.value.payment?.payment_type?.toLowerCase(),s=c.value.payment?.card_amount||c.value.total_amount;if(l>s){_.error(`Refund amount cannot exceed ${f(s)}`);return}$.value=c.value.id;try{const a=await axios.post(`/api/pos/orders/${c.value.id}/refund`,{amount:l,reason:S.value||"Refund requested by admin",payment_type:t});if(a.data.success){_.success(`Refund of ${f(l)} processed successfully`);const i=w.value.findIndex(u=>u.id===c.value.id);i!==-1&&(w.value[i]=a.data.order);const x=document.getElementById("refundModal");if(x){const u=bootstrap.Modal.getInstance(x);u&&u.hide()}c.value=null,D.value=0,S.value=""}}catch(a){console.error("Error processing refund:",a),_.error(a.response?.data?.message||"Failed to process refund")}finally{$.value=null}},ae=()=>{const l=document.getElementById("refundModal");if(l){const t=bootstrap.Modal.getInstance(l);t&&t.hide()}c.value=null,D.value=0,S.value=""},Y=v(!1),P=v(null),Ce=l=>{l&&(P.value=l,Y.value=!0)},oe=()=>{Y.value=!1,P.value=null},ke=async l=>{if(P.value){F.value=P.value.id;try{const t=await axios.post(`/api/pos/orders/${P.value.id}/cancel`,{reason:l});if(t.data.success){_.success("Order cancelled and stock restored successfully");const s=w.value.findIndex(a=>a.id===P.value.id);s!==-1&&(w.value[s]=t.data.order),oe()}}catch(t){console.error("Error cancelling order:",t),_.error(t.response?.data?.message||"Failed to cancel order")}finally{F.value=null}}},Q=l=>{if(!w.value||w.value.length===0){_.error("No orders data to download");return}const t=O.value.trim()?W.value:w.value;if(t.length===0){_.error("No orders found to download");return}try{l==="pdf"?Te(t):l==="excel"?De(t):l==="csv"?$e(t):_.error("Invalid download type")}catch(s){console.error("Download failed:",s),_.error(`Download failed: ${s.message}`)}},$e=l=>{try{const t=["Order ID","Table No.","Order Type","Date","Customer","Payment Type","Sub Total","Promo Discount","Sales Discount","Approved Discount","Tax","Service Charges","Delivery Charges","Total Amount","Status","Promo Name"],s=l.map(n=>[`"${n.id||""}"`,`"${n.type?.table_number||"-"}"`,`"${n.type?.order_type||"-"}"`,`"${I(n.created_at)}"`,`"${n.customer_name||"-"}"`,`"${n.payment?.payment_type||"-"}"`,`"${n.sub_total||0}"`,`"${n.promo?.[0]?.discount_amount||0}"`,`"${n.sales_discount||0}"`,`"${n.approved_discounts||0}"`,`"${n.tax||0}"`,`"${n.service_charges||0}"`,`"${n.delivery_charges||0}"`,`"${n.total_amount||0}"`,`"${n.status||""}"`,`"${n.promo?.[0]?.promo_name||"-"}"`]),a=[t.join(","),...s.map(n=>n.join(","))].join(`
`),i=new Blob([a],{type:"text/csv;charset=utf-8;"}),x=URL.createObjectURL(i),u=document.createElement("a");u.setAttribute("href",x),u.setAttribute("download",`Orders_${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(u),u.click(),document.body.removeChild(u),_.success("CSV downloaded successfully")}catch(t){console.error("CSV generation error:",t),_.error(`CSV generation failed: ${t.message}`,{autoClose:5e3})}},Te=l=>{try{const t=new Ue("l","mm","a4");t.setFontSize(18),t.setFont("helvetica","bold"),t.text("Orders Report",14,20),t.setFontSize(10),t.setFont("helvetica","normal");const s=new Date().toLocaleString();t.text(`Generated on: ${s}`,14,28),t.text(`Total Orders: ${l.length}`,14,34);const a=["Order ID","Table","Type","Date","Customer","Payment","Sub Total","Promo Disc.","Sales Disc.","Total","Status"],i=l.map(u=>[u.id||"",u.type?.table_number||"-",u.type?.order_type||"-",I(u.created_at),u.customer_name||"-",u.payment?.payment_type||"-",`£${Number(u.sub_total||0).toFixed(2)}`,`£${Number(u.promo?.[0]?.discount_amount||0).toFixed(2)}`,`£${Number(u.sales_discount||0).toFixed(2)}`,`£${Number(u.total_amount||0).toFixed(2)}`,u.status||""]);Ge(t,{head:[a],body:i,startY:40,styles:{fontSize:8,cellPadding:2,halign:"left",lineColor:[0,0,0],lineWidth:.1},headStyles:{fillColor:[41,128,185],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]},margin:{left:14,right:14},didDrawPage:u=>{const n=t.internal.getNumberOfPages(),M=t.internal.pageSize.height;t.setFontSize(8),t.text(`Page ${u.pageNumber} of ${n}`,u.settings.margin.left,M-10)}});const x=`Orders_${new Date().toISOString().split("T")[0]}.pdf`;t.save(x),_.success("PDF downloaded successfully")}catch(t){console.error("PDF generation error:",t),_.error(`PDF generation failed: ${t.message}`,{autoClose:5e3})}},De=l=>{try{if(typeof Xe>"u")throw new Error("XLSX library is not loaded");const t=l.map(n=>({"Order ID":n.id||"","Table No.":n.type?.table_number||"-","Order Type":n.type?.order_type||"-",Date:I(n.created_at),Customer:n.customer_name||"-","Payment Type":n.payment?.payment_type||"-","Sub Total":Number(n.sub_total||0).toFixed(2),"Promo Discount":Number(n.promo?.[0]?.discount_amount||0).toFixed(2),"Sales Discount":Number(n.sales_discount||0).toFixed(2),"Approved Discount":Number(n.approved_discounts||0).toFixed(2),Tax:Number(n.tax||0).toFixed(2),"Service Charges":Number(n.service_charges||0).toFixed(2),"Delivery Charges":Number(n.delivery_charges||0).toFixed(2),"Total Amount":Number(n.total_amount||0).toFixed(2),Status:n.status||"","Promo Name":n.promo?.[0]?.promo_name||"-"})),s=E.book_new(),a=E.json_to_sheet(t);a["!cols"]=[{wch:10},{wch:10},{wch:12},{wch:12},{wch:20},{wch:12},{wch:12},{wch:15},{wch:15},{wch:17},{wch:10},{wch:15},{wch:16},{wch:13},{wch:10},{wch:20}],E.book_append_sheet(s,a,"Orders");const i=[{Info:"Generated On",Value:new Date().toLocaleString()},{Info:"Total Records",Value:l.length},{Info:"Total Revenue",Value:`£${l.reduce((n,M)=>n+Number(M.total_amount||0),0).toFixed(2)}`},{Info:"Exported By",Value:"Restaurant Management System"}],x=E.json_to_sheet(i);E.book_append_sheet(s,x,"Report Info");const u=`Orders_${new Date().toISOString().split("T")[0]}.xlsx`;He(s,u),_.success("Excel file downloaded successfully",{autoClose:2500})}catch(t){console.error("Excel generation error:",t),_.error(`Excel generation failed: ${t.message}`,{autoClose:5e3})}};return(l,t)=>(d(),r(R,null,[N(y(Ee),{title:"Orders"}),N(Ve,null,{default:Z(()=>[e("div",pt,[t[75]||(t[75]=e("h4",{class:"fw-semibold mb-3"},"Overall Orders",-1)),e("div",vt,[e("div",bt,[e("div",yt,[e("div",ft,[e("div",null,[e("h3",wt,o(pe.value),1),t[9]||(t[9]=e("p",{class:"text-muted mb-0 small"},"Total Orders",-1))]),t[10]||(t[10]=e("div",{class:"rounded-circle p-2 d-flex align-items-center justify-content-center text-primary",style:{width:"40px",height:"40px"}},[e("i",{class:"bi bi-list-task fs-4"})],-1))])])]),e("div",gt,[e("div",ht,[e("div",_t,[e("div",null,[e("h3",xt,o(ve.value),1),t[11]||(t[11]=e("p",{class:"text-muted mb-0 small"},"Completed Orders",-1))]),t[12]||(t[12]=e("div",{class:"rounded-circle p-3 d-flex align-items-center justify-content-center text-success",style:{width:"40px",height:"40px"}},[e("i",{class:"bi bi-check2-circle fs-4"})],-1))])])]),e("div",Ct,[e("div",kt,[e("div",$t,[e("div",null,[e("h3",Tt,o(be.value),1),t[13]||(t[13]=e("p",{class:"text-muted mb-0 small"},"Pending Orders",-1))]),t[14]||(t[14]=e("div",{class:"rounded-circle p-3 d-flex align-items-center justify-content-center text-warning",style:{width:"40px",height:"40px"}},[e("i",{class:"bi bi-hourglass-split fs-4"})],-1))])])])]),e("div",Dt,[e("div",St,[e("div",Ot,[t[22]||(t[22]=e("h5",{class:"mb-0 fw-semibold"},"Orders",-1)),e("div",Pt,[e("div",Ft,[t[15]||(t[15]=e("i",{class:"bi bi-search"},null,-1)),t[16]||(t[16]=e("input",{type:"email",name:"email",autocomplete:"email",style:{position:"absolute",left:"-9999px",width:"1px",height:"1px"},tabindex:"-1","aria-hidden":"true"},null,-1)),ee.value?A((d(),r("input",{id:H,"onUpdate:modelValue":t[0]||(t[0]=s=>O.value=s),key:J.value,class:"form-control search-input",placeholder:"Search",type:"search",autocomplete:"new-password",name:H,role:"presentation",onFocus:t[1]||(t[1]=(...s)=>l.handleFocus&&l.handleFocus(...s))},null,32)),[[X,O.value]]):(d(),r("input",Mt))]),N(qe,{modelValue:g.value,"onUpdate:modelValue":t[2]||(t[2]=s=>g.value=s),title:"Orders","modal-id":"orderFilterModal","modal-size":"modal-lg","sort-options":V.value.sortOptions,"status-options":V.value.statusOptions,"show-stock-status":!1,"show-price-range":!0,"show-date-range":!0,"price-label":"Total Amount Range",onApply:l.handleFilterApply,onClear:l.handleFilterClear},{customFilters:Z(({filters:s})=>[e("div",jt,[t[18]||(t[18]=e("label",{class:"form-label fw-semibold text-dark"},[e("i",{class:"fas fa-concierge-bell me-2 text-muted"}),T("Order Type ")],-1)),A(e("select",{"onUpdate:modelValue":a=>s.orderType=a,class:"form-select"},[t[17]||(t[17]=e("option",{value:""},"All",-1)),(d(!0),r(R,null,G(V.value.orderTypeOptions,a=>(d(),r("option",{key:a.value,value:a.value},o(a.label),9,At))),128))],8,Nt),[[ue,s.orderType]])]),e("div",It,[t[20]||(t[20]=e("label",{class:"form-label fw-semibold text-dark"},[e("i",{class:"fas fa-credit-card me-2 text-muted"}),T("Payment Type ")],-1)),A(e("select",{"onUpdate:modelValue":a=>s.paymentType=a,class:"form-select"},[t[19]||(t[19]=e("option",{value:""},"All",-1)),(d(!0),r(R,null,G(V.value.paymentTypeOptions,a=>(d(),r("option",{key:a.value,value:a.value},o(a.label),9,Rt))),128))],8,Lt),[[ue,s.paymentType]])])]),_:1},8,["modelValue","sort-options","status-options","onApply","onClear"]),e("div",Et,[t[21]||(t[21]=e("button",{class:"btn btn-outline-secondary rounded-pill px-4 dropdown-toggle","data-bs-toggle":"dropdown"}," Export ",-1)),e("ul",Bt,[e("li",null,[e("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:t[3]||(t[3]=s=>Q("pdf"))}," Export as PDF ")]),e("li",null,[e("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:t[4]||(t[4]=s=>Q("excel"))}," Export as Excel ")]),e("li",null,[e("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:t[5]||(t[5]=s=>Q("csv"))}," Export as CSV ")])])])])]),e("div",Vt,[e("table",zt,[t[25]||(t[25]=e("thead",{class:"border-top small text-muted"},[e("tr",null,[e("th",{style:{width:"70px"}},"S. #"),e("th",null,"Table No."),e("th",null,"Order Type"),e("th",null,"Date"),e("th",null,"Time"),e("th",null,"Customer"),e("th",null,"Payment Type"),e("th",null,"Total"),e("th",null,"Status"),e("th",null,"Source"),e("th",{class:"text-center"},"Actions")])],-1)),e("tbody",null,[(d(!0),r(R,null,G(me.value,(s,a)=>(d(),r("tr",{key:s.id},[e("td",null,o(a+1),1),e("td",null,o(s.type?.table_number??"-"),1),e("td",null,o(s.type?.order_type??"-"),1),e("td",null,o(y(B)(s.created_at)),1),e("td",null,o(te(s.created_at)),1),e("td",null,o(s.customer_name??"-"),1),e("td",null,[e("span",{class:"cursor-pointer",onClick:i=>fe(s.payment)},o(s.payment?.payment_type??"-"),9,qt)]),e("td",null,o(y(f)(s.total_amount)),1),e("td",Ut,[e("span",{class:Be(["badge px-4 py-2 rounded-pill",{"bg-danger":s?.status==="cancelled","bg-warning text-dark":s?.status==="refunded","bg-success":s?.status==="paid"}])},o(s?.status.charAt(0).toUpperCase()+s?.status.slice(1)),3)]),e("td",null,[e("span",Gt,o(s.source==="Pos System"?"POS System":s.source==="website"?"Website":"-"),1)]),e("td",Xt,[e("div",Ht,[e("button",{onClick:i=>we(s),title:"View Details",class:"p-2 rounded-full text-primary hover:bg-gray-100"},[N(y(We),{class:"w-4 h-4"})],8,Wt),s.status!=="cancelled"&&s.status!=="refunded"?(d(),r("button",{key:0,onClick:i=>Ce(s),title:"Cancel Order",disabled:F.value===s.id,class:"p-2 rounded-full text-danger hover:bg-gray-100"},[N(y(Ke),{class:"w-4 h-4"})],8,Kt)):p("",!0),he(s)?(d(),r("button",{key:1,onClick:i=>_e(s),title:"Refund Payment",disabled:$.value===s.id,class:"p-2 rounded-full text-warning hover:bg-gray-100"},[...t[23]||(t[23]=[e("i",{class:"bi bi-arrow-counterclockwise",style:{"font-size":"1rem"}},null,-1)])],8,Yt)):p("",!0)])])]))),128)),W.value.length===0?(d(),r("tr",Qt,[...t[24]||(t[24]=[e("td",{colspan:"18",class:"text-center text-muted py-4"}," No orders found. ",-1)])])):p("",!0)])])])])]),e("div",Zt,[e("div",Jt,[e("div",es,[t[35]||(t[35]=e("div",{class:"modal-header border-0 text-black"},[e("h6",{class:"modal-title fw-semibold"},[e("i",{class:"bi bi-credit-card me-2"}),T(" Payment Details ")]),e("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-danger",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})])])],-1)),e("div",ts,[e("div",ss,[e("div",ls,[e("div",as,[e("div",os,[t[26]||(t[26]=e("span",{class:"label"},"Payment Type",-1)),e("span",ns,o(h.value?.payment_type??"-"),1)])]),e("div",ds,[e("div",rs,[t[27]||(t[27]=e("span",{class:"label"},"Amount Received",-1)),e("span",is,o(K(h.value?.amount_received)),1)])]),h.value?.payment_type==="Split"?(d(),r("div",us,[e("div",cs,[t[28]||(t[28]=e("span",{class:"label"},"Cash Amount",-1)),e("span",ms,o(K(h.value?.cash_amount)),1)])])):p("",!0),h.value?.payment_type==="Split"?(d(),r("div",ps,[e("div",vs,[t[29]||(t[29]=e("span",{class:"label"},"Card Amount",-1)),e("span",bs,o(K(h.value?.card_amount)),1)])])):p("",!0),e("div",ys,[e("div",fs,[t[30]||(t[30]=e("span",{class:"label"},"Payment Date",-1)),e("span",ws,o(I(h.value?.payment_date)),1)])]),h.value?.brand?(d(),r("div",gs,[e("div",hs,[t[31]||(t[31]=e("span",{class:"label"},"Card Brand",-1)),e("span",_s,o(h.value.brand),1)])])):p("",!0),h.value?.last_digits?(d(),r("div",xs,[e("div",Cs,[t[32]||(t[32]=e("span",{class:"label"},"Last 4 Digits",-1)),e("span",ks,"**** **** **** "+o(h.value.last_digits),1)])])):p("",!0),h.value?.exp_month?(d(),r("div",$s,[e("div",Ts,[t[33]||(t[33]=e("span",{class:"label"},"Expiry",-1)),e("span",Ds,o(h.value.exp_month)+"/"+o(h.value.exp_year),1)])])):p("",!0),h.value?.currency_code?(d(),r("div",Ss,[e("div",Os,[t[34]||(t[34]=e("span",{class:"label"},"Currency",-1)),e("span",Ps,o(h.value.currency_code),1)])])):p("",!0)])])])])])]),e("div",Fs,[e("div",Ms,[e("div",js,[e("div",Ns,[e("div",As,[t[36]||(t[36]=e("span",{class:"badge bg-gradient rounded-circle p-3 shadow-sm",style:{background:`linear-gradient(
                                            135deg,
                                            #4e73df,
                                            #224abe
                                        )`}},[e("i",{class:"bi bi-receipt fs-5 text-black"})],-1)),e("div",Is,[e("h5",Ls," Order #"+o(m.value?.id),1),e("small",Rs," Customer: "+o(m.value?.customer_name??"—"),1)])]),t[37]||(t[37]=e("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})])],-1))]),e("div",Es,[m.value?(d(),r("div",Bs,[e("div",Vs,[t[40]||(t[40]=e("h6",{class:"fw-bold mb-3 text-primary"}," Order Details ",-1)),e("div",zs,[e("div",qs,[t[38]||(t[38]=e("span",{class:"fw-semibold text-dark"},"Order Type:",-1)),T(" "+o(m.value?.type?.order_type??"—"),1)]),e("div",Us,[t[39]||(t[39]=e("span",{class:"fw-semibold text-dark"},"Date:",-1)),T(" "+o(y(B)(m.value?.created_at)),1)])])]),t[72]||(t[72]=e("h6",{class:"fw-bold mb-3 text-primary"}," Order Items ",-1)),e("div",Gs,[e("table",Xs,[t[71]||(t[71]=e("thead",{class:"bg-light text-muted small"},[e("tr",null,[e("th",{class:"px-3"},"#"),e("th",null,"Item"),e("th",null,"Qty"),e("th",null,"Actual Price"),e("th",null,"="),e("th",null,"Promo Name"),e("th",null,"Total Price")])],-1)),e("tbody",null,[(d(!0),r(R,null,G(m.value.items??[],(s,a)=>(d(),r("tr",{key:s.id},[e("td",Hs,o(a+1),1),e("td",null,o(s.title),1),e("td",null,o(s.quantity),1),e("td",Ws,o(y(f)(s.price)),1),t[41]||(t[41]=e("td",null,null,-1)),e("td",null,o(m.value.promo[0]?.promo_name||"-"),1),e("td",Ks,o(y(f)(s.price)),1)]))),128)),m.value.promo?(d(),r("tr",Ys,[t[42]||(t[42]=e("td",null,null,-1)),t[43]||(t[43]=e("td",null,null,-1)),t[44]||(t[44]=e("td",null,null,-1)),t[45]||(t[45]=e("td",{colspan:"3",class:"text-end text-muted text-adjusting"},"Promo Discount",-1)),e("td",Qs," -"+o(y(f)(m.value.promo[0]?.discount_amount??0)),1)])):p("",!0),m.value.tax?(d(),r("tr",Zs,[t[46]||(t[46]=e("td",null,null,-1)),t[47]||(t[47]=e("td",null,null,-1)),t[48]||(t[48]=e("td",null,null,-1)),t[49]||(t[49]=e("td",{colspan:"3",class:"text-end text-muted text-adjusting"},"Tax",-1)),e("td",Js," +"+o(y(f)(m.value.tax??0)),1)])):p("",!0),m.value.service_charges?(d(),r("tr",el,[t[50]||(t[50]=e("td",null,null,-1)),t[51]||(t[51]=e("td",null,null,-1)),t[52]||(t[52]=e("td",null,null,-1)),t[53]||(t[53]=e("td",{colspan:"3",class:"text-end text-muted text-adjusting"},"Service Charges",-1)),e("td",tl," +"+o(y(f)(m.value.service_charges??0)),1)])):p("",!0),m.value.delivery_charges?(d(),r("tr",sl,[t[54]||(t[54]=e("td",null,null,-1)),t[55]||(t[55]=e("td",null,null,-1)),t[56]||(t[56]=e("td",null,null,-1)),t[57]||(t[57]=e("td",{colspan:"3",class:"text-end text-muted text-adjusting"},"Delivery Charges",-1)),e("td",ll," +"+o(y(f)(m.value.delivery_charges??0)),1)])):p("",!0),m.value.sales_discount?(d(),r("tr",al,[t[58]||(t[58]=e("td",null,null,-1)),t[59]||(t[59]=e("td",null,null,-1)),t[60]||(t[60]=e("td",null,null,-1)),t[61]||(t[61]=e("td",{colspan:"3",class:"text-end text-muted text-adjusting"},"Sales Discount",-1)),e("td",ol," +"+o(y(f)(m.value.sales_discount??0)),1)])):p("",!0),m.value.approved_discounts?(d(),r("tr",nl,[t[62]||(t[62]=e("td",null,null,-1)),t[63]||(t[63]=e("td",null,null,-1)),t[64]||(t[64]=e("td",null,null,-1)),t[65]||(t[65]=e("td",{colspan:"3",class:"text-end text-muted text-adjusting"},"Approved Discounts",-1)),e("td",dl," +"+o(y(f)(m.value.approved_discounts??0)),1)])):p("",!0),e("tr",rl,[t[66]||(t[66]=e("td",null,null,-1)),t[67]||(t[67]=e("td",null,null,-1)),t[68]||(t[68]=e("td",null,null,-1)),t[69]||(t[69]=e("td",{colspan:"3",class:"text-end text-muted text-adjusting"},"Grand Total ",-1)),e("td",il,o(y(f)(m.value.total_amount)),1)]),(m.value.items??[]).length===0?(d(),r("tr",ul,[...t[70]||(t[70]=[e("td",{colspan:"7",class:"text-center text-muted py-4"}," No items found ",-1)])])):p("",!0)])])])])):p("",!0)]),e("div",cl,[t[74]||(t[74]=e("button",{class:"btn btn-secondary px-2 py-2","data-bs-dismiss":"modal"}," Close ",-1)),se.value.length>0?(d(),r("button",{key:0,class:"btn btn-primary shadow-sm rounded-pill px-4 py-2",onClick:t[6]||(t[6]=s=>ge(m.value))},[...t[73]||(t[73]=[e("i",{class:"bi bi-printer me-1"},null,-1),T(" Print Receipt ",-1)])])):p("",!0)])])])])]),e("div",ml,[e("div",pl,[e("div",vl,[e("div",{class:"modal-header border-0"},[t[77]||(t[77]=e("h5",{class:"modal-title fw-bold"},[e("i",{class:"bi bi-arrow-counterclockwise text-warning me-2"}),T(" Process Refund ")],-1)),e("button",{onClick:ae,class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[...t[76]||(t[76]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",bl,[t[88]||(t[88]=e("div",{class:"alert alert-warning d-flex align-items-start gap-2"},[e("i",{class:"bi bi-exclamation-triangle-fill mt-1"}),e("div",null,[e("strong",null,"Important:"),T(" This will process a refund to the customer's card. This action cannot be undone. ")])],-1)),e("div",yl,[t[84]||(t[84]=e("label",{class:"form-label fw-semibold"},"Order Details",-1)),e("div",fl,[e("div",wl,[t[78]||(t[78]=e("span",{class:"text-muted"},"Order #:",-1)),e("span",gl,o(c.value?.id),1)]),e("div",hl,[t[79]||(t[79]=e("span",{class:"text-muted"},"Customer:",-1)),e("span",_l,o(c.value?.customer_name||"Walk In"),1)]),e("div",xl,[t[80]||(t[80]=e("span",{class:"text-muted"},"Total Amount:",-1)),e("span",Cl,o(y(f)(c.value?.total_amount)),1)]),e("div",kl,[t[81]||(t[81]=e("span",{class:"text-muted"},"Payment Type:",-1)),e("span",$l,o(c.value?.payment?.payment_type),1)]),c.value?.payment?.payment_type?.toLowerCase()==="split"?(d(),r("div",Tl,[t[82]||(t[82]=e("span",{class:"text-muted"},"Card Amount:",-1)),e("span",Dl,o(y(f)(c.value?.payment?.card_amount)),1)])):p("",!0),c.value?.payment?.brand?(d(),r("div",Sl,[t[83]||(t[83]=e("span",{class:"text-muted"},"Card:",-1)),e("span",Ol,o(c.value.payment.brand)+" •••• "+o(c.value.payment.last_digits),1)])):p("",!0)])]),e("div",Pl,[t[86]||(t[86]=e("label",{class:"form-label fw-semibold"},"Refund Amount",-1)),e("div",Fl,[t[85]||(t[85]=e("span",{class:"input-group-text"},"£",-1)),A(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>D.value=s),type:"number",class:"form-control",max:c.value?.payment?.card_amount||c.value?.total_amount,step:"0.01",min:"0.01",required:""},null,8,Ml),[[X,D.value,void 0,{number:!0}]])]),e("small",jl," Maximum: "+o(y(f)(c.value?.payment?.card_amount||c.value?.total_amount)),1)]),e("div",Nl,[t[87]||(t[87]=e("label",{class:"form-label fw-semibold"},"Refund Reason (Optional)",-1)),A(e("textarea",{"onUpdate:modelValue":t[8]||(t[8]=s=>S.value=s),class:"form-control",rows:"3",placeholder:"Enter reason for refund...",maxlength:"500"},null,512),[[X,S.value]]),e("small",Al,o(S.value.length)+"/500 characters",1)])]),e("div",Il,[e("button",{type:"button",class:"btn btn-secondary px-2 py-2",onClick:ae,disabled:$.value!==null}," Cancel ",8,Ll),e("button",{type:"button",class:"btn btn-primary px-2 py-2",onClick:xe,disabled:$.value!==null||!D.value||D.value<=0},[$.value?(d(),r("span",El,[...t[89]||(t[89]=[e("span",{class:"spinner-border spinner-border-sm me-2"},null,-1),T(" Processing... ",-1)])])):(d(),r("span",Bl,[...t[90]||(t[90]=[e("i",{class:"bi bi-arrow-counterclockwise me-1"},null,-1),T(" Process Refund ",-1)])]))],8,Rl)])])])]),N(mt,{show:Y.value,order:P.value,loading:F.value===P.value?.id,onConfirm:ke,onCancel:oe},null,8,["show","order","loading"])]),_:1})],64))}},ta=ce(Vl,[["__scopeId","data-v-f3cf2e9a"]]);export{ta as default};
