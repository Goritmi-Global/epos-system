import{_ as R,b3 as S,j,X as C,r as g,k as U,g as r,o as n,i as m,b as e,x as u,y as k,n as p,t as a,a as y,U as O,W as _,f as h,d as f,s as N}from"./app-DgHj6V6q.js";import{s as V}from"./index-Ctb2bikc.js";import{u as L}from"./useFormatters-CPHeofEZ.js";import"./index-BBadkYNm.js";const T={key:0,class:"fw-bold mb-3"},B={class:"row g-4"},I={class:"col-lg-7"},M={key:0,class:"text-danger"},K={class:"row g-3 align-items-start mt-2"},D={class:"col-md-4"},F={class:"logo-card"},$=["src"],z={key:1,class:"placeholder"},A={key:0,class:"text-danger"},Q={class:"col-md-8"},Y={key:0,class:"text-danger"},W={class:"mt-3"},X={class:"segmented"},G={key:0,class:"text-danger"},H={class:"mt-3"},J={class:"segmented"},Z={class:"mt-3"},ee={class:"d-flex align-items-center justify-content-end mb-1"},te=["disabled"],se={key:0,class:"text-center py-3"},oe={key:1,class:"alert alert-warning py-2 px-3 rounded-3 mt-3"},le={key:2},re={key:1,class:"text-danger"},ne={class:"col-lg-5"},ae={class:"receipt-card"},ie={class:"text-center"},de={key:0,class:"mb-2 logo-container"},ce=["src"],me={class:"mb-1"},pe={class:"text-center my-2"},ue={class:"text-center my-2"},fe={class:"text-muted small"},ve={class:"small"},_e={class:"d-flex justify-content-between"},be={class:"d-flex justify-content-between"},ge={class:"small"},ye={class:"d-flex justify-content-between"},we={key:0,class:"d-flex justify-content-center my-2"},xe={class:"text-center small"},ke={__name:"Step6",props:{model:Object,formErrors:Object,isOnboarding:{type:Boolean,default:!1}},emits:["save"],setup(l,{emit:E}){const i=l,q=E,{formatCurrencySymbol:b}=L(),s=S({receipt_header:i.model?.receipt_header??"",receipt_footer:i.model?.receipt_footer??"",receipt_logo:i.model?.receipt_logo??null,receipt_logo_file:null,show_qr:i.model?.show_qr??1,tax_breakdown:i.model?.tax_breakdown??!0,store_phone:i.model?.phone??"",store_name:i.model?.receipt_header??"Enter store name",address:i.model?.address??"xyz",customer_printer:i.model?.customer_printer??"",kot_printer:i.model?.kot_printer??""});j(s,()=>q("save",{step:6,data:C(s)}),{deep:!0});const w=g(!1);function P({file:d}){s.receipt_logo_file=d,s.receipt_logo=URL.createObjectURL(d)}const v=g([]),c=g(!1),x=async()=>{c.value=!0;try{const d=await axios.get("/api/printers");console.log("Printers:",d.data.data),v.value=d.data.data.filter(t=>t.is_connected===!0||t.status==="OK").map(t=>({label:`${t.name}`,value:t.name,driver:t.driver,port:t.port}))}catch(d){console.error("Failed to fetch printers:",d)}finally{c.value=!1}};return U(x),(d,t)=>(n(),r("div",null,[i.isOnboarding?(n(),r("h5",T,"Step 6 of 9 - Receipt & Printer Setup")):m("",!0),e("div",B,[e("div",I,[t[19]||(t[19]=e("label",{class:"form-label"},"Receipt header",-1)),u(e("input",{class:p(["form-control",{"is-invalid":l.formErrors?.receipt_header}]),"onUpdate:modelValue":t[0]||(t[0]=o=>s.receipt_header=o)},null,2),[[k,s.receipt_header]]),l.formErrors?.receipt_header?(n(),r("small",M,a(l.formErrors.receipt_header[0]),1)):m("",!0),e("div",K,[e("div",D,[t[11]||(t[11]=e("small",{class:"text-muted mt-2"},"Upload Receipt Logo",-1)),e("div",F,[e("div",{class:"logo-frame",onClick:t[1]||(t[1]=o=>s.receipt_logo&&d.openImageModal(s.receipt_logo))},[s.receipt_logo?(n(),r("img",{key:0,src:s.receipt_logo,alt:"Logo"},null,8,$)):(n(),r("div",z,[...t[10]||(t[10]=[e("i",{class:"bi bi-image"},null,-1)])]))]),y(O,{show:w.value,onClose:t[2]||(t[2]=o=>w.value=!1),onCropped:P},null,8,["show"])]),l.formErrors?.receipt_logo_file?(n(),r("small",A,a(l.formErrors.receipt_logo_file[0]),1)):m("",!0)]),e("div",Q,[t[18]||(t[18]=e("label",{class:"form-label"},"Receipt Footer",-1)),u(e("input",{class:p(["form-control",{"is-invalid":l.formErrors?.receipt_footer}]),"onUpdate:modelValue":t[3]||(t[3]=o=>s.receipt_footer=o)},null,2),[[k,s.receipt_footer]]),l.formErrors?.receipt_footer?(n(),r("small",Y,a(l.formErrors.receipt_footer[0]),1)):m("",!0),e("div",W,[t[12]||(t[12]=e("label",{class:"form-label d-block mb-2"}," Show QR Code on Receipt ",-1)),e("div",X,[u(e("input",{class:p(["segmented__input",{"is-invalid":l.formErrors?.show_qr}]),type:"radio",id:"qr-yes",value:1,"onUpdate:modelValue":t[4]||(t[4]=o=>s.show_qr=o)},null,2),[[_,s.show_qr]]),e("label",{class:p(["segmented__btn",{"is-active":s.show_qr===1}]),for:"qr-yes"},"YES",2),u(e("input",{class:"segmented__input",type:"radio",id:"qr-no",value:0,"onUpdate:modelValue":t[5]||(t[5]=o=>s.show_qr=o)},null,512),[[_,s.show_qr]]),e("label",{class:p(["segmented__btn",{"is-active":s.show_qr===0}]),for:"qr-no"},"NO",2),l.formErrors?.show_qr?(n(),r("small",G,a(l.formErrors.show_qr[0]),1)):m("",!0)])]),e("div",H,[t[13]||(t[13]=e("label",{class:"form-label d-block mb-2"},"Tax Breakdown",-1)),e("div",J,[u(e("input",{class:"segmented__input",type:"radio",id:"tb-yes",value:!0,"onUpdate:modelValue":t[6]||(t[6]=o=>s.tax_breakdown=o)},null,512),[[_,s.tax_breakdown]]),e("label",{class:p(["segmented__btn",{"is-active":s.tax_breakdown===!0}]),for:"tb-yes"},"YES",2),u(e("input",{class:"segmented__input",type:"radio",id:"tb-no",value:!1,"onUpdate:modelValue":t[7]||(t[7]=o=>s.tax_breakdown=o)},null,512),[[_,s.tax_breakdown]]),e("label",{class:p(["segmented__btn",{"is-active":s.tax_breakdown===!1}]),for:"tb-no"},"NO",2)])]),e("div",Z,[e("div",ee,[e("button",{type:"button",class:"btn btn-sm btn-outline-primary custom-refresh-btn d-flex align-items-center rounded-pill",onClick:x,disabled:c.value},[e("i",{class:p(["pi pi-refresh me-1 px-1",{"pi-spin":c.value}])},null,2),h(" "+a(c.value?"Refreshing...":"Refresh Printers"),1)],8,te)]),c.value?(n(),r("div",se,[...t[14]||(t[14]=[e("div",{class:"fw-semibold text-secondary mb-2"}," Scanning for printers, please wait... ",-1),e("div",{class:"spinner-border",role:"status",style:{color:"#1c0d82",width:"2rem",height:"2rem"}},[e("span",{class:"visually-hidden"},"Loading...")],-1)])])):v.value.length===0?(n(),r("div",oe,[...t[15]||(t[15]=[e("i",{class:"pi pi-exclamation-triangle me-2"},null,-1),h(' No printers detected. Please connect a printer and click "Refresh Printers". ',-1)])])):(n(),r("div",le,[t[16]||(t[16]=e("label",{class:"form-label d-block mb-2"},"Customer Printer",-1)),y(f(V),{modelValue:s.customer_printer,"onUpdate:modelValue":t[8]||(t[8]=o=>s.customer_printer=o),options:v.value,optionLabel:"label",optionValue:"value",placeholder:"Select POS Printer",loading:c.value,class:"w-100"},null,8,["modelValue","options","loading"]),t[17]||(t[17]=e("label",{class:"form-label d-block mt-3 mb-2"},"KOT Printer",-1)),y(f(V),{modelValue:s.kot_printer,"onUpdate:modelValue":t[9]||(t[9]=o=>s.kot_printer=o),options:v.value,optionLabel:"label",optionValue:"value",placeholder:"Select KOT Printer",loading:c.value,class:"w-100"},null,8,["modelValue","options","loading"])]))]),l.formErrors?.printers?(n(),r("small",re,a(l.formErrors.printers[0]),1)):m("",!0)])])]),e("div",ne,[e("div",ae,[e("div",ie,[s.receipt_logo?(n(),r("div",de,[e("img",{src:s.receipt_logo,alt:"",class:"logo-preview rounded-circle"},null,8,ce)])):m("",!0),e("h6",me,a(s.receipt_header),1),e("div",pe,[e("div",null,a(s.store_phone),1)]),e("div",ue,[e("div",null,a(s.address),1)]),e("div",fe,a(new Date().toLocaleString()),1)]),t[28]||(t[28]=N('<hr class="my-2" data-v-7f38448c><div class="small" data-v-7f38448c><div class="d-flex justify-content-between" data-v-7f38448c><span data-v-7f38448c>Payment Type:</span><span data-v-7f38448c>Credit</span></div><div class="d-flex justify-content-between" data-v-7f38448c><span data-v-7f38448c>Customer Name:</span><span data-v-7f38448c>Lorem Ipsum</span></div><div class="d-flex justify-content-between" data-v-7f38448c><span data-v-7f38448c>Address:</span><span data-v-7f38448c>abc</span></div></div><hr class="my-2" data-v-7f38448c>',3)),e("div",ve,[t[24]||(t[24]=e("div",{class:"d-flex justify-content-between fw-semibold"},[e("span",null,"Name"),e("span",null,"Qty"),e("span",null,"Price")],-1)),e("div",_e,[t[20]||(t[20]=e("span",null,"Item A",-1)),t[21]||(t[21]=e("span",null,"1",-1)),e("span",null,a(f(b)(950,"PKR")),1)]),e("div",be,[t[22]||(t[22]=e("span",null,"Item B",-1)),t[23]||(t[23]=e("span",null,"2",-1)),e("span",null,a(f(b)(50,"Rs")),1)])]),t[29]||(t[29]=e("hr",{class:"my-2"},null,-1)),e("div",ge,[e("div",ye,[t[25]||(t[25]=e("span",null,"Total Price:",-1)),e("span",null,a(f(b)(2e3,"Rs")),1)]),t[26]||(t[26]=e("div",{class:"d-flex justify-content-between"},[e("span",null,"Tax:"),e("span",null,"23%")],-1))]),s.show_qr===1?(n(),r("div",we,[...t[27]||(t[27]=[e("div",{class:"qr-box","aria-hidden":"true"},null,-1)])])):m("",!0),t[30]||(t[30]=e("hr",{class:"my-2"},null,-1)),e("div",xe,a(s.receipt_footer||"Thank you!"),1)])])])]))}},Pe=R(ke,[["__scopeId","data-v-7f38448c"]]);export{Pe as default};
