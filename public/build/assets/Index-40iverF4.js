import{_ as ze,r as c,c as Y,o as ce,n as He,I as qe,P as Ke,y as Xe,E as _e,a as me,b as i,w as G,d as w,e as t,u as R,h as Ye,f as r,F,g as z,t as u,i as O,j as Ge,m as C,k as Z,v as ve,l as I,S as Ce,T as Ze,U as we,x as ke,p as D,q as d}from"./app-BHYyRJnL.js";import{_ as Je}from"./Master-CXzRQq-r.js";import{s as xe}from"./index-bHJi427f.js";import{F as We}from"./FilterModal-D0LkefGG.js";import{E as Qe,a as et,X as tt,u as J,w as at}from"./xlsx-CpHCO-2F.js";import{u as lt}from"./useFormatters-wi1aVjp-.js";import{I as st}from"./importFile-YYl72liC.js";import{S as ot}from"./shapes-C3gV1dMX.js";import{P as nt}from"./package-Ly2dV6B8.js";import{T as it}from"./triangle-alert-P7paFc-g.js";import{C as rt}from"./circle-x-Cr4_Uh6n.js";import{P as ut}from"./plus-DcH1IPmd.js";import{P as Se}from"./pencil-AO5bMxrJ.js";import"./index-B0N7947y.js";import"./createLucideIcon-DmJxs4Lg.js";import"./index-CpMR2yR9.js";import"./index-Bs9GfHmp.js";import"./sun-soDtTQcu.js";import"./index-ZEA6XP_E.js";import"./index-uhINJth7.js";import"./index-Cdn4Pgih.js";const dt={class:"page-wrapper"},ct={class:"row g-3"},mt={class:"card border-0 shadow-sm rounded-4"},vt={class:"card-body d-flex align-items-center justify-content-between"},pt={class:"fw-bold fs-4"},gt={class:"text-muted fs-6"},bt={class:"card border-0 shadow-lg rounded-4 mt-0"},ft={class:"card-body"},yt={class:"d-flex flex-wrap gap-2 justify-content-between align-items-center mb-3"},ht={class:"d-flex flex-wrap gap-2 align-items-center"},_t={class:"search-wrap"},Ct={key:1,class:"form-control search-input",placeholder:"Search",disabled:"",type:"text"},wt={class:"col-12"},kt=["onUpdate:modelValue"],xt=["value"],St={class:"dropdown"},Mt={class:"dropdown-menu dropdown-menu-end shadow rounded-4 py-2"},Ft={class:"table-responsive"},It={class:"table table-striped"},Et={key:0},$t={key:1},Lt={colspan:"11",class:"text-center text-muted py-4"},Nt={class:"fw-semibold"},Pt={class:"text-truncate",style:{"max-width":"260px"}},Vt={key:0},Dt=["onClick"],Bt={key:1},jt={class:"rounded d-inline-flex align-items-center justify-content-center img-chip"},Tt=["src","alt"],At={key:1,class:"fs-5"},Ot={class:"text-center"},Ut={class:"text-center"},Rt={class:"d-inline-flex align-items-center gap-3"},zt=["onClick"],Ht={key:0},qt={colspan:"11",class:"text-center text-muted py-4"},Kt={key:0,class:"mt-4 d-flex justify-content-between align-items-center"},Xt={class:"text-muted small"},Yt={class:"modal fade",id:"viewCatModal",tabindex:"-1","aria-hidden":"true"},Gt={class:"modal-dialog modal-dialog-centered"},Zt={class:"modal-content rounded-4"},Jt={key:0,class:"modal-body"},Wt={class:"fs-4"},Qt={key:0},ea={key:0},ta={key:1},aa={key:1,class:"modal-body text-center"},la={class:"modal fade",id:"addCatModal",tabindex:"-1","aria-hidden":"true"},sa={class:"modal-dialog modal-lg modal-dialog-centered"},oa={class:"modal-content rounded-4"},na={class:"modal-header"},ia={class:"modal-title fw-semibold"},ra={class:"modal-body"},ua={class:"row g-3"},da={class:"col-lg-6"},ca={class:"d-flex align-items-center gap-3"},ma={class:"form-check"},va=["checked"],pa={class:"form-check"},ga=["checked"],ba={key:0,class:"col-lg-6"},fa=["value"],ya={key:0,class:"text-danger"},ha={class:"col-lg-6"},_a={class:"dropdown w-100"},Ca={class:"btn btn-outline-secondary w-100 d-flex justify-content-between align-items-center rounded-3","data-bs-toggle":"dropdown"},wa={class:"d-flex align-items-center"},ka=["src"],xa={class:"dropdown-menu w-100 shadow rounded-3"},Sa=["onClick"],Ma=["src"],Fa={key:1,class:"col-12"},Ia={key:2,class:"text-danger"},Ea={key:2,class:"col-12"},$a={class:"p-3 d-flex justify-content-between"},La={class:"d-flex gap-2"},Na={key:0,class:"text-danger"},Pa={key:1,class:"text-danger"},Va={key:3,class:"col-12"},Da=["value"],Ba={class:"col-12"},ja={class:"d-flex align-items-center gap-3"},Ta={class:"form-check"},Aa=["checked"],Oa={class:"form-check"},Ua=["checked"],Ra={class:"mt-4"},za=["disabled"],Ha={class:"modal fade",id:"editSubCatModal",tabindex:"-1","aria-labelledby":"editSubCatModalLabel","aria-hidden":"true"},qa={class:"modal-dialog"},Ka={class:"modal-content"},Xa={class:"modal-header"},Ya={class:"modal-body"},Ga={class:"mb-3"},Za=["disabled"],Ja={class:"text-danger"},Wa=["disabled"],Qa={key:0,class:"spinner-border spinner-border-sm text-light",role:"status"},el={__name:"Index",setup(tl){lt();const y=c([]),H=c([]),pe=c([]),W={sortBy:"",status:"",hasSubcategories:"",stockStatus:"",valueMin:null,valueMax:null},g=c({...W}),le=c({...W});Y(()=>{const a=[...se.value];switch(g.value.sortBy){case"name_asc":return a.sort((s,o)=>(s.name||"").localeCompare(o.name||""));case"name_desc":return a.sort((s,o)=>(o.name||"").localeCompare(s.name||""));case"value_desc":return a.sort((s,o)=>(o.total_value||0)-(s.total_value||0));case"value_asc":return a.sort((s,o)=>(s.total_value||0)-(o.total_value||0));case"items_desc":return a.sort((s,o)=>(o.primary_inventory_items_count||0)-(s.primary_inventory_items_count||0));case"items_asc":return a.sort((s,o)=>(s.primary_inventory_items_count||0)-(o.primary_inventory_items_count||0));default:return a}});const Q=Y(()=>({sortOptions:[{value:"name_asc",label:"Name: A to Z"},{value:"name_desc",label:"Name: Z to A"},{value:"value_desc",label:"Value: High to Low"},{value:"value_asc",label:"Value: Low to High"}],statusOptions:[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"}],hasSubcategoriesOptions:[{value:"yes",label:"Has Subcategories"},{value:"no",label:"No Subcategories"}],stockStatusOptions:[{value:"in_stock",label:"In Stock"},{value:"low_stock",label:"Low Stock"},{value:"out_of_stock",label:"Out of Stock"},{value:"has_items",label:"Has Items"},{value:"no_items",label:"No Items"}]})),Me=()=>{g.value={...W},le.value={...W}},se=Y(()=>H.value),Fe=()=>{le.value={...g.value},k.value.current_page=1,E(1)},k=c({current_page:1,last_page:1,per_page:10,total:0,from:0,to:0,links:[]}),h=c(null),S=c([]),ee=async()=>{try{const{data:a}=await D.get("/categories",{params:{per_page:1e4}});pe.value=a.data||[]}catch(a){console.error("Failed to fetch all categories:",a)}},E=async(a=null)=>{try{L.value=!0;const e={q:$.value,page:a||k.value.current_page,per_page:k.value.per_page,sort_by:g.value.sortBy||"",status:g.value.status||"",has_subcategories:g.value.hasSubcategories||"",stock_status:g.value.stockStatus||"",value_min:g.value.valueMin||"",value_max:g.value.valueMax||""},{data:s}=await D.get("/categories",{params:e});H.value=s.data||[],k.value={current_page:s.current_page,last_page:s.last_page,per_page:s.per_page,total:s.total,from:s.from,to:s.to,links:s.links}}catch(e){console.error("Failed to fetch categories:",e),d.error("Failed to load categories")}finally{L.value=!1}},Ie=a=>{if(!a)return;const s=new URLSearchParams(a.split("?")[1]).get("page");s&&E(parseInt(s))};ce(async()=>{$.value="",be.value=Date.now(),await He(),setTimeout(()=>{fe.value=!0;const e=document.getElementById(oe);e&&(e.value="",$.value="")},100),ee(),E();const a=document.getElementById("categoryFilterModal");a&&a.addEventListener("hidden.bs.modal",()=>{g.value={...le.value}})});const ge=Y(()=>H.value.filter(a=>a.parent_id===null)),Ee=Y(()=>{const a=pe.value.filter(e=>e.parent_id===null);return[{label:"Categories",value:a.length,icon:ot,iconBg:"bg-light-primary",iconColor:"text-primary"},{label:"Total Active",value:a.filter(e=>e.active).length,icon:nt,iconBg:"bg-light-success",iconColor:"text-success"},{label:"Low Stock",value:a.filter(e=>!e.active).length,icon:it,iconBg:"bg-light-warning",iconColor:"text-warning"},{label:"Out of Stock",value:a.filter(e=>!e.parent_id).length,icon:rt,iconBg:"bg-light-danger",iconColor:"text-danger"}]}),$=c(""),be=c(Date.now()),oe=`search-${Math.random().toString(36).substr(2,9)}`,fe=c(!1),L=c(!1);ce(()=>window.feather?.replace()),qe(()=>window.feather?.replace());const _=c(!1),ne=c(""),N=c(!0),M=c(null),f=c({label:"Produce (Veg/Fruit)",value:"/assets/img/vegetable.png",file:null}),q=[{label:"Produce (Veg/Fruit)",value:"/assets/img/vegetable.png"},{label:"Meat",value:"/assets/img/meat.png"},{label:"Poultry",value:"/assets/img/poultry.png"},{label:"Dairy",value:"/assets/img/dairy.png"},{label:"Grains & Rice",value:"/assets/img/rice.png"},{label:"Spices & Herbs",value:"/assets/img/spice.png"},{label:"Oils & Fats",value:"/assets/img/olive-oil.png"},{label:"Sauces & Condiments",value:"/assets/img/sauces.png"},{label:"Nuts & Seeds",value:"/assets/img/nuts.png"},{label:"Other",value:"/assets/img/other.png"}],K=c([{label:"Produce (Veg/Fruit)",value:"Produce (Veg/Fruit)",icon:"/assets/img/vegetable.png",selected:!1},{label:"Meat",value:"Meat",icon:"/assets/img/meat.png",selected:!1},{label:"Poultry",value:"Poultry",icon:"/assets/img/poultry.png",selected:!1},{label:"Dairy",value:"Dairy",icon:"/assets/img/dairy.png",selected:!1},{label:"Grains & Rice",value:"Grains & Rice",icon:"/assets/img/rice.png",selected:!1},{label:"Flour & Baking",value:"Flour & Baking",icon:"/assets/img/flour.png",selected:!1},{label:"Spices & Herbs",value:"Spices & Herbs",icon:"/assets/img/spice.png",selected:!1},{label:"Oils & Fats",value:"Oils & Fats",icon:"/assets/img/olive-oil.png",selected:!1},{label:"Sauces & Condiments",value:"Sauces & Condiments",icon:"/assets/img/sauces.png",selected:!1},{label:"Nuts & Seeds",value:"Nuts & Seeds",icon:"/assets/img/nuts.png",selected:!1},{label:"Other",value:"Other",icon:"/assets/img/other.png",selected:!1}]),$e=async(a,e)=>{try{const s=await fetch(a);if(!s.ok)return console.error("âŒ Fetch failed:",s.status,s.statusText),null;const o=await s.blob();return new File([o],e,{type:o.type})}catch(s){return console.error("âŒ Error converting URL to File:",s),null}},ie=()=>{_.value=!1,y.value=[],N.value=!0,M.value=null,ne.value="",f.value={label:q[0].label,value:q[0].value,file:null},K.value=K.value.map(a=>({...a,selected:!1})),h.value=null},P=c(!1),p=c({}),Le=async()=>{if(_.value&&!M.value){p.value.parent_id=["Please select a parent category"],d.error(p.value.parent_id[0]),P.value=!1;return}X(),P.value=!0;try{if(f.value.value&&!f.value.file){const e=f.value.label.toLowerCase().replace(/[^a-z0-9]/g,"-")+".jpg",s=await $e(f.value.value,e);s&&(f.value.file=s)}if(h.value){const e=new FormData;let s="";if(_.value?s=ne.value?.trim():s=y.value[0]?.label?.trim()||y.value[0]?.name?.trim()||(typeof y.value[0]=="string"?y.value[0].trim():""),!s){p.value.name=["Category name cannot be empty"],d.error("Category name cannot be empty"),P.value=!1;return}e.append("name",s),e.append("active",N.value?"1":"0"),e.append("parent_id",M.value||""),e.append("_method","PUT"),f.value.file&&f.value.file instanceof File&&e.append("icon",f.value.file),!M.value&&te.value&&te.value.split(",").map(l=>l.trim()).filter(l=>l.length>0).forEach((l,v)=>{const m=h.value.subcategories?.find(n=>n.name.toLowerCase()===l.toLowerCase());e.append(`subcategories[${v}][name]`,l),m?(e.append(`subcategories[${v}][id]`,m.id),e.append(`subcategories[${v}][active]`,m.active?"1":"0")):e.append(`subcategories[${v}][active]`,"1")}),await D.post(`/categories/${h.value.id}`,e,{headers:{"Content-Type":"multipart/form-data"}}),d.success("Category updated successfully"),await E(),await ee()}else{const e=new FormData;let s=[];if(_.value){if(S.value.length===0){p.value.subcategories=["Please add at least one subcategory"],d.error("Please add at least one subcategory"),P.value=!1;return}s=S.value.map(o=>({name:typeof o=="string"?o:o.label,active:N.value,parent_id:M.value}))}else{if(y.value.length===0){p.value.name=["Please add at least one category"],d.error("Please add at least one category"),P.value=!1;return}s=y.value.map(o=>({name:typeof o=="string"?o:o.label,active:N.value,parent_id:null}))}e.append("isSubCategory",_.value?"1":"0"),s.forEach((o,l)=>{e.append(`categories[${l}][name]`,o.name),e.append(`categories[${l}][active]`,o.active?"1":"0"),o.parent_id&&e.append(`categories[${l}][parent_id]`,o.parent_id)}),f.value.file&&f.value.file instanceof File&&e.append("icon",f.value.file),await D.post("/categories",e,{headers:{"Content-Type":"multipart/form-data"}}),d.success("Category created successfully"),await E(),await ee()}bootstrap.Modal.getInstance(document.getElementById("addCatModal"))?.hide(),ie(),h.value=null,await E()}catch(a){if(a.response?.status===422&&a.response?.data?.errors){const e=a.response.data.errors;let s=[];p.value={},Object.keys(e).forEach(o=>{let l=o.replace(/^categories\.\d+\./,"");p.value[l]=e[o],Array.isArray(e[o])&&e[o].forEach(v=>{s.push(v)})}),s.length>0?d.error(s.join(`
`)):d.error("Validation failed. Please check your input.")}else{const e=a.response?.data?.message||"Failed to save category";d.error(e+" âŒ")}}finally{P.value=!1}},X=()=>{p.value={}},te=c(""),Ne=a=>{X(),h.value=a,_.value=!!a.parent_id,M.value=a.parent_id||null;const e=q.find(l=>l.value===a.icon);f.value=e||q[0],_.value?ne.value=a.name:y.value=[{label:a.name,value:a.name,id:a.id}],N.value=a.active,a.subcategories&&a.subcategories.length>0?(U.value=a.subcategories.map(l=>({label:l.name,value:l.id?l.id.toString():`temp_${Date.now()}_${Math.random()}`})),S.value=a.subcategories.map(l=>l.id?l.id.toString():`temp_${Date.now()}_${Math.random()}`),te.value=a.subcategories.map(l=>l.name).join(", ")):(U.value=[],S.value=[],te.value="");const s=document.getElementById("addCatModal");new bootstrap.Modal(s).show()},re=c(""),ye=()=>{const a=(re.value||"").trim();a&&(K.value.some(e=>e.label.toLowerCase()===a.toLowerCase())||K.value.push({label:a,value:a}),y.value.includes(a)||(y.value=[...y.value,a]),re.value="")},Pe=async a=>{if(a?.id)try{const e=await D.delete(`/categories/${a.id}`);e.data.success?(d.success(e.data.message),await E(),await ee()):d.error(e.data.message)}catch(e){console.error("âŒ Delete error:",e.response?.data||e.message);const s=e.response?.data?.message||"Failed to delete category";d.error(s)}},V=c(null),U=c([]),ae=c(""),ue=()=>{const a=ae.value?.trim();a&&(U.value.some(e=>e.value.toLowerCase()===a.toLowerCase())||U.value.push({label:a,value:a}),S.value.includes(a)||S.value.push(a),ae.value="")},Ve=()=>{S.value=U.value.map(a=>a.value)},De=()=>{S.value=[]},x=c({id:null,name:"",parent_id:null}),Be=(a,e)=>{x.value={id:e.id,name:e.name,parent_id:a.id};const s=document.getElementById("editSubCatModal");bootstrap.Modal.getOrCreateInstance(s).show()},B=c(!1),j=c(""),je=async()=>{if(B.value=!0,!x.value.name.trim()){j.value="Subcategory name cannot be empty";return}B.value=!0,j.value="";try{const{data:a}=await D.put(`/api/categories/subcategories/${x.value.id}`,{name:x.value.name.trim()});if(a.success){d.success(a.message);const e=H.value.find(l=>l.id===x.value.parent_id);if(e){const l=e.subcategories.find(v=>v.id===x.value.id);l&&(l.name=x.value.name)}const s=document.getElementById("editSubCatModal");bootstrap.Modal.getInstance(s).hide(),x.value={id:null,name:"",parent_id:null}}else j.value=a.message||"Failed to update subcategory"}catch(a){console.error(a),j.value=a.response?.data?.message||"An error occurred while updating"}finally{B.value=!1}};ce(()=>{const a=document.getElementById("editSubCatModal");a&&a.addEventListener("hidden.bs.modal",()=>{j.value="",x.value={id:null,name:"",parent_id:null}})}),Ke(()=>{const a=document.getElementById("editSubCatModal");a&&a.removeEventListener("hidden.bs.modal",()=>{})});let he=null;Xe($,()=>{clearTimeout(he),he=setTimeout(()=>{k.value.current_page=1,E(1)},500)});const Te=async()=>{try{L.value=!0;const a={q:$.value.trim(),per_page:1e4,page:1,sort_by:g.value.sortBy||"",status:g.value.status||"",has_subcategories:g.value.hasSubcategories||"",stock_status:g.value.stockStatus||"",value_min:g.value.valueMin||"",value_max:g.value.valueMax||""},e=await D.get("/categories",{params:a});return console.log("ðŸ“¦ Export data received:",{total:e.data.total,items:e.data.data.length}),e.data.data.filter(s=>s.parent_id===null)||[]}catch(a){return console.error("âŒ Error fetching export data:",a),d.error("Failed to load data for export"),[]}finally{L.value=!1}},de=async a=>{try{L.value=!0;const e=await Te();if(!e||e.length===0){d.error("No categories found to download"),L.value=!1;return}console.log(`ðŸ“¥ Exporting ${e.length} categories as ${a.toUpperCase()}`),a==="pdf"?Oe(e):a==="excel"?Ue(e):a==="csv"?Ae(e):d.error("Invalid download type")}catch(e){console.error("Download failed:",e),d.error(`Download failed: ${e.message}`)}finally{L.value=!1}},Ae=a=>{try{const e=["category","subcategory","active"],s=a.map(n=>{const b=A=>A==null?'""':(A=String(A).replace(/"/g,'""'),`"${A}"`),T=n.subcategories&&n.subcategories.length>0?n.subcategories.map(A=>A.name).join(", "):"";return[b(n.name),b(T),n.active?"Yes":"No"]}),o=[e.join(","),...s.map(n=>n.join(","))].join(`
`),l=new Blob([o],{type:"text/csv;charset=utf-8;"}),v=URL.createObjectURL(l),m=document.createElement("a");m.setAttribute("href",v),m.setAttribute("download",`Categories_${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(v),d.success(`CSV downloaded successfully (${a.length} categories)`,{autoClose:2500})}catch(e){console.error("CSV generation error:",e),d.error(`CSV generation failed: ${e.message}`,{autoClose:5e3})}},Oe=a=>{try{const e=new Qe("p","mm","a4");e.setFontSize(18),e.setFont("helvetica","bold"),e.text("Inventory Categories Report",14,20),e.setFontSize(10),e.setFont("helvetica","normal");const s=new Date().toLocaleString();e.text(`Generated on: ${s}`,14,28),e.text(`Total Categories: ${a.length}`,14,34);const o=["Category","Subcategory","Active"],l=a.map(m=>{const n=m.subcategories&&m.subcategories.length>0?m.subcategories.map(b=>b.name).join(", "):"";return[m.name||"",n,m.active?"Yes":"No"]});et(e,{head:[o],body:l,startY:40,styles:{fontSize:9,cellPadding:2,halign:"left",lineColor:[0,0,0],lineWidth:.1},headStyles:{fillColor:[41,128,185],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]},margin:{left:14,right:14},didDrawPage:m=>{const n=e.internal.getNumberOfPages(),b=e.internal.pageSize.height;e.setFontSize(8),e.text(`Page ${m.pageNumber} of ${n}`,m.settings.margin.left,b-10)}});const v=`Categories_${new Date().toISOString().split("T")[0]}.pdf`;e.save(v),d.success(`PDF downloaded successfully (${a.length} categories)`,{autoClose:2500})}catch(e){console.error("PDF generation error:",e),d.error(`PDF generation failed: ${e.message}`,{autoClose:5e3})}},Ue=a=>{try{if(typeof tt>"u")throw new Error("XLSX library is not loaded");const e=a.map(n=>{const b=n.subcategories&&n.subcategories.length>0?n.subcategories.map(T=>T.name).join(", "):"";return{Category:n.name||"",Subcategory:b,Active:n.active?"Yes":"No"}}),s=J.book_new(),o=J.json_to_sheet(e);o["!cols"]=[{wch:25},{wch:40},{wch:10}],J.book_append_sheet(s,o,"Categories");const l=[{Info:"Generated On",Value:new Date().toLocaleString()},{Info:"Total Records",Value:a.length},{Info:"Exported By",Value:"Inventory Management System"}],v=J.json_to_sheet(l);J.book_append_sheet(s,v,"Report Info");const m=`Categories_${new Date().toISOString().split("T")[0]}.xlsx`;at(s,m),d.success(`Excel file downloaded successfully (${a.length} categories)`,{autoClose:2500})}catch(e){console.error("Excel generation error:",e),d.error(`Excel generation failed: ${e.message}`,{autoClose:5e3})}},Re=a=>{if(!a||a.length<=1){d.error("The imported file is empty.");return}a[0];const s=a.slice(1).map(n=>({category:n[0]||"",subcategory:n[1]||null,active:n[2]=="no"?0:1})),o=s.filter(n=>n.category).map(n=>n.category.trim().toLowerCase()),l=o.filter((n,b)=>o.indexOf(n)!==b);if(l.length>0){d.error(`Duplicate category names found in CSV: ${[...new Set(l)].join(", ")}`);return}const v=ge.value.map(n=>n.name.trim().toLowerCase()),m=s.filter(n=>n.category).filter(n=>v.includes(n.category.trim().toLowerCase()));if(m.length>0){const n=m.map(b=>b.category).join(", ");d.error(`Categories already exist in the table: ${n}`);return}D.post("/api/categories/import",{categories:s}).then(()=>{d.success("Categories imported successfully");const n=document.querySelector(".modal.show");if(n){const b=bootstrap.Modal.getInstance(n);b&&b.hide()}setTimeout(()=>{document.querySelectorAll(".modal-backdrop").forEach(T=>T.remove()),document.body.classList.remove("modal-open"),document.body.style.overflow="",document.body.style.paddingRight=""},100),E()}).catch(n=>{console.error(n),d.error("Import failed"),setTimeout(()=>{document.querySelectorAll(".modal-backdrop").forEach(T=>T.remove()),document.body.classList.remove("modal-open"),document.body.style.overflow="",document.body.style.paddingRight=""},100)})};return(a,e)=>{const s=_e("ConfirmModal"),o=_e("Button");return i(),me(Je,null,{default:G(()=>[w(R(Ye),{title:"Inventory Category"}),t("div",dt,[e[57]||(e[57]=t("h4",{class:"mb-3"},"Inventory Categories",-1)),t("div",ct,[(i(!0),r(F,null,z(Ee.value,l=>(i(),r("div",{key:l.label,class:"col-md-6 col-xl-3"},[t("div",mt,[t("div",vt,[t("div",null,[t("div",pt,u(l.value),1),t("div",gt,u(l.label),1)]),t("div",{class:O(["p-3 rounded-3 d-flex align-items-center justify-content-center",l.iconBg])},[(i(),me(Ge(l.icon),{class:O(l.iconColor),size:"28"},null,8,["class"]))],2)])])]))),128))]),t("div",bt,[t("div",ft,[t("div",yt,[e[28]||(e[28]=t("h4",{class:"mb-0"},"Categories",-1)),t("div",ht,[t("div",_t,[e[22]||(e[22]=t("i",{class:"bi bi-search"},null,-1)),e[23]||(e[23]=t("input",{type:"email",name:"email",autocomplete:"email",style:{position:"absolute",left:"-9999px",width:"1px",height:"1px"},tabindex:"-1","aria-hidden":"true"},null,-1)),fe.value?Z((i(),r("input",{id:oe,"onUpdate:modelValue":e[0]||(e[0]=l=>$.value=l),key:be.value,class:"form-control search-input",placeholder:"Search",type:"search",autocomplete:"new-password",name:oe,role:"presentation",onFocus:e[1]||(e[1]=(...l)=>a.handleFocus&&a.handleFocus(...l))},null,32)),[[ve,$.value]]):(i(),r("input",Ct))]),w(We,{modelValue:g.value,"onUpdate:modelValue":e[2]||(e[2]=l=>g.value=l),title:"Inventory Categories","modal-id":"categoryFilterModal","modal-size":"modal-lg","sort-options":Q.value.sortOptions,"status-options":Q.value.statusOptions,"show-stock-status":!1,"stock-status-options":Q.value.stockStatusOptions,"show-price-range":!1,"price-label":"Total Value Range",onApply:Fe,onClear:Me},{customFilters:G(({filters:l})=>[t("div",wt,[e[25]||(e[25]=t("label",{class:"form-label fw-semibold text-dark text-muted"},[t("i",{class:"fas fa-sitemap me-2 text-muted"}),I("Subcategories ")],-1)),Z(t("select",{"onUpdate:modelValue":v=>l.hasSubcategories=v,class:"form-select"},[e[24]||(e[24]=t("option",{value:""},"All",-1)),(i(!0),r(F,null,z(Q.value.hasSubcategoriesOptions,v=>(i(),r("option",{key:v.value,value:v.value},u(v.label),9,xt))),128))],8,kt),[[Ce,l.hasSubcategories]])])]),_:1},8,["modelValue","sort-options","status-options","stock-status-options"]),t("button",{"data-bs-toggle":"modal","data-bs-target":"#addCatModal",onClick:e[3]||(e[3]=()=>{X?.(),h.value&&(h.value.value=null),ie?.()}),class:"d-flex align-items-center gap-1 px-4 py-2 btn-sm rounded-pill btn btn-primary text-white"},[w(R(ut),{class:"w-4 h-4"}),e[26]||(e[26]=I(" Add Category ",-1))]),w(st,{label:"Import",sampleHeaders:["category","subcategory","active"],sampleData:[["Dairy","TestSubCat","yes"],["Bakery","Bread","yes"],["Beverages","Juices","no"]],onOnImport:Re}),t("div",St,[e[27]||(e[27]=t("button",{class:"btn btn-outline-secondary rounded-pill py-2 btn-sm px-4 dropdown-toggle","data-bs-toggle":"dropdown"}," Export ",-1)),t("ul",Mt,[t("li",null,[t("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:e[4]||(e[4]=l=>de("pdf"))},"Export as PDF")]),t("li",null,[t("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:e[5]||(e[5]=l=>de("excel"))},"Export as Excel")]),t("li",null,[t("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:e[6]||(e[6]=l=>de("csv"))}," Export as CSV ")])])])])]),t("div",Ft,[t("table",It,[e[30]||(e[30]=t("thead",{class:"border-top small text-muted"},[t("tr",null,[t("th",null,"S.#"),t("th",null,"Category"),t("th",null,"Sub Category"),t("th",null,"Icon"),t("th",null,"Total Item"),t("th",null,"Out of Stock"),t("th",null,"Low Stock"),t("th",null,"In Stock"),t("th",{class:"text-center"},"Status"),t("th",{class:"text-center"},"Action")])],-1)),t("tbody",null,[L.value?(i(),r("tr",Et,[...e[29]||(e[29]=[t("td",{colspan:"11",class:"text-center py-5"},[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")]),t("p",{class:"text-muted mt-2 mb-0"},"Loading categories...")],-1)])])):!L.value&&H.value.length===0?(i(),r("tr",$t,[t("td",Lt,u($.value.trim()?"No categories found matching your search.":"No categories available."),1)])):(i(),r(F,{key:2},[(i(!0),r(F,null,z(se.value,(l,v)=>(i(),r("tr",{key:l.id},[t("td",null,u(k.value.from+v),1),t("td",Nt,u(l.name),1),t("td",Pt,[l.subcategories&&l.subcategories.length?(i(),r("div",Vt,[(i(!0),r(F,null,z(l.subcategories,m=>(i(),r("div",{key:m.id,class:"d-flex justify-content-between align-items-center",style:{gap:"5px"}},[t("span",null,u(m.name),1),t("button",{class:"p-2 rounded-full text-blue-600 hover:bg-blue-100",onClick:n=>Be(l,m),title:"Edit Subcategory"},[w(R(Se),{class:"w-4 h-4"})],8,Dt)]))),128))])):(i(),r("span",Bt,"â€“"))]),t("td",null,[t("div",jt,[l.image_url?(i(),r("img",{key:0,src:l.image_url,alt:l.name,class:"rounded",style:{width:"32px",height:"32px","object-fit":"cover"}},null,8,Tt)):(i(),r("span",At,"ðŸ“¦"))])]),t("td",null,u(l.primary_inventory_items_count),1),t("td",null,u(l.out_of_stock),1),t("td",null,u(l.low_stock),1),t("td",null,u(l.in_stock),1),t("td",Ot,[t("span",{class:O(l.active?"inline-block px-3 py-1 text-xs font-semibold text-white bg-success rounded-full text-center w-20":"inline-block px-3 py-1 text-xs font-semibold text-white bg-danger rounded-full text-center w-20")},u(l.active?"Active":"Inactive"),3)]),t("td",Ut,[t("div",Rt,[t("button",{"data-bs-toggle":"modal","data-bs-target":"#modalUnitForm",onClick:()=>{Ne(l)},title:"Edit",class:"p-2 rounded-full text-blue-600 hover:bg-blue-100"},[w(R(Se),{class:"w-4 h-4"})],8,zt),w(s,{title:"Confirm Delete",message:`Are you sure you want to delete ${l.name}?`,showDeleteButton:!0,onConfirm:()=>{Pe(l)},onCancel:()=>{}},null,8,["message","onConfirm"])])])]))),128)),se.value.length===0?(i(),r("tr",Ht,[t("td",qt,u($.value.trim()?"No categories found matching your search.":"No categories found."),1)])):C("",!0)],64))])])]),k.value.last_page>1?(i(),r("div",Kt,[t("div",Xt," Showing "+u(k.value.from)+" to "+u(k.value.to)+" of "+u(k.value.total)+" entries ",1),w(Ze,{pagination:k.value.links,isApiDriven:!0,onPageChanged:Ie},null,8,["pagination"])])):C("",!0)])]),t("div",Yt,[t("div",Gt,[t("div",Zt,[e[36]||(e[36]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title"},"Category Details"),t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})])])],-1)),V.value?(i(),r("div",Jt,[t("p",null,[e[31]||(e[31]=t("strong",null,"Name:",-1)),I(" "+u(V.value.name),1)]),t("p",null,[e[32]||(e[32]=t("strong",null,"Icon:",-1)),t("span",Wt,u(V.value.icon),1)]),t("p",null,[e[33]||(e[33]=t("strong",null,"Status:",-1)),I(" "+u(V.value.active?"Active":"Inactive"),1)]),V.value.parent?(i(),r("p",Qt,[e[34]||(e[34]=t("strong",null,"Parent Category:",-1)),I(" "+u(V.value.parent.name),1)])):C("",!0),t("p",null,[e[35]||(e[35]=t("strong",null,"Sub-Categories: ",-1)),V.value.subcategories.length?(i(),r("span",ea,u(V.value.subcategories.map(l=>l.name).join(", ")),1)):(i(),r("span",ta,"None"))])])):(i(),r("div",aa," Loading category details... ")),e[37]||(e[37]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ")],-1))])])]),t("div",la,[t("div",sa,[t("div",oa,[t("div",na,[t("h5",ia,u(h.value?"Edit Category":"Add Raw Material Category"),1),e[38]||(e[38]=t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})])],-1))]),t("div",ra,[t("div",ua,[h.value?C("",!0):(i(),r(F,{key:0},[t("div",da,[e[41]||(e[41]=t("label",{class:"form-label d-block mb-2"},"Is this a subcategory?",-1)),t("div",ca,[t("div",ma,[t("input",{class:"form-check-input",type:"radio",checked:_.value,onClick:e[7]||(e[7]=l=>X()),onChange:e[8]||(e[8]=l=>{_.value=!0,M.value=null}),name:"isSub"},null,40,va),e[39]||(e[39]=t("label",{class:"form-check-label"},"Yes",-1))]),t("div",pa,[t("input",{class:"form-check-input",type:"radio",checked:!_.value,onClick:e[9]||(e[9]=l=>X()),onChange:e[10]||(e[10]=l=>{_.value=!1,M.value=null}),name:"isSub"},null,40,ga),e[40]||(e[40]=t("label",{class:"form-check-label"},"No",-1))])])]),_.value?(i(),r("div",ba,[e[43]||(e[43]=t("label",{class:"form-label d-block mb-2"},"Select Parent Category",-1)),Z(t("select",{"onUpdate:modelValue":e[11]||(e[11]=l=>M.value=l),class:O(["form-select",{"is-invalid":p.value?.parent_id}]),required:""},[e[42]||(e[42]=t("option",{disabled:"",value:null}," Choose Parent Category ",-1)),(i(!0),r(F,null,z(ge.value,l=>(i(),r("option",{key:l.id,value:l.id},u(l.name),9,fa))),128))],2),[[Ce,M.value]]),p.value?.parent_id?(i(),r("small",ya,u(p.value.parent_id[0]),1)):C("",!0)])):C("",!0)],64)),t("div",ha,[e[45]||(e[45]=t("label",{class:"form-label d-block mb-2"},"Manual Icon",-1)),t("div",_a,[t("button",Ca,[t("span",wa,[t("img",{src:f.value.value,alt:"icon",class:"me-2 rounded",style:{width:"24px",height:"24px","object-fit":"cover"}},null,8,ka),I(" "+u(f.value.label),1)]),e[44]||(e[44]=t("i",{class:"bi bi-caret-down-fill"},null,-1))]),t("ul",xa,[(i(),r(F,null,z(q,l=>t("li",{key:l.label},[t("a",{class:"dropdown-item d-flex align-items-center",href:"javascript:void(0)",onClick:v=>f.value=l},[t("img",{src:l.value,alt:"icon",class:"me-2 rounded",style:{width:"24px",height:"24px","object-fit":"cover"}},null,8,Ma),I(" "+u(l.label),1)],8,Sa)])),64))])])]),!_.value||h.value?(i(),r("div",Fa,[e[46]||(e[46]=t("label",{class:"form-label"},"Category Name",-1)),h.value?Z((i(),r("input",{key:0,type:"text","onUpdate:modelValue":e[12]||(e[12]=l=>y.value[0].label=l),class:O(["form-control",{"is-invalid":p.value.name}]),placeholder:"Enter category name"},null,2)),[[ve,y.value[0].label]]):(i(),me(R(xe),{key:1,modelValue:y.value,"onUpdate:modelValue":e[13]||(e[13]=l=>y.value=l),options:K.value,optionLabel:"label",optionValue:"value",filter:!0,display:"chip",class:O([{"is-invalid":p.value.name},"w-100 select"]),placeholder:"Select or add categories...",appendTo:"self",onKeydown:we(ke(ye,["prevent"]),["enter"]),onBlur:ye,onFilter:e[14]||(e[14]=l=>re.value=l.value)},{option:G(({option:l})=>[I(u(l.label),1)]),_:1},8,["modelValue","options","class","onKeydown"])),p.value.name?(i(),r("small",Ia,u(p.value.name[0]),1)):C("",!0)])):C("",!0),_.value&&!h.value?(i(),r("div",Ea,[e[47]||(e[47]=t("label",{class:"form-label"},"Subcategory Name(s)",-1)),w(R(xe),{modelValue:S.value,"onUpdate:modelValue":e[15]||(e[15]=l=>S.value=l),options:U.value,optionLabel:"label",optionValue:"value",filter:!0,display:"chip",class:O([{"is-invalid":p.value?.subcategories||p.value?.name},"w-100"]),placeholder:"Select or add subcategories...",appendTo:"self",onFilter:e[16]||(e[16]=l=>ae.value=l.value||""),onKeydown:we(ke(ue,["prevent"]),["enter"]),onBlur:ue},{option:G(({option:l})=>[t("div",null,u(l.label),1)]),footer:G(()=>[t("div",$a,[w(o,{label:"Add Custom",severity:"secondary",variant:"text",size:"small",icon:"pi pi-plus",onClick:ue,disabled:!ae.value.trim()},null,8,["onClick","disabled"]),t("div",La,[w(o,{label:"Select All",severity:"secondary",variant:"text",size:"small",icon:"pi pi-check",onClick:Ve},null,8,["onClick"]),w(o,{label:"Clear All",severity:"danger",variant:"text",size:"small",icon:"pi pi-times",onClick:De},null,8,["onClick"])])])]),_:1},8,["modelValue","options","class","onKeydown"]),p.value?.subcategories?(i(),r("div",Na,u(p.value.subcategories[0]),1)):C("",!0),p.value?.name?(i(),r("div",Pa,u(p.value.name[0]),1)):C("",!0)])):C("",!0),h.value&&a.parentCategory?(i(),r("div",Va,[e[48]||(e[48]=t("label",{class:"form-label"},"Parent Category",-1)),t("input",{type:"text",class:"form-control",value:a.parentCategory.label,disabled:""},null,8,Da)])):C("",!0),t("div",Ba,[e[51]||(e[51]=t("label",{class:"form-label d-block mb-2"},"Active",-1)),t("div",ja,[t("div",Ta,[t("input",{class:"form-check-input",type:"radio",checked:N.value,onChange:e[17]||(e[17]=l=>N.value=!0),name:"active"},null,40,Aa),e[49]||(e[49]=t("label",{class:"form-check-label"},"Yes",-1))]),t("div",Oa,[t("input",{class:"form-check-input",type:"radio",checked:!N.value,onChange:e[18]||(e[18]=l=>N.value=!1),name:"active"},null,40,Ua),e[50]||(e[50]=t("label",{class:"form-check-label"},"No",-1))])])])]),e[54]||(e[54]=t("hr",{class:"my-4"},null,-1)),t("div",Ra,[t("button",{class:"btn btn-primary btn-sm rounded-pill px-4",disabled:P.value,onClick:e[19]||(e[19]=l=>Le())},[P.value?(i(),r(F,{key:0},[e[52]||(e[52]=t("span",{class:"spinner-border spinner-border-sm me-2"},null,-1)),e[53]||(e[53]=I(" Saving... ",-1))],64)):(i(),r(F,{key:1},[I(u((h.value,"Save")),1)],64))],8,za),t("button",{class:"btn btn-secondary rounded-pill btn-sm px-4 ms-2","data-bs-dismiss":"modal",onClick:ie}," Cancel ")])])])])]),t("div",Ha,[t("div",qa,[t("div",Ka,[t("div",Xa,[t("h5",{onClick:e[20]||(e[20]=l=>j.value=""),class:"modal-title",id:"editSubCatModalLabel"}," Edit Subcategory "),e[55]||(e[55]=t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})])],-1))]),t("div",Ya,[t("div",Ga,[e[56]||(e[56]=t("label",{for:"subCategoryName",class:"form-label"},"Subcategory Name",-1)),Z(t("input",{type:"text",class:"form-control",id:"subCategoryName","onUpdate:modelValue":e[21]||(e[21]=l=>x.value.name=l),disabled:B.value},null,8,Za),[[ve,x.value.name]]),t("small",Ja,u(j.value),1)]),t("button",{type:"button",class:"px-4 py-2 rounded-pill btn btn-primary text-white text-center d-flex align-items-center justify-content-center gap-2",onClick:je,disabled:B.value},[B.value?(i(),r("span",Qa)):C("",!0),t("span",null,u(B.value?"Saving...":"Save"),1)],8,Wa)])])])])])]),_:1})}}},kl=ze(el,[["__scopeId","data-v-e215b1aa"]]);export{kl as default};
