import{_ as xe}from"./Master-O196L17Z.js";import{_ as we,r as S,c as L,w as Se,o as ae,I as ke,n as De,g as d,b as u,e as k,u as c,h as Te,d as Re,f as e,l as v,p as x,J as E,F as p,t as i,i as M,K as z,q as Pe}from"./app-8IuynfNs.js";import{u as Ce}from"./useFormatters-DH4zupV8.js";import{s as V}from"./index-baplSocH.js";import{s as Le}from"./index-Cu2K41uh.js";import{E as Ae,a as je,u as J,w as Me}from"./xlsx-BnIfDSd0.js";import"./index-33L4DW5j.js";import"./createLucideIcon-CHSKluew.js";import"./index-T3VCF_Yp.js";import"./index-qUyqoe8i.js";import"./sun-C20Rw8yZ.js";import"./index-B4GukRYa.js";import"./index-KmCVkqca.js";const Ve={class:"page-wrapper"},Oe={class:"d-flex flex-wrap gap-2 align-items-center justify-content-between mb-3"},Ie={class:"card border-0 shadow-sm rounded-4 mb-4"},Ne={class:"card-body"},$e={class:"row g-3"},Ue={class:"col-md-3"},Ye={class:"col-md-3"},Fe={key:0,class:"col-md-3"},qe={key:1,class:"col-md-2"},Qe={key:2,class:"col-md-2"},Ee={key:3,class:"col-md-3"},ze={key:4,class:"col-md-2"},Je={key:5,class:"col-md-2"},Be={class:"row g-3 mb-4"},Ge={class:"col-md-6 col-xl-3"},Ke={class:"card border-0 shadow-sm rounded-4"},Xe={class:"card-body d-flex align-items-center justify-content-between"},He={class:"mb-0 fw-bold"},We={class:"col-md-6 col-xl-3"},Ze={class:"card border-0 shadow-sm rounded-4"},et={class:"card-body d-flex align-items-center justify-content-between"},tt={class:"mb-0 fw-bold"},st={class:"col-md-6 col-xl-3"},lt={class:"card border-0 shadow-sm rounded-4"},at={class:"card-body d-flex align-items-center justify-content-between"},ot={class:"mb-0 fw-bold"},nt={class:"col-md-6 col-xl-3"},it={class:"card border-0 shadow-sm rounded-4"},dt={class:"card-body d-flex align-items-center justify-content-between"},ut={class:"mb-0 fw-bold"},rt={class:"col-md-6 col-xl-3"},ct={class:"card border-0 shadow-sm rounded-4"},mt={class:"card-body d-flex align-items-center justify-content-between"},vt={class:"mb-0 fw-bold"},yt={class:"col-md-6 col-xl-3"},pt={class:"card border-0 shadow-sm rounded-4"},ht={class:"card-body d-flex align-items-center justify-content-between"},bt={class:"mb-0 fw-bold"},gt={class:"col-md-6 col-xl-3"},_t={class:"card border-0 shadow-sm rounded-4"},ft={class:"card-body d-flex align-items-center justify-content-between"},xt={class:"mb-0 fw-bold"},wt={class:"col-md-6 col-xl-3"},St={class:"card border-0 shadow-sm rounded-4"},kt={class:"card-body d-flex align-items-center justify-content-between"},Dt={class:"mb-0 fw-bold"},Tt={class:"col-md-6 col-xl-3"},Rt={class:"card border-0 shadow-sm rounded-4"},Pt={class:"card-body d-flex align-items-center justify-content-between"},Ct={class:"mb-0 fw-bold"},Lt={class:"col-md-6 col-xl-3"},At={class:"card border-0 shadow-sm rounded-4"},jt={class:"card-body d-flex align-items-center justify-content-between"},Mt={class:"mb-0 fw-bold"},Vt={class:"col-md-6 col-xl-3"},Ot={class:"card border-0 shadow-sm rounded-4"},It={class:"card-body d-flex align-items-center justify-content-between"},Nt={class:"mb-0 fw-bold"},$t={class:"col-md-6 col-xl-3"},Ut={class:"card border-0 shadow-sm rounded-4"},Yt={class:"card-body d-flex align-items-center justify-content-between"},Ft={class:"mb-0 fw-bold"},qt={class:"col-md-6 col-xl-3"},Qt={class:"card border-0 shadow-sm rounded-4"},Et={class:"card-body d-flex align-items-center justify-content-between"},zt={class:"mb-0 fw-bold"},Jt={class:"col-md-6 col-xl-3"},Bt={class:"card border-0 shadow-sm rounded-4"},Gt={class:"card-body d-flex align-items-center justify-content-between"},Kt={class:"mb-0 fw-bold"},Xt={class:"col-md-6 col-xl-3"},Ht={class:"card border-0 shadow-sm rounded-4"},Wt={class:"card-body d-flex align-items-center justify-content-between"},Zt={class:"mb-0 fw-bold"},es={class:"col-md-6 col-xl-3"},ts={class:"card border-0 shadow-sm rounded-4"},ss={class:"card-body d-flex align-items-center justify-content-between"},ls={class:"mb-0 fw-bold"},as={class:"col-md-6 col-xl-3"},os={class:"card border-0 shadow-sm rounded-4"},ns={class:"card-body d-flex align-items-center justify-content-between"},is={class:"mb-0 fw-bold"},ds={class:"col-md-6 col-xl-3"},us={class:"card border-0 shadow-sm rounded-4"},rs={class:"card-body d-flex align-items-center justify-content-between"},cs={class:"mb-0 fw-bold"},ms={class:"col-md-6 col-xl-3"},vs={class:"card border-0 shadow-sm rounded-4"},ys={class:"card-body d-flex align-items-center justify-content-between"},ps={class:"mb-0 fw-bold"},hs={class:"col-md-6 col-xl-3"},bs={class:"card border-0 shadow-sm rounded-4"},gs={class:"card-body d-flex align-items-center justify-content-between"},_s={class:"mb-0 fw-bold"},fs={class:"col-md-6 col-xl-3"},xs={class:"card border-0 shadow-sm rounded-4"},ws={class:"card-body d-flex align-items-center justify-content-between"},Ss={class:"mb-0 fw-bold"},ks={class:"col-md-6 col-xl-3"},Ds={class:"card border-0 shadow-sm rounded-4"},Ts={class:"card-body d-flex align-items-center justify-content-between"},Rs={class:"mb-0 fw-bold"},Ps={class:"col-md-6 col-xl-3"},Cs={class:"card border-0 shadow-sm rounded-4"},Ls={class:"card-body d-flex align-items-center justify-content-between"},As={class:"mb-0 fw-bold"},js={class:"col-md-6 col-xl-3"},Ms={class:"card border-0 shadow-sm rounded-4"},Vs={class:"card-body d-flex align-items-center justify-content-between"},Os={class:"mb-0 fw-bold"},Is={key:0,class:"alert alert-warning border-0 rounded-4 shadow-sm"},Ns={class:"card border-0 shadow-sm rounded-4 mt-3"},$s={class:"card-body"},Us={class:"table-responsive"},Ys={class:"table table-hover align-middle"},Fs={class:"small text-muted"},qs={key:0},Qs={key:1},Es={key:2},zs={key:3},Js={key:4},Bs={key:5,style:{width:"150px"}},Gs={key:6,style:{width:"100px"}},Ks={key:7,style:{width:"100px"}},Xs={key:0},Hs={key:1},Ws={key:2,style:{width:"100px"}},Zs={key:3},el={key:4,style:{width:"150px"}},tl={key:5,style:{width:"150px"}},sl={key:6,style:{width:"130px"}},ll={key:7,style:{width:"150px"}},al={key:8,style:{width:"120px"}},ol={key:9,style:{width:"100px"}},nl={class:"fw-semibold"},il={key:0,class:"small"},dl={key:1,class:"small"},ul={class:"fw-bold text-success"},rl={key:2,class:"small"},cl={class:"fw-semibold"},ml={key:0,class:"fw-semibold"},vl={key:1,class:"small"},yl={key:0,class:"text-muted"},pl={key:1,class:"text-secondary"},hl={key:2,class:"small"},bl={class:"fw-bold text-success"},gl={key:3,class:"small"},_l={key:4},fl={key:0,class:"badge bg-success-subtle text-success px-3 py-2 rounded-pill"},xl={key:1,class:"badge bg-warning-subtle text-warning px-3 py-2 rounded-pill"},wl={key:2,class:"badge bg-secondary-subtle text-secondary px-3 py-2 rounded-pill"},Sl={class:"fw-semibold"},kl={class:"fw-semibold"},Dl={key:0,class:"badge bg-success-subtle text-success"},Tl={key:1,class:"badge bg-warning-subtle text-warning"},Rl={key:2,class:"badge bg-danger-subtle text-danger"},Pl={class:"fw-semibold"},Cl={class:"fw-semibold"},Ll={key:0,class:"table-active fw-bold border-top border-3"},Al={class:"text-success"},jl={key:1,class:"table-active fw-bold border-top border-3"},Ml={key:2},Vl={key:3},Ol={class:"row g-3"},Il={class:"col-lg-8"},Nl={class:"card border-0 shadow-sm rounded-4 h-100"},$l={class:"card-body"},Ul={class:"fw-semibold mb-2"},Yl={class:"chart"},Fl={viewBox:"0 0 840 280"},ql=["y1","y2"],Ql=["x","y"],El=["x","y"],zl=["d"],Jl=["d"],Bl={key:2},Gl={key:3,x:"430",y:"140","text-anchor":"middle",fill:"#6b7280"},Kl={class:"col-lg-4"},Xl={class:"card border-0 shadow-sm rounded-4 mb-3"},Hl={class:"card-body"},Wl={class:"stack-row"},Zl={class:"stack-val"},ea={class:"progress thin"},ta={class:"card border-0 shadow-sm rounded-4"},sa={class:"card-body"},la={class:"stack"},aa={class:"stack-row"},oa={class:"stack-val"},na={class:"stack-row"},ia={class:"stack-val"},da={class:"stack-row"},ua={class:"stack-val"},ra={class:"stack-row"},ca={__name:"Index",setup(ma){const{formatNumber:w,formatCurrencySymbol:n,dateFmt:D}=Ce(),s=S({type:"sales",timeRange:"monthly",selectedMonth:"",selectedYear:"",selectedDate:"",selectedYear:"",dateFrom:"",dateTo:"",orderType:"",paymentType:""}),$=S(null),oe=[{label:"PDF",value:"pdf"},{label:"Excel",value:"excel"}],ne=m=>{m&&(m==="pdf"&&pe(),m==="excel"&&he(),$.value=null)},ie=[{label:"Sales Analytics",value:"sales"},{label:"Purchase Analytics",value:"purchase"},{label:"Sales vs Purchase",value:"comparison"},{label:"Stock Analysis",value:"stock"},{label:"Cashier Performance",value:"userSales"},{label:"Category Analysis",value:"category"}],de=[{label:"Daily",value:"daily"},{label:"Monthly",value:"monthly"},{label:"Yearly",value:"yearly"},{label:"Custom Range",value:"custom"}],R=S(!1),T=S(""),ue=S(Date.now()),re=`search-${Math.random().toString(36).substr(2,9)}`,ce=S(!1),U=S(""),_=S({}),Y=S([]),P=S([]),B=S([]),r=S({}),G=S("Just now"),K=S(0),me=L(()=>{const m=[],t=["January","February","March","April","May","June","July","August","September","October","November","December"];for(let a=1;a<=12;a++){const l=String(a).padStart(2,"0");m.push({value:l,label:t[a-1]})}return m}),X=L(()=>{const m=new Date().getFullYear(),t=[];for(let a=m;a>=m-10;a--)t.push(a);return t}),H=L(()=>({sales:"Sales Over Time",purchase:"Purchase Over Time",comparison:"Sales vs Purchase",stock:"Stock Trend",userSales:"Cashier Performance",category:"Category Distribution"})[s.value.type]||"Chart"),W=L(()=>{if(s.value.timeRange==="daily")return s.value.selectedDate?`Date: ${s.value.selectedDate}`:"Select a date";if(s.value.timeRange==="monthly"){const t=["January","February","March","April","May","June","July","August","September","October","November","December"][parseInt(s.value.selectedMonth)-1]||"";return s.value.selectedMonth&&s.value.selectedYear?`${t} ${s.value.selectedYear}`:"Select month and year"}return s.value.timeRange==="yearly"?s.value.selectedYear?`Year: ${s.value.selectedYear}`:"Select a year":s.value.dateFrom&&s.value.dateTo?`${s.value.dateFrom} to ${s.value.dateTo}`:"Select dates"});function ve(m,t,a,l={l:50,r:20,t:40,b:50}){if(!m?.length)return{paths:[],xLabels:[],yLabels:[]};const b=m.map((y,f)=>f),o=m.map(y=>+y.total||+y.sales||+y.purchase||+y.value||0),g=m.map(y=>+y.purchase||0),I=0,be=Math.max(1,b.length-1),ge=[...o,...g].filter(y=>y>0),Z=0,ee=Math.max(1,...ge),_e=Math.max(1,t-l.l-l.r),F=Math.max(1,a-l.t-l.b),A=y=>l.l+(y-I)/(be-I)*_e,j=y=>l.t+F-(y-Z)/(ee-Z)*F;let q="";if(b.length===1){const y=A(0),f=j(o[0]);q=`M${y},${f} L${y+.01},${f}`}else q=b.map((y,f)=>`${f?"L":"M"}${A(y)},${j(o[f])}`).join(" ");let Q="";if(g.some(y=>y>0))if(b.length===1){const y=A(0),f=j(g[0]);Q=`M${y},${f} L${y+.01},${f}`}else Q=b.map((y,f)=>`${f?"L":"M"}${A(y)},${j(g[f])}`).join(" ");const fe=m.map((y,f)=>{let N;if(y.date){const le=new Date(y.date);y.date.length===7&&y.date.includes("-")?N=le.toLocaleDateString("en-US",{month:"short"}):N=le.toLocaleDateString("en-US",{weekday:"short"})}else N=`Day ${f+1}`;return{x:A(f),y:l.t+F+20,text:N}}),te=5,se=[];for(let y=0;y<=te;y++){const f=ee/te*y;se.push({x:l.l-10,y:j(f),text:Math.round(f).toLocaleString()})}return{salesPath:q,purchasePath:Q,xLabels:fe,yLabels:se}}const C=L(()=>ve(Y.value,840,280)),h=L(()=>{const m=U.value.trim().toLowerCase();return s.value.type!=="sales"?m?(P.value||[]).filter(t=>[t.name,t.cashierName,t.categoryName,t.metric].filter(Boolean).join(" ").toLowerCase().includes(m)):P.value||[]:m?(P.value||[]).filter(t=>[String(t.id),t.customer_name].filter(Boolean).join(" ").toLowerCase().includes(m)):P.value||[]}),ye=()=>{s.value.selectedMonth="",s.value.selectedYear="",s.value.selectedDate="",s.value.dateFrom="",s.value.dateTo=""},O=async()=>{if(s.value.timeRange==="daily"&&!s.value.selectedDate){T.value="Please select a date";return}if(s.value.timeRange==="monthly"&&(!s.value.selectedMonth||!s.value.selectedYear)){T.value="Please select both month and year";return}if(s.value.timeRange==="monthly"&&!s.value.selectedMonth){T.value="Please select a month";return}if(s.value.timeRange==="yearly"&&!s.value.selectedYear){T.value="Please select a year";return}if(s.value.timeRange==="custom"&&(!s.value.dateFrom||!s.value.dateTo)){T.value="Please select both start and end dates";return}R.value=!0,T.value="";try{const{data:m}=await Pe.get("/api/analytics",{params:{type:s.value.type,timeRange:s.value.timeRange,selectedMonth:s.value.selectedMonth,selectedYear:s.value.selectedYear,selectedDate:s.value.selectedDate,dateFrom:s.value.dateFrom,dateTo:s.value.dateTo,orderType:s.value.orderType,paymentType:s.value.paymentType}});_.value=m.kpi||{},Y.value=m.chartData||[],P.value=m.tableData||[],B.value=m.distributionData||[],r.value=m.totalsSummary||{},K.value=P.value.length,G.value=new Date().toLocaleTimeString()}catch(m){console.error(m),T.value=m.response?.data?.message||"Failed to load analytics"}finally{R.value=!1}};Se(()=>[s.value.type,s.value.timeRange,s.value.selectedMonth,s.value.selectedYear,s.value.selectedDate],()=>{s.value.type&&s.value.timeRange&&(s.value.timeRange==="daily"&&s.value.selectedDate||s.value.timeRange==="monthly"&&s.value.selectedMonth&&s.value.selectedYear||s.value.timeRange==="yearly"&&s.value.selectedYear||s.value.timeRange==="custom"&&s.value.dateFrom&&s.value.dateTo)&&O()}),ae(()=>window.feather?.replace()),ke(()=>window.feather?.replace()),ae(async()=>{U.value="",ue.value=Date.now(),await De(),setTimeout(()=>{ce.value=!0;const m=document.getElementById(re);m&&(m.value="",U.value="")},100)});const pe=()=>{try{const m=new Ae("l","mm","a4");m.setFontSize(18),m.setFont("helvetica","bold"),m.text(`${H.value}`,14,20),m.setFontSize(10),m.setFont("helvetica","normal");const t=new Date().toLocaleString();m.text(`Generated on: ${t}`,14,28),m.text(`Period: ${W.value}`,14,34),m.text(`Total Records: ${h.value.length}`,14,40);let a=[],l=[];if(s.value.type==="sales"){if(s.value.timeRange==="monthly"?(a=["S.#","Day","Orders","Items","Qty","Sub Total","Tax","Service","Delivery","Sales Disc.","Approved Disc.","Promo Disc.","Total"],l=h.value.map((o,g)=>[g+1,"Day "+new Date(o.order_date).getDate(),o.order_count,o.item_count,o.total_qty,n(o.sub_total),n(o.tax),n(o.service_charges),n(o.delivery_charges),n(o.sales_discount),n(o.approved_discounts),n(o.promo_discount),n(o.total_amount)])):s.value.timeRange==="yearly"?(a=["S.#","Month","Orders","Items","Qty","Sub Total","Tax","Service","Delivery","Sales Disc.","Approved Disc.","Promo Disc.","Total"],l=h.value.map((o,g)=>[g+1,new Date(o.order_month+"-01").toLocaleDateString("en-US",{month:"long",year:"numeric"}),o.order_count,o.item_count,o.total_qty,n(o.sub_total),n(o.tax),n(o.service_charges),n(o.delivery_charges),n(o.sales_discount),n(o.approved_discounts),n(o.promo_discount),n(o.total_amount)])):(a=["S.#","Order ID","Customer","Items","Qty","Sub Total","Tax","Service","Delivery","Sales Disc.","Approved Disc.","Promo Disc.","Promos","Promo Type","Total","Date"],l=h.value.map((o,g)=>[g+1,o.id,o.customer_name||"-",o.item_count,o.total_qty,n(o.sub_total),n(o.tax),n(o.service_charges),n(o.delivery_charges),n(o.sales_discount),n(o.approved_discounts),n(o.promo_discount),o.promo_names||"-",o.promo_types||"-",n(o.total_amount),D(o.order_date)])),r.value&&h.value.length>0){const o=s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?["TOTAL","-","-",r.value.item_count,r.value.total_qty,n(r.value.sub_total),n(r.value.tax),n(r.value.service_charges),n(r.value.delivery_charges),n(r.value.sales_discount),n(r.value.approved_discounts),n(r.value.promo_discount),n(r.value.total_amount)]:["TOTAL","-","-",r.value.item_count,r.value.total_qty,n(r.value.sub_total),n(r.value.tax),n(r.value.service_charges),n(r.value.delivery_charges),n(r.value.sales_discount),n(r.value.approved_discounts),n(r.value.promo_discount),"-","-",n(r.value.total_amount),"-"];l.push(o)}}else if(s.value.type==="purchase"){if(s.value.timeRange==="monthly"?(a=["S.#","Day","Purchases","Quantity","Unit Price","Sub Total","Suppliers","Total Amount"],l=h.value.map((o,g)=>[g+1,"Day "+new Date(o.purchase_date).getDate(),o.purchase_count,o.quantity,n(o.total_unit_price),n(o.sub_total),o.supplier_names||"-",n(o.total_amount)])):s.value.timeRange==="yearly"?(a=["S.#","Month","Purchases","Quantity","Unit Price","Sub Total","Suppliers","Total Amount"],l=h.value.map((o,g)=>[g+1,new Date(o.purchase_month+"-01").toLocaleDateString("en-US",{month:"long",year:"numeric"}),o.purchase_count,o.quantity,n(o.total_unit_price),n(o.sub_total),o.supplier_names||"-",n(o.total_amount)])):(a=["S.#","Purchase ID","Supplier","Product","Quantity","Unit Price","Sub Total","Expiry","Purchase Date","Status"],l=h.value.map((o,g)=>[g+1,o.purchase_id,o.supplier_name||"-",o.product_name||"-",o.quantity,n(o.unit_price),n(o.sub_total),o.expiry_date?D(o.expiry_date):"N/A",D(o.purchase_date),o.status||"-"])),r.value&&h.value.length>0){const o=s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?["TOTAL","-","-",r.value.quantity,n(r.value.total_unit_price),n(r.value.sub_total),"-",n(r.value.total_amount)]:["TOTAL","-","-","-",r.value.quantity,n(r.value.total_unit_price),n(r.value.sub_total),"-","-","-"];l.push(o)}}else s.value.type==="comparison"?(a=["S.#","Metric","Sales","Purchase","Difference"],l=h.value.map((o,g)=>[g+1,o.metric,n(o.sales),n(o.purchase),n(o.difference)])):s.value.type==="stock"?(a=["S.#","Item","Current Stock","Min Level","Status"],l=h.value.map((o,g)=>[g+1,o.name,o.currentStock,o.minLevel,o.currentStock>o.minLevel?"In Stock":o.currentStock>0?"Low Stock":"Out of Stock"])):s.value.type==="userSales"?(a=["S.#","Cashier Name","Orders","Total Sales","Avg Sale"],l=h.value.map((o,g)=>[g+1,o.cashierName,o.orderCount,n(o.totalSales),n(o.avgSale)])):s.value.type==="category"&&(a=["S.#","Category","Qty Sold","Revenue","% of Total"],l=h.value.map((o,g)=>[g+1,o.categoryName,o.qty,n(o.revenue),o.percentage+"%"]));je(m,{head:[a],body:l,startY:46,styles:{fontSize:7,cellPadding:2,halign:"left",lineColor:[0,0,0],lineWidth:.1},headStyles:{fillColor:[41,128,185],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]},margin:{left:14,right:14},didDrawPage:o=>{const g=m.internal.getNumberOfPages(),I=m.internal.pageSize.height;m.setFontSize(8),m.text(`Page ${o.pageNumber} of ${g}`,o.settings.margin.left,I-10)}});const b=`${s.value.type}_Analytics_${new Date().toISOString().split("T")[0]}.pdf`;m.save(b)}catch(m){console.error("PDF generation error:",m),T.value=`PDF generation failed: ${m.message}`}},he=()=>{let m=[];if(s.value.type==="sales"){if(s.value.timeRange==="monthly"?m=h.value.map((l,b)=>({"S.#":b+1,Day:"Day "+new Date(l.order_date).getDate(),Orders:l.order_count,"Item Count":l.item_count,"Total Qty":l.total_qty,"Sub Total":l.sub_total,Tax:l.tax,"Service Charge":l.service_charges,"Delivery Charge":l.delivery_charges,"Sales Discount":l.sales_discount,"Approved Discount":l.approved_discounts,"Promo Discount":l.promo_discount,"Total Amount":l.total_amount})):s.value.timeRange==="yearly"?m=h.value.map((l,b)=>({"S.#":b+1,Month:new Date(l.order_month+"-01").toLocaleDateString("en-US",{month:"long",year:"numeric"}),Orders:l.order_count,"Item Count":l.item_count,"Total Qty":l.total_qty,"Sub Total":l.sub_total,Tax:l.tax,"Service Charge":l.service_charges,"Delivery Charge":l.delivery_charges,"Sales Discount":l.sales_discount,"Approved Discount":l.approved_discounts,"Promo Discount":l.promo_discount,"Total Amount":l.total_amount})):m=h.value.map((l,b)=>({"S.#":b+1,"Order ID":l.id,"Customer Name":l.customer_name,"Item Count":l.item_count,"Total Qty":l.total_qty,"Sub Total":l.sub_total,Tax:l.tax,"Service Charge":l.service_charges,"Delivery Charge":l.delivery_charges,"Sales Discount":l.sales_discount,"Approved Discount":l.approved_discounts,"Promo Discount":l.promo_discount,"Applied Promos":l.promo_names,"Promo Type":l.promo_types,"Total Amount":l.total_amount,Date:D(l.order_date)})),r.value){const l=s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?{"S.#":"TOTAL",[s.value.timeRange==="monthly"?"Day":"Month"]:"-",Orders:"-","Item Count":r.value.item_count,"Total Qty":r.value.total_qty,"Sub Total":r.value.sub_total,Tax:r.value.tax,"Service Charge":r.value.service_charges,"Delivery Charge":r.value.delivery_charges,"Sales Discount":r.value.sales_discount,"Approved Discount":r.value.approved_discounts,"Promo Discount":r.value.promo_discount,"Total Amount":r.value.total_amount}:{"S.#":"TOTAL","Order ID":"-","Customer Name":"-","Item Count":r.value.item_count,"Total Qty":r.value.total_qty,"Sub Total":r.value.sub_total,Tax:r.value.tax,"Service Charge":r.value.service_charges,"Delivery Charge":r.value.delivery_charges,"Sales Discount":r.value.sales_discount,"Approved Discount":r.value.approved_discounts,"Promo Discount":r.value.promo_discount,"Applied Promos":"-","Promo Type":"-","Total Amount":r.value.total_amount,Date:"-"};m.push(l)}}else if(s.value.type==="purchase"){if(s.value.timeRange==="monthly"?m=h.value.map((l,b)=>({"S.#":b+1,Day:"Day "+new Date(l.purchase_date).getDate(),Purchases:l.purchase_count,Quantity:l.quantity,"Unit Price":l.total_unit_price,"Sub Total":l.sub_total,Suppliers:l.supplier_names,"Total Amount":l.total_amount})):s.value.timeRange==="yearly"?m=h.value.map((l,b)=>({"S.#":b+1,Month:new Date(l.purchase_month+"-01").toLocaleDateString("en-US",{month:"long",year:"numeric"}),Purchases:l.purchase_count,Quantity:l.quantity,"Unit Price":l.total_unit_price,"Sub Total":l.sub_total,Suppliers:l.supplier_names,"Total Amount":l.total_amount})):m=h.value.map((l,b)=>({"S.#":b+1,"Purchase ID":l.purchase_id,"Supplier Name":l.supplier_name,"Product Name":l.product_name,Quantity:l.quantity,"Unit Price":l.unit_price,"Sub Total":l.sub_total,"Expiry Date":l.expiry_date?D(l.expiry_date):"N/A","Purchase Date":D(l.purchase_date),Status:l.status})),r.value){const l=s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?{"S.#":"TOTAL",[s.value.timeRange==="monthly"?"Day":"Month"]:"-",Purchases:"-",Quantity:r.value.quantity,"Unit Price":r.value.total_unit_price,"Sub Total":r.value.sub_total,Suppliers:"-","Total Amount":r.value.total_amount}:{"S.#":"TOTAL","Purchase ID":"-","Supplier Name":"-","Product Name":"-",Quantity:r.value.quantity,"Unit Price":r.value.total_unit_price,"Sub Total":r.value.sub_total,"Expiry Date":"-","Purchase Date":"-",Status:"-"};m.push(l)}}else s.value.type==="comparison"?m=h.value.map((l,b)=>({"S.#":b+1,Metric:l.metric,Sales:l.sales,Purchase:l.purchase,Difference:l.difference})):s.value.type==="stock"?m=h.value.map((l,b)=>({"S.#":b+1,Item:l.name,"Current Stock":l.currentStock,"Min Level":l.minLevel,Status:l.currentStock>l.minLevel?"In Stock":l.currentStock>0?"Low Stock":"Out of Stock"})):s.value.type==="userSales"?m=h.value.map((l,b)=>({"S.#":b+1,"Cashier Name":l.cashierName,Orders:l.orderCount,"Total Sales":l.totalSales,"Avg Sale":l.avgSale})):s.value.type==="category"&&(m=h.value.map((l,b)=>({"S.#":b+1,Category:l.categoryName,"Qty Sold":l.qty,Revenue:l.revenue,"% of Total":l.percentage+"%"})));const t=J.json_to_sheet(m),a=J.book_new();J.book_append_sheet(a,t,s.value.type),Me(a,`${s.value.type}-analytics-${Date.now()}.xlsx`)};return(m,t)=>(u(),d(p,null,[k(c(Te),{title:"Analytics"}),k(xe,null,{default:Re(()=>[e("div",Ve,[e("div",Oe,[t[9]||(t[9]=e("h4",{class:"mb-1"},"Analytics & Reports",-1)),t[10]||(t[10]=e("div",null,null,-1)),k(c(Le),{modelValue:$.value,"onUpdate:modelValue":[t[0]||(t[0]=a=>$.value=a),ne],options:oe,optionLabel:"label",optionValue:"value",placeholder:"Export",class:"export-select"},null,8,["modelValue"])]),e("div",Ie,[e("div",Ne,[e("div",$e,[e("div",Ue,[t[11]||(t[11]=e("label",{class:"form-label fw-semibold text-dark"},[e("i",{class:"fas fa-chart-bar me-2 text-muted"}),x("Analytics Type ")],-1)),k(c(V),{modelValue:s.value.type,"onUpdate:modelValue":t[1]||(t[1]=a=>s.value.type=a),options:ie,optionLabel:"label",optionValue:"value",placeholder:"Select Analytics Type",class:"w-100"},null,8,["modelValue"])]),e("div",Ye,[t[12]||(t[12]=e("label",{class:"form-label fw-semibold text-dark"},[e("i",{class:"fas fa-calendar-alt me-2 text-muted"}),x("Time Range ")],-1)),k(c(V),{modelValue:s.value.timeRange,"onUpdate:modelValue":t[2]||(t[2]=a=>s.value.timeRange=a),options:de,optionLabel:"label",optionValue:"value",placeholder:"Select Time Range",onChange:ye,class:"w-100"},null,8,["modelValue"])]),s.value.timeRange==="daily"?(u(),d("div",Fe,[t[13]||(t[13]=e("label",{class:"form-label fw-semibold text-dark"},[e("i",{class:"fas fa-calendar me-2 text-muted"}),x("Select Date ")],-1)),k(c(E),{modelValue:s.value.selectedDate,"onUpdate:modelValue":t[3]||(t[3]=a=>s.value.selectedDate=a),placeholder:"Choose Date",format:"yyyy-MM-dd","enable-time-picker":!1,"single-calendar":""},null,8,["modelValue"])])):v("",!0),s.value.timeRange==="monthly"?(u(),d("div",qe,[t[14]||(t[14]=e("label",{class:"form-label fw-semibold text-dark"},[e("i",{class:"fas fa-calendar me-2 text-muted"}),x("Select Month ")],-1)),k(c(V),{modelValue:s.value.selectedMonth,"onUpdate:modelValue":t[4]||(t[4]=a=>s.value.selectedMonth=a),options:me.value,optionLabel:"label",optionValue:"value",placeholder:"Choose Month",class:"w-100"},null,8,["modelValue","options"])])):v("",!0),s.value.timeRange==="monthly"?(u(),d("div",Qe,[t[15]||(t[15]=e("label",{class:"form-label fw-semibold text-dark"},[e("i",{class:"fas fa-calendar me-2 text-muted"}),x("Select Year ")],-1)),k(c(V),{modelValue:s.value.selectedYear,"onUpdate:modelValue":t[5]||(t[5]=a=>s.value.selectedYear=a),options:X.value,placeholder:"Choose Year",class:"w-100"},null,8,["modelValue","options"])])):v("",!0),s.value.timeRange==="yearly"?(u(),d("div",Ee,[t[16]||(t[16]=e("label",{class:"form-label fw-semibold text-dark"},[e("i",{class:"fas fa-calendar me-2 text-muted"}),x("Select Year ")],-1)),k(c(V),{modelValue:s.value.selectedYear,"onUpdate:modelValue":t[6]||(t[6]=a=>s.value.selectedYear=a),options:X.value,placeholder:"Choose Year",class:"w-100"},null,8,["modelValue","options"])])):v("",!0),s.value.timeRange==="custom"?(u(),d("div",ze,[t[17]||(t[17]=e("label",{class:"form-label fw-semibold text-dark"},[e("i",{class:"fas fa-calendar me-2 text-muted"}),x("Start Date ")],-1)),k(c(E),{modelValue:s.value.dateFrom,"onUpdate:modelValue":t[7]||(t[7]=a=>s.value.dateFrom=a),placeholder:"Select Start Date",format:"yyyy-MM-dd"},null,8,["modelValue"])])):v("",!0),s.value.timeRange==="custom"?(u(),d("div",Je,[t[18]||(t[18]=e("label",{class:"form-label fw-semibold text-dark"},[e("i",{class:"fas fa-calendar me-2 text-muted"}),x("End Date ")],-1)),k(c(E),{modelValue:s.value.dateTo,"onUpdate:modelValue":t[8]||(t[8]=a=>s.value.dateTo=a),placeholder:"Select End Date",format:"yyyy-MM-dd"},null,8,["modelValue"])])):v("",!0)])])]),e("div",Be,[s.value.type==="sales"?(u(),d(p,{key:0},[e("div",Ge,[e("div",Ke,[e("div",Xe,[e("div",null,[e("h4",He,i(c(n)(_.value.revenue||0)),1),t[19]||(t[19]=e("p",{class:"text-muted mb-0 small"},"Total Revenue",-1))]),t[20]||(t[20]=e("div",{class:"rounded-circle p-3 bg-success-subtle text-success d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-currency-pound fs-4"})],-1))])])]),e("div",We,[e("div",Ze,[e("div",et,[e("div",null,[e("h4",tt,i(c(w)(_.value.ordersCount)),1),t[21]||(t[21]=e("p",{class:"text-muted mb-0 small"},"Total Orders",-1))]),t[22]||(t[22]=e("div",{class:"rounded-circle p-3 bg-primary-subtle text-primary d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-receipt fs-4"})],-1))])])]),e("div",st,[e("div",lt,[e("div",at,[e("div",null,[e("h4",ot,i(c(n)(_.value.aov||0)),1),t[23]||(t[23]=e("p",{class:"text-muted mb-0 small"},"Avg. Order Value",-1))]),t[24]||(t[24]=e("div",{class:"rounded-circle p-3 bg-warning-subtle text-warning d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-graph-up fs-4"})],-1))])])]),e("div",nt,[e("div",it,[e("div",dt,[e("div",null,[e("h4",ut,i(c(w)(_.value.itemsSold)),1),t[25]||(t[25]=e("p",{class:"text-muted mb-0 small"},"Items Sold",-1))]),t[26]||(t[26]=e("div",{class:"rounded-circle p-3 bg-danger-subtle text-danger d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-basket fs-4"})],-1))])])])],64)):v("",!0),s.value.type==="purchase"?(u(),d(p,{key:1},[e("div",rt,[e("div",ct,[e("div",mt,[e("div",null,[e("h4",vt,i(c(n)(_.value.purchaseCost||0)),1),t[27]||(t[27]=e("p",{class:"text-muted mb-0 small"},"Total Purchase Cost",-1))]),t[28]||(t[28]=e("div",{class:"rounded-circle p-3 bg-info-subtle text-info d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-bag-check fs-4"})],-1))])])]),e("div",yt,[e("div",pt,[e("div",ht,[e("div",null,[e("h4",bt,i(c(w)(_.value.purchaseCount)),1),t[29]||(t[29]=e("p",{class:"text-muted mb-0 small"},"Total Purchases",-1))]),t[30]||(t[30]=e("div",{class:"rounded-circle p-3 bg-primary-subtle text-primary d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-box-seam fs-4"})],-1))])])]),e("div",gt,[e("div",_t,[e("div",ft,[e("div",null,[e("h4",xt,i(c(n)(_.value.avgPurchaseValue||0)),1),t[31]||(t[31]=e("p",{class:"text-muted mb-0 small"},"Avg. Purchase Value",-1))]),t[32]||(t[32]=e("div",{class:"rounded-circle p-3 bg-warning-subtle text-warning d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-graph-up fs-4"})],-1))])])]),e("div",wt,[e("div",St,[e("div",kt,[e("div",null,[e("h4",Dt,i(c(w)(_.value.itemsPurchased)),1),t[33]||(t[33]=e("p",{class:"text-muted mb-0 small"},"Items Purchased",-1))]),t[34]||(t[34]=e("div",{class:"rounded-circle p-3 bg-secondary-subtle text-secondary d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-boxes fs-4"})],-1))])])])],64)):v("",!0),s.value.type==="comparison"?(u(),d(p,{key:2},[e("div",Tt,[e("div",Rt,[e("div",Pt,[e("div",null,[e("h4",Ct,i(c(n)(_.value.salesRevenue)),1),t[35]||(t[35]=e("p",{class:"text-muted mb-0 small"},"Sales Revenue",-1))]),t[36]||(t[36]=e("div",{class:"rounded-circle p-3 bg-success-subtle text-success d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-arrow-up-right fs-4"})],-1))])])]),e("div",Lt,[e("div",At,[e("div",jt,[e("div",null,[e("h4",Mt,i(c(n)(_.value.purchaseCost)),1),t[37]||(t[37]=e("p",{class:"text-muted mb-0 small"},"Purchase Cost",-1))]),t[38]||(t[38]=e("div",{class:"rounded-circle p-3 bg-danger-subtle text-danger d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-arrow-down-left fs-4"})],-1))])])]),e("div",Vt,[e("div",Ot,[e("div",It,[e("div",null,[e("h4",Nt,i(c(n)(_.value.grossProfit)),1),t[39]||(t[39]=e("p",{class:"text-muted mb-0 small"},"Gross Profit",-1))]),t[40]||(t[40]=e("div",{class:"rounded-circle p-3 bg-primary-subtle text-primary d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-graph-up fs-4"})],-1))])])]),e("div",$t,[e("div",Ut,[e("div",Yt,[e("div",null,[e("h4",Ft,i(_.value.profitMargin)+"%",1),t[41]||(t[41]=e("p",{class:"text-muted mb-0 small"},"Profit Margin",-1))]),t[42]||(t[42]=e("div",{class:"rounded-circle p-3 bg-info-subtle text-info d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-percent fs-4"})],-1))])])])],64)):v("",!0),s.value.type==="stock"?(u(),d(p,{key:3},[e("div",qt,[e("div",Qt,[e("div",Et,[e("div",null,[e("h4",zt,i(c(w)(_.value.totalStock)),1),t[43]||(t[43]=e("p",{class:"text-muted mb-0 small"},"Total Items in Stock",-1))]),t[44]||(t[44]=e("div",{class:"rounded-circle p-3 bg-info-subtle text-info d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-box-seam fs-4"})],-1))])])]),e("div",Jt,[e("div",Bt,[e("div",Gt,[e("div",null,[e("h4",Kt,i(c(w)(_.value.lowStockItems)),1),t[45]||(t[45]=e("p",{class:"text-muted mb-0 small"},"Low Stock Items",-1))]),t[46]||(t[46]=e("div",{class:"rounded-circle p-3 bg-warning-subtle text-warning d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-exclamation-triangle fs-4"})],-1))])])]),e("div",Xt,[e("div",Ht,[e("div",Wt,[e("div",null,[e("h4",Zt,i(c(w)(_.value.outOfStockItems)),1),t[47]||(t[47]=e("p",{class:"text-muted mb-0 small"},"Out of Stock",-1))]),t[48]||(t[48]=e("div",{class:"rounded-circle p-3 bg-danger-subtle text-danger d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-x-circle fs-4"})],-1))])])]),e("div",es,[e("div",ts,[e("div",ss,[e("div",null,[e("h4",ls,i(c(n)(_.value.stockValue)),1),t[49]||(t[49]=e("p",{class:"text-muted mb-0 small"},"Total Stock Value",-1))]),t[50]||(t[50]=e("div",{class:"rounded-circle p-3 bg-success-subtle text-success d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-cash-coin fs-4"})],-1))])])])],64)):v("",!0),s.value.type==="userSales"?(u(),d(p,{key:4},[e("div",as,[e("div",os,[e("div",ns,[e("div",null,[e("h4",is,i(c(n)(_.value.totalUserSales)),1),t[51]||(t[51]=e("p",{class:"text-muted mb-0 small"},"Total Sales",-1))]),t[52]||(t[52]=e("div",{class:"rounded-circle p-3 bg-success-subtle text-success d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-currency-pound fs-4"})],-1))])])]),e("div",ds,[e("div",us,[e("div",rs,[e("div",null,[e("h4",cs,i(c(n)(_.value.avgCashierSales)),1),t[53]||(t[53]=e("p",{class:"text-muted mb-0 small"},"Avg. per Cashier",-1))]),t[54]||(t[54]=e("div",{class:"rounded-circle p-3 bg-primary-subtle text-primary d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-person-check fs-4"})],-1))])])]),e("div",ms,[e("div",vs,[e("div",ys,[e("div",null,[e("h4",ps,i(c(w)(_.value.activeCashiers)),1),t[55]||(t[55]=e("p",{class:"text-muted mb-0 small"},"Active Cashiers",-1))]),t[56]||(t[56]=e("div",{class:"rounded-circle p-3 bg-info-subtle text-info d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-people fs-4"})],-1))])])]),e("div",hs,[e("div",bs,[e("div",gs,[e("div",null,[e("h4",_s,i(c(n)(_.value.topCashierSales)),1),t[57]||(t[57]=e("p",{class:"text-muted mb-0 small"},"Top Cashier Sales",-1))]),t[58]||(t[58]=e("div",{class:"rounded-circle p-3 bg-warning-subtle text-warning d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-star fs-4"})],-1))])])])],64)):v("",!0),s.value.type==="category"?(u(),d(p,{key:5},[e("div",fs,[e("div",xs,[e("div",ws,[e("div",null,[e("h4",Ss,i(c(w)(_.value.totalCategories)),1),t[59]||(t[59]=e("p",{class:"text-muted mb-0 small"},"Total Categories",-1))]),t[60]||(t[60]=e("div",{class:"rounded-circle p-3 bg-info-subtle text-info d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-tag fs-4"})],-1))])])]),e("div",ks,[e("div",Ds,[e("div",Ts,[e("div",null,[e("h4",Rs,i(c(n)(_.value.categoryRevenue)),1),t[61]||(t[61]=e("p",{class:"text-muted mb-0 small"},"Total Revenue",-1))]),t[62]||(t[62]=e("div",{class:"rounded-circle p-3 bg-success-subtle text-success d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-currency-pound fs-4"})],-1))])])]),e("div",Ps,[e("div",Cs,[e("div",Ls,[e("div",null,[e("h4",As,i(_.value.topCategory),1),t[63]||(t[63]=e("p",{class:"text-muted mb-0 small"},"Top Category",-1))]),t[64]||(t[64]=e("div",{class:"rounded-circle p-3 bg-primary-subtle text-primary d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-trophy fs-4"})],-1))])])]),e("div",js,[e("div",Ms,[e("div",Vs,[e("div",null,[e("h4",Os,i(c(w)(_.value.totalCategorySales)),1),t[65]||(t[65]=e("p",{class:"text-muted mb-0 small"},"Total Items Sold",-1))]),t[66]||(t[66]=e("div",{class:"rounded-circle p-3 bg-warning-subtle text-warning d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-bag-check fs-4"})],-1))])])])],64)):v("",!0)]),T.value?(u(),d("div",Is,i(T.value),1)):v("",!0),e("div",Ns,[e("div",$s,[t[106]||(t[106]=e("div",{class:"d-flex flex-wrap gap-2 justify-content-between align-items-center mb-3"},[e("h6",{class:"fw-semibold mb-0"},"Detailed Data")],-1)),e("div",Us,[e("table",Ys,[e("thead",Fs,[e("tr",null,[t[95]||(t[95]=e("th",{style:{width:"60px"}},"S.#",-1)),s.value.type==="sales"?(u(),d(p,{key:0},[s.value.timeRange==="monthly"?(u(),d("th",qs,"Day")):s.value.timeRange==="yearly"?(u(),d("th",Qs,"Month")):(u(),d("th",Es,"Order ID")),s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?(u(),d("th",zs," Orders")):(u(),d("th",Js,"Customer Name")),t[67]||(t[67]=e("th",{style:{width:"120px"}},"Sub Total",-1)),t[68]||(t[68]=e("th",{style:{width:"120px"}},"Tax",-1)),t[69]||(t[69]=e("th",{style:{width:"120px"}},"Service Charge",-1)),t[70]||(t[70]=e("th",{style:{width:"120px"}},"Delivery Charge",-1)),t[71]||(t[71]=e("th",{style:{width:"120px"}},"Sale Discount",-1)),t[72]||(t[72]=e("th",{style:{width:"120px"}},"Approved Discount",-1)),t[73]||(t[73]=e("th",{style:{width:"140px"}},"Promo Discount",-1)),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("th",Bs,"Applied Promos")):v("",!0),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("th",Gs,"Promo Type")):v("",!0),t[74]||(t[74]=e("th",{style:{width:"140px"}},"Total Amount",-1)),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("th",Ks,"Date")):v("",!0)],64)):v("",!0),s.value.type==="purchase"?(u(),d(p,{key:1},[s.value.timeRange==="monthly"?(u(),d("th",Xs,"Day")):s.value.timeRange==="yearly"?(u(),d("th",Hs,"Month")):(u(),d("th",Ws,"Purchase ID")),s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?(u(),d("th",Zs," Purchases")):(u(),d("th",el,"Supplier Name")),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("th",tl,"Product Name")):v("",!0),t[75]||(t[75]=e("th",{style:{width:"100px"}},"Quantity",-1)),t[76]||(t[76]=e("th",{style:{width:"120px"}},"Unit Price",-1)),t[77]||(t[77]=e("th",{style:{width:"140px"}},"Sub Total",-1)),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("th",sl,"Expiry Date")):v("",!0),s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?(u(),d("th",ll,"Suppliers")):v("",!0),t[78]||(t[78]=e("th",{style:{width:"140px"}},"Total Amount",-1)),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("th",al,"Purchase Date")):v("",!0),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("th",ol,"Status")):v("",!0)],64)):v("",!0),s.value.type==="comparison"?(u(),d(p,{key:2},[t[79]||(t[79]=e("th",null,"Metric",-1)),t[80]||(t[80]=e("th",{style:{width:"140px"}},"Sales",-1)),t[81]||(t[81]=e("th",{style:{width:"140px"}},"Purchase",-1)),t[82]||(t[82]=e("th",{style:{width:"140px"}},"Difference",-1))],64)):v("",!0),s.value.type==="stock"?(u(),d(p,{key:3},[t[83]||(t[83]=e("th",null,"Item",-1)),t[84]||(t[84]=e("th",{style:{width:"100px"}},"Stock",-1)),t[85]||(t[85]=e("th",{style:{width:"100px"}},"Min Level",-1)),t[86]||(t[86]=e("th",{style:{width:"120px"}},"Status",-1))],64)):v("",!0),s.value.type==="userSales"?(u(),d(p,{key:4},[t[87]||(t[87]=e("th",null,"Cashier Name",-1)),t[88]||(t[88]=e("th",{style:{width:"120px"}},"Orders",-1)),t[89]||(t[89]=e("th",{style:{width:"140px"}},"Total Sales",-1)),t[90]||(t[90]=e("th",{style:{width:"120px"}},"Avg Sale",-1))],64)):v("",!0),s.value.type==="category"?(u(),d(p,{key:5},[t[91]||(t[91]=e("th",null,"Category",-1)),t[92]||(t[92]=e("th",{style:{width:"120px"}},"Qty Sold",-1)),t[93]||(t[93]=e("th",{style:{width:"140px"}},"Revenue",-1)),t[94]||(t[94]=e("th",{style:{width:"100px"}},"% of Total",-1))],64)):v("",!0)])]),e("tbody",null,[(u(!0),d(p,null,M(h.value,(a,l)=>(u(),d("tr",{key:l},[e("td",null,i(l+1),1),s.value.type==="sales"?(u(),d(p,{key:0},[e("td",nl,[s.value.timeRange==="monthly"?(u(),d(p,{key:0},[x(i(new Date(a.order_date).toLocaleString("en-US",{month:"short"})+" "+String(new Date(a.order_date).getDate()).padStart(2,"0")),1)],64)):s.value.timeRange==="yearly"?(u(),d(p,{key:1},[x(i(new Date(a.order_month+"-01").toLocaleDateString("en-US",{month:"long",year:"numeric"})),1)],64)):(u(),d(p,{key:2},[x(i(a.id),1)],64))]),e("td",null,[s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?(u(),d(p,{key:0},[x(i(a.order_count)+" Orders ",1)],64)):(u(),d(p,{key:1},[x(i(a.customer_name),1)],64))]),e("td",null,i(c(n)(a.sub_total)),1),e("td",null,i(c(n)(a.tax)),1),e("td",null,i(c(n)(a.service_charges)),1),e("td",null,i(c(n)(a.delivery_charges)),1),e("td",null,i(c(n)(a.sales_discount)),1),e("td",null,i(c(n)(a.approved_discounts)),1),e("td",null,i(c(n)(a.promo_discount)),1),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("td",il,i(a.promo_names),1)):v("",!0),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("td",dl,i(a.promo_types),1)):v("",!0),e("td",ul,i(c(n)(a.total_amount)),1),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("td",rl,i(c(D)(a.order_date)),1)):v("",!0)],64)):v("",!0),s.value.type==="purchase"?(u(),d(p,{key:1},[e("td",cl,[s.value.timeRange==="monthly"?(u(),d(p,{key:0},[x(i(new Date(a.purchase_date).toLocaleString("en-US",{month:"short"})+" "+String(new Date(a.purchase_date).getDate()).padStart(2,"0")),1)],64)):s.value.timeRange==="yearly"?(u(),d(p,{key:1},[x(i(new Date(a.purchase_month+"-01").toLocaleDateString("en-US",{month:"long",year:"numeric"})),1)],64)):(u(),d(p,{key:2},[x(i(a.purchase_id),1)],64))]),e("td",null,[s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?(u(),d(p,{key:0},[x(i(a.purchase_count)+" Purchases ",1)],64)):(u(),d(p,{key:1},[x(i(a.supplier_name),1)],64))]),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("td",ml,i(a.product_name),1)):v("",!0),e("td",null,i(c(w)(a.quantity)),1),e("td",null,i(c(n)(a.total_unit_price)),1),e("td",null,i(c(n)(a.sub_total)),1),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("td",vl,[a.expiry_date?(u(),d("span",yl,i(c(D)(a.expiry_date)),1)):(u(),d("span",pl,"N/A"))])):v("",!0),s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?(u(),d("td",hl,i(a.supplier_names),1)):v("",!0),e("td",bl,i(c(n)(a.total_amount)),1),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("td",gl,i(c(D)(a.purchase_date)),1)):v("",!0),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("td",_l,[a.status==="completed"?(u(),d("span",fl," Completed ")):a.status==="pending"?(u(),d("span",xl," Pending ")):(u(),d("span",wl,i(a.status),1))])):v("",!0)],64)):v("",!0),s.value.type==="comparison"?(u(),d(p,{key:2},[e("td",Sl,i(a.metric),1),e("td",null,i(c(n)(a.sales)),1),e("td",null,i(c(n)(a.purchase)),1),e("td",{style:z({color:a.difference>0?"#10b981":"#ef4444"}),class:"fw-semibold"},i(c(n)(a.difference)),5)],64)):v("",!0),s.value.type==="stock"?(u(),d(p,{key:3},[e("td",kl,i(a.name),1),e("td",null,i(c(w)(a.currentStock)),1),e("td",null,i(c(w)(a.minLevel)),1),e("td",null,[a.currentStock>a.minLevel?(u(),d("span",Dl," In Stock ")):a.currentStock>0?(u(),d("span",Tl," Low Stock ")):(u(),d("span",Rl," Out of Stock "))])],64)):v("",!0),s.value.type==="userSales"?(u(),d(p,{key:4},[e("td",Pl,i(a.cashierName),1),e("td",null,i(c(w)(a.orderCount)),1),e("td",null,i(c(n)(a.totalSales)),1),e("td",null,i(c(n)(a.avgSale)),1)],64)):v("",!0),s.value.type==="category"?(u(),d(p,{key:5},[e("td",Cl,i(a.categoryName),1),e("td",null,i(c(w)(a.qty)),1),e("td",null,i(c(n)(a.revenue)),1),e("td",null,i(a.percentage)+"%",1)],64)):v("",!0)]))),128)),s.value.type==="sales"&&h.value.length>0?(u(),d("tr",Ll,[t[96]||(t[96]=e("td",{colspan:"0",class:"text-end"},"TOTALS",-1)),t[97]||(t[97]=e("td",{colspan:"0"},"-",-1)),t[98]||(t[98]=e("td",{colspan:"0"},"-",-1)),e("td",null,i(c(n)(r.value.sub_total)),1),e("td",null,i(c(n)(r.value.tax)),1),e("td",null,i(c(n)(r.value.service_charges)),1),e("td",null,i(c(n)(r.value.delivery_charges)),1),e("td",null,i(c(n)(r.value.sales_discount+r.value.approved_discounts)),1),e("td",null,i(c(n)(r.value.approved_discounts)),1),e("td",null,i(c(n)(r.value.promo_discount)),1),e("td",Al,i(c(n)(r.value.total_amount)),1),t[99]||(t[99]=e("td",null,null,-1))])):v("",!0),s.value.type==="purchase"&&h.value.length>0?(u(),d("tr",jl,[t[100]||(t[100]=e("td",{colspan:"0"},"TOTALS",-1)),t[101]||(t[101]=e("td",null,"-",-1)),t[102]||(t[102]=e("td",null,"-",-1)),e("td",null,i(c(w)(r.value.quantity)),1),e("td",null,i(c(n)(r.value.total_unit_price)),1),e("td",null,i(c(n)(r.value.sub_total)),1),t[103]||(t[103]=e("td",{colspan:"3"},null,-1))])):v("",!0),!R.value&&h.value.length===0?(u(),d("tr",Ml,[...t[104]||(t[104]=[e("td",{colspan:16,class:"text-center text-muted py-4"}," No data available for this period. ",-1)])])):v("",!0),R.value?(u(),d("tr",Vl,[...t[105]||(t[105]=[e("td",{colspan:5,class:"text-center text-muted py-4"},[e("i",{class:"fas fa-spinner fa-spin me-2"}),x("Loadingâ€¦ ")],-1)])])):v("",!0)])])])])]),e("div",Ol,[e("div",Il,[e("div",Nl,[e("div",$l,[e("h6",Ul,i(H.value),1),e("div",Yl,[(u(),d("svg",Fl,[t[108]||(t[108]=e("line",{x1:"50",y1:"40",x2:"50",y2:"230",stroke:"#4b5563","stroke-width":"1"},null,-1)),t[109]||(t[109]=e("line",{x1:"50",y1:"230",x2:"820",y2:"230",stroke:"#4b5563","stroke-width":"1"},null,-1)),(u(),d(p,null,M(5,a=>e("g",{key:"grid"+a},[e("line",{x1:50,x2:820,y1:230-a*38,y2:230-a*38,stroke:"#374151","stroke-width":"0.5",opacity:"0.3"},null,8,ql)])),64)),(u(!0),d(p,null,M(C.value.yLabels,(a,l)=>(u(),d("text",{key:"ylabel"+l,x:a.x,y:a.y+5,"text-anchor":"end",fill:"#9ca3af","font-size":"11"},i(a.text),9,Ql))),128)),(u(!0),d(p,null,M(C.value.xLabels,(a,l)=>(u(),d("text",{key:"xlabel"+l,x:a.x,y:a.y,"text-anchor":"middle",fill:"#9ca3af","font-size":"11"},i(a.text),9,El))),128)),C.value.salesPath?(u(),d("path",{key:0,d:C.value.salesPath,fill:"none",stroke:"#10b981","stroke-width":"3","stroke-linecap":"round"},null,8,zl)):v("",!0),s.value.type==="comparison"&&C.value.purchasePath?(u(),d("path",{key:1,d:C.value.purchasePath,fill:"none",stroke:"#ef4444","stroke-width":"3","stroke-linecap":"round"},null,8,Jl)):v("",!0),s.value.type==="comparison"?(u(),d("g",Bl,[...t[107]||(t[107]=[e("circle",{cx:"750",cy:"20",r:"5",fill:"#10b981"},null,-1),e("text",{x:"760",y:"25",fill:"#9ca3af","font-size":"12"},"Sales",-1),e("circle",{cx:"820",cy:"20",r:"5",fill:"#ef4444"},null,-1),e("text",{x:"830",y:"25",fill:"#9ca3af","font-size":"12"},"Purchase",-1)])])):v("",!0),Y.value.length?v("",!0):(u(),d("text",Gl," No data available "))]))])])])]),e("div",Kl,[e("div",Xl,[e("div",Hl,[t[110]||(t[110]=e("h6",{class:"fw-semibold mb-3"},"Distribution",-1)),(u(!0),d(p,null,M(B.value,a=>(u(),d("div",{key:a.label,class:"stack"},[e("div",Wl,[e("span",null,i(a.label),1),e("span",Zl,i(a.value)+" ("+i(a.percentage)+"%)",1)]),e("div",ea,[e("div",{class:"progress-bar",style:z({width:a.percentage+"%",backgroundColor:a.color})},null,4)])]))),128))])]),e("div",ta,[e("div",sa,[t[115]||(t[115]=e("h6",{class:"fw-semibold mb-3"},"Summary Info",-1)),e("div",la,[e("div",aa,[t[111]||(t[111]=e("span",null,"Period",-1)),e("span",oa,i(c(D)(W.value)),1)]),e("div",na,[t[112]||(t[112]=e("span",null,"Data Points",-1)),e("span",ia,i(K.value),1)]),e("div",da,[t[113]||(t[113]=e("span",null,"Last Updated",-1)),e("span",ua,i(G.value),1)]),e("div",ra,[t[114]||(t[114]=e("span",null,"Status",-1)),e("span",{class:"stack-val",style:z({color:R.value?"#f59e0b":"#10b981"})},i(R.value?"Loading...":"Active"),5)])])])])])])])]),_:1})],64))}},Ta=we(ca,[["__scopeId","data-v-a74fc22e"]]);export{Ta as default};
