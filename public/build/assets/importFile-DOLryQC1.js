import{r as k,u as I}from"./xlsx-Dn9bPu55.js";import{_ as S,r as C,f as j,b as F,e as t,t as z,B as m,F as B,q as p}from"./app-DMbHFmC5.js";const E=["data-bs-target"],D={__name:"importFile",props:{label:{type:String,default:"Import"},sampleHeaders:{type:Array,default:()=>[]},sampleData:{type:Array,default:()=>[]}},emits:["on-import"],setup(c,{emit:u}){const o=c,v=u,n=C(null),r=`modalImport-${o.label.replace(/\s+/g,"-")}`,b=()=>{n.value.click()},f=async s=>{const e=s.target.files[0];if(e)try{const l=new FileReader;l.onload=a=>{const d=a.target.result,i=k(d,{type:"binary"}),w=i.SheetNames[0],h=i.Sheets[w],x=I.sheet_to_json(h,{header:1});v("on-import",x),n.value.value="",g()},l.readAsBinaryString(e)}catch(l){p.error("Import failed: "+l.message)}},g=()=>{const s=document.getElementById(r);(window.bootstrap?.Modal.getInstance(s)||new window.bootstrap.Modal(s)).hide()},y=()=>{if(!o.sampleHeaders.length){p.warn("No sample format defined for this module.");return}const e=[o.sampleHeaders,...o.sampleData].map(d=>d.join(",")).join(`
`),l=new Blob([e],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a");a.href=URL.createObjectURL(l),a.download=`${o.label}_Sample.csv`,document.body.appendChild(a),a.click(),document.body.removeChild(a)};return(s,e)=>(F(),j(B,null,[t("button",{class:"btn btn-primary py-2 btn-sm rounded-pill px-4","data-bs-toggle":"modal","data-bs-target":`#${r}`},z(c.label),9,E),t("div",{class:"modal fade",id:r,tabindex:"-1","aria-hidden":"true"},[t("div",{class:"modal-dialog modal-dialog-centered"},[t("div",{class:"modal-content border-0 shadow-lg",style:{"border-radius":"20px",overflow:"hidden"}},[e[4]||(e[4]=m('<div class="modal-header" data-v-0657c8c8><h5 class="modal-title fw-semibold" data-v-0657c8c8> Import </h5><button class="absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110" data-bs-dismiss="modal" aria-label="Close" title="Close" data-v-0657c8c8><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" data-v-0657c8c8><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" data-v-0657c8c8></path></svg></button></div>',1)),t("div",{class:"modal-body",style:{padding:"2rem 1.5rem"}},[e[2]||(e[2]=m('<div class="d-flex align-items-start mb-4" data-v-0657c8c8><div class="flex-shrink-0 me-3" data-v-0657c8c8><div class="rounded-circle d-flex align-items-center justify-content-center" style="width:48px;height:48px;background:linear-gradient(135deg, #667eea 0%, #764ba2 100%);" data-v-0657c8c8><span style="font-size:1.5rem;" data-v-0657c8c8>üìã</span></div></div><div class="flex-grow-1" data-v-0657c8c8><h6 class="fw-bold mb-3" style="color:#2d3748;font-size:1.1rem;" data-v-0657c8c8>Import Guidelines</h6><ul class="list-unstyled mb-0" data-v-0657c8c8><li class="mb-2 d-flex align-items-start" data-v-0657c8c8><span class="text-success me-2" data-v-0657c8c8>‚úì</span><span style="color:#4a5568;font-size:0.925rem;" data-v-0657c8c8>File must be in <strong data-v-0657c8c8>CSV</strong> or <strong data-v-0657c8c8>Excel</strong> format</span></li><li class="mb-2 d-flex align-items-start" data-v-0657c8c8><span class="text-success me-2" data-v-0657c8c8>‚úì</span><span style="color:#4a5568;font-size:0.925rem;" data-v-0657c8c8>Ensure column order matches the required structure</span></li><li class="mb-0 d-flex align-items-start" data-v-0657c8c8><span class="text-success me-2" data-v-0657c8c8>‚úì</span><span style="color:#4a5568;font-size:0.925rem;" data-v-0657c8c8>Empty rows will be ignored automatically</span></li></ul></div></div>',1)),t("div",{class:"row g-3"},[t("div",{class:"col-6"},[t("button",{class:"btn btn-primary w-100 rounded-pill d-flex align-items-center justify-content-center gap-2 py-2",onClick:y},[...e[0]||(e[0]=[t("i",{class:"bi bi-download",style:{"font-size":"1rem"}},null,-1),t("span",null,"Download Sample",-1)])])]),t("div",{class:"col-6"},[t("button",{class:"btn btn-primary rounded-pill w-100 d-flex align-items-center justify-content-center gap-2 py-2 text-white",onClick:b},[...e[1]||(e[1]=[t("span",{style:{"font-size":"1rem"}},"üìÅ",-1),t("span",null,"Import File",-1)])])])]),e[3]||(e[3]=t("div",{class:"mt-4 pt-3 border-top"},[t("p",{class:"text-center mb-0 small",style:{color:"#a0aec0"}},[t("span",{style:{"font-size":"1rem","vertical-align":"middle"}},"üí°"),t("span",{class:"ms-1"},"Need help? Check our documentation for detailed instructions")])],-1))])])])]),t("input",{type:"file",ref_key:"fileInput",ref:n,accept:".csv, .xlsx, .xls",class:"d-none",onChange:f},null,544)],64))}},_=S(D,[["__scopeId","data-v-0657c8c8"]]);export{_ as I};
