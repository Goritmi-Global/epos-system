import{_ as xe,r as m,c as I,o as te,n as ke,I as we,E as Se,a as se,b as l,w as Ce,d as C,e as t,u as h,h as Fe,f as n,m as b,l as $,k as O,v as A,F as ae,g as oe,t as d,i as Q,p as F,q as g}from"./app-CtUM9wQF.js";import{_ as De}from"./Master-DMu0fF8n.js";import{E as le,a as ne,u as V,w as Ne}from"./xlsx-CsAMcugo.js";import Pe from"./PurchaseComponent-Cnyw2-ct.js";import Ie from"./OrderComponent-Do7K-AF1.js";import{u as $e}from"./useFormatters-CzJlWf-b.js";import Oe from"./BulkOrderComponent-BAgGs0Tz.js";import{E as Ae}from"./eye-5WksUePH.js";import{T as Ve}from"./trash-2-BwViwtvD.js";import"./index-Yi4DTr5Y.js";import"./createLucideIcon-XTnGKXOB.js";import"./index-BcwoPGio.js";import"./index-DlKEzyjw.js";import"./sun-B2mq1kk5.js";import"./index-BYXGeiV9.js";import"./index-DwQqJpOo.js";import"./index-Bu8ldZuv.js";const Te={class:"page-wrapper"},Ee={class:"card border-0 shadow-lg rounded-4"},Ue={class:"card-body p-4"},ze={class:"d-flex align-items-center justify-content-between mb-3"},Me={class:"d-flex align-items-center gap-2"},je={class:"position-relative"},Be={key:0,class:"help-popover shadow rounded-4 p-3"},Re={class:"d-flex gap-2 align-items-center"},qe={class:"search-wrap me-1"},Le={key:1,class:"form-control search-input",placeholder:"Search",disabled:"",type:"text"},Ge={class:"dropdown"},Ye={class:"dropdown-menu dropdown-menu-end shadow rounded-4 py-2"},He={class:"table-responsive"},We={class:"table table-striped"},Qe={key:0},Ke={class:"text-nowrap"},Xe={class:"small text-muted"},Je={class:"text-start"},Ze={class:"text-end"},et={class:"d-flex gap-2 justify-content-end"},tt=["onClick"],st=["onClick","disabled"],at={key:2},ot={class:"modal fade",id:"orderDetailsModal",tabindex:"-1","aria-hidden":"true"},lt={class:"modal-dialog modal-xl modal-dialog-centered"},nt={class:"modal-content rounded-4 shadow-lg border-0"},rt={class:"modal-header align-items-center"},dt={class:"d-flex align-items-center gap-2"},it={class:"d-flex flex-column"},ut={class:"modal-title mb-0"},ct={class:"text-muted"},pt={key:0,class:"modal-body p-4 bg-light"},mt={class:"row g-3"},vt={class:"col-md-6"},gt={class:"fw-semibold"},ht={class:"col-md-6"},yt={class:"col-md-6"},bt={class:"fw-semibold"},_t={class:"fw-semibold mb-3"},ft={class:"table-responsive"},xt={class:"table table-bordered align-middle"},kt={class:"table-light"},wt={key:0},St={key:0},Ct=["onUpdate:modelValue"],Ft={key:0},Dt=["onUpdate:modelValue","onInput"],Nt={key:0},Pt=["onUpdate:modelValue","onInput"],It={key:0},$t=["onUpdate:modelValue"],Ot={key:0},At={key:2,class:"text-danger"},Vt={key:0},Tt=["onClick"],Et={key:0},Ut=["colspan"],zt={class:"footer"},Mt={class:"fw-bold"},jt={key:0,class:"alert alert-info mt-3"},Bt={key:1,class:"modal-footer"},Rt=["disabled"],qt={key:0},Lt={key:1},Gt={__name:"Index",setup(Yt){const{formatCurrencySymbol:w,dateFmt:M}=$e(),j=(a,e="GBP")=>new Intl.NumberFormat("en-GB",{style:"currency",currency:e}).format(Number(a||0)),T=m(""),K=m(Date.now()),B=`search-${Math.random().toString(36).substr(2,9)}`,X=m(!1),D=a=>new Date(a).toLocaleString("en-GB",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0}),R=a=>Math.round((Number(a)||0)*100)/100,q=m(!1),E=m([]),re=async()=>{const a=await F.get("/api/suppliers/pluck");E.value=a.data},L=m([]),G=m(""),de=async()=>{try{const a=await F.get("/inventory/api-inventories");L.value=a.data.data}catch(a){console.error("Error fetching inventory:",a)}},U=I(()=>{const a=G.value.trim().toLowerCase();return a?L.value.filter(e=>[e.name,e.category??"",e.subcategory??"",String(e.stock??"")].join(" ").toLowerCase().includes(a)):L.value});console.log("p_filteredInv",U);const J=I(()=>{const a=G.value.trim().toLowerCase();return a?P.value.filter(e=>[e.supplier??"",e.status??"",String(e.total??""),D(e.purchasedAt)??""].join(" ").toLowerCase().includes(a)):P.value});te(async()=>{T.value="",K.value=Date.now(),await ke(),setTimeout(()=>{X.value=!0;const a=document.getElementById(B);a&&(a.value="",T.value="")},100),de(),re()});const N=m(!1),_=m({data:[],current_page:1,last_page:1,per_page:20,total:0,links:[]}),P=I(()=>_.value.data||[]),Y=I(()=>({current_page:_.value.current_page,last_page:_.value.last_page,per_page:_.value.per_page,total:_.value.total}));I(()=>_.value.links||[]);const H=m(20);function ie(a){const e=a?.data??a;if(e&&e.data&&Array.isArray(e.data)&&typeof e.current_page<"u")return{data:e.data,current_page:Number(e.current_page)||1,last_page:Number(e.last_page)||1,per_page:Number(e.per_page)||20,total:Number(e.total)||(e.data?.length??0),links:Array.isArray(e.links)?e.links:[]};if(a&&a.data&&Array.isArray(a.data)&&typeof a.current_page<"u")return{data:a.data,current_page:Number(a.current_page)||1,last_page:Number(a.last_page)||1,per_page:Number(a.per_page)||20,total:Number(a.total)||(a.data?.length??0),links:Array.isArray(a.links)?a.links:[]};if(a&&Array.isArray(a.data)&&a.meta){const o=a.meta;return{data:a.data,current_page:Number(o.current_page)||1,last_page:Number(o.last_page)||1,per_page:Number(o.per_page)||20,total:Number(o.total)||(a.data?.length??0),links:Array.isArray(o.links)?o.links:[]}}return{data:Array.isArray(e)?e:[],current_page:1,last_page:1,per_page:H.value,total:Array.isArray(e)?e.length:0,links:[]}}const S=async(a=1)=>{N.value=!0;try{const e=await F.get("/api/purchase-orders/fetch-orders",{params:{page:a,per_page:H.value}}),o=e?.data?.data??e?.data??e,s=ie(o);_.value=s}catch(e){console.error(e),g.error("Failed to fetch orders"),_.value={data:[],current_page:1,last_page:1,per_page:H.value,total:0,links:[]}}finally{N.value=!1}},v=m(null),f=m([]),u=m(!1),x=m({}),ue=()=>{x.value={}},z=m(!1);m(!1);async function ce(a){try{const e=await F.get(`/purchase-orders/${a.id}`);v.value=e.data,console.log("selectedOrder.value",v.value),a.status==="pending"?(u.value=!0,f.value=v.value.items.map(s=>({id:s.id,product_id:s.product_id,name:s.product?.name||"Unknown",quantity:s.quantity,unit_price:s.unit_price,expiry:s.expiry||"",sub_total:s.sub_total}))):u.value=!1,new bootstrap.Modal(document.getElementById("orderDetailsModal")).show()}catch(e){console.error(e),g.error("Failed to load order details")}}async function pe(){if(v.value){z.value=!0;try{const a={status:"completed",items:f.value.map(o=>({purchase_id:v.value.id,product_id:o.product_id,qty:o.quantity,unit_price:o.unit_price,expiry:o.expiry||null}))};await F.put(`/purchase-orders/${v.value.id}`,a),bootstrap.Modal.getInstance(document.getElementById("orderDetailsModal"))?.hide(),x.value={},await S(),await S(Y.value.current_page),g.success("Order updated successfully and stock entries created!")}catch(a){if(a.response?.status===422&&a.response?.data?.errors){x.value=a.response.data.errors;const e=Object.values(x.value).flat().join(`
`);g.error(e)}else console.error("Error updating order:",a),g.error("Failed to update order")}finally{z.value=!1}}}function Z(a){const e=parseFloat(a.quantity)||0,o=parseFloat(a.unit_price)||0;a.sub_total=(e*o).toFixed(2)}const W=a=>{switch(a){case"pdf":ve(P.value);break;case"excel":ge(P.value);break;case"csv":me(P.value);break;default:g.error("Invalid export type")}},me=a=>{try{const e=["S.No","Supplier Name","Purchase Date","Status","Total Value"],o=a.map((p,k)=>[k+1,`"${p.supplier||""}"`,`"${D(p.purchasedAt)||""}"`,`"${p.status||""}"`,`"${R(p.total)||0}"`]),s=[e.join(","),...o.map(p=>p.join(","))].join(`
`),i=new Blob([s],{type:"text/csv;charset=utf-8;"}),r=URL.createObjectURL(i),c=document.createElement("a");c.href=r,c.download=`purchase_orders_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(c),c.click(),document.body.removeChild(c),g.success("CSV downloaded successfully",{autoClose:2500})}catch(e){console.error("CSV generation error:",e),g.error(`CSV generation failed: ${e.message}`)}},ve=a=>{try{const e=new le("p","mm","a4");e.setFontSize(18),e.setFont("helvetica","bold"),e.text("Purchase Orders Report",60,20),e.setFontSize(10),e.setFont("helvetica","normal");const o=new Date().toLocaleString();e.text(`Generated on: ${o}`,14,28),e.text(`Total Records: ${a.length}`,14,33);const s=["S.No","Supplier Name","Purchase Date","Status","Total Value"],i=a.map((c,p)=>[p+1,c.supplier||"",D(c.purchasedAt)||"",c.status||"",R(c.total)||0]);ne(e,{head:[s],body:i,startY:40,styles:{fontSize:9,cellPadding:2,lineWidth:.1,halign:"left"},headStyles:{fillColor:[41,128,185],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[240,240,240]},margin:{left:14,right:14},didDrawPage:c=>{const p=e.internal.getNumberOfPages(),k=e.internal.pageSize.height;e.setFontSize(8),e.text(`Page ${c.pageNumber} of ${p}`,c.settings.margin.left,k-10)}});const r=`purchase_orders_${new Date().toISOString().split("T")[0]}.pdf`;e.save(r),g.success("PDF downloaded successfully",{autoClose:2500})}catch(e){console.error("PDF generation error:",e),g.error(`PDF generation failed: ${e.message}`)}},ge=a=>{try{const e=a.map((p,k)=>({"S.No":k+1,"Supplier Name":p.supplier||"","Purchase Date":D(p.purchasedAt)||"",Status:p.status||"","Total Value":R(p.total)||0})),o=V.book_new(),s=V.json_to_sheet(e);s["!cols"]=[{wch:8},{wch:25},{wch:25},{wch:15},{wch:15}],V.book_append_sheet(o,s,"Purchase Orders");const i=[{Info:"Generated On",Value:new Date().toLocaleString()},{Info:"Total Records",Value:a.length},{Info:"Exported By",Value:"Purchase Order System"}],r=V.json_to_sheet(i);V.book_append_sheet(o,r,"Report Info");const c=`purchase_orders_${new Date().toISOString().split("T")[0]}.xlsx`;Ne(o,c),g.success("Excel file downloaded successfully",{autoClose:2500})}catch(e){console.error("Excel generation error:",e),g.error(`Excel generation failed: ${e.message}`)}};te(()=>{S(1)}),we(()=>window.feather?.replace?.());const he=async a=>{try{const o=(await F.get(`/purchase-orders/${a.id}`)).data,s=new le("p","mm","a4");s.setFontSize(24),s.setFont("helvetica","bold"),s.setTextColor(41,128,185),s.text("INVOICE",14,20),s.setFontSize(10),s.setFont("helvetica","normal"),s.setTextColor(0,0,0);const i=140;s.text(`Invoice #: ${o.id}`,i,20),s.text(`Date: ${D(o.purchasedAt||o.purchase_date)}`,i,26),s.text(`Status: ${o.status?.toUpperCase()||"PENDING"}`,i,32),s.setFontSize(12),s.setFont("helvetica","bold"),s.text("FROM (Your Company):",14,45),s.setFontSize(10),s.setFont("helvetica","normal"),s.text("Your Company Name",14,52),s.text("123 Business Street",14,58),s.text("City, Country",14,64),s.text("contact@company.com",14,70),s.setFontSize(12),s.setFont("helvetica","bold"),s.text("TO (Supplier):",100,45),s.setFontSize(10),s.setFont("helvetica","normal");const r=o.supplier?.name||o.supplier||"N/A";s.text(r,100,52),s.text("Supplier Details",100,58),s.text("Contact: "+(o.supplier?.contact||"N/A"),100,64),s.text("Email: "+(o.supplier?.email||"N/A"),100,70),s.setDrawColor(41,128,185),s.setLineWidth(.5),s.line(14,78,196,78);const c=["Item","Quantity","Unit Price","Subtotal"],p=o.items.map(y=>[y.product?.name||y.name||"Unknown Product",y.quantity,j(y.unit_price),j(y.sub_total||y.quantity*y.unit_price)]);ne(s,{head:[c],body:p,startY:85,styles:{fontSize:10,cellPadding:3,lineWidth:.1,halign:"left"},headStyles:{fillColor:[41,128,185],textColor:255,fontStyle:"bold",halign:"center"},alternateRowStyles:{fillColor:[245,245,245]},margin:{left:14,right:14},columnStyles:{1:{halign:"center"},2:{halign:"right"},3:{halign:"right"}}});const k=s.lastAutoTable.finalY||150;s.setFontSize(11),s.setFont("helvetica","bold");const ye=o.items.reduce((y,fe)=>y+(parseFloat(fe.sub_total)||0),0);s.text(`Total Amount: ${j(ye)}`,140,k+15),s.setFontSize(9),s.setFont("helvetica","normal"),s.setTextColor(128,128,128);const ee=s.internal.pageSize.height,be=s.internal.getNumberOfPages();s.text(`Page 1 of ${be}`,14,ee-10),s.text("Thank you for your business!",100,ee-10);const _e=`invoice_${o.id}_${new Date().toISOString().split("T")[0]}.pdf`;s.save(_e),g.success("Invoice downloaded successfully",{autoClose:2500})}catch(e){console.error("Invoice generation error:",e),g.error(`Invoice generation failed: ${e.message}`)}};return(a,e)=>{const o=Se("VueDatePicker");return l(),se(De,null,{default:Ce(()=>[C(h(Fe),{title:"Purchase Order"}),t("div",Te,[t("div",Ee,[t("div",Ue,[t("div",ze,[t("div",Me,[e[9]||(e[9]=t("h3",{class:"fw-semibold mb-0"},"Purchase Order",-1)),t("div",je,[t("button",{class:"btn btn-link p-0 ms-2",onClick:e[0]||(e[0]=s=>q.value=!q.value),title:"Help"},[...e[7]||(e[7]=[t("i",{class:"bi bi-question-circle fs-5"},null,-1)])]),q.value?(l(),n("div",Be,[...e[8]||(e[8]=[t("p",{class:"mb-2"}," This screen allows you to view, manage, and update all purchase orders. ",-1),t("p",{class:"mb-2"},[t("strong",null,"Add Purchase"),$(": create a purchase and stock-in immediately. ")],-1),t("p",{class:"mb-0"},[t("strong",null,"Add Order"),$(": create a purchase order for later delivery. ")],-1)])])):b("",!0)])]),t("div",Re,[t("div",qe,[e[10]||(e[10]=t("i",{class:"bi bi-search"},null,-1)),e[11]||(e[11]=t("input",{type:"email",name:"email",autocomplete:"email",style:{position:"absolute",left:"-9999px",width:"1px",height:"1px"},tabindex:"-1","aria-hidden":"true"},null,-1)),X.value?O((l(),n("input",{id:B,"onUpdate:modelValue":e[1]||(e[1]=s=>T.value=s),key:K.value,class:"form-control search-input",placeholder:"Search",type:"search",autocomplete:"new-password",name:B,role:"presentation",onFocus:e[2]||(e[2]=(...s)=>a.handleFocus&&a.handleFocus(...s))},null,32)),[[A,T.value]]):(l(),n("input",Le))]),e[13]||(e[13]=t("button",{class:"btn btn-primary btn-sm py-2 rounded-pill px-4","data-bs-toggle":"modal","data-bs-target":"#bulkOrderModal"}," Bulk Purchase ",-1)),C(Oe,{suppliers:E.value,items:U.value,onRefreshData:S},null,8,["suppliers","items"]),C(Pe,{suppliers:E.value,items:U.value,onRefreshData:S,"onUpdate:search":e[3]||(e[3]=s=>G.value=s)},null,8,["suppliers","items"]),e[14]||(e[14]=t("button",{class:"btn btn-primary btn-sm py-2 rounded-pill px-4 py-2","data-bs-toggle":"modal","data-bs-target":"#addOrderModal"}," Order ",-1)),C(Ie,{suppliers:E.value,items:U.value,onRefreshData:S},null,8,["suppliers","items"]),t("div",Ge,[e[12]||(e[12]=t("button",{class:"btn btn-outline-secondary btn-sm rounded-pill py-2 px-4 dropdown-toggle","data-bs-toggle":"dropdown"}," Export ",-1)),t("ul",Ye,[t("li",null,[t("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:e[4]||(e[4]=s=>W("pdf"))},"Export as PDF")]),t("li",null,[t("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:e[5]||(e[5]=s=>W("excel"))},"Export as Excel")]),t("li",null,[t("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:e[6]||(e[6]=s=>W("csv"))}," Export as CSV ")])])])])]),t("div",He,[t("table",We,[e[18]||(e[18]=t("thead",{class:"small text-muted"},[t("tr",null,[t("th",{style:{width:"80px"}},"S. #"),t("th",null,"Supplier Name"),t("th",null,"Purchase date"),t("th",{class:"text-start"},"Status"),t("th",null,"Total value"),t("th",{class:"text-end"},"Action")])],-1)),t("tbody",null,[N.value?(l(),n("tr",Qe,[...e[15]||(e[15]=[t("td",{colspan:"6",class:"text-center text-muted py-4"}," Loading… ",-1)])])):(l(!0),n(ae,{key:1},oe(J.value,(s,i)=>(l(),n("tr",{key:s.id},[t("td",null,d((Y.value.current_page-1)*Y.value.per_page+(i+1)),1),t("td",null,d(s.supplier),1),t("td",Ke,[$(d(s.purchasedAt)+", "+d(new Date(s.create_at).toLocaleTimeString([],{hour12:!0}))+" ",1),t("div",Xe,d(h(M)(s.purchasedAt).split(",")[1]?.trim()),1)]),t("td",Je,[t("span",{class:Q(["badge rounded-pill",s.status==="pending"?"bg-warning text-dark":s.status==="completed"?"bg-success":"bg-secondary"])},d(s.status),3)]),t("td",null,d(h(w)(s.total)),1),t("td",Ze,[t("div",et,[t("button",{class:"p-2 rounded-pill text-primary hover:bg-gray-100 btn",onClick:r=>ce(s),title:"View Item"},[C(h(Ae),{class:"w-4 h-4"})],8,tt),t("button",{class:"p-2 rounded-pill text-success hover:bg-gray-100 btn",onClick:r=>he(s),disabled:N.value,title:"Print Invoice"},[...e[16]||(e[16]=[t("i",{class:"bi bi-printer fs-5"},null,-1)])],8,st)])])]))),128)),!N.value&&J.value?.length===0?(l(),n("tr",at,[...e[17]||(e[17]=[t("td",{colspan:"6",class:"text-center text-muted py-4"}," No purchase orders found. ",-1)])])):b("",!0)])])])])]),t("div",ot,[t("div",lt,[t("div",nt,[t("div",rt,[t("div",dt,[e[19]||(e[19]=t("span",{class:"badge bg-success rounded-circle p-2"},[t("i",{class:"bi bi-basket"})],-1)),t("div",it,[t("h5",ut,d(u.value?"Edit Purchase Order":"Purchase Details"),1),t("small",ct," Supplier: "+d(v.value?.supplier?.name??"—"),1)])]),t("button",{onClick:ue,class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[...e[20]||(e[20]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),v.value?(l(),n("div",pt,[e[33]||(e[33]=t("h6",{class:"fw-semibold mb-3"},"Order Summary",-1)),t("div",mt,[t("div",vt,[e[21]||(e[21]=t("small",{class:"text-muted d-block"},"Purchase Date",-1)),t("div",gt,d(h(M)(v.value.purchase_date).split(",")[0]),1)]),t("div",ht,[e[22]||(e[22]=t("small",{class:"text-muted d-block"},"Status",-1)),t("span",{class:Q(["badge rounded-pill",v.value.status==="completed"?"bg-success":"bg-warning"])},d(v.value.status),3)]),t("div",yt,[e[23]||(e[23]=t("small",{class:"text-muted d-block"},"Total Amount",-1)),t("div",bt,d(h(w)(v.value.total_amount)),1)])]),e[34]||(e[34]=t("hr",{class:"my-4"},null,-1)),t("h6",_t,d(u.value?"Edit Items":"Purchased Items"),1),t("div",ft,[t("table",xt,[t("thead",kt,[t("tr",null,[e[24]||(e[24]=t("th",null,"Product",-1)),e[25]||(e[25]=t("th",null,"Qty",-1)),e[26]||(e[26]=t("th",null,"Unit Price",-1)),e[27]||(e[27]=t("th",null,"Subtotal",-1)),e[28]||(e[28]=t("th",null,"Expiry",-1)),u.value?(l(),n("th",wt,"Action")):b("",!0)])]),t("tbody",null,[(l(!0),n(ae,null,oe(u.value?f.value:v.value.items,(s,i)=>(l(),n("tr",{class:"black-row",key:s.id||i},[t("td",null,[u.value?O((l(),n("input",{key:1,"onUpdate:modelValue":r=>s.name=r,class:"form-control",readonly:""},null,8,Ct)),[[A,s.name]]):(l(),n("span",St,d(s.product?.name||s.name||"Unknown Product"),1))]),t("td",null,[u.value?O((l(),n("input",{key:1,"onUpdate:modelValue":r=>s.quantity=r,type:"number",class:"form-control",onInput:r=>Z(s)},null,40,Dt)),[[A,s.quantity,void 0,{number:!0}]]):(l(),n("span",Ft,d(h(w)(s.quantity)),1))]),t("td",null,[u.value?O((l(),n("input",{key:1,"onUpdate:modelValue":r=>s.unit_price=r,type:"number",class:"form-control",onInput:r=>Z(s)},null,40,Pt)),[[A,s.unit_price,void 0,{number:!0}]]):(l(),n("span",Nt,d(h(w)(s.unit_price)),1))]),t("td",null,[u.value?O((l(),n("input",{key:1,"onUpdate:modelValue":r=>s.sub_total=r,class:"form-control",readonly:""},null,8,$t)),[[A,s.sub_total]]):(l(),n("span",It,d(h(w)(s.sub_total)),1))]),t("td",null,[u.value?(l(),se(o,{key:1,modelValue:s.expiry,"onUpdate:modelValue":r=>s.expiry=r,enableTimePicker:!1,"min-date":new Date,teleport:!0,format:"yyyy-MM-dd",placeholder:"Select expiry date",class:Q({"is-invalid":x.value[`items.${i}.expiry`]})},null,8,["modelValue","onUpdate:modelValue","min-date","class"])):(l(),n("span",Ot,d(h(M)(s.expiry_date)),1)),x.value[`items.${i}.expiry`]?(l(),n("small",At,d(x.value[`items.${i}.expiry`][0]),1)):b("",!0)]),e[29]||(e[29]=t("br",null,null,-1)),u.value?(l(),n("td",Vt,[t("button",{class:"p-2 rounded-full transition transform hover:bg-gray-100 hover:scale-110",onClick:r=>f.value.splice(i,1),title:"Delete"},[C(h(Ve),{class:"w-4 h-4 text-red-500"})],8,Tt)])):b("",!0)]))),128)),(u.value?f.value.length:v.value.items.length)===0?(l(),n("tr",Et,[t("td",{colspan:u.value?6:5,class:"text-center text-muted py-3"}," No items found ",8,Ut)])):b("",!0)]),t("tfoot",zt,[t("tr",null,[e[30]||(e[30]=t("td",{colspan:"3",class:"text-end fw-bold"}," Total: ",-1)),t("td",Mt,d(h(w)((u.value?f.value:v.value.items).reduce((s,i)=>s+parseFloat(i.sub_total||0),0))),1),e[31]||(e[31]=t("td",{colspan:"2"},null,-1))])])])]),u.value?(l(),n("div",jt,[...e[32]||(e[32]=[t("i",{class:"bi bi-info-circle me-2"},null,-1),$(" Updating will mark this order as completed and create stock entries. ",-1)])])):b("",!0)])):b("",!0),u.value?(l(),n("div",Bt,[t("button",{type:"button",class:"btn btn-primary rounded-pill px-4 py-2",onClick:pe,disabled:z.value||f.value.length===0},[z.value?(l(),n("span",qt,[...e[35]||(e[35]=[t("span",{class:"spinner-border spinner-border-sm me-2"},null,-1),$(" Updating... ",-1)])])):(l(),n("span",Lt,"Complete Order & Update Stock"))],8,Rt),e[36]||(e[36]=t("button",{type:"button",class:"btn btn-secondary rounded-pill px-4 py-2","data-bs-dismiss":"modal"}," Cancel ",-1))])):b("",!0)])])])])]),_:1})}}},us=xe(Gt,[["__scopeId","data-v-59b80b43"]]);export{us as default};
