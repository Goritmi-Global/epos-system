import{_ as je,r as m,o as oe,n as Le,c as ne,I as Te,P as Be,y as Ve,E as ve,a as ie,b as n,w as q,d as k,e as t,u as L,h as Ae,f as r,F as M,g as K,t as d,i as T,j as Oe,m as h,k as J,v as re,l as $,S as Ue,T as Re,U as ge,x as be,p as B,q as u}from"./app-DMtB1k9Z.js";import{_ as ze}from"./Master-DkDSd6J3.js";import{s as fe}from"./index-C7880m82.js";import{E as Ke,a as Xe,X as Ye,u as X,w as Ge}from"./xlsx-fRNLkj6H.js";import{u as He}from"./useFormatters-BAefhHg6.js";import{I as qe}from"./importFile-C85iIISf.js";import{S as Je}from"./shapes-BLDQPtg9.js";import{P as We}from"./package-BZ8eksFV.js";import{T as Qe}from"./triangle-alert-Cr02BkmO.js";import{C as Ze}from"./circle-x-BrLvzpD5.js";import{P as et}from"./plus-D9DcySqO.js";import{P as ye}from"./pencil-DJkLt8dK.js";import"./index-DcRx_qMm.js";import"./createLucideIcon-Celos4K_.js";import"./index-Ds9HV7qR.js";import"./index-Bep5Ew2j.js";import"./sun-Cn8MmWHN.js";import"./index-CptKtDcN.js";import"./index-D3qxtxH9.js";import"./index-DUpVbZbj.js";const tt={class:"page-wrapper"},at={class:"row g-3"},lt={class:"card border-0 shadow-sm rounded-4"},st={class:"card-body d-flex align-items-center justify-content-between"},ot={class:"fw-bold fs-4"},nt={class:"text-muted fs-6"},it={class:"card border-0 shadow-lg rounded-4 mt-0"},rt={class:"card-body"},dt={class:"d-flex flex-wrap gap-2 justify-content-between align-items-center mb-3"},ut={class:"d-flex flex-wrap gap-2 align-items-center"},ct={class:"search-wrap"},mt={key:1,class:"form-control search-input",placeholder:"Search",disabled:"",type:"text"},pt={class:"dropdown"},vt={class:"dropdown-menu dropdown-menu-end shadow rounded-4 py-2"},gt={class:"table-responsive"},bt={class:"table table-striped"},ft={key:0},yt={class:"fw-semibold"},ht={class:"text-truncate",style:{"max-width":"260px"}},Ct={key:0},_t=["onClick"],wt={key:1},kt={class:"rounded d-inline-flex align-items-center justify-content-center img-chip"},xt=["src","alt"],St={key:1,class:"fs-5"},It={class:"text-center"},Ft={class:"text-center"},Mt={class:"d-inline-flex align-items-center gap-3"},$t=["onClick"],Et={key:0},Pt={colspan:"11",class:"text-center text-muted py-4"},Dt={key:0,class:"mt-4 d-flex justify-content-between align-items-center"},Nt={class:"text-muted small"},jt={class:"modal fade",id:"viewCatModal",tabindex:"-1","aria-hidden":"true"},Lt={class:"modal-dialog modal-dialog-centered"},Tt={class:"modal-content rounded-4"},Bt={key:0,class:"modal-body"},Vt={class:"fs-4"},At={key:0},Ot={key:0},Ut={key:1},Rt={key:1,class:"modal-body text-center"},zt={class:"modal fade",id:"addCatModal",tabindex:"-1","aria-hidden":"true"},Kt={class:"modal-dialog modal-lg modal-dialog-centered"},Xt={class:"modal-content rounded-4"},Yt={class:"modal-header"},Gt={class:"modal-title fw-semibold"},Ht={class:"modal-body"},qt={class:"row g-3"},Jt={class:"col-lg-6"},Wt={class:"d-flex align-items-center gap-3"},Qt={class:"form-check"},Zt=["checked"],ea={class:"form-check"},ta=["checked"],aa={key:0,class:"col-lg-6"},la=["value"],sa={key:0,class:"text-danger"},oa={class:"col-lg-6"},na={class:"dropdown w-100"},ia={class:"btn btn-outline-secondary w-100 d-flex justify-content-between align-items-center rounded-3","data-bs-toggle":"dropdown"},ra={class:"d-flex align-items-center"},da=["src"],ua={class:"dropdown-menu w-100 shadow rounded-3"},ca=["onClick"],ma=["src"],pa={key:1,class:"col-12"},va={key:2,class:"text-danger"},ga={key:2,class:"col-12"},ba={class:"p-3 d-flex justify-content-between"},fa={class:"d-flex gap-2"},ya={key:0,class:"text-danger"},ha={key:1,class:"text-danger"},Ca={key:3,class:"col-12"},_a=["value"],wa={class:"col-12"},ka={class:"d-flex align-items-center gap-3"},xa={class:"form-check"},Sa=["checked"],Ia={class:"form-check"},Fa=["checked"],Ma={class:"mt-4"},$a=["disabled"],Ea={class:"modal fade",id:"editSubCatModal",tabindex:"-1","aria-labelledby":"editSubCatModalLabel","aria-hidden":"true"},Pa={class:"modal-dialog"},Da={class:"modal-content"},Na={class:"modal-header"},ja={class:"modal-body"},La={class:"mb-3"},Ta=["disabled"],Ba={class:"text-danger"},Va=["disabled"],Aa={key:0,class:"spinner-border spinner-border-sm text-light",role:"status"},Oa={__name:"Index",setup(Ua){const{formatCurrencySymbol:he}=He(),b=m([]),V=m([]),de=m([]),C=m({current_page:1,last_page:1,per_page:10,total:0,from:0,to:0,links:[]}),f=m(null),x=m([]),Y=async()=>{try{const{data:l}=await B.get("/categories",{params:{per_page:1e4}});de.value=l.data||[]}catch(l){console.error("Failed to fetch all categories:",l)}},E=async(l=null)=>{try{const{data:e}=await B.get("/categories",{params:{q:I.value,page:l||C.value.current_page,per_page:C.value.per_page}});V.value=e.data||[],C.value={current_page:e.current_page,last_page:e.last_page,per_page:e.per_page,total:e.total,from:e.from,to:e.to,links:e.links}}catch(e){console.error("Failed to fetch categories:",e),u.error("Failed to load categories")}},Ce=l=>{if(!l)return;const s=new URLSearchParams(l.split("?")[1]).get("page");s&&E(parseInt(s))};oe(async()=>{I.value="",ue.value=Date.now(),await Le(),setTimeout(()=>{ce.value=!0;const l=document.getElementById(W);l&&(l.value="",I.value="")},100),Y(),E()});const O=ne(()=>V.value.filter(l=>l.parent_id===null)),_e=ne(()=>{const l=de.value.filter(e=>e.parent_id===null);return[{label:"Categories",value:l.length,icon:Je,iconBg:"bg-light-primary",iconColor:"text-primary"},{label:"Total Active",value:l.filter(e=>e.active).length,icon:We,iconBg:"bg-light-success",iconColor:"text-success"},{label:"Low Stock",value:l.filter(e=>!e.active).length,icon:Qe,iconBg:"bg-light-warning",iconColor:"text-warning"},{label:"Out of Stock",value:l.filter(e=>!e.parent_id).length,icon:Ze,iconBg:"bg-light-danger",iconColor:"text-danger"}]}),I=m(""),ue=m(Date.now()),W=`search-${Math.random().toString(36).substr(2,9)}`,ce=m(!1),Q=ne(()=>{const l=I.value.trim().toLowerCase();return l?V.value.filter(e=>e.name.toLowerCase().includes(l)):V.value});oe(()=>window.feather?.replace()),Te(()=>window.feather?.replace());const y=m(!1),Z=m(""),F=m(!0),S=m(null),g=m({label:"Produce (Veg/Fruit)",value:"/assets/img/vegetable.png",file:null}),U=[{label:"Produce (Veg/Fruit)",value:"/assets/img/vegetable.png"},{label:"Meat",value:"/assets/img/meat.png"},{label:"Poultry",value:"/assets/img/poultry.png"},{label:"Dairy",value:"/assets/img/dairy.png"},{label:"Grains & Rice",value:"/assets/img/rice.png"},{label:"Spices & Herbs",value:"/assets/img/spice.png"},{label:"Oils & Fats",value:"/assets/img/olive-oil.png"},{label:"Sauces & Condiments",value:"/assets/img/sauces.png"},{label:"Nuts & Seeds",value:"/assets/img/nuts.png"},{label:"Other",value:"/assets/img/other.png"}],R=m([{label:"Produce (Veg/Fruit)",value:"Produce (Veg/Fruit)",icon:"/assets/img/vegetable.png",selected:!1},{label:"Meat",value:"Meat",icon:"/assets/img/meat.png",selected:!1},{label:"Poultry",value:"Poultry",icon:"/assets/img/poultry.png",selected:!1},{label:"Dairy",value:"Dairy",icon:"/assets/img/dairy.png",selected:!1},{label:"Grains & Rice",value:"Grains & Rice",icon:"/assets/img/rice.png",selected:!1},{label:"Flour & Baking",value:"Flour & Baking",icon:"/assets/img/flour.png",selected:!1},{label:"Spices & Herbs",value:"Spices & Herbs",icon:"/assets/img/spice.png",selected:!1},{label:"Oils & Fats",value:"Oils & Fats",icon:"/assets/img/olive-oil.png",selected:!1},{label:"Sauces & Condiments",value:"Sauces & Condiments",icon:"/assets/img/sauces.png",selected:!1},{label:"Nuts & Seeds",value:"Nuts & Seeds",icon:"/assets/img/nuts.png",selected:!1},{label:"Other",value:"Other",icon:"/assets/img/other.png",selected:!1}]),we=async(l,e)=>{try{const s=await fetch(l);if(!s.ok)return console.error("âŒ Fetch failed:",s.status,s.statusText),null;const i=await s.blob();return new File([i],e,{type:i.type})}catch(s){return console.error("âŒ Error converting URL to File:",s),null}},ee=()=>{y.value=!1,b.value=[],F.value=!0,S.value=null,Z.value="",g.value={label:U[0].label,value:U[0].value,file:null},R.value=R.value.map(l=>({...l,selected:!1})),f.value=null},P=m(!1),p=m({}),ke=async()=>{if(y.value&&!S.value){p.value.parent_id=["Please select a parent category"],u.error(p.value.parent_id[0]),P.value=!1;return}z(),P.value=!0;try{if(g.value.value&&!g.value.file){const e=g.value.label.toLowerCase().replace(/[^a-z0-9]/g,"-")+".jpg",s=await we(g.value.value,e);s&&(g.value.file=s)}if(f.value){const e=new FormData;let s="";if(y.value?s=Z.value?.trim():s=b.value[0]?.label?.trim()||b.value[0]?.name?.trim()||(typeof b.value[0]=="string"?b.value[0].trim():""),!s){p.value.name=["Category name cannot be empty"],u.error("Category name cannot be empty"),P.value=!1;return}e.append("name",s),e.append("active",F.value?"1":"0"),e.append("parent_id",S.value||""),e.append("_method","PUT"),g.value.file&&g.value.file instanceof File&&e.append("icon",g.value.file),!S.value&&G.value&&G.value.split(",").map(a=>a.trim()).filter(a=>a.length>0).forEach((a,v)=>{const c=f.value.subcategories?.find(o=>o.name.toLowerCase()===a.toLowerCase());e.append(`subcategories[${v}][name]`,a),c?(e.append(`subcategories[${v}][id]`,c.id),e.append(`subcategories[${v}][active]`,c.active?"1":"0")):e.append(`subcategories[${v}][active]`,"1")}),await B.post(`/categories/${f.value.id}`,e,{headers:{"Content-Type":"multipart/form-data"}}),u.success("Category updated successfully"),await E(),await Y()}else{const e=new FormData;let s=[];if(y.value){if(x.value.length===0){p.value.subcategories=["Please add at least one subcategory"],u.error("Please add at least one subcategory"),P.value=!1;return}s=x.value.map(i=>({name:typeof i=="string"?i:i.label,active:F.value,parent_id:S.value}))}else{if(b.value.length===0){p.value.name=["Please add at least one category"],u.error("Please add at least one category"),P.value=!1;return}s=b.value.map(i=>({name:typeof i=="string"?i:i.label,active:F.value,parent_id:null}))}e.append("isSubCategory",y.value?"1":"0"),s.forEach((i,a)=>{e.append(`categories[${a}][name]`,i.name),e.append(`categories[${a}][active]`,i.active?"1":"0"),i.parent_id&&e.append(`categories[${a}][parent_id]`,i.parent_id)}),g.value.file&&g.value.file instanceof File&&e.append("icon",g.value.file),await B.post("/categories",e,{headers:{"Content-Type":"multipart/form-data"}}),u.success("Category created successfully"),await E(),await Y()}bootstrap.Modal.getInstance(document.getElementById("addCatModal"))?.hide(),ee(),f.value=null,await E()}catch(l){if(l.response?.status===422&&l.response?.data?.errors){const e=l.response.data.errors;let s=[];p.value={},Object.keys(e).forEach(i=>{let a=i.replace(/^categories\.\d+\./,"");p.value[a]=e[i],Array.isArray(e[i])&&e[i].forEach(v=>{s.push(v)})}),s.length>0?u.error(s.join(`
`)):u.error("Validation failed. Please check your input.")}else{const e=l.response?.data?.message||"Failed to save category";u.error(e+" âŒ")}}finally{P.value=!1}},z=()=>{p.value={}},G=m(""),xe=l=>{z(),f.value=l,y.value=!!l.parent_id,S.value=l.parent_id||null;const e=U.find(a=>a.value===l.icon);g.value=e||U[0],y.value?Z.value=l.name:b.value=[{label:l.name,value:l.name,id:l.id}],F.value=l.active,l.subcategories&&l.subcategories.length>0?(A.value=l.subcategories.map(a=>({label:a.name,value:a.id?a.id.toString():`temp_${Date.now()}_${Math.random()}`})),x.value=l.subcategories.map(a=>a.id?a.id.toString():`temp_${Date.now()}_${Math.random()}`),G.value=l.subcategories.map(a=>a.name).join(", ")):(A.value=[],x.value=[],G.value="");const s=document.getElementById("addCatModal");new bootstrap.Modal(s).show()},te=m(""),me=()=>{const l=(te.value||"").trim();l&&(R.value.some(e=>e.label.toLowerCase()===l.toLowerCase())||R.value.push({label:l,value:l}),b.value.includes(l)||(b.value=[...b.value,l]),te.value="")},Se=async l=>{if(l?.id)try{await B.delete(`/categories/${l.id}`),u.success("Category deleted successfully"),await E(),await Y()}catch(e){console.error("âŒ Delete error:",e.response?.data||e.message),u.error("Failed to delete category âŒ")}},D=m(null),A=m([]),H=m(""),ae=()=>{const l=H.value?.trim();l&&(A.value.some(e=>e.value.toLowerCase()===l.toLowerCase())||A.value.push({label:l,value:l}),x.value.includes(l)||x.value.push(l),H.value="")},Ie=()=>{x.value=A.value.map(l=>l.value)},Fe=()=>{x.value=[]},_=m({id:null,name:"",parent_id:null}),Me=(l,e)=>{_.value={id:e.id,name:e.name,parent_id:l.id};const s=document.getElementById("editSubCatModal");bootstrap.Modal.getOrCreateInstance(s).show()},N=m(!1),j=m(""),$e=async()=>{if(N.value=!0,!_.value.name.trim()){j.value="Subcategory name cannot be empty";return}N.value=!0,j.value="";try{const{data:l}=await B.put(`/api/categories/subcategories/${_.value.id}`,{name:_.value.name.trim()});if(l.success){u.success(l.message);const e=V.value.find(a=>a.id===_.value.parent_id);if(e){const a=e.subcategories.find(v=>v.id===_.value.id);a&&(a.name=_.value.name)}const s=document.getElementById("editSubCatModal");bootstrap.Modal.getInstance(s).hide(),_.value={id:null,name:"",parent_id:null}}else j.value=l.message||"Failed to update subcategory"}catch(l){console.error(l),j.value=l.response?.data?.message||"An error occurred while updating"}finally{N.value=!1}};oe(()=>{const l=document.getElementById("editSubCatModal");l&&l.addEventListener("hidden.bs.modal",()=>{j.value="",_.value={id:null,name:"",parent_id:null}})}),Be(()=>{const l=document.getElementById("editSubCatModal");l&&l.removeEventListener("hidden.bs.modal",()=>{})});let pe=null;Ve(I,()=>{clearTimeout(pe),pe=setTimeout(()=>{C.value.current_page=1,E(1)},500)});const le=l=>{if(!O.value||O.value.length===0){u.error("No Units data to download");return}const e=I.value.trim()?Q.value:O.value;if(e.length===0){u.error("No Units found to download");return}try{l==="pdf"?Pe(e):l==="excel"?De(e):l==="csv"?Ee(e):u.error("Invalid download type")}catch(s){console.error("Download failed:",s),u.error(`Download failed: ${s.message}`)}},Ee=l=>{try{const e=["category","subcategory","active"],s=l.map(o=>{const w=o.subcategories&&o.subcategories.length>0?o.subcategories.map(se=>se.name).join(", "):"";return[`"${o.name||""}"`,`"${w}"`,`${o.active?"Yes":"No"}`]}),i=[e.join(","),...s.map(o=>o.join(","))].join(`
`),a=new Blob([i],{type:"text/csv;charset=utf-8;"}),v=URL.createObjectURL(a),c=document.createElement("a");c.setAttribute("href",v),c.setAttribute("download",`Categories_${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(c),c.click(),document.body.removeChild(c),u.success("CSV downloaded successfully")}catch(e){console.error("CSV generation error:",e),u.error(`CSV generation failed: ${e.message}`,{autoClose:5e3})}},Pe=l=>{try{const e=new Ke("p","mm","a4");e.setFontSize(18),e.setFont("helvetica","bold"),e.text("Inventory Categories Report",14,20),e.setFontSize(10),e.setFont("helvetica","normal");const s=new Date().toLocaleString();e.text(`Generated on: ${s}`,14,28),e.text(`Total Categories: ${l.length}`,14,34);const i=["Category","Subcategory","Active"],a=l.map(c=>{const o=c.subcategories&&c.subcategories.length>0?c.subcategories.map(w=>w.name).join(", "):"";return[c.name||"",o,c.active?"Yes":"No"]});Xe(e,{head:[i],body:a,startY:40,styles:{fontSize:9,cellPadding:2,halign:"left",lineColor:[0,0,0],lineWidth:.1},headStyles:{fillColor:[41,128,185],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]},margin:{left:14,right:14},didDrawPage:c=>{const o=e.internal.getNumberOfPages(),w=e.internal.pageSize.height;e.setFontSize(8),e.text(`Page ${c.pageNumber} of ${o}`,c.settings.margin.left,w-10)}});const v=`Categories_${new Date().toISOString().split("T")[0]}.pdf`;e.save(v),u.success("PDF downloaded successfully")}catch(e){console.error("PDF generation error:",e),u.error(`PDF generation failed: ${e.message}`,{autoClose:5e3})}},De=l=>{try{if(typeof Ye>"u")throw new Error("XLSX library is not loaded");const e=l.map(o=>{const w=o.subcategories&&o.subcategories.length>0?o.subcategories.map(se=>se.name).join(", "):"";return{Category:o.name||"",Subcategory:w,Active:o.active?"Yes":"No"}}),s=X.book_new(),i=X.json_to_sheet(e);i["!cols"]=[{wch:25},{wch:40},{wch:10}],X.book_append_sheet(s,i,"Categories");const a=[{Info:"Generated On",Value:new Date().toLocaleString()},{Info:"Total Records",Value:l.length},{Info:"Exported By",Value:"Inventory Management System"}],v=X.json_to_sheet(a);X.book_append_sheet(s,v,"Report Info");const c=`Categories_${new Date().toISOString().split("T")[0]}.xlsx`;Ge(s,c),u.success("Excel file downloaded successfully",{autoClose:2500})}catch(e){console.error("Excel generation error:",e),u.error(`Excel generation failed: ${e.message}`,{autoClose:5e3})}},Ne=l=>{if(!l||l.length<=1){u.error("The imported file is empty.");return}l[0];const s=l.slice(1).map(o=>({category:o[0]||"",subcategory:o[1]||null,active:o[2]=="no"?0:1})),i=s.filter(o=>o.category).map(o=>o.category.trim().toLowerCase()),a=i.filter((o,w)=>i.indexOf(o)!==w);if(a.length>0){u.error(`Duplicate category names found in CSV: ${[...new Set(a)].join(", ")}`);return}const v=O.value.map(o=>o.name.trim().toLowerCase()),c=s.filter(o=>o.category).filter(o=>v.includes(o.category.trim().toLowerCase()));if(c.length>0){const o=c.map(w=>w.category).join(", ");u.error(`Categories already exist in the table: ${o}`);return}B.post("/api/categories/import",{categories:s}).then(()=>{u.success("Categories imported successfully"),E()}).catch(o=>{console.error(o),u.error("Import failed")})};return(l,e)=>{const s=ve("ConfirmModal"),i=ve("Button");return n(),ie(ze,null,{default:q(()=>[k(L(Ae),{title:"Inventory Category"}),t("div",tt,[e[54]||(e[54]=t("h4",{class:"mb-3"},"Inventory Categories",-1)),t("div",at,[(n(!0),r(M,null,K(_e.value,a=>(n(),r("div",{key:a.label,class:"col-md-6 col-xl-3"},[t("div",lt,[t("div",st,[t("div",null,[t("div",ot,d(a.value),1),t("div",nt,d(a.label),1)]),t("div",{class:T(["p-3 rounded-3 d-flex align-items-center justify-content-center",a.iconBg])},[(n(),ie(Oe(a.icon),{class:T(a.iconColor),size:"28"},null,8,["class"]))],2)])])]))),128))]),t("div",it,[t("div",rt,[t("div",dt,[e[25]||(e[25]=t("h4",{class:"mb-0"},"Categories",-1)),t("div",ut,[t("div",ct,[e[21]||(e[21]=t("i",{class:"bi bi-search"},null,-1)),e[22]||(e[22]=t("input",{type:"email",name:"email",autocomplete:"email",style:{position:"absolute",left:"-9999px",width:"1px",height:"1px"},tabindex:"-1","aria-hidden":"true"},null,-1)),ce.value?J((n(),r("input",{id:W,"onUpdate:modelValue":e[0]||(e[0]=a=>I.value=a),key:ue.value,class:"form-control search-input",placeholder:"Search",type:"search",autocomplete:"new-password",name:W,role:"presentation",onFocus:e[1]||(e[1]=(...a)=>l.handleFocus&&l.handleFocus(...a))},null,32)),[[re,I.value]]):(n(),r("input",mt))]),t("button",{"data-bs-toggle":"modal","data-bs-target":"#addCatModal",onClick:e[2]||(e[2]=()=>{z?.(),f.value&&(f.value.value=null),ee?.()}),class:"d-flex align-items-center gap-1 px-4 py-2 btn-sm rounded-pill btn btn-primary text-white"},[k(L(et),{class:"w-4 h-4"}),e[23]||(e[23]=$(" Add Category ",-1))]),k(qe,{label:"Import",sampleHeaders:["category","subcategory","active"],sampleData:[["Dairy","TestSubCat","yes"],["Bakery","Bread","yes"],["Beverages","Juices","no"]],onOnImport:Ne}),t("div",pt,[e[24]||(e[24]=t("button",{class:"btn btn-outline-secondary rounded-pill py-2 btn-sm px-4 dropdown-toggle","data-bs-toggle":"dropdown"}," Export ",-1)),t("ul",vt,[t("li",null,[t("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:e[3]||(e[3]=a=>le("pdf"))},"Export as PDF")]),t("li",null,[t("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:e[4]||(e[4]=a=>le("excel"))},"Export as Excel")]),t("li",null,[t("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:e[5]||(e[5]=a=>le("csv"))}," Export as CSV ")])])])])]),t("div",gt,[t("table",bt,[e[27]||(e[27]=t("thead",{class:"border-top small text-muted"},[t("tr",null,[t("th",null,"S.#"),t("th",null,"Category"),t("th",null,"Sub Category"),t("th",null,"Icon"),t("th",null,"Total value"),t("th",null,"Total Item"),t("th",null,"Out of Stock"),t("th",null,"Low Stock"),t("th",null,"In Stock"),t("th",{class:"text-center"},"Status"),t("th",{class:"text-center"},"Action")])],-1)),t("tbody",null,[!V.value.length&&C.value.total===0?(n(),r("tr",ft,[...e[26]||(e[26]=[t("td",{colspan:"11",class:"text-center py-5"},[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")]),t("p",{class:"text-muted mt-2 mb-0"},"Loading categories...")],-1)])])):(n(),r(M,{key:1},[(n(!0),r(M,null,K(Q.value,(a,v)=>(n(),r("tr",{key:a.id},[t("td",null,d(C.value.from+v),1),t("td",yt,d(a.name),1),t("td",ht,[a.subcategories&&a.subcategories.length?(n(),r("div",Ct,[(n(!0),r(M,null,K(a.subcategories,c=>(n(),r("div",{key:c.id,class:"d-flex justify-content-between align-items-center",style:{gap:"5px"}},[t("span",null,d(c.name),1),t("button",{class:"p-2 rounded-full text-blue-600 hover:bg-blue-100",onClick:o=>Me(a,c),title:"Edit Subcategory"},[k(L(ye),{class:"w-4 h-4"})],8,_t)]))),128))])):(n(),r("span",wt,"â€“"))]),t("td",null,[t("div",kt,[a.image_url?(n(),r("img",{key:0,src:a.image_url,alt:a.name,class:"rounded",style:{width:"32px",height:"32px","object-fit":"cover"}},null,8,xt)):(n(),r("span",St,"ðŸ“¦"))])]),t("td",null,d(L(he)(a.total_value)),1),t("td",null,d(a.primary_inventory_items_count),1),t("td",null,d(a.out_of_stock),1),t("td",null,d(a.low_stock),1),t("td",null,d(a.in_stock),1),t("td",It,[t("span",{class:T(a.active?"inline-block px-3 py-1 text-xs font-semibold text-white bg-success rounded-full text-center w-20":"inline-block px-3 py-1 text-xs font-semibold text-white bg-danger rounded-full text-center w-20")},d(a.active?"Active":"Inactive"),3)]),t("td",Ft,[t("div",Mt,[t("button",{"data-bs-toggle":"modal","data-bs-target":"#modalUnitForm",onClick:()=>{xe(a)},title:"Edit",class:"p-2 rounded-full text-blue-600 hover:bg-blue-100"},[k(L(ye),{class:"w-4 h-4"})],8,$t),k(s,{title:"Confirm Delete",message:`Are you sure you want to delete ${a.name}?`,showDeleteButton:!0,onConfirm:()=>{Se(a)},onCancel:()=>{}},null,8,["message","onConfirm"])])])]))),128)),Q.value.length===0?(n(),r("tr",Et,[t("td",Pt,d(I.value.trim()?"No categories found matching your search.":"No categories found."),1)])):h("",!0)],64))])])]),C.value.last_page>1?(n(),r("div",Dt,[t("div",Nt," Showing "+d(C.value.from)+" to "+d(C.value.to)+" of "+d(C.value.total)+" entries ",1),k(Ue,{pagination:C.value.links,isApiDriven:!0,onPageChanged:Ce},null,8,["pagination"])])):h("",!0)])]),t("div",jt,[t("div",Lt,[t("div",Tt,[e[33]||(e[33]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title"},"Category Details"),t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})])])],-1)),D.value?(n(),r("div",Bt,[t("p",null,[e[28]||(e[28]=t("strong",null,"Name:",-1)),$(" "+d(D.value.name),1)]),t("p",null,[e[29]||(e[29]=t("strong",null,"Icon:",-1)),t("span",Vt,d(D.value.icon),1)]),t("p",null,[e[30]||(e[30]=t("strong",null,"Status:",-1)),$(" "+d(D.value.active?"Active":"Inactive"),1)]),D.value.parent?(n(),r("p",At,[e[31]||(e[31]=t("strong",null,"Parent Category:",-1)),$(" "+d(D.value.parent.name),1)])):h("",!0),t("p",null,[e[32]||(e[32]=t("strong",null,"Sub-Categories: ",-1)),D.value.subcategories.length?(n(),r("span",Ot,d(D.value.subcategories.map(a=>a.name).join(", ")),1)):(n(),r("span",Ut,"None"))])])):(n(),r("div",Rt," Loading category details... ")),e[34]||(e[34]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ")],-1))])])]),t("div",zt,[t("div",Kt,[t("div",Xt,[t("div",Yt,[t("h5",Gt,d(f.value?"Edit Category":"Add Raw Material Category"),1),e[35]||(e[35]=t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})])],-1))]),t("div",Ht,[t("div",qt,[f.value?h("",!0):(n(),r(M,{key:0},[t("div",Jt,[e[38]||(e[38]=t("label",{class:"form-label d-block mb-2"},"Is this a subcategory?",-1)),t("div",Wt,[t("div",Qt,[t("input",{class:"form-check-input",type:"radio",checked:y.value,onClick:e[6]||(e[6]=a=>z()),onChange:e[7]||(e[7]=a=>{y.value=!0,S.value=null}),name:"isSub"},null,40,Zt),e[36]||(e[36]=t("label",{class:"form-check-label"},"Yes",-1))]),t("div",ea,[t("input",{class:"form-check-input",type:"radio",checked:!y.value,onClick:e[8]||(e[8]=a=>z()),onChange:e[9]||(e[9]=a=>{y.value=!1,S.value=null}),name:"isSub"},null,40,ta),e[37]||(e[37]=t("label",{class:"form-check-label"},"No",-1))])])]),y.value?(n(),r("div",aa,[e[40]||(e[40]=t("label",{class:"form-label d-block mb-2"},"Select Parent Category",-1)),J(t("select",{"onUpdate:modelValue":e[10]||(e[10]=a=>S.value=a),class:T(["form-select",{"is-invalid":p.value?.parent_id}]),required:""},[e[39]||(e[39]=t("option",{disabled:"",value:null}," Choose Parent Category ",-1)),(n(!0),r(M,null,K(O.value,a=>(n(),r("option",{key:a.id,value:a.id},d(a.name),9,la))),128))],2),[[Re,S.value]]),p.value?.parent_id?(n(),r("small",sa,d(p.value.parent_id[0]),1)):h("",!0)])):h("",!0)],64)),t("div",oa,[e[42]||(e[42]=t("label",{class:"form-label d-block mb-2"},"Manual Icon",-1)),t("div",na,[t("button",ia,[t("span",ra,[t("img",{src:g.value.value,alt:"icon",class:"me-2 rounded",style:{width:"24px",height:"24px","object-fit":"cover"}},null,8,da),$(" "+d(g.value.label),1)]),e[41]||(e[41]=t("i",{class:"bi bi-caret-down-fill"},null,-1))]),t("ul",ua,[(n(),r(M,null,K(U,a=>t("li",{key:a.label},[t("a",{class:"dropdown-item d-flex align-items-center",href:"javascript:void(0)",onClick:v=>g.value=a},[t("img",{src:a.value,alt:"icon",class:"me-2 rounded",style:{width:"24px",height:"24px","object-fit":"cover"}},null,8,ma),$(" "+d(a.label),1)],8,ca)])),64))])])]),!y.value||f.value?(n(),r("div",pa,[e[43]||(e[43]=t("label",{class:"form-label"},"Category Name",-1)),f.value?J((n(),r("input",{key:0,type:"text","onUpdate:modelValue":e[11]||(e[11]=a=>b.value[0].label=a),class:T(["form-control",{"is-invalid":p.value.name}]),placeholder:"Enter category name"},null,2)),[[re,b.value[0].label]]):(n(),ie(L(fe),{key:1,modelValue:b.value,"onUpdate:modelValue":e[12]||(e[12]=a=>b.value=a),options:R.value,optionLabel:"label",optionValue:"value",filter:!0,display:"chip",class:T([{"is-invalid":p.value.name},"w-100 select"]),placeholder:"Select or add categories...",appendTo:"self",onKeydown:ge(be(me,["prevent"]),["enter"]),onBlur:me,onFilter:e[13]||(e[13]=a=>te.value=a.value)},{option:q(({option:a})=>[$(d(a.label),1)]),_:1},8,["modelValue","options","class","onKeydown"])),p.value.name?(n(),r("small",va,d(p.value.name[0]),1)):h("",!0)])):h("",!0),y.value&&!f.value?(n(),r("div",ga,[e[44]||(e[44]=t("label",{class:"form-label"},"Subcategory Name(s)",-1)),k(L(fe),{modelValue:x.value,"onUpdate:modelValue":e[14]||(e[14]=a=>x.value=a),options:A.value,optionLabel:"label",optionValue:"value",filter:!0,display:"chip",class:T([{"is-invalid":p.value?.subcategories||p.value?.name},"w-100"]),placeholder:"Select or add subcategories...",appendTo:"self",onFilter:e[15]||(e[15]=a=>H.value=a.value||""),onKeydown:ge(be(ae,["prevent"]),["enter"]),onBlur:ae},{option:q(({option:a})=>[t("div",null,d(a.label),1)]),footer:q(()=>[t("div",ba,[k(i,{label:"Add Custom",severity:"secondary",variant:"text",size:"small",icon:"pi pi-plus",onClick:ae,disabled:!H.value.trim()},null,8,["onClick","disabled"]),t("div",fa,[k(i,{label:"Select All",severity:"secondary",variant:"text",size:"small",icon:"pi pi-check",onClick:Ie},null,8,["onClick"]),k(i,{label:"Clear All",severity:"danger",variant:"text",size:"small",icon:"pi pi-times",onClick:Fe},null,8,["onClick"])])])]),_:1},8,["modelValue","options","class","onKeydown"]),p.value?.subcategories?(n(),r("div",ya,d(p.value.subcategories[0]),1)):h("",!0),p.value?.name?(n(),r("div",ha,d(p.value.name[0]),1)):h("",!0)])):h("",!0),f.value&&l.parentCategory?(n(),r("div",Ca,[e[45]||(e[45]=t("label",{class:"form-label"},"Parent Category",-1)),t("input",{type:"text",class:"form-control",value:l.parentCategory.label,disabled:""},null,8,_a)])):h("",!0),t("div",wa,[e[48]||(e[48]=t("label",{class:"form-label d-block mb-2"},"Active",-1)),t("div",ka,[t("div",xa,[t("input",{class:"form-check-input",type:"radio",checked:F.value,onChange:e[16]||(e[16]=a=>F.value=!0),name:"active"},null,40,Sa),e[46]||(e[46]=t("label",{class:"form-check-label"},"Yes",-1))]),t("div",Ia,[t("input",{class:"form-check-input",type:"radio",checked:!F.value,onChange:e[17]||(e[17]=a=>F.value=!1),name:"active"},null,40,Fa),e[47]||(e[47]=t("label",{class:"form-check-label"},"No",-1))])])])]),e[51]||(e[51]=t("hr",{class:"my-4"},null,-1)),t("div",Ma,[t("button",{class:"btn btn-primary btn-sm rounded-pill px-4",disabled:P.value,onClick:e[18]||(e[18]=a=>ke())},[P.value?(n(),r(M,{key:0},[e[49]||(e[49]=t("span",{class:"spinner-border spinner-border-sm me-2"},null,-1)),e[50]||(e[50]=$(" Saving... ",-1))],64)):(n(),r(M,{key:1},[$(d((f.value,"Save")),1)],64))],8,$a),t("button",{class:"btn btn-secondary rounded-pill btn-sm px-4 ms-2","data-bs-dismiss":"modal",onClick:ee}," Cancel ")])])])])]),t("div",Ea,[t("div",Pa,[t("div",Da,[t("div",Na,[t("h5",{onClick:e[19]||(e[19]=a=>j.value=""),class:"modal-title",id:"editSubCatModalLabel"}," Edit Subcategory "),e[52]||(e[52]=t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})])],-1))]),t("div",ja,[t("div",La,[e[53]||(e[53]=t("label",{for:"subCategoryName",class:"form-label"},"Subcategory Name",-1)),J(t("input",{type:"text",class:"form-control",id:"subCategoryName","onUpdate:modelValue":e[20]||(e[20]=a=>_.value.name=a),disabled:N.value},null,8,Ta),[[re,_.value.name]]),t("small",Ba,d(j.value),1)]),t("button",{type:"button",class:"px-4 py-2 rounded-pill btn btn-primary text-white text-center d-flex align-items-center justify-content-center gap-2",onClick:$e,disabled:N.value},[N.value?(n(),r("span",Aa)):h("",!0),t("span",null,d(N.value?"Saving...":"Save"),1)],8,Va)])])])])])]),_:1})}}},rl=je(Oa,[["__scopeId","data-v-947ae86b"]]);export{rl as default};
