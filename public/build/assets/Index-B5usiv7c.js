import{_ as K,r as m,k as X,p as Y,C as B,H as G,D as J,c as E,o as i,w as T,a as p,b as e,d as u,h as Q,g as d,F as w,v as U,n as r,B as W,t as n,x as g,y as _,f as M,i as c,U as ee,A as P,m as y}from"./app-CKq2yLFP.js";import{_ as te}from"./Master-CiX_JCFa.js";import{s as N}from"./index-BwvD7aB-.js";import{u as se}from"./useFormatters-CBalBVwV.js";import{c as $}from"./createLucideIcon-D4RXw3zI.js";import{T as ae}from"./triangle-alert-BAJfggBo.js";import{C as le}from"./circle-x-kwKzrm7o.js";import{P as oe}from"./plus-CmkVQZMT.js";import{P as ne}from"./pencil-D8cMydcw.js";import"./index-B9vr8CaN.js";import"./sun-qiut8AwL.js";import"./index-C12fXkxv.js";/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=$("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=$("percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]),re={class:"page-wrapper"},ue={class:"row g-3"},ce={class:"card border-0 shadow-sm rounded-4"},me={class:"card-body d-flex align-items-center"},pe={class:"mb-0 fw-bold"},ve={class:"text-muted mb-0 small"},be={class:"card border-0 shadow-lg rounded-4 mt-0"},ge={class:"card-body"},_e={class:"d-flex flex-wrap gap-2 justify-content-between align-items-center mb-3"},fe={class:"d-flex flex-wrap gap-2 align-items-center"},he={class:"search-wrap"},ye={key:1,class:"form-control search-input",placeholder:"Search",disabled:"",type:"text"},xe={class:"table-responsive"},ke={class:"table table-striped"},Ce={class:"fw-semibold"},we={class:"text-center"},Pe={class:"text-center"},Ve={class:"d-inline-flex align-items-center gap-3"},Me=["onClick"],Se=["title"],De={key:0},Fe={class:"modal fade",id:"promoModal",tabindex:"-1","aria-hidden":"true"},Ie={class:"modal-dialog modal-lg modal-dialog-centered"},Ae={class:"modal-content rounded-4"},Be={class:"modal-header"},Ee={class:"modal-title fw-semibold"},Te={class:"modal-body"},Ue={class:"row g-3"},Ne={class:"col-12"},$e={key:0,class:"text-danger"},Le={class:"col-md-6"},je={key:0,class:"text-danger"},Oe={class:"col-md-6"},Ze={key:0,class:"text-danger"},qe={class:"col-12"},ze={key:0,class:"text-danger"},Re={key:0,class:"text-danger"},He={class:"col-md-6"},Ke={key:0,class:"text-danger"},Xe={class:"col-md-6"},Ye={key:0,class:"text-danger"},Ge={class:"col-md-6"},Je={key:0,class:"text-danger"},Qe={class:"col-md-6"},We={key:0,class:"text-danger"},et={class:"col-12"},tt={key:0,class:"text-danger"},st={class:"mt-4"},at=["disabled"],lt={__name:"Index",setup(ot){const{formatCurrencySymbol:S,dateFmt:x}=se(),v=m([]),b=m(null),k=m(!1),l=m({}),L=[{label:"Flat Amount",value:"flat"},{label:"Percentage",value:"percent"}],j=[{label:"Active",value:"active"},{label:"Deactive",value:"inactive"}],D=async()=>{try{const a=await P.get("api/promos/all");v.value=a.data.data}catch(a){console.error("Failed to fetch promos:",a),y.error("Failed to load promos")}};X(async()=>{f.value="",F.value=Date.now(),await Y(),setTimeout(()=>{I.value=!0;const a=document.getElementById(V);a&&(a.value="",f.value="")},100),D()});const O=B(()=>[{label:"Total Promos",value:v.value.length,icon:de,iconBg:"bg-light-primary",iconColor:"text-primary"},{label:"Active Promos",value:v.value.filter(a=>a.status==="active").length,icon:ie,iconBg:"bg-light-success",iconColor:"text-success"},{label:"Flat Discount",value:v.value.filter(a=>a.type==="flat").length,icon:ae,iconBg:"bg-light-warning",iconColor:"text-warning"},{label:"Percentage",value:v.value.filter(a=>a.type==="percent").length,icon:le,iconBg:"bg-light-danger",iconColor:"text-danger"}]),f=m(""),F=m(Date.now()),V=`search-${Math.random().toString(36).substr(2,9)}`,I=m(!1),A=B(()=>{const a=f.value.trim().toLowerCase();return a?v.value.filter(t=>t.name.toLowerCase().includes(a)):v.value}),o=m({name:"",type:"percent",status:"active",start_date:"",end_date:"",min_purchase:0,max_discount:null,description:"",discount_amount:null}),C=()=>{o.value={name:"",type:"percent",status:"active",start_date:"",end_date:"",min_purchase:0,max_discount:null,description:"",discount_amount:null},b.value=null,l.value={}},Z=async()=>{k.value=!0,l.value={};try{b.value?(await P.post(`/promos/${b.value.id}`,o.value),y.success("Promo updated successfully")):(await P.post("/promos",o.value),y.success("Promo created successfully")),bootstrap.Modal.getInstance(document.getElementById("promoModal"))?.hide(),C(),await D()}catch(a){if(console.error("âŒ Error:",a.response?.data||a.message),a.response?.status===422&&a.response?.data?.errors){l.value=a.response.data.errors;const t=Object.values(a.response.data.errors).flat();y.error(t.join(`
`))}else{const t=a.response?.data?.message||"Failed to save promo";y.error(t)}}finally{k.value=!1}},q=a=>{b.value=a,o.value={name:a.name,type:a.type,status:a.status,start_date:a.start_date,end_date:a.end_date,min_purchase:a.min_purchase,max_discount:a.max_discount,description:a.description||"",discount_amount:a.discount_amount};const t=document.getElementById("promoModal");new bootstrap.Modal(t).show()},z=async a=>{const t=a.status==="active"?"inactive":"active";try{await P.patch(`/api/promos/${a.id}/toggle-status`,{status:t}),a.status=t}catch(h){console.error("Failed to update status:",h)}};return G(()=>window.feather?.replace()),(a,t)=>{const h=J("VueDatePicker");return i(),E(te,null,{default:T(()=>[p(u(Q),{title:"Promo"}),e("div",re,[t[31]||(t[31]=e("h4",{class:"fw-semibold mb-3"},"Promo Management",-1)),e("div",ue,[(i(!0),d(w,null,U(O.value,s=>(i(),d("div",{key:s.label,class:"col-md-6 col-xl-3"},[e("div",ce,[e("div",me,[e("div",{class:r([[s.iconBg,s.iconColor],"rounded-circle p-3 d-flex align-items-center justify-content-center me-3"]),style:{width:"56px",height:"56px"}},[(i(),E(W(s.icon),{class:"w-6 h-6"}))],2),e("div",null,[e("h3",pe,n(s.value),1),e("p",ve,n(s.label),1)])])])]))),128))]),e("div",be,[e("div",ge,[e("div",_e,[t[15]||(t[15]=e("h5",{class:"mb-0 fw-semibold"},"Promos",-1)),e("div",fe,[e("div",he,[t[12]||(t[12]=e("i",{class:"bi bi-search"},null,-1)),t[13]||(t[13]=e("input",{type:"email",name:"email",autocomplete:"email",style:{position:"absolute",left:"-9999px",width:"1px",height:"1px"},tabindex:"-1","aria-hidden":"true"},null,-1)),I.value?g((i(),d("input",{id:V,"onUpdate:modelValue":t[0]||(t[0]=s=>f.value=s),key:F.value,class:"form-control search-input",placeholder:"Search",type:"search",autocomplete:"new-password",name:V,role:"presentation",onFocus:t[1]||(t[1]=(...s)=>a.handleFocus&&a.handleFocus(...s))},null,32)),[[_,f.value]]):(i(),d("input",ye))]),e("button",{"data-bs-toggle":"modal","data-bs-target":"#promoModal",onClick:C,class:"d-flex align-items-center gap-1 px-4 py-2 rounded-pill btn btn-primary text-white"},[p(u(oe),{class:"w-4 h-4"}),t[14]||(t[14]=M(" Add Promo ",-1))])])]),e("div",xe,[e("table",ke,[t[17]||(t[17]=e("thead",{class:"border-top small text-muted"},[e("tr",null,[e("th",null,"S.#"),e("th",null,"Name"),e("th",null,"Type"),e("th",null,"Start Date"),e("th",null,"End Date"),e("th",null,"Min Purchase"),e("th",null,"Max Discount"),e("th",{class:"text-center"},"Status"),e("th",{class:"text-center"},"Action")])],-1)),e("tbody",null,[(i(!0),d(w,null,U(A.value,(s,R)=>(i(),d("tr",{key:s.id},[e("td",null,n(R+1),1),e("td",Ce,n(s.name),1),e("td",null,[e("span",{class:r(s.type==="flat"?"badge bg-primary px-4 py-2 rounded-pill":"badge bg-warning px-4 py-2 rounded-pill")},n(s.type==="flat"?"Flat":"Percent"),3)]),e("td",null,n(u(x)(s.start_date)),1),e("td",null,n(u(x)(s.end_date)),1),e("td",null,n(u(S)(s.min_purchase)),1),e("td",null,n(s.max_discount?u(S)(s.max_discount):"N/A"),1),e("td",we,[e("span",{class:r(s.status==="active"?"badge bg-success px-4 py-2 rounded-pill":"badge bg-danger px-4 py-2 rounded-pill")},n(s.status==="active"?"Active":"Inactive"),3)]),e("td",Pe,[e("div",Ve,[e("button",{onClick:H=>q(s),title:"Edit",class:"p-2 rounded-full text-blue-600 hover:bg-blue-100"},[p(u(ne),{class:"w-4 h-4"})],8,Me),p(ee,{title:"Confirm Status Change",message:`Are you sure you want to set ${s.name} to ${s.status==="active"?"Inactive":"Active"}?`,showStatusButton:!0,confirmText:"Yes, Change",cancelText:"Cancel",status:s.status,onConfirm:H=>z(s)},{trigger:T(()=>[e("button",{class:r(["relative inline-flex items-center w-8 h-4 rounded-full transition-colors duration-300 focus:outline-none",s.status==="active"?"bg-green-500 hover:bg-green-600":"bg-red-400 hover:bg-red-500"]),title:s.status==="active"?"Set Inactive":"Set Active"},[e("span",{class:r(["absolute left-0.5 top-0.5 w-3 h-3 bg-white rounded-full shadow transform transition-transform duration-300",s.status==="active"?"translate-x-4":"translate-x-0"])},null,2)],10,Se)]),_:2},1032,["message","status","onConfirm"])])])]))),128)),A.value.length===0?(i(),d("tr",De,[...t[16]||(t[16]=[e("td",{colspan:"9",class:"text-center text-muted py-4"}," No promos found. ",-1)])])):c("",!0)])])])])]),e("div",Fe,[e("div",Ie,[e("div",Ae,[e("div",Be,[e("h5",Ee,n(b.value?"Edit Promo":"Add New Promo"),1),e("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110",onClick:C,"data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[...t[18]||(t[18]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",Te,[e("div",Ue,[e("div",Ne,[t[19]||(t[19]=e("label",{class:"form-label"},"Promo Name",-1)),g(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>o.value.name=s),type:"text",class:r(["form-control",{"is-invalid":l.value.name}]),placeholder:"Enter promo name"},null,2),[[_,o.value.name]]),l.value.name?(i(),d("small",$e,n(l.value.name[0]),1)):c("",!0)]),e("div",Le,[t[20]||(t[20]=e("label",{class:"form-label"},"Discount Type",-1)),p(u(N),{modelValue:o.value.type,"onUpdate:modelValue":t[3]||(t[3]=s=>o.value.type=s),options:L,optionLabel:"label",appendTo:"self",autoZIndex:!0,baseZIndex:2e3,optionValue:"value",class:r(["form-select",{"is-invalid":l.value.type}])},null,8,["modelValue","class"]),l.value.type?(i(),d("small",je,n(l.value.type[0]),1)):c("",!0)]),e("div",Oe,[t[21]||(t[21]=e("label",{class:"form-label"},"Status",-1)),p(u(N),{modelValue:o.value.status,"onUpdate:modelValue":t[4]||(t[4]=s=>o.value.status=s),options:j,optionLabel:"label",optionValue:"value",class:r(["form-select",{"is-invalid":l.value.status}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","class"]),l.value.status?(i(),d("small",Ze,n(l.value.status[0]),1)):c("",!0)]),e("div",qe,[t[22]||(t[22]=e("label",{class:"form-label"},"Discount Amount",-1)),g(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>o.value.discount_amount=s),type:"number",class:r(["form-control",{"is-invalid":l.value.discount_amount}]),placeholder:"Enter discount amount"},null,2),[[_,o.value.discount_amount]]),l.value.discount_amount?(i(),d("small",ze,n(l.value.discount_amount[0]),1)):c("",!0)]),l.value.name?(i(),d("small",Re,n(l.value.name[0]),1)):c("",!0),e("div",He,[t[23]||(t[23]=e("label",{class:"form-label"},"Start Date",-1)),p(h,{modelValue:o.value.start_date,"onUpdate:modelValue":t[6]||(t[6]=s=>o.value.start_date=s),format:u(x),"min-date":new Date,enableTimePicker:!1,placeholder:"Select Start date",class:r({"is-invalid":l.value.start_date})},null,8,["modelValue","format","min-date","class"]),l.value.start_date?(i(),d("small",Ke,n(l.value.start_date[0]),1)):c("",!0)]),e("div",Xe,[t[24]||(t[24]=e("label",{class:"form-label"},"End Date",-1)),p(h,{modelValue:o.value.end_date,"onUpdate:modelValue":t[7]||(t[7]=s=>o.value.end_date=s),format:u(x),"min-date":new Date,enableTimePicker:!1,placeholder:"Select End date",class:r({"is-invalid":l.value.end_date})},null,8,["modelValue","format","min-date","class"]),l.value.end_date?(i(),d("small",Ye,n(l.value.end_date[0]),1)):c("",!0)]),e("div",Ge,[t[25]||(t[25]=e("label",{class:"form-label"},"Minimum Purchase Amount",-1)),g(e("input",{"onUpdate:modelValue":t[8]||(t[8]=s=>o.value.min_purchase=s),type:"number",step:"0.01",class:r(["form-control",{"is-invalid":l.value.min_purchase}]),placeholder:"0.00"},null,2),[[_,o.value.min_purchase]]),l.value.min_purchase?(i(),d("small",Je,n(l.value.min_purchase[0]),1)):c("",!0)]),e("div",Qe,[t[26]||(t[26]=e("label",{class:"form-label"},"Maximum Discount (Optional)",-1)),g(e("input",{"onUpdate:modelValue":t[9]||(t[9]=s=>o.value.max_discount=s),type:"number",step:"0.01",class:r(["form-control",{"is-invalid":l.value.max_discount}]),placeholder:"0.00"},null,2),[[_,o.value.max_discount]]),l.value.max_discount?(i(),d("small",We,n(l.value.max_discount[0]),1)):c("",!0)]),e("div",et,[t[27]||(t[27]=e("label",{class:"form-label"},"Description (Optional)",-1)),g(e("textarea",{"onUpdate:modelValue":t[10]||(t[10]=s=>o.value.description=s),class:r(["form-control",{"is-invalid":l.value.description}]),rows:"3",placeholder:"Enter promo description"},null,2),[[_,o.value.description]]),l.value.description?(i(),d("small",tt,n(l.value.description[0]),1)):c("",!0)])]),t[30]||(t[30]=e("hr",{class:"my-4"},null,-1)),e("div",st,[e("button",{class:"btn btn-primary rounded-pill px-4",disabled:k.value,onClick:t[11]||(t[11]=s=>Z())},[k.value?(i(),d(w,{key:0},[t[28]||(t[28]=e("span",{class:"spinner-border spinner-border-sm me-2"},null,-1)),t[29]||(t[29]=M(" Saving... ",-1))],64)):(i(),d(w,{key:1},[M(n((b.value,"Save")),1)],64))],8,at),e("button",{class:"btn btn-secondary rounded-pill px-4 ms-2","data-bs-dismiss":"modal",onClick:C}," Cancel ")])])])])])])]),_:1})}}},ft=K(lt,[["__scopeId","data-v-93bdbcd6"]]);export{ft as default};
