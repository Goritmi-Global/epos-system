import{_ as M,r,C as S,k as U,O as $,g as n,o as a,b as e,i as m,x as h,y,f as P,F as L,v as A,t as c,a as D,d as T,n as E,A as g,m as f}from"./app-CYEkE9GK.js";import{P as j}from"./pencil-CHVYe7FI.js";import"./createLucideIcon-BvjKrCmJ.js";const I={class:"card shadow-sm border-0 rounded-4"},F={class:"card-header d-flex flex-wrap gap-2 justify-content-between align-items-center"},O={class:"d-flex align-items-center gap-2"},q={class:"input-group"},z={class:"table-responsive"},K={class:"table table-hover mb-0"},G={class:"badge bg-light py-2 text-dark"},H=["onClick"],J={key:0},Q={key:1},R={colspan:"3",class:"text-center text-muted py-4"},W={key:0,class:"modal fade show d-block",style:{background:"#0006"}},X={class:"modal-dialog modal-dialog-end"},Y={class:"modal-content rounded-4"},Z={class:"modal-header"},ee={class:"modal-title"},se={class:"modal-body"},te={class:"mb-2"},oe={key:0,class:"invalid-feedback d-block"},le={class:"mb-2"},ne={key:0,class:"invalid-feedback d-block"},ae={class:"modal-footer"},ie=["disabled"],re={key:0,class:"spinner-border spinner-border-sm me-1"},w="/permissions",de={__name:"Permissions",setup(ue){const d=r(!1),v=r(null),p=r([]),i=r({name:"",description:""}),l=r({}),b=r(!1),u=r("");async function _(){const{data:t}=await g.get(w);p.value=t||[]}const k=S(()=>{const t=u.value.trim().toLowerCase();return t?p.value.filter(s=>{const o=(s.name||"").toLowerCase(),C=(s.description||"").toLowerCase();return o.includes(t)||C.includes(t)}):p.value});function x(t){t.key==="Escape"&&u.value&&(u.value="")}function N(){v.value=null,i.value={name:"",description:""},l.value={},d.value=!0}function V(t){v.value=t.id,i.value={name:t.name,description:t.description??""},l.value={},d.value=!0}async function B(){try{b.value=!0,l.value={},v.value?(await g.put(`${w}/${v.value}`,i.value),f.success("Permission updated successfully")):(await g.post(w,i.value),f.success("Permission created successfully")),await _(),d.value=!1}catch(t){if(t?.response?.status===422){const s=t.response.data?.errors||{};l.value=s;const o=Object.values(s)?.[0]?.[0]??"Please fix the highlighted fields and try again.";f.error(o)}else console.error("Save failed",t),f.error("Something went wrong. Please try again.")}finally{b.value=!1}}return U(()=>{_(),window.addEventListener("keydown",x)}),$(()=>{window.removeEventListener("keydown",x)}),(t,s)=>(a(),n(L,null,[e("div",I,[e("div",F,[s[6]||(s[6]=e("div",null,[e("h5",{class:"mb-0"},"List of Permissions"),e("small",{class:"text-muted"},"These are all the permissions that this system uses.")],-1)),e("div",O,[e("div",q,[h(e("input",{"onUpdate:modelValue":s[0]||(s[0]=o=>u.value=o),type:"text",class:"form-control rounded-pill shadow-sm",placeholder:"Search permissions…",style:{width:"360px"}},null,512),[[y,u.value,void 0,{trim:!0}]])]),e("button",{class:"btn btn-primary btn-sm rounded-pill w-100 px-3 py-2",onClick:N},[...s[5]||(s[5]=[e("i",{class:"bi bi-plus-lg me-1"},null,-1),P(" Add Permission ",-1)])])])]),e("div",z,[e("table",K,[s[8]||(s[8]=e("thead",{class:"table-primary"},[e("tr",null,[e("th",null,"Permission"),e("th",null,"Description"),e("th",{style:{width:"110px"}},"Action")])],-1)),e("tbody",null,[(a(!0),n(L,null,A(k.value,o=>(a(),n("tr",{key:o.id},[e("td",null,[e("span",G,c(o.name),1)]),e("td",null,c(o.description),1),e("td",null,[e("button",{class:"p-2 rounded-full text-blue-600 hover:bg-blue-100",onClick:C=>V(o)},[D(T(j),{class:"w-4 h-4"})],8,H)])]))),128)),p.value.length?k.value.length?m("",!0):(a(),n("tr",Q,[e("td",R," No results for “"+c(u.value)+"” ",1)])):(a(),n("tr",J,[...s[7]||(s[7]=[e("td",{colspan:"3",class:"text-center text-muted py-4"}," No permissions ",-1)])]))])])])]),d.value?(a(),n("div",W,[e("div",X,[e("div",Y,[e("div",Z,[e("h6",ee,c(v.value?"Edit Permission":"Create Permission"),1),e("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110",onClick:s[1]||(s[1]=o=>d.value=!1),"data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[...s[9]||(s[9]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",se,[e("div",te,[s[10]||(s[10]=e("label",{class:"form-label"},"Name",-1)),h(e("input",{"onUpdate:modelValue":s[2]||(s[2]=o=>i.value.name=o),class:E(["form-control",{"is-invalid":l.value.name,"bg-danger bg-opacity-10":l.value.name}]),placeholder:"inventory.view"},null,2),[[y,i.value.name]]),l.value.name?(a(),n("div",oe,c(l.value.name[0]),1)):m("",!0)]),e("div",le,[s[11]||(s[11]=e("label",{class:"form-label"},"Description",-1)),h(e("input",{"onUpdate:modelValue":s[3]||(s[3]=o=>i.value.description=o),class:E(["form-control",{"is-invalid":l.value.description,"bg-danger bg-opacity-10":l.value.description}]),placeholder:"Inventory"},null,2),[[y,i.value.description]]),l.value.description?(a(),n("div",ne,c(l.value.description[0]),1)):m("",!0)])]),e("div",ae,[e("button",{class:"btn btn-primary rounded-pill px-2 py-2",disabled:b.value,onClick:B},[b.value?(a(),n("span",re)):m("",!0),s[12]||(s[12]=P(" Save ",-1))],8,ie),e("button",{class:"btn btn-secondary rounded-pill px-2 py-2",onClick:s[4]||(s[4]=o=>d.value=!1)}," Cancel ")])])])])):m("",!0)],64))}},pe=M(de,[["__scopeId","data-v-1b0ee3fe"]]);export{pe as default};
