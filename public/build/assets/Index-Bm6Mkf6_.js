import{_ as De,r as p,c as f,o as se,n as Se,w as Fe,g as c,b as u,e as y,u as _,h as Pe,d as ae,f as e,t as o,l as F,m as q,v as Ne,p as V,F as k,i as P,T as le,j as C,y as je,P as Ee,s as h}from"./app-BQcLyXae.js";import{_ as Ke}from"./Master-CqVL6ONQ.js";import{u as Ae}from"./useFormatters-gZqjEMKN.js";import{F as Ve}from"./FilterModal-DeIcJooP.js";import{E as Me,a as Be,X as Le,u as N,w as We}from"./xlsx-BYTrw9Ws.js";import{s as ze}from"./index-CTconj2N.js";import{E as Re}from"./eye-6HvzY3rR.js";import{P as oe}from"./printer-BOkH_Ny_.js";import{C as Ue}from"./clock-BJdwgiEB.js";import{c as qe}from"./createLucideIcon-Coc_9-2_.js";import{C as Xe}from"./circle-check-big-Q7fjXgph.js";import{C as He}from"./circle-x-BBd6AacI.js";import"./index-ChDEJC2l.js";import"./index-BYOzUaWA.js";import"./index-vdhn3Fjw.js";import"./sun-BNSuMpoO.js";import"./index-BZw_b2Hb.js";import"./index-DGPcsmUV.js";import"./index-BStk-RuA.js";/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=qe("loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]]),Je={class:"page-wrapper"},Qe={class:"row g-4"},Ye={class:"col-md-6 col-xl-3"},Ze={class:"card border-0 shadow-sm rounded-4"},et={class:"card-body d-flex align-items-center justify-content-between"},tt={class:"mb-0 fw-bold"},st={class:"col-md-6 col-xl-3"},at={class:"card border-0 shadow-sm rounded-4"},lt={class:"card-body d-flex align-items-center justify-content-between"},ot={class:"mb-0 fw-bold"},nt={class:"col-md-6 col-xl-3"},rt={class:"card border-0 shadow-sm rounded-4"},dt={class:"card-body d-flex align-items-center justify-content-between"},it={class:"mb-0 fw-bold"},ct={class:"col-md-6 col-xl-3"},ut={class:"card border-0 shadow-sm rounded-4"},mt={class:"card-body d-flex align-items-center justify-content-between"},pt={class:"mb-0 fw-bold"},bt={class:"col-md-6 col-xl-3"},vt={class:"card border-0 shadow-sm rounded-4"},gt={class:"card-body d-flex align-items-center justify-content-between"},ht={class:"mb-0 fw-bold"},yt={class:"col-md-6 col-xl-3"},_t={class:"card border-0 shadow-sm rounded-4"},ft={class:"card-body d-flex align-items-center justify-content-between"},xt={class:"mb-0 fw-bold"},wt={class:"card border-0 shadow-lg rounded-4"},kt={class:"card-body"},Ct={class:"d-flex flex-wrap gap-2 justify-content-between align-items-center mb-3"},Tt={class:"d-flex flex-wrap gap-2 align-items-center"},It={class:"search-wrap"},Ot={key:1,class:"form-control search-input",placeholder:"Search",disabled:"",type:"text"},$t={class:"col-md-6"},Dt=["onUpdate:modelValue"],St=["value"],Ft={class:"col-md-6 mt-3"},Pt=["onUpdate:modelValue"],Nt=["value"],jt={class:"mb-4"},Et={class:"d-flex gap-2 flex-wrap"},Kt=["onClick"],At={class:"table-responsive"},Vt={class:"table table-hover align-middle mb-0"},Mt={key:0},Bt={class:"fw-semibold"},Lt={class:"badge bg-info text-white rounded-pill"},Wt={class:"d-flex justify-content-center align-items-center gap-2"},zt=["onClick"],Rt=["onClick"],Ut={key:0},qt={colspan:"10",class:"text-center text-muted py-4"},Xt={class:"d-flex flex-column align-items-center justify-content-center py-3"},Ht={class:"small text-secondary mt-1"},Gt={key:0,class:"mt-4 d-flex justify-content-between align-items-center"},Jt={class:"text-muted small"},Qt={class:"modal fade",id:"orderItemsModal",tabindex:"-1","aria-hidden":"true"},Yt={class:"modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable"},Zt={class:"modal-content rounded-4 shadow border-0 dark:bg-[#212121]"},es={class:"modal-header border-0 dark:bg-[#181818]"},ts={class:"d-flex align-items-center gap-3 dark:text-white"},ss={class:"modal-title fw-bold mb-1"},as={class:"opacity-75"},ls={class:"modal-body p-4"},os={key:0,class:"rounded-3 p-4"},ns={class:"row mb-4"},rs={class:"col-md-3"},ds={class:"dark:text-white"},is={class:"col-md-3"},cs={class:"dark:text-white"},us={class:"col-md-3"},ms={class:"col-md-3"},ps={class:"dark:text-white"},bs={class:"fw-bold mb-3 text-primary dark:text-blue-400"},vs={class:"table-responsive"},gs={class:"table table-hover align-middle rounded-3 overflow-hidden dark:text-gray-200"},hs={class:"px-3"},ys={class:"fw-semibold"},_s={class:"badge bg-secondary"},fs={class:"text-muted dark:text-gray-400"},xs={class:"text-muted dark:text-gray-400"},ws={class:"d-flex justify-content-center align-items-center gap-2"},ks=["onClick"],Cs=["onClick"],Ts=["onClick"],Is=["onClick"],Os={class:"modal-footer border-0 dark:bg-[#212121]"},$s={__name:"Index",setup(Ds){const{dateFmt:j}=Ae(),m=p([]),S=p(!1),b=p(null),X=p(!1),T=p("All"),ne=p([{label:"All",value:"All",icon:"bi-list-ul"},{label:"Waiting",value:"Waiting",icon:"bi-hourglass-split"},{label:"In Progress",value:"In Progress",icon:"bi-gear"},{label:"Done",value:"Done",icon:"bi-check-circle"},{label:"Cancelled",value:"Cancelled",icon:"bi-x-circle"}]),re=a=>{T.value=a,a==="All"?g.value.status="":g.value.status=a,v.value.current_page=1,I(1)},M=p(null),de=[{label:"PDF",value:"pdf"},{label:"Excel",value:"excel"},{label:"CSV",value:"csv"}],ie=a=>{a.value&&(xe(a.value),M.value=null)},H=f(()=>{const a={All:m.value.length,Waiting:0,"In Progress":0,Done:0,Cancelled:0};return m.value.forEach(t=>{t.status&&a.hasOwnProperty(t.status)&&a[t.status]++}),a}),ce=a=>{switch(a){case"Waiting":return"bg-warning text-dark";case"In Progress":return"bg-info text-white";case"Done":return"bg-success";case"Cancelled":return"bg-danger";default:return"bg-secondary"}},v=p({current_page:1,last_page:1,per_page:10,total:0,from:0,to:0,links:[]}),I=async(a=null)=>{S.value=!0;try{const t={q:O.value,page:a||v.value.current_page,per_page:v.value.per_page,sort_by:g.value.sortBy||"",order_type:g.value.orderType||"",status:g.value.status||"",date_from:g.value.dateFrom||"",date_to:g.value.dateTo||""};Object.keys(t).forEach(l=>{(t[l]===void 0||t[l]==="")&&delete t[l]});const s=await axios.get("/api/kots/all-orders",{params:t});console.log("Fetched KOT Orders:",s.data.data),m.value=(s.data.data||[]).map(l=>{const d=l.pos_order_type?.order,i=d?.items||[];return{id:d?.id||l.id,kot_id:l.id,created_at:d?.created_at||l.created_at,customer_name:d?.customer_name||"Walk In",total_amount:d?.total_amount||0,sub_total:d?.sub_total||0,status:l.status||"Waiting",type:{order_type:l.pos_order_type?.order_type,table_number:l.pos_order_type?.table_number},payment:d?.payment,items:(l.items||[]).map(n=>{const r=i.find($=>$.title===n.item_name||$.product_id===n.product_id);return{...n,title:n.item_name,price:r?.price||0,quantity:n.quantity||1,variant_name:n.variant_name||"-",item_kitchen_note:n.item_kitchen_note||"",ingredients:n.ingredients||[]}}),item_count:l.items?.length||0}}),v.value={current_page:s.data.current_page,last_page:s.data.last_page,per_page:s.data.per_page,total:s.data.total,from:s.data.from,to:s.data.to,links:s.data.links}}catch(t){console.error("Error fetching orders:",t),m.value=[],h.error("Failed to load KOT orders")}finally{S.value=!1}},ue=a=>{if(!a)return;const s=new URLSearchParams(a.split("?")[1]).get("page");s&&I(parseInt(s))};se(async()=>{O.value="",G.value=Date.now(),await Se(),setTimeout(()=>{J.value=!0;const t=document.getElementById(B);t&&(t.value="",O.value="")},100),I();const a=document.getElementById("kotFilterModal");a&&a.addEventListener("hidden.bs.modal",()=>{x.value={sortBy:g.value.sortBy||"",orderType:g.value.orderType||"",status:g.value.status||"",dateFrom:g.value.dateFrom||"",dateTo:g.value.dateTo||""}})});const O=p(""),G=p(Date.now()),B=`search-${Math.random().toString(36).substr(2,9)}`,J=p(!1),x=p({sortBy:"",orderType:"",status:"",dateFrom:"",dateTo:""}),g=p({sortBy:"",orderType:"",status:"",dateFrom:"",dateTo:""});p("All"),p("All"),p(["All","Eat In","Delivery","Takeaway","Collection"]),p(["All","Waiting","In Progress","Done","Cancelled"]);const me=a=>{x.value={...x.value,...a},g.value={...x.value},v.value.current_page=1,I(1),bootstrap.Modal.getInstance(document.getElementById("kotFilterModal"))?.hide(),console.log("Filters applied:",x.value)},pe=()=>{x.value={sortBy:"",orderType:"",status:"",dateFrom:"",dateTo:""},g.value={sortBy:"",orderType:"",status:"",dateFrom:"",dateTo:""},v.value.current_page=1,v.value.per_page=10,I(1),console.log("Filters cleared")},L=f(()=>m.value),W=f(()=>({sortOptions:[{value:"order_desc",label:"Order ID: High to Low"},{value:"order_asc",label:"Order ID: Low to High"},{value:"date_desc",label:"Date: Newest First"},{value:"date_asc",label:"Date: Oldest First"}],orderTypeOptions:[{value:"Eat In",label:"Eat In"},{value:"Delivery",label:"Delivery"},{value:"Takeaway",label:"Takeaway"},{value:"Collection",label:"Collection"}],statusOptions:[{value:"Waiting",label:"Waiting"},{value:"In Progress",label:"In Progress"},{value:"Done",label:"Done"},{value:"Cancelled",label:"Cancelled"}]})),be=f(()=>new Set(m.value.map(t=>t.type?.table_number).filter(t=>t)).size),ve=f(()=>m.value.reduce((a,t)=>a+(t.item_count||0),0)),ge=f(()=>m.value.reduce((a,t)=>{const s=t.items?.filter(l=>l.status==="Waiting").length||0;return a+s},0)),he=f(()=>m.value.reduce((a,t)=>{const s=t.items?.filter(l=>l.status==="In Progress").length||0;return a+s},0)),ye=f(()=>m.value.reduce((a,t)=>{const s=t.items?.filter(l=>l.status==="Done").length||0;return a+s},0)),_e=f(()=>m.value.reduce((a,t)=>{const s=t.items?.filter(l=>l.status==="Cancelled").length||0;return a+s},0)),z=a=>{switch(a){case"Done":return"bg-success";case"Cancelled":return"bg-danger";case"Waiting":return"bg-warning text-dark";case"In Progress":return"bg-info text-white";default:return"bg-secondary"}},Q=a=>{const t=JSON.parse(JSON.stringify(a)),s=t?.customer_name||"Walk-in Customer",l=t?.type?.order_type||"Eat In",d=t?.type?.table_number,i=t?.payment,n=t?.items||[],r=n.reduce((D,A)=>D+Number(A.price||0)*Number(A.quantity||0),0),$=t?.total_amount||r,te=t?.created_at?new Date(t.created_at):new Date,Te=te.toISOString().split("T")[0],Ie=te.toTimeString().split(" ")[0],U=(i?.payment_method||"cash").toLowerCase();let K="";U==="split"?K=`Payment Type: Split (Cash: £${Number(i?.cash_amount??0).toFixed(2)}, Card: £${Number(i?.card_amount??0).toFixed(2)})`:U==="card"||U==="stripe"?K=`Payment Type: Card${i?.card_brand?` (${i.card_brand}`:""}${i?.last4?` •••• ${i.last4}`:""}${i?.card_brand?")":""}`:K=`Payment Type: ${i?.payment_method||"Cash"}`;const Oe=`
    <html>
    <head>
      <title>Kitchen Order Ticket</title>
      <style>
        @page { size: 80mm auto; margin: 0; }
        html, body {
          width: 80mm;
          margin: 0;
          padding: 8px;
          font-family: monospace, Arial, sans-serif;
          font-size: 12px;
          line-height: 1.4;
        }
        .header { text-align: center; margin-bottom: 10px; }
        .order-info { margin: 10px 0; }
        .order-info div { margin-bottom: 3px; }
        .payment-info { margin-top: 8px; margin-bottom: 8px; }
        table { width: 100%; border-collapse: collapse; margin: 10px 0; }
        th, td { padding: 4px 0; text-align: left; }
        th { border-bottom: 1px solid #000; }
        td:last-child, th:last-child { text-align: right; }
        .totals { margin-top: 10px; border-top: 1px dashed #000; padding-top: 8px; }
        .footer { text-align: center; margin-top: 10px; font-size: 11px; }
      </style>
    </head>
    <body>
      <div class="header">
        <h2>KITCHEN ORDER TICKET</h2>
      </div>
      
      <div class="order-info">
        <div>KOT ID: #${t.id}</div>
        <div>Date: ${Te}</div>
        <div>Time: ${Ie}</div>
        <div>Customer: ${s}</div>
        <div>Order Type: ${l}</div>
        ${d?`<div>Table: ${d}</div>`:""}
        
        <div class="payment-info">
          <div>${K}</div>
        </div>
        
        <div>Status: ${t.status}</div>
      </div>

      <table>
        <thead>
          <tr>
            <th>Item</th>
            <th>Qty</th>
            <th>Price</th>
          </tr>
        </thead>
        <tbody>
         ${n.map(D=>{const A=Number(D.quantity)||1,$e=Number(D.price)||0;return`
      <tr>
        <td>${D.title||D.item_name||"Unknown Item"}</td>
        <td>${A}</td>
        <td>£${$e.toFixed(2)}</td>
      </tr>
    `}).join("")}
        </tbody>
      </table>

      <div class="totals">
        <div>Subtotal: £${Number(r).toFixed(2)}</div>
        <div>Total: £${Number($).toFixed(2)}</div>
        ${i?.cash_received?`<div>Cash Received: £${Number(i.cash_received).toFixed(2)}</div>`:""}
        ${i?.change?`<div>Change: £${Number(i.change).toFixed(2)}</div>`:""}
      </div>

      <div class="footer">
        Kitchen Copy - Thank you!
      </div>
    </body>
    </html>
  `,w=window.open("","_blank","width=400,height=600");if(!w){alert("Please allow popups for this site to print KOT");return}w.document.open(),w.document.write(Oe),w.document.close(),w.onload=()=>{w.print(),w.close()}},R=p([]),Y=p(!1);se(async()=>{Y.value=!0;try{const a=await axios.get("/api/printers");console.log("Printers:",a.data.data),R.value=a.data.data.filter(t=>t.is_connected===!0||t.status==="OK").map(t=>({label:`${t.name}`,value:t.name,driver:t.driver,port:t.port}))}catch(a){console.error("Failed to fetch printers:",a)}finally{Y.value=!1}});let Z=null;Fe(O,()=>{clearTimeout(Z),Z=setTimeout(()=>{v.value.current_page=1,I(1)},500)});const fe=a=>{b.value=a,X.value=!0;const t=document.getElementById("orderItemsModal");t&&new bootstrap.Modal(t).show()},ee=()=>{X.value=!1,b.value=null;const a=document.getElementById("orderItemsModal");if(a){const t=bootstrap.Modal.getInstance(a);t&&t.hide()}},E=async(a,t,s)=>{try{const l=await axios.put(`/api/kots/pos/kot-item/${t.id}/status`,{status:s}),d=m.value.findIndex(i=>i.kot_id===a.kot_id);if(d!==-1){const i=m.value[d].items.findIndex(n=>n.id===t.id);i!==-1&&(m.value[d].items[i].status=l.data.status,m.value[d].status=l.data.order_status,m.value=[...m.value])}h.success(`"${t.item_name}" marked as ${s}`)}catch(l){console.error("Failed to update KOT item status:",l),h.error(l.response?.data?.message||"Failed to update status")}},xe=a=>{if(!m.value||m.value.length===0){h.error("No kitchen orders data to download");return}const t=L.value;if(t.length===0){h.error("No kitchen orders found to download");return}try{a==="pdf"?ke(t):a==="excel"?Ce(t):a==="csv"?we(t):h.error("Invalid download type")}catch(s){console.error("Download failed:",s),h.error(`Download failed: ${s.message}`)}},we=a=>{try{const t=["KOT ID","Order ID","Customer Name","Order Type","Table Number","Items Count","Status","Total Amount","Date"],s=a.map(r=>[`"${r.kot_id||""}"`,`"${r.id||""}"`,`"${r.customer_name||"Walk In"}"`,`"${r.type?.order_type||"-"}"`,`"${r.type?.table_number||"-"}"`,`"${r.item_count||0}"`,`"${r.status||""}"`,`"${Number(r.total_amount||0).toFixed(2)}"`,`"${r.created_at?j(r.created_at):""}"`]),l=[t.join(","),...s.map(r=>r.join(","))].join(`
`),d=new Blob([l],{type:"text/csv;charset=utf-8;"}),i=URL.createObjectURL(d),n=document.createElement("a");n.setAttribute("href",i),n.setAttribute("download",`Kitchen_Orders_${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(n),n.click(),document.body.removeChild(n),h.success("CSV downloaded successfully")}catch(t){console.error("CSV generation error:",t),h.error(`CSV generation failed: ${t.message}`)}},ke=a=>{try{const t=new Me("l","mm","a4");t.setFontSize(18),t.setFont("helvetica","bold"),t.text("Kitchen Orders Report",14,20),t.setFontSize(10),t.setFont("helvetica","normal");const s=new Date().toLocaleString();t.text(`Generated on: ${s}`,14,28),t.text(`Total Orders: ${a.length}`,14,34);const l=["KOT ID","Order ID","Customer","Type","Table","Items","Status","Amount","Date"],d=a.map(n=>[n.kot_id||"",n.id||"",n.customer_name||"Walk In",n.type?.order_type||"-",n.type?.table_number||"-",n.item_count||0,n.status||"",`£${Number(n.total_amount||0).toFixed(2)}`,n.created_at?j(n.created_at):""]);Be(t,{head:[l],body:d,startY:40,styles:{fontSize:8,cellPadding:2,halign:"left",lineColor:[0,0,0],lineWidth:.1},headStyles:{fillColor:[41,128,185],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]},margin:{left:14,right:14},didDrawPage:n=>{const r=t.internal.getNumberOfPages(),$=t.internal.pageSize.height;t.setFontSize(8),t.text(`Page ${n.pageNumber} of ${r}`,n.settings.margin.left,$-10)}});const i=`Kitchen_Orders_${new Date().toISOString().split("T")[0]}.pdf`;t.save(i),h.success("PDF downloaded successfully")}catch(t){console.error("PDF generation error:",t),h.error(`PDF generation failed: ${t.message}`)}},Ce=a=>{try{if(typeof Le>"u")throw new Error("XLSX library is not loaded");const t=a.map(r=>({"KOT ID":r.kot_id||"","Order ID":r.id||"","Customer Name":r.customer_name||"Walk In","Order Type":r.type?.order_type||"-","Table Number":r.type?.table_number||"-","Items Count":r.item_count||0,Status:r.status||"","Total Amount":Number(r.total_amount||0).toFixed(2),Date:r.created_at||""})),s=N.book_new(),l=N.json_to_sheet(t);l["!cols"]=[{wch:10},{wch:10},{wch:20},{wch:12},{wch:12},{wch:12},{wch:12},{wch:12},{wch:18}],N.book_append_sheet(s,l,"Kitchen Orders");const d=[{Info:"Generated On",Value:new Date().toLocaleString()},{Info:"Total Orders",Value:a.length},{Info:"Exported By",Value:"Kitchen Management System"}],i=N.json_to_sheet(d);N.book_append_sheet(s,i,"Report Info");const n=`Kitchen_Orders_${new Date().toISOString().split("T")[0]}.xlsx`;We(s,n),h.success("Excel file downloaded successfully")}catch(t){console.error("Excel generation error:",t),h.error(`Excel generation failed: ${t.message}`)}};return(a,t)=>(u(),c(k,null,[y(_(Pe),{title:"Kitchen Orders"}),y(Ke,null,{default:ae(()=>[e("div",Je,[t[28]||(t[28]=e("h4",{class:"fw-semibold mb-3"},"Kitchen Order Tickets",-1)),e("div",Qe,[e("div",Ye,[e("div",Ze,[e("div",et,[e("div",null,[e("h3",tt,o(be.value),1),t[5]||(t[5]=e("p",{class:"text-muted mb-0 small"},"Total Tables",-1))]),t[6]||(t[6]=e("div",{class:"rounded-circle p-3 bg-primary-subtle text-primary d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-table fs-4"})],-1))])])]),e("div",st,[e("div",at,[e("div",lt,[e("div",null,[e("h3",ot,o(ve.value),1),t[7]||(t[7]=e("p",{class:"text-muted mb-0 small"},"Total Items",-1))]),t[8]||(t[8]=e("div",{class:"rounded-circle p-3 bg-success-subtle text-success d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-basket fs-4"})],-1))])])]),e("div",nt,[e("div",rt,[e("div",dt,[e("div",null,[e("h3",it,o(ge.value),1),t[9]||(t[9]=e("p",{class:"text-muted mb-0 small"},"Pending Items",-1))]),t[10]||(t[10]=e("div",{class:"rounded-circle p-3 bg-warning-subtle text-warning d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-hourglass-split fs-4"})],-1))])])]),e("div",ct,[e("div",ut,[e("div",mt,[e("div",null,[e("h3",pt,o(he.value),1),t[11]||(t[11]=e("p",{class:"text-muted mb-0 small"},"In Progress",-1))]),t[12]||(t[12]=e("div",{class:"rounded-circle p-3 bg-info-subtle text-info d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-gear fs-4"})],-1))])])]),e("div",bt,[e("div",vt,[e("div",gt,[e("div",null,[e("h3",ht,o(ye.value),1),t[13]||(t[13]=e("p",{class:"text-muted mb-0 small"},"Completed Items",-1))]),t[14]||(t[14]=e("div",{class:"rounded-circle p-3 bg-success-subtle text-success d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-check-circle fs-4"})],-1))])])]),e("div",yt,[e("div",_t,[e("div",ft,[e("div",null,[e("h3",xt,o(_e.value),1),t[15]||(t[15]=e("p",{class:"text-muted mb-0 small"},"Cancelled Items",-1))]),t[16]||(t[16]=e("div",{class:"rounded-circle p-3 bg-danger-subtle text-danger d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-x-circle fs-4"})],-1))])])])]),e("div",wt,[e("div",kt,[e("div",Ct,[t[23]||(t[23]=e("h5",{class:"mb-0 fw-semibold"},"Kitchen Orders",-1)),e("div",Tt,[e("div",It,[t[17]||(t[17]=e("i",{class:"bi bi-search"},null,-1)),t[18]||(t[18]=e("input",{type:"email",name:"email",autocomplete:"email",style:{position:"absolute",left:"-9999px",width:"1px",height:"1px"},tabindex:"-1","aria-hidden":"true"},null,-1)),J.value?q((u(),c("input",{id:B,"onUpdate:modelValue":t[0]||(t[0]=s=>O.value=s),key:G.value,class:"form-control search-input",placeholder:"Search",type:"search",autocomplete:"new-password",name:B,role:"presentation",onFocus:t[1]||(t[1]=(...s)=>a.handleFocus&&a.handleFocus(...s))},null,32)),[[Ne,O.value]]):(u(),c("input",Ot))]),y(Ve,{modelValue:x.value,"onUpdate:modelValue":t[2]||(t[2]=s=>x.value=s),title:"Kitchen Orders","modal-id":"kotFilterModal","modal-size":"modal-lg","sort-options":W.value.sortOptions,"show-date-range":!0,onApply:me,showDateRange:!1,"show-stock-status":!1,onClear:pe},{customFilters:ae(({filters:s})=>[e("div",$t,[t[20]||(t[20]=e("label",{class:"form-label fw-semibold text-dark"},[e("i",{class:"fas fa-concierge-bell me-2 text-muted"}),V("Order Type ")],-1)),q(e("select",{"onUpdate:modelValue":l=>s.orderType=l,class:"form-select"},[t[19]||(t[19]=e("option",{value:""},"All",-1)),(u(!0),c(k,null,P(W.value.orderTypeOptions,l=>(u(),c("option",{key:l.value,value:l.value},o(l.label),9,St))),128))],8,Dt),[[le,s.orderType]])]),e("div",Ft,[t[22]||(t[22]=e("label",{class:"form-label fw-semibold text-dark"},[e("i",{class:"fas fa-tasks me-2 text-muted"}),V("Order Status ")],-1)),q(e("select",{"onUpdate:modelValue":l=>s.status=l,class:"form-select"},[t[21]||(t[21]=e("option",{value:""},"All",-1)),(u(!0),c(k,null,P(W.value.statusOptions,l=>(u(),c("option",{key:l.value,value:l.value},o(l.label),9,Nt))),128))],8,Pt),[[le,s.status]])])]),_:1},8,["modelValue","sort-options"]),y(_(ze),{modelValue:M.value,"onUpdate:modelValue":t[3]||(t[3]=s=>M.value=s),options:de,optionLabel:"label",optionValue:"value",placeholder:"Export",class:"export-dropdown",onChange:ie},null,8,["modelValue"])])]),e("div",jt,[e("div",Et,[(u(!0),c(k,null,P(ne.value,s=>(u(),c("button",{key:s.value,onClick:l=>re(s.value),class:C(["btn btn-sm rounded-pill px-4 py-2 d-flex align-items-center gap-2",T.value===s.value?"btn-primary text-white shadow-sm":"btn-outline-secondary"]),style:{"min-width":"120px",transition:"all 0.2s ease"}},[e("i",{class:C(s.icon)},null,2),e("span",null,o(s.label),1),s.value!=="All"?(u(),c("span",{key:0,class:C(["badge rounded-pill ms-1",T.value===s.value?"bg-white text-primary":ce(s.value)]),style:{"min-width":"24px"}},o(H.value[s.value]||0),3)):(u(),c("span",{key:1,class:C(["badge rounded-pill ms-1",T.value===s.value?"bg-white text-primary":"bg-secondary"]),style:{"min-width":"24px"}},o(H.value.All),3))],10,Kt))),128))])]),e("div",At,[e("table",Vt,[t[27]||(t[27]=e("thead",{class:"border-top small text-muted"},[e("tr",null,[e("th",null,"#"),e("th",null,"KOT ID"),e("th",null,"Order ID"),e("th",null,"Customer"),e("th",null,"Order Type"),e("th",null,"Table"),e("th",null,"Items Count"),e("th",null,"Status"),e("th",null,"Date"),e("th",{class:"text-center"},"Actions")])],-1)),e("tbody",null,[S.value?(u(),c("tr",Mt,[...t[24]||(t[24]=[e("td",{colspan:"10",class:"text-center py-5"},[e("div",{class:"d-flex flex-column align-items-center justify-content-center"},[e("div",{class:"spinner-border mb-3",role:"status",style:{color:"#1B1670",width:"3rem",height:"3rem","border-width":"0.3em"}},[e("span",{class:"visually-hidden"},"Loading...")]),e("div",{class:"fw-semibold text-muted"},"Loading KOT orders...")])],-1)])])):(u(),c(k,{key:1},[(u(!0),c(k,null,P(L.value,(s,l)=>(u(),c("tr",{key:s.kot_id},[e("td",null,o((v.value.current_page-1)*v.value.per_page+l+1),1),e("td",Bt,o(s.kot_id),1),e("td",null,o(s.id),1),e("td",null,o(s.customer_name),1),e("td",null,o(s.type?.order_type||"-"),1),e("td",null,o(s.type?.table_number||"-"),1),e("td",null,[e("span",Lt,o(s.item_count)+" items ",1)]),e("td",null,[e("span",{class:C(["badge","rounded-pill",z(s.status)]),style:{"min-width":"90px",display:"inline-flex","justify-content":"center","align-items":"center",height:"25px"}},o(s.status),3)]),e("td",null,o(_(j)(s.created_at)),1),e("td",null,[e("div",Wt,[e("button",{onClick:d=>fe(s),title:"View Items",class:"p-2 rounded-full text-primary hover:bg-gray-100"},[y(_(Re),{class:"w-5 h-5"})],8,zt),R.value.length>0?(u(),c("button",{key:0,class:"p-2 rounded-full text-gray-600 hover:bg-gray-100",onClick:je(d=>Q(s),["prevent"]),title:"Print"},[y(_(oe),{class:"w-5 h-5"})],8,Rt)):F("",!0)])])]))),128)),!S.value&&L.value.length===0?(u(),c("tr",Ut,[e("td",qt,[e("div",Xt,[t[25]||(t[25]=e("i",{class:"bi bi-inbox",style:{"font-size":"2rem",opacity:"0.5","margin-bottom":"0.5rem"}},null,-1)),t[26]||(t[26]=e("div",{class:"fw-semibold"},"No KOT orders found",-1)),e("div",Ht,o(T.value==="All"?"Try adjusting your filters or date range":`No orders with status "${T.value}"`),1)])])])):F("",!0)],64))])])]),!S.value&&v.value.last_page>1?(u(),c("div",Gt,[e("div",Jt," Showing "+o(v.value.from)+" to "+o(v.value.to)+" of "+o(v.value.total)+" items ",1),y(Ee,{pagination:v.value.links,isApiDriven:!0,onPageChanged:ue},null,8,["pagination"])])):F("",!0)])])]),e("div",Qt,[e("div",Yt,[e("div",Zt,[e("div",es,[e("div",ts,[t[29]||(t[29]=e("div",{class:"rounded-circle p-3 bg-white bg-opacity-25 dark:bg-white dark:bg-opacity-10"},[e("i",{class:"bi bi-list-task fs-4"})],-1)),e("div",null,[e("h5",ss," Order Items - KOT #"+o(b.value?.kot_id),1),e("small",as," Order #"+o(b.value?.id)+" | "+o(b.value?.customer_name),1)])]),e("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition transform hover:scale-110",onClick:ee,"data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[...t[30]||(t[30]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",ls,[b.value?(u(),c("div",os,[e("div",ns,[e("div",rs,[t[31]||(t[31]=e("small",{class:"text-muted d-block dark:text-gray-400"},"Order Type",-1)),e("strong",ds,o(b.value.type?.order_type||"-"),1)]),e("div",is,[t[32]||(t[32]=e("small",{class:"text-muted d-block dark:text-gray-400"},"Table Number",-1)),e("strong",cs,o(b.value.type?.table_number||"-"),1)]),e("div",us,[t[33]||(t[33]=e("small",{class:"text-muted d-block dark:text-gray-400"},"Order Status",-1)),e("span",{class:C(["badge","rounded-pill",z(b.value.status)])},o(b.value.status),3)]),e("div",ms,[t[34]||(t[34]=e("small",{class:"text-muted d-block dark:text-gray-400"},"Date",-1)),e("strong",ps,o(_(j)(b.value.created_at)),1)])]),t[37]||(t[37]=e("hr",{class:"my-3 dark:border-gray-600"},null,-1)),e("h6",bs,[t[35]||(t[35]=e("i",{class:"bi bi-basket me-2"},null,-1)),V("Order Items ("+o(b.value.item_count)+") ",1)]),e("div",vs,[e("table",gs,[t[36]||(t[36]=e("thead",null,[e("tr",null,[e("th",{class:"px-3"},"#"),e("th",null,"Item Name"),e("th",null,"Variant"),e("th",null,"Quantity"),e("th",null,"Kitchen Note"),e("th",null,"Ingredients"),e("th",null,"Status"),e("th",{class:"text-center"},"Actions")])],-1)),e("tbody",null,[(u(!0),c(k,null,P(b.value.items,(s,l)=>(u(),c("tr",{key:s.id,class:"dark:border-gray-700"},[e("td",hs,o(l+1),1),e("td",ys,o(s.item_name),1),e("td",null,o(s.variant_name),1),e("td",null,[e("span",_s,o(s.quantity),1)]),e("td",null,[e("small",fs,o(s.item_kitchen_note||"-"),1)]),e("td",null,[e("small",xs,o(s.ingredients?.join(", ")||"-"),1)]),e("td",null,[e("span",{class:C(["badge","rounded-pill",z(s.status)]),style:{"min-width":"80px"}},o(s.status),3)]),e("td",null,[e("div",ws,[e("button",{onClick:d=>E(b.value,s,"Waiting"),title:"Waiting",class:"btn btn-sm p-1 text-warning dark:text-yellow-400 dark:hover:bg-gray-700"},[y(_(Ue),{class:"w-4 h-4"})],8,ks),e("button",{onClick:d=>E(b.value,s,"In Progress"),title:"In Progress",class:"btn btn-sm p-1 text-info dark:text-blue-400 dark:hover:bg-gray-700"},[y(_(Ge),{class:"w-4 h-4"})],8,Cs),e("button",{onClick:d=>E(b.value,s,"Done"),title:"Done",class:"btn btn-sm p-1 text-success dark:text-green-400 dark:hover:bg-gray-700"},[y(_(Xe),{class:"w-4 h-4"})],8,Ts),e("button",{onClick:d=>E(b.value,s,"Cancelled"),title:"Cancelled",class:"btn btn-sm p-1 text-danger dark:text-red-400 dark:hover:bg-gray-700"},[y(_(He),{class:"w-4 h-4"})],8,Is)])])]))),128))])])])])):F("",!0)]),e("div",Os,[e("button",{type:"button",class:"btn btn-secondary rounded-pill px-4 py-2",onClick:ee}," Close "),R.value.length>0?(u(),c("button",{key:0,class:"btn btn-primary rounded-pill px-4",onClick:t[4]||(t[4]=s=>Q(b.value))},[y(_(oe),{class:"w-4 h-4 me-2",style:{display:"inline-block"}}),t[38]||(t[38]=V(" Print Order ",-1))])):F("",!0)])])])])]),_:1})],64))}},Qs=De($s,[["__scopeId","data-v-6c24882f"]]);export{Qs as default};
