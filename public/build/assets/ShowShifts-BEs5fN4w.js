import{_ as I,A as M,r as o,o as U,q as h,s as n,c as O,g as l,b as r,l as p,f as e,F as w,i as A,e as B,u as D,t as y,m as x,v as g}from"./app-DFa9wJfT.js";import{s as E}from"./index-BtyAJPKh.js";import"./index-BjeygHyk.js";import"./index-obOPNEdp.js";const P={key:0,class:"fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center z-50 p-4"},q={class:"relative bg-white rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden flex flex-col max-h-[90vh]"},z={class:"px-6 py-4 overflow-y-auto check-list-body flex-1"},R={class:"mb-6"},T={class:"space-y-3 bg-gray-50 p-4 check-list-item rounded-lg max-h-64 overflow-y-auto grid grid-cols-2 gap-4"},L=["for"],Y={class:"text-sm font-medium text-gray-700 block"},G={key:0,class:"text-xs text-gray-500"},H={class:"mt-4 flex gap-2"},J={class:"mb-6"},K={class:"mb-6"},Q={class:"flex justify-end gap-2 border-t border-gray-100 px-6 py-3 bg-gray-50"},W=["disabled"],X={key:0,class:"spinner-border spinner-border-sm mx-1"},Z={key:1,class:"fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center z-50 p-4"},$={class:"relative bg-white rounded-2xl shadow-2xl w-full max-w-md p-6 flex flex-col items-center"},ee=["disabled"],te={key:0,class:"spinner-border spinner-border-sm"},se={__name:"ShowShifts",setup(ae){const k=M(),_=o(k.props.showShiftModal||!1),S=o(k.props.showNoShiftModal||!1),m=o(""),v=o(""),c=o(!1),d=o(!1),f=o([]),i=o({}),u=o("");U(async()=>{try{const s=await h.get("/shift/checklist-items",{params:{type:"start"}});f.value=s.data.data,f.value.forEach(t=>{i.value[t.id]=!1})}catch(s){console.error("Failed to fetch checklist items:",s),n.error("Failed to load checklist items")}});const C=O(()=>m.value!==""&&Object.values(i.value).some(s=>s===!0)),V=async()=>{if(u.value.trim())try{const s=await h.post("/shift/checklist-items/custom",{name:u.value,type:"start"});if(s.data.success){const t=s.data.data;f.value.push(t),i.value[t.id]=!0,u.value="",n.success("Custom checklist added successfully")}}catch(s){console.error("Failed to add custom checklist:",s),n.error("Failed to add custom checklist")}},F=async()=>{try{c.value=!0;const s=Object.keys(i.value).filter(a=>i.value[a]===!0);(await h.post("/shift/start",{opening_cash:m.value,notes:v.value,checklists:s})).status===200&&(n.success("Shift started successfully!"),window.location.href="/dashboard")}catch(s){console.error(s),n.error(s.response?.data?.message||"Failed to start shift")}finally{c.value=!1}},N=async()=>{try{d.value=!0;const s=await h.post("/shift/check-active-shift");s.data.active?window.location.href=s.data.redirect_url:n.error("Shift is still not active. Please try again later.")}catch(s){console.error(s),n.error("Failed to check shift status")}finally{d.value=!1}};return(s,t)=>(r(),l(w,null,[_.value?(r(),l("div",P,[e("div",q,[t[7]||(t[7]=e("div",{class:"px-6 py-4 border-b border-gray-100"},[e("h2",{class:"text-xl font-semibold text-gray-800"},"Start Shift"),e("p",{class:"text-sm mt-1 text-gray-600"}," Enter opening cash, complete checklist items, and add notes. ")],-1)),e("div",z,[e("div",R,[t[3]||(t[3]=e("h3",{class:"text-sm font-semibold text-white mb-3"}," Daily Safety Checklist ",-1)),t[4]||(t[4]=e("p",{class:"text-xs text-gray-600 mb-4"}," Complete all required checks before opening. You can add your own checks too. ",-1)),e("div",T,[(r(!0),l(w,null,A(f.value,(a,b)=>(r(),l("div",{key:"item-"+b,class:"flex items-start gap-2"},[B(D(E),{modelValue:i.value[a.id],"onUpdate:modelValue":j=>i.value[a.id]=j,inputId:"check-"+b,binary:"",class:"cursor-pointer"},null,8,["modelValue","onUpdate:modelValue","inputId"]),e("label",{for:"check-"+b,class:"flex-1 cursor-pointer"},[e("span",Y,y(a.name),1),a.description?(r(),l("span",G,y(a.description),1)):p("",!0)],8,L)]))),128))]),e("div",H,[x(e("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>u.value=a),type:"text",class:"form-control flex-1",placeholder:"Add your own check..."},null,512),[[g,u.value]]),e("button",{onClick:V,class:"btn btn-outline-secondary px-4 py-2 rounded-lg text-sm"}," Add ")])]),e("div",J,[t[5]||(t[5]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Opening Cash",-1)),x(e("input",{type:"number","onUpdate:modelValue":t[1]||(t[1]=a=>m.value=a),step:"0.01",class:"form-control w-full",placeholder:"0.00"},null,512),[[g,m.value]])]),e("div",K,[t[6]||(t[6]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Notes",-1)),x(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=a=>v.value=a),class:"form-control w-full",rows:"2",placeholder:"Optional notes..."},null,512),[[g,v.value]])])]),e("div",Q,[e("button",{onClick:F,disabled:c.value||!C.value,class:"btn btn-primary py-2 px-4 rounded-pill flex items-center justify-center gap-2 transition disabled:opacity-50 disabled:cursor-not-allowed"},[c.value?(r(),l("span",X)):p("",!0),e("span",null,y(c.value?" Starting...":"Start Shift"),1)],8,W)])])])):p("",!0),S.value?(r(),l("div",Z,[e("div",$,[t[8]||(t[8]=e("h2",{class:"text-xl font-semibold mb-2 text-gray-800"},"No active shift",-1)),t[9]||(t[9]=e("p",{class:"text-sm text-gray-600 mb-4 text-center"}," There is no currently active shift available. Please ask manager or admin to start session or try again later. ",-1)),e("button",{onClick:N,disabled:d.value,class:"btn btn-primary py-2 px-4 w-100 rounded-pill flex items-center justify-center gap-2 transition"},[d.value?(r(),l("span",te)):p("",!0),e("span",null,y(d.value?"Checking...":"Retry"),1)],8,ee)])])):p("",!0)],64))}},ne=I(se,[["__scopeId","data-v-08704717"]]);export{ne as default};
