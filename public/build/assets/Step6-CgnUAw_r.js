import{_ as C,S,w as P,Y as R,r as _,o as T,g as a,b as i,l as m,f as t,m as c,v as w,j as u,t as n,e as g,X as O,Z as b,p as x,u as k,B as U}from"./app-DvoCJ4rQ.js";import{s as h}from"./index-DpmYlLyt.js";import{u as N}from"./useFormatters-BE7Ie_le.js";import"./index-D4izHQ_h.js";import"./index-DHsebJ0t.js";import"./index-CgE8cIOG.js";import"./index-Jx_m_aUp.js";const L={key:0,class:"fw-bold mb-3"},B={class:"row g-4"},D={class:"col-lg-7"},I={key:0,class:"text-danger"},M={class:"row g-3 align-items-start mt-2"},Y={class:"col-md-4 upload-image-area"},F={class:"logo-card"},K=["src"],$={key:1,class:"placeholder"},z={key:0,class:"text-danger"},Q={class:"col-md-8 right-side-receipt-area"},A={key:0,class:"text-danger"},J={class:"mt-3"},X={class:"segmented"},Z={key:0,class:"text-danger"},G={class:"mt-3"},H={class:"segmented"},W={class:"mt-3"},ee={class:"d-flex align-items-center justify-content-end mb-1"},te=["disabled"],se={key:0,class:"text-center py-3"},oe={key:1,class:"alert alert-warning py-2 px-3 rounded-3 mt-3"},le={key:2},ne={key:1,class:"text-danger"},re={class:"col-lg-5"},ae={class:"receipt-card"},ie={class:"text-center"},de={key:0,class:"mb-3 receipt-logo-container"},me=["src"],ue={class:"mb-1"},pe={class:"text-center my-2"},ce={class:"text-muted small"},fe={class:"text-center my-2"},ve={class:"text-muted small"},be={class:"small"},_e={class:"d-flex justify-content-between"},ge={class:"d-flex justify-content-between"},ye={class:"small"},we={class:"d-flex justify-content-between"},xe={class:"d-flex justify-content-between"},ke={class:"small"},he={class:"d-flex justify-content-between"},Ee={key:0,class:"d-flex justify-content-center my-2"},Ve={class:"text-center small"},je={__name:"Step6",props:{model:Object,formErrors:Object,isOnboarding:{type:Boolean,default:!1}},emits:["save"],setup(r,{emit:E}){const o=r,V=E;N();const s=S({receipt_header:o.model?.receipt_header??o.model?.business_name??"Enter store name",receipt_footer:o.model?.receipt_footer??"Thank You for Taste Us",receipt_logo:o.model?.receipt_logo_url??o.model?.logo_url??null,receipt_logo_file:null,show_qr:o.model?.show_qr??1,tax_breakdown:o.model?.tax_breakdown??!0,store_phone:o.model?.phone??"",store_name:o.model?.store_name??o.model?.business_name??"Enter store name",address:o.model?.address??"xyz",customer_printer:o.model?.customer_printer??"",kot_printer:o.model?.kot_printer??""});P(s,()=>V("save",{step:6,data:R(s)}),{deep:!0,immediate:!0});const f=_(!1);function j(){f.value=!0}function q({file:p}){s.receipt_logo_file=p,s.receipt_logo=URL.createObjectURL(p),f.value=!1}const v=_([]),d=_(!1),y=async()=>{d.value=!0;try{const p=await axios.get("/api/printers");v.value=p.data.data.filter(e=>e.is_connected===!0||e.status==="OK").map(e=>({label:`${e.name}`,value:e.name,driver:e.driver,port:e.port}))}catch(p){console.error("Failed to fetch printers:",p)}finally{d.value=!1}};return T(y),(p,e)=>(i(),a("div",null,[o.isOnboarding?(i(),a("h5",L,"Step 6 of 9 - Receipt & Printer Setup")):m("",!0),t("div",B,[t("div",D,[e[20]||(e[20]=t("label",{class:"form-label"},"Receipt header",-1)),c(t("input",{class:u(["form-control",{"is-invalid":r.formErrors?.receipt_header}]),"onUpdate:modelValue":e[0]||(e[0]=l=>s.receipt_header=l)},null,2),[[w,s.receipt_header]]),r.formErrors?.receipt_header?(i(),a("small",I,n(r.formErrors.receipt_header[0]),1)):m("",!0),t("div",M,[t("div",Y,[e[12]||(e[12]=t("small",{class:"text-muted mt-2"},"Upload Receipt Logo",-1)),t("div",F,[t("div",{class:"logo-frame",onClick:e[1]||(e[1]=l=>j())},[s.receipt_logo?(i(),a("img",{key:0,src:s.receipt_logo,alt:"Receipt Logo",class:"receipt-logo-preview"},null,8,K)):(i(),a("div",$,[...e[10]||(e[10]=[t("i",{class:"bi bi-image"},null,-1)])]))]),g(O,{show:f.value,onClose:e[2]||(e[2]=l=>f.value=!1),onCropped:q},null,8,["show"]),e[11]||(e[11]=t("small",{class:"d-block text-center mt-2 text-muted"},"Click to upload/change logo",-1))]),r.formErrors?.receipt_logo_file?(i(),a("small",z,n(r.formErrors.receipt_logo_file[0]),1)):m("",!0)]),t("div",Q,[e[19]||(e[19]=t("label",{class:"form-label"},"Receipt Footer",-1)),c(t("input",{class:u(["form-control",{"is-invalid":r.formErrors?.receipt_footer}]),"onUpdate:modelValue":e[3]||(e[3]=l=>s.receipt_footer=l)},null,2),[[w,s.receipt_footer]]),r.formErrors?.receipt_footer?(i(),a("small",A,n(r.formErrors.receipt_footer[0]),1)):m("",!0),t("div",J,[e[13]||(e[13]=t("label",{class:"form-label d-block mb-2"}," Show QR Code on Receipt ",-1)),t("div",X,[c(t("input",{class:u(["segmented__input",{"is-invalid":r.formErrors?.show_qr}]),type:"radio",id:"qr-yes",value:1,"onUpdate:modelValue":e[4]||(e[4]=l=>s.show_qr=l)},null,2),[[b,s.show_qr,void 0,{number:!0}]]),t("label",{class:u(["segmented__btn",{"is-active":s.show_qr===1}]),for:"qr-yes"},"YES",2),c(t("input",{class:"segmented__input",type:"radio",id:"qr-no",value:0,"onUpdate:modelValue":e[5]||(e[5]=l=>s.show_qr=l)},null,512),[[b,s.show_qr,void 0,{number:!0}]]),t("label",{class:u(["segmented__btn",{"is-active":s.show_qr===0}]),for:"qr-no"},"NO",2),r.formErrors?.show_qr?(i(),a("small",Z,n(r.formErrors.show_qr[0]),1)):m("",!0)])]),t("div",G,[e[14]||(e[14]=t("label",{class:"form-label d-block mb-2"},"Tax Breakdown",-1)),t("div",H,[c(t("input",{class:"segmented__input",type:"radio",id:"tb-yes",value:!0,"onUpdate:modelValue":e[6]||(e[6]=l=>s.tax_breakdown=l)},null,512),[[b,s.tax_breakdown]]),t("label",{class:u(["segmented__btn",{"is-active":s.tax_breakdown===!0}]),for:"tb-yes"},"YES",2),c(t("input",{class:"segmented__input",type:"radio",id:"tb-no",value:!1,"onUpdate:modelValue":e[7]||(e[7]=l=>s.tax_breakdown=l)},null,512),[[b,s.tax_breakdown]]),t("label",{class:u(["segmented__btn",{"is-active":s.tax_breakdown===!1}]),for:"tb-no"},"NO",2)])]),t("div",W,[t("div",ee,[t("button",{type:"button",class:"btn btn-sm btn-outline-primary custom-refresh-btn d-flex align-items-center rounded-pill",onClick:y,disabled:d.value},[t("i",{class:u(["pi pi-refresh me-1 px-1",{"pi-spin":d.value}])},null,2),x(" "+n(d.value?"Refreshing...":"Refresh Printers"),1)],8,te)]),d.value?(i(),a("div",se,[...e[15]||(e[15]=[t("div",{class:"fw-semibold text-secondary mb-2"}," Scanning for printers, please wait... ",-1),t("div",{class:"spinner-border",role:"status",style:{color:"#1c0d82",width:"2rem",height:"2rem"}},[t("span",{class:"visually-hidden"},"Loading...")],-1)])])):v.value.length===0?(i(),a("div",oe,[...e[16]||(e[16]=[t("i",{class:"pi pi-exclamation-triangle me-2"},null,-1),x(' No printers detected. Please connect a printer and click "Refresh Printers". ',-1)])])):(i(),a("div",le,[e[17]||(e[17]=t("label",{class:"form-label d-block mb-2"},"Customer Printer",-1)),g(k(h),{modelValue:s.customer_printer,"onUpdate:modelValue":e[8]||(e[8]=l=>s.customer_printer=l),options:v.value,optionLabel:"label",optionValue:"value",placeholder:"Select POS Printer",loading:d.value,class:"w-100"},null,8,["modelValue","options","loading"]),e[18]||(e[18]=t("label",{class:"form-label d-block mt-3 mb-2"},"KOT Printer",-1)),g(k(h),{modelValue:s.kot_printer,"onUpdate:modelValue":e[9]||(e[9]=l=>s.kot_printer=l),options:v.value,optionLabel:"label",optionValue:"value",placeholder:"Select KOT Printer",loading:d.value,class:"w-100"},null,8,["modelValue","options","loading"])]))]),r.formErrors?.printers?(i(),a("small",ne,n(r.formErrors.printers[0]),1)):m("",!0)])])]),t("div",re,[t("div",ae,[t("div",ie,[s.receipt_logo?(i(),a("div",de,[t("img",{src:s.receipt_logo,alt:"Receipt Logo",class:"receipt-logo-display"},null,8,me)])):m("",!0),t("h6",ue,n(s.receipt_header),1),t("div",pe,[t("div",ce,n(s.store_phone),1)]),t("div",fe,[t("div",ve,n(s.address),1)])]),e[32]||(e[32]=t("hr",{class:"my-2"},null,-1)),t("div",be,[t("div",_e,[e[21]||(e[21]=t("span",null,"Date:",-1)),t("span",null,n(new Date().toLocaleDateString().replace(/\//g,"-")),1)]),t("div",ge,[e[22]||(e[22]=t("span",null,"Time:",-1)),t("span",null,n(new Date().toLocaleTimeString()),1)]),e[23]||(e[23]=U('<div class="d-flex justify-content-between" data-v-cf895b56><span data-v-cf895b56>Customer Name:</span><span data-v-cf895b56>John Snow</span></div><div class="d-flex justify-content-between" data-v-cf895b56><span data-v-cf895b56>Order Type:</span><span data-v-cf895b56>Dine In</span></div><div class="d-flex justify-content-between" data-v-cf895b56><span data-v-cf895b56>Note:</span><span data-v-cf895b56>One Cheese Burger Please</span></div><div class="d-flex justify-content-between" data-v-cf895b56><span data-v-cf895b56>Payment Type:</span><span data-v-cf895b56>Cash/Card</span></div>',4))]),e[33]||(e[33]=t("hr",{class:"my-2"},null,-1)),t("div",ye,[e[28]||(e[28]=t("div",{class:"d-flex justify-content-between fw-semibold"},[t("span",null,"Name"),t("span",null,"Qty"),t("span",null,"Price")],-1)),t("div",we,[e[24]||(e[24]=t("span",null,"Item A",-1)),e[25]||(e[25]=t("span",null,"1",-1)),t("span",null,n(o.model?.currency??"£")+" 950 ",1)]),t("div",xe,[e[26]||(e[26]=t("span",null,"Item B",-1)),e[27]||(e[27]=t("span",null,"2",-1)),t("span",null,n(o.model?.currency??"£")+" 50",1)])]),e[34]||(e[34]=t("hr",{class:"my-2"},null,-1)),t("div",ke,[t("div",he,[e[29]||(e[29]=t("span",null,"Total Price:",-1)),t("span",null,n(o.model?.currency??"£")+" 2000",1)]),e[30]||(e[30]=t("div",{class:"d-flex justify-content-between"},[t("span",null,"Tax:"),t("span",null,"23%")],-1))]),s.show_qr===1?(i(),a("div",Ee,[...e[31]||(e[31]=[t("div",{class:"qr-box","aria-hidden":"true"},null,-1)])])):m("",!0),e[35]||(e[35]=t("hr",{class:"my-2"},null,-1)),t("div",Ve,n(s.receipt_footer||"Thank you!"),1)])])])]))}},Ue=C(je,[["__scopeId","data-v-cf895b56"]]);export{Ue as default};
