import{_ as Se}from"./Master-Byc-9el0.js";import{_ as ke,r as S,c as L,w as De,o as ae,I as Te,n as Re,g as d,b as u,e as D,u as m,h as Pe,d as Ce,f as e,l as v,p as x,J as E,F as p,t as i,i as j,K as z,q as oe}from"./app-CCSEjIT4.js";import{u as Le}from"./useFormatters-DQEMZb3n.js";import{s as V}from"./index-FDc3FNfE.js";import{s as Ae}from"./index-D7k8c467.js";import{E as Me,a as je,u as B,w as Ve}from"./xlsx-D9vfwJJ2.js";import"./index-B5eCIMEK.js";import"./createLucideIcon-bhPlb3RE.js";import"./index-Bm9uMUox.js";import"./index-BQdLG6Qw.js";import"./sun-BVEIikp2.js";import"./index-Kclx_GWY.js";import"./index-CUHCErLp.js";import"./index-DIvh2939.js";const Oe={class:"page-wrapper"},Ie={class:"d-flex flex-wrap gap-2 align-items-center justify-content-between mb-3"},Ne={class:"card border-0 shadow-sm rounded-4 mb-4"},$e={class:"card-body"},Ue={class:"row g-3"},Ye={class:"col-md-3"},Fe={class:"col-md-3"},qe={key:0,class:"col-md-3"},Qe={key:1,class:"col-md-2"},Ee={key:2,class:"col-md-2"},ze={key:3,class:"col-md-3"},Be={key:4,class:"col-md-2"},Je={key:5,class:"col-md-2"},Ge={class:"row g-3 mb-4"},Ke={class:"col-md-6 col-xl-3"},Xe={class:"card border-0 shadow-sm rounded-4"},He={class:"card-body d-flex align-items-center justify-content-between"},We={class:"mb-0 fw-bold"},Ze={class:"col-md-6 col-xl-3"},et={class:"card border-0 shadow-sm rounded-4"},tt={class:"card-body d-flex align-items-center justify-content-between"},st={class:"mb-0 fw-bold"},lt={class:"col-md-6 col-xl-3"},at={class:"card border-0 shadow-sm rounded-4"},ot={class:"card-body d-flex align-items-center justify-content-between"},nt={class:"mb-0 fw-bold"},it={class:"col-md-6 col-xl-3"},dt={class:"card border-0 shadow-sm rounded-4"},ut={class:"card-body d-flex align-items-center justify-content-between"},rt={class:"mb-0 fw-bold"},ct={class:"col-md-6 col-xl-3"},mt={class:"card border-0 shadow-sm rounded-4"},vt={class:"card-body d-flex align-items-center justify-content-between"},yt={class:"mb-0 fw-bold"},pt={class:"col-md-6 col-xl-3"},ht={class:"card border-0 shadow-sm rounded-4"},bt={class:"card-body d-flex align-items-center justify-content-between"},gt={class:"mb-0 fw-bold"},_t={class:"col-md-6 col-xl-3"},ft={class:"card border-0 shadow-sm rounded-4"},xt={class:"card-body d-flex align-items-center justify-content-between"},wt={class:"mb-0 fw-bold"},St={class:"col-md-6 col-xl-3"},kt={class:"card border-0 shadow-sm rounded-4"},Dt={class:"card-body d-flex align-items-center justify-content-between"},Tt={class:"mb-0 fw-bold"},Rt={class:"col-md-6 col-xl-3"},Pt={class:"card border-0 shadow-sm rounded-4"},Ct={class:"card-body d-flex align-items-center justify-content-between"},Lt={class:"mb-0 fw-bold"},At={class:"col-md-6 col-xl-3"},Mt={class:"card border-0 shadow-sm rounded-4"},jt={class:"card-body d-flex align-items-center justify-content-between"},Vt={class:"mb-0 fw-bold"},Ot={class:"col-md-6 col-xl-3"},It={class:"card border-0 shadow-sm rounded-4"},Nt={class:"card-body d-flex align-items-center justify-content-between"},$t={class:"mb-0 fw-bold"},Ut={class:"col-md-6 col-xl-3"},Yt={class:"card border-0 shadow-sm rounded-4"},Ft={class:"card-body d-flex align-items-center justify-content-between"},qt={class:"mb-0 fw-bold"},Qt={class:"col-md-6 col-xl-3"},Et={class:"card border-0 shadow-sm rounded-4"},zt={class:"card-body d-flex align-items-center justify-content-between"},Bt={class:"mb-0 fw-bold"},Jt={class:"col-md-6 col-xl-3"},Gt={class:"card border-0 shadow-sm rounded-4"},Kt={class:"card-body d-flex align-items-center justify-content-between"},Xt={class:"mb-0 fw-bold"},Ht={class:"col-md-6 col-xl-3"},Wt={class:"card border-0 shadow-sm rounded-4"},Zt={class:"card-body d-flex align-items-center justify-content-between"},es={class:"mb-0 fw-bold"},ts={class:"col-md-6 col-xl-3"},ss={class:"card border-0 shadow-sm rounded-4"},ls={class:"card-body d-flex align-items-center justify-content-between"},as={class:"mb-0 fw-bold"},os={class:"col-md-6 col-xl-3"},ns={class:"card border-0 shadow-sm rounded-4"},is={class:"card-body d-flex align-items-center justify-content-between"},ds={class:"mb-0 fw-bold"},us={class:"col-md-6 col-xl-3"},rs={class:"card border-0 shadow-sm rounded-4"},cs={class:"card-body d-flex align-items-center justify-content-between"},ms={class:"mb-0 fw-bold"},vs={class:"col-md-6 col-xl-3"},ys={class:"card border-0 shadow-sm rounded-4"},ps={class:"card-body d-flex align-items-center justify-content-between"},hs={class:"mb-0 fw-bold"},bs={class:"col-md-6 col-xl-3"},gs={class:"card border-0 shadow-sm rounded-4"},_s={class:"card-body d-flex align-items-center justify-content-between"},fs={class:"mb-0 fw-bold"},xs={class:"col-md-6 col-xl-3"},ws={class:"card border-0 shadow-sm rounded-4"},Ss={class:"card-body d-flex align-items-center justify-content-between"},ks={class:"mb-0 fw-bold"},Ds={class:"col-md-6 col-xl-3"},Ts={class:"card border-0 shadow-sm rounded-4"},Rs={class:"card-body d-flex align-items-center justify-content-between"},Ps={class:"mb-0 fw-bold"},Cs={class:"col-md-6 col-xl-3"},Ls={class:"card border-0 shadow-sm rounded-4"},As={class:"card-body d-flex align-items-center justify-content-between"},Ms={class:"mb-0 fw-bold"},js={class:"col-md-6 col-xl-3"},Vs={class:"card border-0 shadow-sm rounded-4"},Os={class:"card-body d-flex align-items-center justify-content-between"},Is={class:"mb-0 fw-bold"},Ns={key:0,class:"alert alert-warning border-0 rounded-4 shadow-sm"},$s={class:"card border-0 shadow-sm rounded-4 mt-3"},Us={class:"card-body"},Ys={class:"table-responsive"},Fs={class:"table table-hover align-middle"},qs={class:"small text-muted"},Qs={key:0},Es={key:1},zs={key:2},Bs={key:3},Js={key:4},Gs={key:5,style:{width:"150px"}},Ks={key:6,style:{width:"100px"}},Xs={key:7,style:{width:"100px"}},Hs={key:0},Ws={key:1},Zs={key:2,style:{width:"100px"}},el={key:3},tl={key:4,style:{width:"150px"}},sl={key:5,style:{width:"150px"}},ll={key:6,style:{width:"130px"}},al={key:7,style:{width:"150px"}},ol={key:8,style:{width:"120px"}},nl={key:9,style:{width:"100px"}},il={class:"fw-semibold"},dl={key:0,class:"small"},ul={key:1,class:"small"},rl={class:"fw-bold text-success"},cl={key:2,class:"small"},ml={class:"fw-semibold"},vl={key:0,class:"fw-semibold"},yl={key:1,class:"small"},pl={key:0,class:"text-muted"},hl={key:1,class:"text-secondary"},bl={key:2,class:"small"},gl={class:"fw-bold text-success"},_l={key:3,class:"small"},fl={key:4},xl={key:0,class:"badge bg-success-subtle text-success px-3 py-2 rounded-pill"},wl={key:1,class:"badge bg-warning-subtle text-warning px-3 py-2 rounded-pill"},Sl={key:2,class:"badge bg-secondary-subtle text-secondary px-3 py-2 rounded-pill"},kl={class:"fw-semibold"},Dl={class:"fw-semibold"},Tl={key:0,class:"badge bg-success-subtle text-success"},Rl={key:1,class:"badge bg-warning-subtle text-warning"},Pl={key:2,class:"badge bg-danger-subtle text-danger"},Cl={class:"fw-semibold"},Ll={class:"fw-semibold"},Al={key:0,class:"table-active fw-bold border-top border-3"},Ml={class:"text-success"},jl={key:1,class:"table-active fw-bold border-top border-3"},Vl={key:2},Ol={key:3},Il={class:"row g-3"},Nl={class:"col-lg-8"},$l={class:"card border-0 shadow-sm rounded-4 h-100"},Ul={class:"card-body"},Yl={class:"fw-semibold mb-2"},Fl={class:"chart"},ql={viewBox:"0 0 840 280"},Ql=["y1","y2"],El=["x","y"],zl=["x","y"],Bl=["d"],Jl=["d"],Gl={key:2},Kl={key:3,x:"430",y:"140","text-anchor":"middle",fill:"#6b7280"},Xl={class:"col-lg-4"},Hl={class:"card border-0 shadow-sm rounded-4 mb-3"},Wl={class:"card-body"},Zl={class:"stack-row"},ea={class:"stack-val"},ta={class:"progress thin"},sa={class:"card border-0 shadow-sm rounded-4"},la={class:"card-body"},aa={class:"stack"},oa={class:"stack-row"},na={class:"stack-val"},ia={class:"stack-row"},da={class:"stack-val"},ua={class:"stack-row"},ra={class:"stack-val"},ca={class:"stack-row"},ma={__name:"Index",setup(va){const{formatNumber:w,formatCurrencySymbol:n,dateFmt:T}=Le(),s=S({type:"sales",timeRange:"monthly",selectedMonth:"",selectedYear:"",selectedDate:"",selectedYear:"",dateFrom:"",dateTo:"",orderType:"",paymentType:""}),$=S(null),ne=[{label:"PDF",value:"pdf"},{label:"Excel",value:"excel"},{label:"CSV",value:"csv"}],ie=async r=>{r&&(r==="pdf"?he():r==="excel"?be():r==="csv"&&await ge(),$.value=null)},de=[{label:"Sales Analytics",value:"sales"},{label:"Purchase Analytics",value:"purchase"},{label:"Sales vs Purchase",value:"comparison"},{label:"Stock Analysis",value:"stock"},{label:"Cashier Performance",value:"userSales"},{label:"Category Analysis",value:"category"}],ue=[{label:"Daily",value:"daily"},{label:"Monthly",value:"monthly"},{label:"Yearly",value:"yearly"},{label:"Custom Range",value:"custom"}],R=S(!1),k=S(""),re=S(Date.now()),ce=`search-${Math.random().toString(36).substr(2,9)}`,me=S(!1),U=S(""),_=S({}),Y=S([]),P=S([]),J=S([]),c=S({}),G=S("Just now"),K=S(0),ve=L(()=>{const r=[],t=["January","February","March","April","May","June","July","August","September","October","November","December"];for(let a=1;a<=12;a++){const l=String(a).padStart(2,"0");r.push({value:l,label:t[a-1]})}return r}),X=L(()=>{const r=new Date().getFullYear(),t=[];for(let a=r;a>=r-10;a--)t.push(a);return t}),H=L(()=>({sales:"Sales Over Time",purchase:"Purchase Over Time",comparison:"Sales vs Purchase",stock:"Stock Trend",userSales:"Cashier Performance",category:"Category Distribution"})[s.value.type]||"Chart"),W=L(()=>{if(s.value.timeRange==="daily")return s.value.selectedDate?`Date: ${s.value.selectedDate}`:"Select a date";if(s.value.timeRange==="monthly"){const t=["January","February","March","April","May","June","July","August","September","October","November","December"][parseInt(s.value.selectedMonth)-1]||"";return s.value.selectedMonth&&s.value.selectedYear?`${t} ${s.value.selectedYear}`:"Select month and year"}return s.value.timeRange==="yearly"?s.value.selectedYear?`Year: ${s.value.selectedYear}`:"Select a year":s.value.dateFrom&&s.value.dateTo?`${s.value.dateFrom} to ${s.value.dateTo}`:"Select dates"});function ye(r,t,a,l={l:50,r:20,t:40,b:50}){if(!r?.length)return{paths:[],xLabels:[],yLabels:[]};const b=r.map((y,f)=>f),o=r.map(y=>+y.total||+y.sales||+y.purchase||+y.value||0),g=r.map(y=>+y.purchase||0),I=0,_e=Math.max(1,b.length-1),fe=[...o,...g].filter(y=>y>0),Z=0,ee=Math.max(1,...fe),xe=Math.max(1,t-l.l-l.r),F=Math.max(1,a-l.t-l.b),A=y=>l.l+(y-I)/(_e-I)*xe,M=y=>l.t+F-(y-Z)/(ee-Z)*F;let q="";if(b.length===1){const y=A(0),f=M(o[0]);q=`M${y},${f} L${y+.01},${f}`}else q=b.map((y,f)=>`${f?"L":"M"}${A(y)},${M(o[f])}`).join(" ");let Q="";if(g.some(y=>y>0))if(b.length===1){const y=A(0),f=M(g[0]);Q=`M${y},${f} L${y+.01},${f}`}else Q=b.map((y,f)=>`${f?"L":"M"}${A(y)},${M(g[f])}`).join(" ");const we=r.map((y,f)=>{let N;if(y.date){const le=new Date(y.date);y.date.length===7&&y.date.includes("-")?N=le.toLocaleDateString("en-US",{month:"short"}):N=le.toLocaleDateString("en-US",{weekday:"short"})}else N=`Day ${f+1}`;return{x:A(f),y:l.t+F+20,text:N}}),te=5,se=[];for(let y=0;y<=te;y++){const f=ee/te*y;se.push({x:l.l-10,y:M(f),text:Math.round(f).toLocaleString()})}return{salesPath:q,purchasePath:Q,xLabels:we,yLabels:se}}const C=L(()=>ye(Y.value,840,280)),h=L(()=>{const r=U.value.trim().toLowerCase();return s.value.type!=="sales"?r?(P.value||[]).filter(t=>[t.name,t.cashierName,t.categoryName,t.metric].filter(Boolean).join(" ").toLowerCase().includes(r)):P.value||[]:r?(P.value||[]).filter(t=>[String(t.id),t.customer_name].filter(Boolean).join(" ").toLowerCase().includes(r)):P.value||[]}),pe=()=>{s.value.selectedMonth="",s.value.selectedYear="",s.value.selectedDate="",s.value.dateFrom="",s.value.dateTo=""},O=async()=>{if(s.value.timeRange==="daily"&&!s.value.selectedDate){k.value="Please select a date";return}if(s.value.timeRange==="monthly"&&(!s.value.selectedMonth||!s.value.selectedYear)){k.value="Please select both month and year";return}if(s.value.timeRange==="monthly"&&!s.value.selectedMonth){k.value="Please select a month";return}if(s.value.timeRange==="yearly"&&!s.value.selectedYear){k.value="Please select a year";return}if(s.value.timeRange==="custom"&&(!s.value.dateFrom||!s.value.dateTo)){k.value="Please select both start and end dates";return}R.value=!0,k.value="";try{const{data:r}=await oe.get("/api/analytics",{params:{type:s.value.type,timeRange:s.value.timeRange,selectedMonth:s.value.selectedMonth,selectedYear:s.value.selectedYear,selectedDate:s.value.selectedDate,dateFrom:s.value.dateFrom,dateTo:s.value.dateTo,orderType:s.value.orderType,paymentType:s.value.paymentType}});_.value=r.kpi||{},Y.value=r.chartData||[],P.value=r.tableData||[],J.value=r.distributionData||[],c.value=r.totalsSummary||{},K.value=P.value.length,G.value=new Date().toLocaleTimeString()}catch(r){console.error(r),k.value=r.response?.data?.message||"Failed to load analytics"}finally{R.value=!1}};De(()=>[s.value.type,s.value.timeRange,s.value.selectedMonth,s.value.selectedYear,s.value.selectedDate],()=>{s.value.type&&s.value.timeRange&&(s.value.timeRange==="daily"&&s.value.selectedDate||s.value.timeRange==="monthly"&&s.value.selectedMonth&&s.value.selectedYear||s.value.timeRange==="yearly"&&s.value.selectedYear||s.value.timeRange==="custom"&&s.value.dateFrom&&s.value.dateTo)&&O()}),ae(()=>window.feather?.replace()),Te(()=>window.feather?.replace()),ae(async()=>{const r=new Date;s.value.selectedMonth=String(r.getMonth()+1).padStart(2,"0"),s.value.selectedYear=r.getFullYear(),U.value="",re.value=Date.now(),await Re(),setTimeout(()=>{me.value=!0;const t=document.getElementById(ce);t&&(t.value="",U.value="")},100)});const he=()=>{try{const r=new Me("l","mm","a4");r.setFontSize(18),r.setFont("helvetica","bold"),r.text(`${H.value}`,14,20),r.setFontSize(10),r.setFont("helvetica","normal");const t=new Date().toLocaleString();r.text(`Generated on: ${t}`,14,28),r.text(`Period: ${W.value}`,14,34),r.text(`Total Records: ${h.value.length}`,14,40);let a=[],l=[];if(s.value.type==="sales"){if(s.value.timeRange==="monthly"?(a=["S.#","Day","Orders","Items","Qty","Sub Total","Tax","Service","Delivery","Sales Disc.","Approved Disc.","Promo Disc.","Total"],l=h.value.map((o,g)=>[g+1,"Day "+new Date(o.order_date).getDate(),o.order_count,o.item_count,o.total_qty,n(o.sub_total),n(o.tax),n(o.service_charges),n(o.delivery_charges),n(o.sales_discount),n(o.approved_discounts),n(o.promo_discount),n(o.total_amount)])):s.value.timeRange==="yearly"?(a=["S.#","Month","Orders","Items","Qty","Sub Total","Tax","Service","Delivery","Sales Disc.","Approved Disc.","Promo Disc.","Total"],l=h.value.map((o,g)=>[g+1,new Date(o.order_month+"-01").toLocaleDateString("en-US",{month:"long",year:"numeric"}),o.order_count,o.item_count,o.total_qty,n(o.sub_total),n(o.tax),n(o.service_charges),n(o.delivery_charges),n(o.sales_discount),n(o.approved_discounts),n(o.promo_discount),n(o.total_amount)])):(a=["S.#","Order ID","Customer","Items","Qty","Sub Total","Tax","Service","Delivery","Sales Disc.","Approved Disc.","Promo Disc.","Promos","Promo Type","Total","Date"],l=h.value.map((o,g)=>[g+1,o.id,o.customer_name||"-",o.item_count,o.total_qty,n(o.sub_total),n(o.tax),n(o.service_charges),n(o.delivery_charges),n(o.sales_discount),n(o.approved_discounts),n(o.promo_discount),o.promo_names||"-",o.promo_types||"-",n(o.total_amount),T(o.order_date)])),c.value&&h.value.length>0){const o=s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?["TOTAL","-","-",c.value.item_count,c.value.total_qty,n(c.value.sub_total),n(c.value.tax),n(c.value.service_charges),n(c.value.delivery_charges),n(c.value.sales_discount),n(c.value.approved_discounts),n(c.value.promo_discount),n(c.value.total_amount)]:["TOTAL","-","-",c.value.item_count,c.value.total_qty,n(c.value.sub_total),n(c.value.tax),n(c.value.service_charges),n(c.value.delivery_charges),n(c.value.sales_discount),n(c.value.approved_discounts),n(c.value.promo_discount),"-","-",n(c.value.total_amount),"-"];l.push(o)}}else if(s.value.type==="purchase"){if(s.value.timeRange==="monthly"?(a=["S.#","Day","Purchases","Quantity","Unit Price","Sub Total","Suppliers","Total Amount"],l=h.value.map((o,g)=>[g+1,"Day "+new Date(o.purchase_date).getDate(),o.purchase_count,o.quantity,n(o.total_unit_price),n(o.sub_total),o.supplier_names||"-",n(o.total_amount)])):s.value.timeRange==="yearly"?(a=["S.#","Month","Purchases","Quantity","Unit Price","Sub Total","Suppliers","Total Amount"],l=h.value.map((o,g)=>[g+1,new Date(o.purchase_month+"-01").toLocaleDateString("en-US",{month:"long",year:"numeric"}),o.purchase_count,o.quantity,n(o.total_unit_price),n(o.sub_total),o.supplier_names||"-",n(o.total_amount)])):(a=["S.#","Purchase ID","Supplier","Product","Quantity","Unit Price","Sub Total","Expiry","Purchase Date","Status"],l=h.value.map((o,g)=>[g+1,o.purchase_id,o.supplier_name||"-",o.product_name||"-",o.quantity,n(o.unit_price),n(o.sub_total),o.expiry_date?T(o.expiry_date):"N/A",T(o.purchase_date),o.status||"-"])),c.value&&h.value.length>0){const o=s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?["TOTAL","-","-",c.value.quantity,n(c.value.total_unit_price),n(c.value.sub_total),"-",n(c.value.total_amount)]:["TOTAL","-","-","-",c.value.quantity,n(c.value.total_unit_price),n(c.value.sub_total),"-","-","-"];l.push(o)}}else s.value.type==="comparison"?(a=["S.#","Metric","Sales","Purchase","Difference"],l=h.value.map((o,g)=>[g+1,o.metric,n(o.sales),n(o.purchase),n(o.difference)])):s.value.type==="stock"?(a=["S.#","Item","Current Stock","Min Level","Status"],l=h.value.map((o,g)=>[g+1,o.name,o.currentStock,o.minLevel,o.currentStock>o.minLevel?"In Stock":o.currentStock>0?"Low Stock":"Out of Stock"])):s.value.type==="userSales"?(a=["S.#","Cashier Name","Orders","Total Sales","Avg Sale"],l=h.value.map((o,g)=>[g+1,o.cashierName,o.orderCount,n(o.totalSales),n(o.avgSale)])):s.value.type==="category"&&(a=["S.#","Category","Qty Sold","Revenue","% of Total"],l=h.value.map((o,g)=>[g+1,o.categoryName,o.qty,n(o.revenue),o.percentage+"%"]));je(r,{head:[a],body:l,startY:46,styles:{fontSize:7,cellPadding:2,halign:"left",lineColor:[0,0,0],lineWidth:.1},headStyles:{fillColor:[41,128,185],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]},margin:{left:14,right:14},didDrawPage:o=>{const g=r.internal.getNumberOfPages(),I=r.internal.pageSize.height;r.setFontSize(8),r.text(`Page ${o.pageNumber} of ${g}`,o.settings.margin.left,I-10)}});const b=`${s.value.type}_Analytics_${new Date().toISOString().split("T")[0]}.pdf`;r.save(b)}catch(r){console.error("PDF generation error:",r),k.value=`PDF generation failed: ${r.message}`}},be=()=>{let r=[];if(s.value.type==="sales"){if(s.value.timeRange==="monthly"?r=h.value.map((l,b)=>({"S.#":b+1,Day:"Day "+new Date(l.order_date).getDate(),Orders:l.order_count,"Item Count":l.item_count,"Total Qty":l.total_qty,"Sub Total":l.sub_total,Tax:l.tax,"Service Charge":l.service_charges,"Delivery Charge":l.delivery_charges,"Sales Discount":l.sales_discount,"Approved Discount":l.approved_discounts,"Promo Discount":l.promo_discount,"Total Amount":l.total_amount})):s.value.timeRange==="yearly"?r=h.value.map((l,b)=>({"S.#":b+1,Month:new Date(l.order_month+"-01").toLocaleDateString("en-US",{month:"long",year:"numeric"}),Orders:l.order_count,"Item Count":l.item_count,"Total Qty":l.total_qty,"Sub Total":l.sub_total,Tax:l.tax,"Service Charge":l.service_charges,"Delivery Charge":l.delivery_charges,"Sales Discount":l.sales_discount,"Approved Discount":l.approved_discounts,"Promo Discount":l.promo_discount,"Total Amount":l.total_amount})):r=h.value.map((l,b)=>({"S.#":b+1,"Order ID":l.id,"Customer Name":l.customer_name,"Item Count":l.item_count,"Total Qty":l.total_qty,"Sub Total":l.sub_total,Tax:l.tax,"Service Charge":l.service_charges,"Delivery Charge":l.delivery_charges,"Sales Discount":l.sales_discount,"Approved Discount":l.approved_discounts,"Promo Discount":l.promo_discount,"Applied Promos":l.promo_names,"Promo Type":l.promo_types,"Total Amount":l.total_amount,Date:T(l.order_date)})),c.value){const l=s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?{"S.#":"TOTAL",[s.value.timeRange==="monthly"?"Day":"Month"]:"-",Orders:"-","Item Count":c.value.item_count,"Total Qty":c.value.total_qty,"Sub Total":c.value.sub_total,Tax:c.value.tax,"Service Charge":c.value.service_charges,"Delivery Charge":c.value.delivery_charges,"Sales Discount":c.value.sales_discount,"Approved Discount":c.value.approved_discounts,"Promo Discount":c.value.promo_discount,"Total Amount":c.value.total_amount}:{"S.#":"TOTAL","Order ID":"-","Customer Name":"-","Item Count":c.value.item_count,"Total Qty":c.value.total_qty,"Sub Total":c.value.sub_total,Tax:c.value.tax,"Service Charge":c.value.service_charges,"Delivery Charge":c.value.delivery_charges,"Sales Discount":c.value.sales_discount,"Approved Discount":c.value.approved_discounts,"Promo Discount":c.value.promo_discount,"Applied Promos":"-","Promo Type":"-","Total Amount":c.value.total_amount,Date:"-"};r.push(l)}}else if(s.value.type==="purchase"){if(s.value.timeRange==="monthly"?r=h.value.map((l,b)=>({"S.#":b+1,Day:"Day "+new Date(l.purchase_date).getDate(),Purchases:l.purchase_count,Quantity:l.quantity,"Unit Price":l.total_unit_price,"Sub Total":l.sub_total,Suppliers:l.supplier_names,"Total Amount":l.total_amount})):s.value.timeRange==="yearly"?r=h.value.map((l,b)=>({"S.#":b+1,Month:new Date(l.purchase_month+"-01").toLocaleDateString("en-US",{month:"long",year:"numeric"}),Purchases:l.purchase_count,Quantity:l.quantity,"Unit Price":l.total_unit_price,"Sub Total":l.sub_total,Suppliers:l.supplier_names,"Total Amount":l.total_amount})):r=h.value.map((l,b)=>({"S.#":b+1,"Purchase ID":l.purchase_id,"Supplier Name":l.supplier_name,"Product Name":l.product_name,Quantity:l.quantity,"Unit Price":l.unit_price,"Sub Total":l.sub_total,"Expiry Date":l.expiry_date?T(l.expiry_date):"N/A","Purchase Date":T(l.purchase_date),Status:l.status})),c.value){const l=s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?{"S.#":"TOTAL",[s.value.timeRange==="monthly"?"Day":"Month"]:"-",Purchases:"-",Quantity:c.value.quantity,"Unit Price":c.value.total_unit_price,"Sub Total":c.value.sub_total,Suppliers:"-","Total Amount":c.value.total_amount}:{"S.#":"TOTAL","Purchase ID":"-","Supplier Name":"-","Product Name":"-",Quantity:c.value.quantity,"Unit Price":c.value.total_unit_price,"Sub Total":c.value.sub_total,"Expiry Date":"-","Purchase Date":"-",Status:"-"};r.push(l)}}else s.value.type==="comparison"?r=h.value.map((l,b)=>({"S.#":b+1,Metric:l.metric,Sales:l.sales,Purchase:l.purchase,Difference:l.difference})):s.value.type==="stock"?r=h.value.map((l,b)=>({"S.#":b+1,Item:l.name,"Current Stock":l.currentStock,"Min Level":l.minLevel,Status:l.currentStock>l.minLevel?"In Stock":l.currentStock>0?"Low Stock":"Out of Stock"})):s.value.type==="userSales"?r=h.value.map((l,b)=>({"S.#":b+1,"Cashier Name":l.cashierName,Orders:l.orderCount,"Total Sales":l.totalSales,"Avg Sale":l.avgSale})):s.value.type==="category"&&(r=h.value.map((l,b)=>({"S.#":b+1,Category:l.categoryName,"Qty Sold":l.qty,Revenue:l.revenue,"% of Total":l.percentage+"%"})));const t=B.json_to_sheet(r),a=B.book_new();B.book_append_sheet(a,t,s.value.type),Ve(a,`${s.value.type}-analytics-${Date.now()}.xlsx`)},ge=async()=>{try{const r=await oe.get("/api/analytics/export-csv",{params:{type:s.value.type,timeRange:s.value.timeRange,selectedMonth:s.value.selectedMonth,selectedYear:s.value.selectedYear,selectedDate:s.value.selectedDate,dateFrom:s.value.dateFrom,dateTo:s.value.dateTo,orderType:s.value.orderType,paymentType:s.value.paymentType},responseType:"blob"}),t=window.URL.createObjectURL(new Blob([r.data])),a=document.createElement("a");a.href=t,a.setAttribute("download",`${s.value.type}_analytics_${Date.now()}.csv`),document.body.appendChild(a),a.click(),a.remove()}catch(r){console.error("CSV download error:",r),k.value="Failed to download CSV"}};return(r,t)=>(u(),d(p,null,[D(m(Pe),{title:"Analytics"}),D(Se,null,{default:Ce(()=>[e("div",Oe,[e("div",Ie,[t[9]||(t[9]=e("h4",{class:"mb-1"},"Analytics & Reports",-1)),t[10]||(t[10]=e("div",null,null,-1)),D(m(Ae),{modelValue:$.value,"onUpdate:modelValue":[t[0]||(t[0]=a=>$.value=a),ie],options:ne,optionLabel:"label",optionValue:"value",placeholder:"Export",class:"export-select"},null,8,["modelValue"])]),e("div",Ne,[e("div",$e,[e("div",Ue,[e("div",Ye,[t[11]||(t[11]=e("label",{class:"form-label fw-semibold text-dark"},[e("i",{class:"fas fa-chart-bar me-2 text-muted"}),x("Analytics Type ")],-1)),D(m(V),{modelValue:s.value.type,"onUpdate:modelValue":t[1]||(t[1]=a=>s.value.type=a),options:de,optionLabel:"label",optionValue:"value",placeholder:"Select Analytics Type",class:"w-100"},null,8,["modelValue"])]),e("div",Fe,[t[12]||(t[12]=e("label",{class:"form-label fw-semibold text-dark"},[e("i",{class:"fas fa-calendar-alt me-2 text-muted"}),x("Time Range ")],-1)),D(m(V),{modelValue:s.value.timeRange,"onUpdate:modelValue":t[2]||(t[2]=a=>s.value.timeRange=a),options:ue,optionLabel:"label",optionValue:"value",placeholder:"Select Time Range",onChange:pe,class:"w-100"},null,8,["modelValue"])]),s.value.timeRange==="daily"?(u(),d("div",qe,[t[13]||(t[13]=e("label",{class:"form-label fw-semibold text-dark"},[e("i",{class:"fas fa-calendar me-2 text-muted"}),x("Select Date ")],-1)),D(m(E),{modelValue:s.value.selectedDate,"onUpdate:modelValue":t[3]||(t[3]=a=>s.value.selectedDate=a),placeholder:"Choose Date",format:"yyyy-MM-dd","enable-time-picker":!1,"single-calendar":""},null,8,["modelValue"])])):v("",!0),s.value.timeRange==="monthly"?(u(),d("div",Qe,[t[14]||(t[14]=e("label",{class:"form-label fw-semibold text-dark"},[e("i",{class:"fas fa-calendar me-2 text-muted"}),x("Select Month ")],-1)),D(m(V),{modelValue:s.value.selectedMonth,"onUpdate:modelValue":t[4]||(t[4]=a=>s.value.selectedMonth=a),options:ve.value,optionLabel:"label",optionValue:"value",placeholder:"Choose Month",class:"w-100"},null,8,["modelValue","options"])])):v("",!0),s.value.timeRange==="monthly"?(u(),d("div",Ee,[t[15]||(t[15]=e("label",{class:"form-label fw-semibold text-dark"},[e("i",{class:"fas fa-calendar me-2 text-muted"}),x("Select Year ")],-1)),D(m(V),{modelValue:s.value.selectedYear,"onUpdate:modelValue":t[5]||(t[5]=a=>s.value.selectedYear=a),options:X.value,placeholder:"Choose Year",class:"w-100"},null,8,["modelValue","options"])])):v("",!0),s.value.timeRange==="yearly"?(u(),d("div",ze,[t[16]||(t[16]=e("label",{class:"form-label fw-semibold text-dark"},[e("i",{class:"fas fa-calendar me-2 text-muted"}),x("Select Year ")],-1)),D(m(V),{modelValue:s.value.selectedYear,"onUpdate:modelValue":t[6]||(t[6]=a=>s.value.selectedYear=a),options:X.value,placeholder:"Choose Year",class:"w-100"},null,8,["modelValue","options"])])):v("",!0),s.value.timeRange==="custom"?(u(),d("div",Be,[t[17]||(t[17]=e("label",{class:"form-label fw-semibold text-dark"},[e("i",{class:"fas fa-calendar me-2 text-muted"}),x("Start Date ")],-1)),D(m(E),{modelValue:s.value.dateFrom,"onUpdate:modelValue":t[7]||(t[7]=a=>s.value.dateFrom=a),placeholder:"Select Start Date",format:"yyyy-MM-dd"},null,8,["modelValue"])])):v("",!0),s.value.timeRange==="custom"?(u(),d("div",Je,[t[18]||(t[18]=e("label",{class:"form-label fw-semibold text-dark"},[e("i",{class:"fas fa-calendar me-2 text-muted"}),x("End Date ")],-1)),D(m(E),{modelValue:s.value.dateTo,"onUpdate:modelValue":t[8]||(t[8]=a=>s.value.dateTo=a),placeholder:"Select End Date",format:"yyyy-MM-dd"},null,8,["modelValue"])])):v("",!0)])])]),e("div",Ge,[s.value.type==="sales"?(u(),d(p,{key:0},[e("div",Ke,[e("div",Xe,[e("div",He,[e("div",null,[e("h4",We,i(m(n)(_.value.revenue||0)),1),t[19]||(t[19]=e("p",{class:"text-muted mb-0 small"},"Total Revenue",-1))]),t[20]||(t[20]=e("div",{class:"rounded-circle p-3 bg-success-subtle text-success d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-currency-pound fs-4"})],-1))])])]),e("div",Ze,[e("div",et,[e("div",tt,[e("div",null,[e("h4",st,i(m(w)(_.value.ordersCount)),1),t[21]||(t[21]=e("p",{class:"text-muted mb-0 small"},"Total Orders",-1))]),t[22]||(t[22]=e("div",{class:"rounded-circle p-3 bg-primary-subtle text-primary d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-receipt fs-4"})],-1))])])]),e("div",lt,[e("div",at,[e("div",ot,[e("div",null,[e("h4",nt,i(m(n)(_.value.aov||0)),1),t[23]||(t[23]=e("p",{class:"text-muted mb-0 small"},"Avg. Order Value",-1))]),t[24]||(t[24]=e("div",{class:"rounded-circle p-3 bg-warning-subtle text-warning d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-graph-up fs-4"})],-1))])])]),e("div",it,[e("div",dt,[e("div",ut,[e("div",null,[e("h4",rt,i(m(w)(_.value.itemsSold)),1),t[25]||(t[25]=e("p",{class:"text-muted mb-0 small"},"Items Sold",-1))]),t[26]||(t[26]=e("div",{class:"rounded-circle p-3 bg-danger-subtle text-danger d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-basket fs-4"})],-1))])])])],64)):v("",!0),s.value.type==="purchase"?(u(),d(p,{key:1},[e("div",ct,[e("div",mt,[e("div",vt,[e("div",null,[e("h4",yt,i(m(n)(_.value.purchaseCost||0)),1),t[27]||(t[27]=e("p",{class:"text-muted mb-0 small"},"Total Purchase Cost",-1))]),t[28]||(t[28]=e("div",{class:"rounded-circle p-3 bg-info-subtle text-info d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-bag-check fs-4"})],-1))])])]),e("div",pt,[e("div",ht,[e("div",bt,[e("div",null,[e("h4",gt,i(m(w)(_.value.purchaseCount)),1),t[29]||(t[29]=e("p",{class:"text-muted mb-0 small"},"Total Purchases",-1))]),t[30]||(t[30]=e("div",{class:"rounded-circle p-3 bg-primary-subtle text-primary d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-box-seam fs-4"})],-1))])])]),e("div",_t,[e("div",ft,[e("div",xt,[e("div",null,[e("h4",wt,i(m(n)(_.value.avgPurchaseValue||0)),1),t[31]||(t[31]=e("p",{class:"text-muted mb-0 small"},"Avg. Purchase Value",-1))]),t[32]||(t[32]=e("div",{class:"rounded-circle p-3 bg-warning-subtle text-warning d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-graph-up fs-4"})],-1))])])]),e("div",St,[e("div",kt,[e("div",Dt,[e("div",null,[e("h4",Tt,i(m(w)(_.value.itemsPurchased)),1),t[33]||(t[33]=e("p",{class:"text-muted mb-0 small"},"Items Purchased",-1))]),t[34]||(t[34]=e("div",{class:"rounded-circle p-3 bg-secondary-subtle text-secondary d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-boxes fs-4"})],-1))])])])],64)):v("",!0),s.value.type==="comparison"?(u(),d(p,{key:2},[e("div",Rt,[e("div",Pt,[e("div",Ct,[e("div",null,[e("h4",Lt,i(m(n)(_.value.salesRevenue)),1),t[35]||(t[35]=e("p",{class:"text-muted mb-0 small"},"Sales Revenue",-1))]),t[36]||(t[36]=e("div",{class:"rounded-circle p-3 bg-success-subtle text-success d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-arrow-up-right fs-4"})],-1))])])]),e("div",At,[e("div",Mt,[e("div",jt,[e("div",null,[e("h4",Vt,i(m(n)(_.value.purchaseCost)),1),t[37]||(t[37]=e("p",{class:"text-muted mb-0 small"},"Purchase Cost",-1))]),t[38]||(t[38]=e("div",{class:"rounded-circle p-3 bg-danger-subtle text-danger d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-arrow-down-left fs-4"})],-1))])])]),e("div",Ot,[e("div",It,[e("div",Nt,[e("div",null,[e("h4",$t,i(m(n)(_.value.grossProfit)),1),t[39]||(t[39]=e("p",{class:"text-muted mb-0 small"},"Gross Profit",-1))]),t[40]||(t[40]=e("div",{class:"rounded-circle p-3 bg-primary-subtle text-primary d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-graph-up fs-4"})],-1))])])]),e("div",Ut,[e("div",Yt,[e("div",Ft,[e("div",null,[e("h4",qt,i(_.value.profitMargin)+"%",1),t[41]||(t[41]=e("p",{class:"text-muted mb-0 small"},"Profit Margin",-1))]),t[42]||(t[42]=e("div",{class:"rounded-circle p-3 bg-info-subtle text-info d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-percent fs-4"})],-1))])])])],64)):v("",!0),s.value.type==="stock"?(u(),d(p,{key:3},[e("div",Qt,[e("div",Et,[e("div",zt,[e("div",null,[e("h4",Bt,i(m(w)(_.value.totalStock)),1),t[43]||(t[43]=e("p",{class:"text-muted mb-0 small"},"Total Items in Stock",-1))]),t[44]||(t[44]=e("div",{class:"rounded-circle p-3 bg-info-subtle text-info d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-box-seam fs-4"})],-1))])])]),e("div",Jt,[e("div",Gt,[e("div",Kt,[e("div",null,[e("h4",Xt,i(m(w)(_.value.lowStockItems)),1),t[45]||(t[45]=e("p",{class:"text-muted mb-0 small"},"Low Stock Items",-1))]),t[46]||(t[46]=e("div",{class:"rounded-circle p-3 bg-warning-subtle text-warning d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-exclamation-triangle fs-4"})],-1))])])]),e("div",Ht,[e("div",Wt,[e("div",Zt,[e("div",null,[e("h4",es,i(m(w)(_.value.outOfStockItems)),1),t[47]||(t[47]=e("p",{class:"text-muted mb-0 small"},"Out of Stock",-1))]),t[48]||(t[48]=e("div",{class:"rounded-circle p-3 bg-danger-subtle text-danger d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-x-circle fs-4"})],-1))])])]),e("div",ts,[e("div",ss,[e("div",ls,[e("div",null,[e("h4",as,i(m(n)(_.value.stockValue)),1),t[49]||(t[49]=e("p",{class:"text-muted mb-0 small"},"Total Stock Value",-1))]),t[50]||(t[50]=e("div",{class:"rounded-circle p-3 bg-success-subtle text-success d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-cash-coin fs-4"})],-1))])])])],64)):v("",!0),s.value.type==="userSales"?(u(),d(p,{key:4},[e("div",os,[e("div",ns,[e("div",is,[e("div",null,[e("h4",ds,i(m(n)(_.value.totalUserSales)),1),t[51]||(t[51]=e("p",{class:"text-muted mb-0 small"},"Total Sales",-1))]),t[52]||(t[52]=e("div",{class:"rounded-circle p-3 bg-success-subtle text-success d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-currency-pound fs-4"})],-1))])])]),e("div",us,[e("div",rs,[e("div",cs,[e("div",null,[e("h4",ms,i(m(n)(_.value.avgCashierSales)),1),t[53]||(t[53]=e("p",{class:"text-muted mb-0 small"},"Avg. per Cashier",-1))]),t[54]||(t[54]=e("div",{class:"rounded-circle p-3 bg-primary-subtle text-primary d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-person-check fs-4"})],-1))])])]),e("div",vs,[e("div",ys,[e("div",ps,[e("div",null,[e("h4",hs,i(m(w)(_.value.activeCashiers)),1),t[55]||(t[55]=e("p",{class:"text-muted mb-0 small"},"Active Cashiers",-1))]),t[56]||(t[56]=e("div",{class:"rounded-circle p-3 bg-info-subtle text-info d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-people fs-4"})],-1))])])]),e("div",bs,[e("div",gs,[e("div",_s,[e("div",null,[e("h4",fs,i(m(n)(_.value.topCashierSales)),1),t[57]||(t[57]=e("p",{class:"text-muted mb-0 small"},"Top Cashier Sales",-1))]),t[58]||(t[58]=e("div",{class:"rounded-circle p-3 bg-warning-subtle text-warning d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-star fs-4"})],-1))])])])],64)):v("",!0),s.value.type==="category"?(u(),d(p,{key:5},[e("div",xs,[e("div",ws,[e("div",Ss,[e("div",null,[e("h4",ks,i(m(w)(_.value.totalCategories)),1),t[59]||(t[59]=e("p",{class:"text-muted mb-0 small"},"Total Categories",-1))]),t[60]||(t[60]=e("div",{class:"rounded-circle p-3 bg-info-subtle text-info d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-tag fs-4"})],-1))])])]),e("div",Ds,[e("div",Ts,[e("div",Rs,[e("div",null,[e("h4",Ps,i(m(n)(_.value.categoryRevenue)),1),t[61]||(t[61]=e("p",{class:"text-muted mb-0 small"},"Total Revenue",-1))]),t[62]||(t[62]=e("div",{class:"rounded-circle p-3 bg-success-subtle text-success d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-currency-pound fs-4"})],-1))])])]),e("div",Cs,[e("div",Ls,[e("div",As,[e("div",null,[e("h4",Ms,i(_.value.topCategory),1),t[63]||(t[63]=e("p",{class:"text-muted mb-0 small"},"Top Category",-1))]),t[64]||(t[64]=e("div",{class:"rounded-circle p-3 bg-primary-subtle text-primary d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-trophy fs-4"})],-1))])])]),e("div",js,[e("div",Vs,[e("div",Os,[e("div",null,[e("h4",Is,i(m(w)(_.value.totalCategorySales)),1),t[65]||(t[65]=e("p",{class:"text-muted mb-0 small"},"Total Items Sold",-1))]),t[66]||(t[66]=e("div",{class:"rounded-circle p-3 bg-warning-subtle text-warning d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-bag-check fs-4"})],-1))])])])],64)):v("",!0)]),k.value?(u(),d("div",Ns,i(k.value),1)):v("",!0),e("div",$s,[e("div",Us,[t[106]||(t[106]=e("div",{class:"d-flex flex-wrap gap-2 justify-content-between align-items-center mb-3"},[e("h6",{class:"fw-semibold mb-0"},"Detailed Data")],-1)),e("div",Ys,[e("table",Fs,[e("thead",qs,[e("tr",null,[t[95]||(t[95]=e("th",{style:{width:"60px"}},"S.#",-1)),s.value.type==="sales"?(u(),d(p,{key:0},[s.value.timeRange==="monthly"?(u(),d("th",Qs,"Day")):s.value.timeRange==="yearly"?(u(),d("th",Es,"Month")):(u(),d("th",zs,"Order ID")),s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?(u(),d("th",Bs," Orders")):(u(),d("th",Js,"Customer Name")),t[67]||(t[67]=e("th",{style:{width:"120px"}},"Sub Total",-1)),t[68]||(t[68]=e("th",{style:{width:"120px"}},"Tax",-1)),t[69]||(t[69]=e("th",{style:{width:"120px"}},"Service Charge",-1)),t[70]||(t[70]=e("th",{style:{width:"120px"}},"Delivery Charge",-1)),t[71]||(t[71]=e("th",{style:{width:"120px"}},"Sale Discount",-1)),t[72]||(t[72]=e("th",{style:{width:"120px"}},"Approved Discount",-1)),t[73]||(t[73]=e("th",{style:{width:"140px"}},"Promo Discount",-1)),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("th",Gs,"Applied Promos")):v("",!0),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("th",Ks,"Promo Type")):v("",!0),t[74]||(t[74]=e("th",{style:{width:"140px"}},"Total Amount",-1)),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("th",Xs,"Date")):v("",!0)],64)):v("",!0),s.value.type==="purchase"?(u(),d(p,{key:1},[s.value.timeRange==="monthly"?(u(),d("th",Hs,"Day")):s.value.timeRange==="yearly"?(u(),d("th",Ws,"Month")):(u(),d("th",Zs,"Purchase ID")),s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?(u(),d("th",el," Purchases")):(u(),d("th",tl,"Supplier Name")),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("th",sl,"Product Name")):v("",!0),t[75]||(t[75]=e("th",{style:{width:"100px"}},"Quantity",-1)),t[76]||(t[76]=e("th",{style:{width:"120px"}},"Unit Price",-1)),t[77]||(t[77]=e("th",{style:{width:"140px"}},"Sub Total",-1)),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("th",ll,"Expiry Date")):v("",!0),s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?(u(),d("th",al,"Suppliers")):v("",!0),t[78]||(t[78]=e("th",{style:{width:"140px"}},"Total Amount",-1)),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("th",ol,"Purchase Date")):v("",!0),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("th",nl,"Status")):v("",!0)],64)):v("",!0),s.value.type==="comparison"?(u(),d(p,{key:2},[t[79]||(t[79]=e("th",null,"Metric",-1)),t[80]||(t[80]=e("th",{style:{width:"140px"}},"Sales",-1)),t[81]||(t[81]=e("th",{style:{width:"140px"}},"Purchase",-1)),t[82]||(t[82]=e("th",{style:{width:"140px"}},"Difference",-1))],64)):v("",!0),s.value.type==="stock"?(u(),d(p,{key:3},[t[83]||(t[83]=e("th",null,"Item",-1)),t[84]||(t[84]=e("th",{style:{width:"100px"}},"Stock",-1)),t[85]||(t[85]=e("th",{style:{width:"100px"}},"Min Level",-1)),t[86]||(t[86]=e("th",{style:{width:"120px"}},"Status",-1))],64)):v("",!0),s.value.type==="userSales"?(u(),d(p,{key:4},[t[87]||(t[87]=e("th",null,"Cashier Name",-1)),t[88]||(t[88]=e("th",{style:{width:"120px"}},"Orders",-1)),t[89]||(t[89]=e("th",{style:{width:"140px"}},"Total Sales",-1)),t[90]||(t[90]=e("th",{style:{width:"120px"}},"Avg Sale",-1))],64)):v("",!0),s.value.type==="category"?(u(),d(p,{key:5},[t[91]||(t[91]=e("th",null,"Category",-1)),t[92]||(t[92]=e("th",{style:{width:"120px"}},"Qty Sold",-1)),t[93]||(t[93]=e("th",{style:{width:"140px"}},"Revenue",-1)),t[94]||(t[94]=e("th",{style:{width:"100px"}},"% of Total",-1))],64)):v("",!0)])]),e("tbody",null,[(u(!0),d(p,null,j(h.value,(a,l)=>(u(),d("tr",{key:l},[e("td",null,i(l+1),1),s.value.type==="sales"?(u(),d(p,{key:0},[e("td",il,[s.value.timeRange==="monthly"?(u(),d(p,{key:0},[x(i(new Date(a.order_date).toLocaleString("en-US",{month:"short"})+" "+String(new Date(a.order_date).getDate()).padStart(2,"0")),1)],64)):s.value.timeRange==="yearly"?(u(),d(p,{key:1},[x(i(new Date(a.order_month+"-01").toLocaleDateString("en-US",{month:"long",year:"numeric"})),1)],64)):(u(),d(p,{key:2},[x(i(a.id),1)],64))]),e("td",null,[s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?(u(),d(p,{key:0},[x(i(a.order_count)+" Orders ",1)],64)):(u(),d(p,{key:1},[x(i(a.customer_name),1)],64))]),e("td",null,i(m(n)(a.sub_total)),1),e("td",null,i(m(n)(a.tax)),1),e("td",null,i(m(n)(a.service_charges)),1),e("td",null,i(m(n)(a.delivery_charges)),1),e("td",null,i(m(n)(a.sales_discount)),1),e("td",null,i(m(n)(a.approved_discounts)),1),e("td",null,i(m(n)(a.promo_discount)),1),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("td",dl,i(a.promo_names),1)):v("",!0),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("td",ul,i(a.promo_types),1)):v("",!0),e("td",rl,i(m(n)(a.total_amount)),1),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("td",cl,i(m(T)(a.order_date)),1)):v("",!0)],64)):v("",!0),s.value.type==="purchase"?(u(),d(p,{key:1},[e("td",ml,[s.value.timeRange==="monthly"?(u(),d(p,{key:0},[x(i(new Date(a.purchase_date).toLocaleString("en-US",{month:"short"})+" "+String(new Date(a.purchase_date).getDate()).padStart(2,"0")),1)],64)):s.value.timeRange==="yearly"?(u(),d(p,{key:1},[x(i(new Date(a.purchase_month+"-01").toLocaleDateString("en-US",{month:"long",year:"numeric"})),1)],64)):(u(),d(p,{key:2},[x(i(a.purchase_id),1)],64))]),e("td",null,[s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?(u(),d(p,{key:0},[x(i(a.purchase_count)+" Purchases ",1)],64)):(u(),d(p,{key:1},[x(i(a.supplier_name),1)],64))]),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("td",vl,i(a.product_name),1)):v("",!0),e("td",null,i(m(w)(a.quantity)),1),e("td",null,i(m(n)(a.total_unit_price)),1),e("td",null,i(m(n)(a.sub_total)),1),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("td",yl,[a.expiry_date?(u(),d("span",pl,i(m(T)(a.expiry_date)),1)):(u(),d("span",hl,"N/A"))])):v("",!0),s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?(u(),d("td",bl,i(a.supplier_names),1)):v("",!0),e("td",gl,i(m(n)(a.total_amount)),1),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("td",_l,i(m(T)(a.purchase_date)),1)):v("",!0),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("td",fl,[a.status==="completed"?(u(),d("span",xl," Completed ")):a.status==="pending"?(u(),d("span",wl," Pending ")):(u(),d("span",Sl,i(a.status),1))])):v("",!0)],64)):v("",!0),s.value.type==="comparison"?(u(),d(p,{key:2},[e("td",kl,i(a.metric),1),e("td",null,i(m(n)(a.sales)),1),e("td",null,i(m(n)(a.purchase)),1),e("td",{style:z({color:a.difference>0?"#10b981":"#ef4444"}),class:"fw-semibold"},i(m(n)(a.difference)),5)],64)):v("",!0),s.value.type==="stock"?(u(),d(p,{key:3},[e("td",Dl,i(a.name),1),e("td",null,i(m(w)(a.currentStock)),1),e("td",null,i(m(w)(a.minLevel)),1),e("td",null,[a.currentStock>a.minLevel?(u(),d("span",Tl," In Stock ")):a.currentStock>0?(u(),d("span",Rl," Low Stock ")):(u(),d("span",Pl," Out of Stock "))])],64)):v("",!0),s.value.type==="userSales"?(u(),d(p,{key:4},[e("td",Cl,i(a.cashierName),1),e("td",null,i(m(w)(a.orderCount)),1),e("td",null,i(m(n)(a.totalSales)),1),e("td",null,i(m(n)(a.avgSale)),1)],64)):v("",!0),s.value.type==="category"?(u(),d(p,{key:5},[e("td",Ll,i(a.categoryName),1),e("td",null,i(m(w)(a.qty)),1),e("td",null,i(m(n)(a.revenue)),1),e("td",null,i(a.percentage)+"%",1)],64)):v("",!0)]))),128)),s.value.type==="sales"&&h.value.length>0?(u(),d("tr",Al,[t[96]||(t[96]=e("td",{colspan:"0",class:"text-end"},"TOTALS",-1)),t[97]||(t[97]=e("td",{colspan:"0"},"-",-1)),t[98]||(t[98]=e("td",{colspan:"0"},"-",-1)),e("td",null,i(m(n)(c.value.sub_total)),1),e("td",null,i(m(n)(c.value.tax)),1),e("td",null,i(m(n)(c.value.service_charges)),1),e("td",null,i(m(n)(c.value.delivery_charges)),1),e("td",null,i(m(n)(c.value.sales_discount+c.value.approved_discounts)),1),e("td",null,i(m(n)(c.value.approved_discounts)),1),e("td",null,i(m(n)(c.value.promo_discount)),1),e("td",Ml,i(m(n)(c.value.total_amount)),1),t[99]||(t[99]=e("td",null,null,-1))])):v("",!0),s.value.type==="purchase"&&h.value.length>0?(u(),d("tr",jl,[t[100]||(t[100]=e("td",{colspan:"0"},"TOTALS",-1)),t[101]||(t[101]=e("td",null,"-",-1)),t[102]||(t[102]=e("td",null,"-",-1)),e("td",null,i(m(w)(c.value.quantity)),1),e("td",null,i(m(n)(c.value.total_unit_price)),1),e("td",null,i(m(n)(c.value.sub_total)),1),t[103]||(t[103]=e("td",{colspan:"3"},null,-1))])):v("",!0),!R.value&&h.value.length===0?(u(),d("tr",Vl,[...t[104]||(t[104]=[e("td",{colspan:16,class:"text-center text-muted py-4"}," No data available for this period. ",-1)])])):v("",!0),R.value?(u(),d("tr",Ol,[...t[105]||(t[105]=[e("td",{colspan:5,class:"text-center text-muted py-4"},[e("i",{class:"fas fa-spinner fa-spin me-2"}),x("Loadingâ€¦ ")],-1)])])):v("",!0)])])])])]),e("div",Il,[e("div",Nl,[e("div",$l,[e("div",Ul,[e("h6",Yl,i(H.value),1),e("div",Fl,[(u(),d("svg",ql,[t[108]||(t[108]=e("line",{x1:"50",y1:"40",x2:"50",y2:"230",stroke:"#4b5563","stroke-width":"1"},null,-1)),t[109]||(t[109]=e("line",{x1:"50",y1:"230",x2:"820",y2:"230",stroke:"#4b5563","stroke-width":"1"},null,-1)),(u(),d(p,null,j(5,a=>e("g",{key:"grid"+a},[e("line",{x1:50,x2:820,y1:230-a*38,y2:230-a*38,stroke:"#374151","stroke-width":"0.5",opacity:"0.3"},null,8,Ql)])),64)),(u(!0),d(p,null,j(C.value.yLabels,(a,l)=>(u(),d("text",{key:"ylabel"+l,x:a.x,y:a.y+5,"text-anchor":"end",fill:"#9ca3af","font-size":"11"},i(a.text),9,El))),128)),(u(!0),d(p,null,j(C.value.xLabels,(a,l)=>(u(),d("text",{key:"xlabel"+l,x:a.x,y:a.y,"text-anchor":"middle",fill:"#9ca3af","font-size":"11"},i(a.text),9,zl))),128)),C.value.salesPath?(u(),d("path",{key:0,d:C.value.salesPath,fill:"none",stroke:"#10b981","stroke-width":"3","stroke-linecap":"round"},null,8,Bl)):v("",!0),s.value.type==="comparison"&&C.value.purchasePath?(u(),d("path",{key:1,d:C.value.purchasePath,fill:"none",stroke:"#ef4444","stroke-width":"3","stroke-linecap":"round"},null,8,Jl)):v("",!0),s.value.type==="comparison"?(u(),d("g",Gl,[...t[107]||(t[107]=[e("circle",{cx:"750",cy:"20",r:"5",fill:"#10b981"},null,-1),e("text",{x:"760",y:"25",fill:"#9ca3af","font-size":"12"},"Sales",-1),e("circle",{cx:"820",cy:"20",r:"5",fill:"#ef4444"},null,-1),e("text",{x:"830",y:"25",fill:"#9ca3af","font-size":"12"},"Purchase",-1)])])):v("",!0),Y.value.length?v("",!0):(u(),d("text",Kl," No data available "))]))])])])]),e("div",Xl,[e("div",Hl,[e("div",Wl,[t[110]||(t[110]=e("h6",{class:"fw-semibold mb-3"},"Distribution",-1)),(u(!0),d(p,null,j(J.value,a=>(u(),d("div",{key:a.label,class:"stack"},[e("div",Zl,[e("span",null,i(a.label),1),e("span",ea,i(a.value)+" ("+i(a.percentage)+"%)",1)]),e("div",ta,[e("div",{class:"progress-bar",style:z({width:a.percentage+"%",backgroundColor:a.color})},null,4)])]))),128))])]),e("div",sa,[e("div",la,[t[115]||(t[115]=e("h6",{class:"fw-semibold mb-3"},"Summary Info",-1)),e("div",aa,[e("div",oa,[t[111]||(t[111]=e("span",null,"Period",-1)),e("span",na,i(m(T)(W.value)),1)]),e("div",ia,[t[112]||(t[112]=e("span",null,"Data Points",-1)),e("span",da,i(K.value),1)]),e("div",ua,[t[113]||(t[113]=e("span",null,"Last Updated",-1)),e("span",ra,i(G.value),1)]),e("div",ca,[t[114]||(t[114]=e("span",null,"Status",-1)),e("span",{class:"stack-val",style:z({color:R.value?"#f59e0b":"#10b981"})},i(R.value?"Loading...":"Active"),5)])])])])])])])]),_:1})],64))}},Pa=ke(ma,[["__scopeId","data-v-958e9bff"]]);export{Pa as default};
