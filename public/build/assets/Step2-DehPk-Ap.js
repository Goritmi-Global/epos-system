import{_ as D,R as $,r as c,c as j,y as B,o as z,$ as W,f as r,b as i,m,e as s,k as h,v as w,i as v,t as u,d as I,X as A,w as E,l as _,u as q,F as G,g as X}from"./app-BhEqVOjM.js";import{s as Y}from"./index-uUe_1fUt.js";import"./index-Cy0L8lww.js";import"./index-B2SIu7dG.js";import"./index-DPAewq5T.js";import"./index-C-3a7XlK.js";const H={key:0,class:"fw-bold mb-4"},J={class:"row g-4"},Q={class:"col-12"},Z={key:0,class:"text-danger"},ee={class:"col-md-4"},se={class:"logo-card"},le=["src"],oe={key:1,class:"placeholder"},te={key:0,class:"text-danger"},ae={class:"col-md-8"},ne={key:0},re={key:1},ie={class:"d-flex align-items-center gap-2"},ue={key:0,class:"badge bg-primary text-white",style:{"font-size":"10px"}},me={key:0,class:"p-2 border-top"},de={key:0,class:"text-danger"},ce={key:1,class:"text-danger"},pe={class:"row g-3 mt-1"},be={class:"col-md-6"},fe={class:"input-group"},ve={key:0,class:"text-danger d-block mt-1"},ge={key:1,class:"text-danger d-block mt-1"},ye={key:2,class:"text-success d-block mt-1"},he={class:"col-md-6"},we={key:0,class:"text-danger"},ke={key:2,class:"text-danger"},O="+44",_e={__name:"Step2",props:{model:Object,formErrors:Object,isOnboarding:{type:Boolean,default:!1}},emits:["save"],setup(a,{emit:L}){const n=a,F=L,l=$({business_name:n.model?.business_name??"",business_type:n.model?.business_type??"",address:n.model?.address??"",email:n.model?.email??"",website:n.model?.website??"",legal_name:n.model?.legal_name??"",phone_country:"GB",phone_code:O,phone_local:n.model?.phone_local??"",phone:n.model?.phone??"",logo:n.model?.logo??null,logo_url:n.model?.logo_url??null,logo_file:null}),d=c(""),k=c(!1),C=c([]),x=()=>{d.value="",C.value=[],k.value=!1;const t=String(l.phone_local||"").trim();if(!t)return d.value="Phone number is required",!1;let e=t.replace(/\D+/g,"");if(e.length!==10)return d.value="UK mobile number must be exactly 10 digits",!1;if(!e.startsWith("7"))return d.value="UK mobile numbers must start with 7",!1;if(!/^7[0-9]{9}$/.test(e))return d.value="Invalid UK mobile number format",!1;const y=e.substring(1,3);return["11","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99"].includes(y)?(k.value=!0,!0):(d.value="Invalid UK mobile operator code",!1)},g=c([{name:"Cafe",code:"cafe"},{name:"Restaurant",code:"restaurant"},{name:"Bakery",code:"bakery"},{name:"Takeaway",code:"takeaway"},{name:"Food Truck",code:"food_truck"}]),N=()=>{const t=n.model?.business_type;if(!t){f.value=null;return}let e=g.value.find(o=>o.name===t);if(!e){const o={name:t,code:t.toLowerCase().replace(/\s+/g,"_"),custom:!0};g.value.push(o),e=o}f.value=e},f=c(null),p=c(""),P=j(()=>{if(!p.value||p.value.trim()==="")return!1;const t=p.value.toLowerCase().trim();return!g.value.some(e=>e.name.toLowerCase()===t)}),S=()=>{const t=p.value.trim();if(!t)return;const e={name:t,code:t.toLowerCase().replace(/\s+/g,"_"),custom:!0};g.value.push(e),f.value=e,p.value=""};B(f,t=>{l.business_type=t?.name||"",b()});function U(){const t=String(l.phone_local||"").replace(/\D+/g,"");l.phone=l.phone_code+t}z(async()=>{if(N(),n.model?.phone_local)l.phone_local=n.model.phone_local;else if(n.model?.phone){const t=n.model.phone;l.phone_local=t.replace(O,"").trim()}U(),!l.logo_url&&n.model?.upload_id&&n.model?.logo_path&&(l.logo_url=n.model?.logo_url||`/storage/${n.model?.logo_path}`)}),B(()=>l.phone_local,t=>{U(),x(),b()});const V=c(!1),K=c(!1),T=c(null);function M(t){T.value=l.logo_url,T.value&&(K.value=!0)}function R({file:t}){l.logo_file=t,l.logo_url=URL.createObjectURL(t),b()}function b(){const t=x();F("save",{step:2,data:W(l),valid:t})}return(t,e)=>(i(),r("div",null,[n.isOnboarding?(i(),r("h5",H,"Step 2 of 9 - Business Information")):m("",!0),s("div",J,[s("div",Q,[e[9]||(e[9]=s("label",{class:"form-label"},"Business Name*",-1)),h(s("input",{class:v(["form-control",{"is-invalid":a.formErrors?.business_name}]),"onUpdate:modelValue":e[0]||(e[0]=o=>l.business_name=o),onInput:b},null,34),[[w,l.business_name]]),a.formErrors?.business_name?(i(),r("small",Z,u(a.formErrors.business_name[0]),1)):m("",!0)]),s("div",ee,[e[11]||(e[11]=s("small",{class:"text-muted mt-2"},"Upload Logo",-1)),s("div",se,[s("div",{class:"logo-frame",onClick:e[1]||(e[1]=o=>l.logo_url&&M())},[l.logo_url?(i(),r("img",{key:0,src:l.logo_url,alt:"Logo"},null,8,le)):(i(),r("div",oe,[...e[10]||(e[10]=[s("i",{class:"bi bi-image"},null,-1)])]))]),I(A,{show:V.value,onClose:e[2]||(e[2]=o=>V.value=!1),onCropped:R},null,8,["show"]),a.formErrors?.logo_file?(i(),r("small",te,u(a.formErrors.logo_file[0]),1)):m("",!0)])]),s("div",ae,[e[19]||(e[19]=s("label",{class:"form-label"},"Business Type*",-1)),I(q(Y),{modelValue:f.value,"onUpdate:modelValue":e[3]||(e[3]=o=>f.value=o),options:g.value,optionLabel:"name",filter:!0,onFilter:e[4]||(e[4]=o=>p.value=o.value),pt:{listContainer:{class:"bg-white text-black"},option:{class:"text-black hover:bg-gray-100"},header:{class:"bg-white text-black"},IconField:{class:"bg-white"},InputText:{class:"bg-white"},pcFilter:{class:"bg-white"},pcFilterContainer:{class:"bg-white"}},placeholder:"Select or type business type",class:v(["w-100",{"is-invalid":a.formErrors?.business_type}])},{value:E(({value:o,placeholder:y})=>[o?(i(),r("span",ne,u(o.name),1)):(i(),r("span",re,u(y),1))]),option:E(({option:o})=>[s("div",ie,[s("span",null,u(o.name),1),o.custom?(i(),r("span",ue,"Custom")):m("",!0)])]),footer:E(()=>[P.value?(i(),r("div",me,[s("button",{type:"button",class:"btn btn-sm btn-primary w-100",onClick:S},[e[12]||(e[12]=s("i",{class:"bi bi-plus-circle me-1"},null,-1)),_(' Add "'+u(p.value)+'" ',1)])])):m("",!0)]),_:1},8,["modelValue","options","class"]),a.formErrors?.business_type?(i(),r("small",de,u(a.formErrors.business_type[0]),1)):m("",!0),e[20]||(e[20]=s("br",null,null,-1)),e[21]||(e[21]=s("label",{class:"form-label mt-3"},"Address*",-1)),h(s("input",{class:v(["form-control",{"is-invalid":a.formErrors?.address}]),"onUpdate:modelValue":e[5]||(e[5]=o=>l.address=o),onInput:b},null,34),[[w,l.address]]),a.formErrors?.address?(i(),r("small",ce,u(a.formErrors.address[0]),1)):m("",!0),s("div",pe,[s("div",be,[e[17]||(e[17]=s("label",{class:"form-label"},"UK Phone*",-1)),s("div",fe,[e[13]||(e[13]=s("span",{class:"input-group-text p-0"},[s("input",{type:"text",class:"form-control text-center border-0 bg-light fw-semibold",value:"+44",readonly:"",style:{width:"70px"}})],-1)),h(s("input",{class:v(["form-control phone-input",{"is-invalid":d.value,"is-valid":k.value&&l.phone_local}]),inputmode:"numeric",placeholder:"7311865859","onUpdate:modelValue":e[6]||(e[6]=o=>l.phone_local=o),onBlur:x,maxlength:"10"},null,34),[[w,l.phone_local]])]),d.value?(i(),r("small",ve,[e[14]||(e[14]=s("i",{class:"bi bi-exclamation-circle me-1"},null,-1)),_(u(d.value),1)])):a.formErrors?.phone_local?(i(),r("small",ge,u(a.formErrors.phone_local[0]),1)):m("",!0),k.value&&l.phone_local?(i(),r("small",ye,[...e[15]||(e[15]=[s("i",{class:"bi bi-check-circle me-1"},null,-1),_("âœ“ Valid UK phone number ",-1)])])):m("",!0),(i(!0),r(G,null,X(C.value,(o,y)=>(i(),r("small",{key:y,class:"text-info d-block mt-1"},[e[16]||(e[16]=s("i",{class:"bi bi-info-circle me-1"},null,-1)),_(u(o),1)]))),128))]),s("div",he,[e[18]||(e[18]=s("label",{class:"form-label"},"Email*",-1)),h(s("input",{type:"email",class:v(["form-control",{"is-invalid":a.formErrors?.email}]),"onUpdate:modelValue":e[7]||(e[7]=o=>l.email=o),onInput:b},null,34),[[w,l.email]]),a.formErrors?.email?(i(),r("small",we,u(a.formErrors.email[0]),1)):m("",!0)])]),e[22]||(e[22]=s("label",{class:"form-label mt-3"},"Website",-1)),h(s("input",{class:v(["form-control",{"is-invalid":a.formErrors?.website}]),"onUpdate:modelValue":e[8]||(e[8]=o=>l.website=o),onInput:b},null,34),[[w,l.website]]),a.formErrors?.website?(i(),r("small",ke,u(a.formErrors.website[0]),1)):m("",!0)])])]))}},Ie=D(_e,[["__scopeId","data-v-7ca6c400"]]);export{Ie as default};
