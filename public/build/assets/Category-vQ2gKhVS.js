import{_ as Te,r as g,k as me,p as Pe,C as z,H as Ae,D as ve,c as oe,o as i,w as U,a as C,b as t,d as D,h as Oe,g as d,F as M,v as H,t as m,n as B,B as ze,x as G,y as ne,f as R,I as Ue,i as I,Q as pe,e as ge,A,m as c}from"./app-C8Xsdeiq.js";import{_ as He}from"./Master-C5zbO8q8.js";import{P as Re,s as be}from"./index-DJ6bf7DA.js";import{s as We}from"./index-BOoCw-R4.js";import{u as Ke}from"./useFormatters-ZLqOMbOR.js";import{F as Xe}from"./FilterModal-Bpt_aK1M.js";import{E as Ze,a as Ye,X as qe,u as W,w as Ge}from"./xlsx-d9Zr9GFG.js";import{I as Je}from"./importFile-Dr5yqNa3.js";import{S as Qe}from"./shapes-C_9UMWuK.js";import{C as et}from"./circle-x-C4aaRpjp.js";import{P as tt}from"./plus-DLdYktfN.js";import{P as fe}from"./pencil-3goqc9oR.js";import"./index-DxYZ9pSU.js";import"./createLucideIcon-Is2tcEJ3.js";import"./sun-DxahoOHL.js";import"./index-Cq4AMUzx.js";const at={class:"page-wrapper"},lt={class:"row g-3"},st={class:"card border-0 shadow-sm rounded-4"},ot={class:"card-body d-flex align-items-center justify-content-between"},nt={class:"fw-bold fs-4"},it={class:"text-muted fs-6"},rt={class:"card border-0 shadow-lg rounded-4 mt-0"},ut={class:"card-body"},ct={class:"d-flex flex-wrap gap-2 justify-content-between align-items-center mb-3"},dt={class:"d-flex flex-wrap gap-2 align-items-center"},mt={class:"search-wrap"},vt={key:1,class:"form-control search-input",placeholder:"Search",disabled:"",type:"text"},pt={class:"col-12"},gt=["onUpdate:modelValue"],bt=["value"],ft={class:"dropdown"},yt={class:"dropdown-menu dropdown-menu-end shadow rounded-4 py-2"},ht={class:"table-responsive"},Ct={class:"table table-hover align-middle"},_t={class:"fw-semibold"},kt={class:"text-truncate",style:{"max-width":"260px"}},wt={key:0},St=["onClick"],xt={key:1},It={class:"rounded d-inline-flex align-items-center justify-content-center img-chip"},Ft=["src","alt"],$t={key:1,class:"fs-5"},Dt={class:"text-center"},Mt={class:"d-inline-flex align-items-center gap-3"},Bt=["onClick"],Et={key:0},Vt={class:"modal fade",id:"addCatModal",tabindex:"-1","aria-hidden":"true"},Lt={class:"modal-dialog modal-lg modal-dialog-centered"},Nt={class:"modal-content rounded-4"},jt={class:"modal-header"},Tt={class:"modal-title fw-semibold"},Pt={class:"modal-body"},At={class:"row g-3"},Ot={class:"col-lg-12"},zt={class:"d-flex align-items-center gap-3"},Ut={class:"form-check"},Ht=["checked"],Rt={class:"form-check"},Wt=["checked"],Kt={key:0,class:"col-lg-12"},Xt={key:0,class:"text-danger"},Zt={class:"col-lg-12"},Yt={class:"dropdown w-100"},qt={class:"btn btn-outline-secondary w-100 d-flex justify-content-between align-items-center rounded-3","data-bs-toggle":"dropdown",type:"button"},Gt={class:"d-flex align-items-center"},Jt=["src"],Qt={class:"dropdown-menu w-100 shadow rounded-3"},ea=["onClick"],ta=["src"],aa={key:1,class:"col-12"},la={key:2,class:"text-danger"},sa={key:2,class:"col-12"},oa={class:"p-3 d-flex justify-content-between"},na={class:"d-flex gap-2"},ia={key:0,class:"text-danger"},ra={key:1,class:"text-danger"},ua={key:3,class:"col-12"},ca=["value"],da={class:"col-12"},ma={class:"d-flex align-items-center gap-3"},va={class:"form-check"},pa=["checked"],ga={class:"form-check"},ba=["checked"],fa={class:"mt-4"},ya=["disabled"],ha={class:"modal fade",id:"editSubCatModal",tabindex:"-1","aria-labelledby":"editSubCatModalLabel","aria-hidden":"true"},Ca={class:"modal-dialog modal-md modal-dialog-centered"},_a={class:"modal-content"},ka={class:"modal-body"},wa={class:"mb-3"},Sa=["disabled"],xa={class:"text-danger"},Ia=["disabled"],Fa={__name:"Category",setup($a){const{formatCurrencySymbol:ye}=Ke(),b=g([]),F=g([]),f=g(null),_=g([]),ie={sortBy:"",status:"",hasSubcategories:"",stockStatus:"",valueMin:null,valueMax:null},h=g({...ie}),K=async()=>{try{const l=await A.get("/api/menu-categories/parents/list");F.value=l.data.data,console.log("Fetched categories:",F.value)}catch(l){console.error("Failed to fetch categories:",l)}};me(async()=>{j.value="",re.value=Date.now(),await Pe(),setTimeout(()=>{ue.value=!0;const l=document.getElementById(J);l&&(l.value="",j.value="")},100),K()});const X=z(()=>F.value.filter(l=>l.parent_id===null)),he=z(()=>[{label:"Total Categories",value:X.value.length,icon:Qe,iconBg:"bg-light-primary",iconColor:"text-primary"},{label:"Active Categories",value:X.value.filter(l=>l.active).length,icon:Re,iconBg:"bg-light-success",iconColor:"text-success"},{label:"Inactive Categories",value:X.value.filter(l=>!l.active).length,icon:et,iconBg:"bg-light-danger",iconColor:"text-danger"}]),j=g(""),re=g(Date.now()),J=`search-${Math.random().toString(36).substr(2,9)}`,ue=g(!1),Q=z(()=>{const l=j.value.trim().toLowerCase();let e=F.value.filter(s=>s.parent_id===null);return l&&(e=e.filter(s=>s.name.toLowerCase().includes(l))),h.value.status!==""&&(e=e.filter(s=>h.value.status==="active"?s.active===1||s.active===!0:s.active===0||s.active===!1)),h.value.hasSubcategories!==""&&(e=e.filter(s=>{const o=s.subcategories&&s.subcategories.length>0;return h.value.hasSubcategories==="yes"?o:!o})),h.value.stockStatus&&(e=e.filter(s=>{const o=s.out_of_stock||0,a=s.low_stock||0,u=s.in_stock||0,r=s.total_items||0;switch(h.value.stockStatus){case"in_stock":return u>0;case"low_stock":return a>0;case"out_of_stock":return o>0;case"has_items":return r>0;case"no_items":return r===0;default:return!0}})),(h.value.valueMin!==null||h.value.valueMax!==null)&&(e=e.filter(s=>{const o=s.total_value||0,a=h.value.valueMin||0,u=h.value.valueMax||1/0;return o>=a&&o<=u})),e}),Ce=z(()=>{const l=[...Q.value];switch(h.value.sortBy){case"name_asc":return l.sort((s,o)=>(s.name||"").localeCompare(o.name||""));case"name_desc":return l.sort((s,o)=>(o.name||"").localeCompare(s.name||""));case"value_desc":return l.sort((s,o)=>(o.total_value||0)-(s.total_value||0));case"value_asc":return l.sort((s,o)=>(s.total_value||0)-(o.total_value||0));case"items_desc":return l.sort((s,o)=>(o.total_items||0)-(s.total_items||0));case"items_asc":return l.sort((s,o)=>(s.total_items||0)-(o.total_items||0));default:return l}}),Z=z(()=>({sortOptions:[{value:"name_asc",label:"Name: A to Z"},{value:"name_desc",label:"Name: Z to A"},{value:"value_desc",label:"Value: High to Low"},{value:"value_asc",label:"Value: Low to High"},{value:"items_desc",label:"Items: High to Low"},{value:"items_asc",label:"Items: Low to High"}],statusOptions:[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"}],hasSubcategoriesOptions:[{value:"yes",label:"Has Subcategories"},{value:"no",label:"No Subcategories"}],stockStatusOptions:[{value:"in_stock",label:"In Stock"},{value:"low_stock",label:"Low Stock"},{value:"out_of_stock",label:"Out of Stock"},{value:"has_items",label:"Has Items"},{value:"no_items",label:"No Items"}]})),_e=l=>{console.log("Filters applied:",l)},ke=()=>{h.value={...ie}};me(()=>window.feather?.replace()),Ae(()=>window.feather?.replace());const y=g(!1),Y=g(""),x=g(!0),k=g(null),v=g({label:"Produce (Veg/Fruit)",value:"https://wallpaperaccess.com/full/5502204.jpg",file:null}),E=[{label:"Hot Drinks",value:"Hot Drinks",icon:"/assets/img/coffee.png"},{label:"Cold Drinks",value:"Cold Drinks",icon:"/assets/img/soda.png"},{label:"Breakfast",value:"Breakfast",icon:"/assets/img/english-breakfast.png"},{label:"Street Snacks",value:"Street Snacks",icon:"/assets/img/food.png"},{label:"Wala Wraps",value:"Wala Wraps",icon:"/assets/img/burrito.png"},{label:"Bombay Toasties",value:"Bombay Toasties",icon:"/assets/img/food (1).png"},{label:"Salads",value:"Salads",icon:"/assets/img/salad.png"},{label:"Bombay Bowls",value:"Bombay Bowls",icon:"/assets/img/porridge.png"},{label:"Bakery",value:"Bakery",icon:"/assets/img/cake.png"},{label:"Soup",value:"Soup",icon:"/assets/img/bowl.png"},{label:"Desserts",value:"Desserts",icon:"/assets/img/cupcake.png"},{label:"Ice Cream",value:"Ice Cream",icon:"/assets/img/ice-cream.png"}],ee=[{label:"Hot Drinks",value:"Hot Drinks",icon:"/assets/img/coffee.png"},{label:"Cold Drinks",value:"Cold Drinks",icon:"/assets/img/soda.png"},{label:"Breakfast",value:"Breakfast",icon:"/assets/img/english-breakfast.png"},{label:"Street Snacks",value:"Street Snacks",icon:"/assets/img/food.png"},{label:"Wala Wraps",value:"Wala Wraps",icon:"/assets/img/wrap.png"},{label:"Bombay Toasties",value:"Bombay Toasties",icon:"/assets/img/bombay-toasties.png"},{label:"Salads",value:"Salads",icon:"/assets/img/salad.png"},{label:"Bombay Bowls",value:"Bombay Bowls",icon:"/assets/img/porridge.png"},{label:"Bakery",value:"Bakery",icon:"/assets/img/cake.png"},{label:"Soup",value:"Soup",icon:"/assets/img/bowl.png"},{label:"Desserts",value:"Desserts",icon:"/assets/img/cupcake.png"},{label:"Ice Cream",value:"Ice Cream",icon:"/assets/img/ice-cream.png"}],$=g(!1),p=g({}),we=()=>{y.value=!1,b.value=[],_.value=[],Y.value="",x.value=!0,k.value=null,v.value=E[0],p.value={},q.value="",O.value="",L.value=[],T.value="",f.value=null},ce=async(l,e)=>{try{console.log("ðŸ”„ Converting URL to File:",l);const s=await fetch(l);if(!s.ok)return console.error("âŒ Fetch failed:",s.status),null;const o=await s.blob(),a=new File([o],e,{type:o.type||"image/jpeg"});return console.log("âœ… File created:",{name:a.name,size:a.size,type:a.type}),a}catch(s){return console.error("âŒ Error converting URL to File:",s),null}},Se=async l=>{console.log("ðŸŽ¨ Icon selected:",l.label),v.value={label:l.label,value:l.value,icon:l.icon,file:null};const e=l.label.toLowerCase().replace(/[^a-z0-9]/g,"-")+".jpg",s=await ce(l.icon,e);s?(v.value.file=s,console.log("âœ… Icon file ready:",s.name)):(console.error("âŒ Failed to convert icon to file"),c.error("Failed to load icon. Please try again."))},xe=async()=>{if(y.value&&!k.value){p.value.parent_id=["Please select a parent category"],c.error(p.value.parent_id[0]),$.value=!1;return}V(),$.value=!0;try{if(v.value.icon&&!v.value.file){console.log("â³ Icon file not ready, converting now...");const e=v.value.label.toLowerCase().replace(/[^a-z0-9]/g,"-")+".jpg",s=await ce(v.value.icon,e);s?(v.value.file=s,console.log("âœ… Icon converted just in time")):console.warn("âš ï¸ Could not convert icon to file")}if(f.value){const e=new FormData;let s="";if(y.value?s=Y.value?.trim():s=b.value[0]?.label?.trim()||b.value[0]?.name?.trim()||(typeof b.value[0]=="string"?b.value[0].trim():""),!s){p.value.name=["Category name cannot be empty"],c.error("Category name cannot be empty"),$.value=!1;return}e.append("name",s),e.append("active",x.value?"1":"0"),e.append("parent_id",k.value||""),e.append("_method","PUT"),v.value.file&&v.value.file instanceof File?(e.append("icon",v.value.file),console.log("ðŸ“Ž Icon attached to FormData:",{name:v.value.file.name,size:v.value.file.size,type:v.value.file.type})):console.warn("âš ï¸ No icon file to attach"),!k.value&&T.value&&T.value.split(",").map(a=>a.trim()).filter(a=>a.length>0).forEach((a,u)=>{const r=f.value.subcategories?.find(n=>n.name.toLowerCase()===a.toLowerCase());e.append(`subcategories[${u}][name]`,a),r?(e.append(`subcategories[${u}][id]`,r.id),e.append(`subcategories[${u}][active]`,r.active?"1":"0")):e.append(`subcategories[${u}][active]`,"1")}),console.log("ðŸ“¦ FormData contents (UPDATE):");for(let o of e.entries())o[1]instanceof File?console.log(`  ${o[0]}: [FILE] ${o[1].name} (${o[1].size} bytes)`):console.log(`  ${o[0]}: ${o[1]}`);await A.post(`/menu-categories/${f.value.id}`,e,{headers:{"Content-Type":"multipart/form-data"}}),c.success("Category updated successfully")}else{const e=new FormData;let s=[];if(y.value){if(_.value.length===0){p.value.subcategories=["Please add at least one subcategory"],c.error("Please add at least one subcategory"),$.value=!1;return}s=_.value.map(o=>({name:typeof o=="string"?o:o.label,active:x.value,parent_id:k.value}))}else{if(b.value.length===0){p.value.name=["Please add at least one category"],c.error("Please add at least one category"),$.value=!1;return}s=b.value.map(o=>({name:typeof o=="string"?o:o.label,active:x.value,parent_id:null}))}e.append("isSubCategory",y.value?"1":"0"),s.forEach((o,a)=>{e.append(`categories[${a}][name]`,o.name),e.append(`categories[${a}][active]`,o.active?"1":"0"),o.parent_id&&e.append(`categories[${a}][parent_id]`,o.parent_id)}),v.value.file&&v.value.file instanceof File?(e.append("icon",v.value.file),console.log("ðŸ“Ž Icon attached to FormData:",{name:v.value.file.name,size:v.value.file.size,type:v.value.file.type})):console.warn("âš ï¸ No icon file to attach"),console.log("ðŸ“¦ FormData contents (CREATE):");for(let o of e.entries())o[1]instanceof File?console.log(`  ${o[0]}: [FILE] ${o[1].name} (${o[1].size} bytes)`):console.log(`  ${o[0]}: ${o[1]}`);await A.post("/menu-categories",e,{headers:{"Content-Type":"multipart/form-data"}}),c.success("Category created successfully")}bootstrap.Modal.getInstance(document.getElementById("addCatModal"))?.hide(),te(),f.value=null,await K()}catch(l){if(console.error("âŒ Submit error:",l),l.response?.status===422&&l.response?.data?.errors){const e=l.response.data.errors;let s=[];p.value={},Object.keys(e).forEach(o=>{let a=o.replace(/^categories\.\d+\./,"");p.value[a]=e[o],Array.isArray(e[o])&&e[o].forEach(u=>{s.push(u)})}),s.length>0?c.error(s.join(`
`)):c.error("Validation failed. Please check your input.")}else{const e=l.response?.data?.message||"Failed to save category";c.error(e+" âŒ")}}finally{$.value=!1}},te=()=>{y.value=!1,b.value=[],x.value=!0,k.value=null,Y.value="",v.value={label:E[0].label,value:E[0].value,icon:E[0].icon,file:null},f.value=null,T.value=""},V=()=>{p.value={},N.value=""},T=g(""),Ie=l=>{V(),f.value=l,y.value=!!l.parent_id,k.value=l.parent_id||null;const e=E.find(a=>a.value===l.icon);v.value=e||E[0],y.value?Y.value=l.name:b.value=[{label:l.name,value:l.name,id:l.id}],x.value=l.active,l.subcategories&&l.subcategories.length>0?(L.value=l.subcategories.map(a=>({label:a.name,value:a.id?a.id.toString():`temp_${Date.now()}_${Math.random()}`})),_.value=l.subcategories.map(a=>a.id?a.id.toString():`temp_${Date.now()}_${Math.random()}`),T.value=l.subcategories.map(a=>a.name).join(", ")):(L.value=[],_.value=[],T.value="");const s=document.getElementById("addCatModal");new bootstrap.Modal(s).show()},q=g(""),de=()=>{const l=(q.value||"").trim();l&&(ee.value.some(e=>e.label.toLowerCase()===l.toLowerCase())||ee.value.push({label:l,value:l}),b.value.includes(l)||(b.value=[...b.value,l]),q.value="")},Fe=async l=>{if(l?.id)try{await A.delete(`/menu-categories/${l.id}`),c.success("Category deleted successfully"),await K()}catch(e){console.error("âŒ Delete error:",e.response?.data||e.message),c.error("Failed to delete category âŒ")}},L=g([]),O=g(""),ae=()=>{const l=O.value?.trim();l&&(L.value.some(e=>e.value.toLowerCase()===l.toLowerCase())||L.value.push({label:l,value:l}),_.value.includes(l)||_.value.push(l),O.value="")},$e=()=>{_.value=L.value.map(l=>l.value)},De=()=>{_.value=[]},w=g({id:null,name:"",parent_id:null}),Me=(l,e)=>{w.value={id:e.id,name:e.name,parent_id:l.id};const s=document.getElementById("editSubCatModal"),o=bootstrap.Modal.getOrCreateInstance(s);V(),o.show()},P=g(!1),N=g(""),Be=()=>{w.value={id:null,name:"",parent_id:null},N.value={},P.value=!1},Ee=async()=>{if(!w.value.name.trim()){N.value="Subcategory name cannot be empty",c.error("Please filled all the required fields");return}P.value=!0;try{const{data:l}=await A.put(`/menu-categories/subcategories/${w.value.id}`,{name:w.value.name.trim()});if(l.success){c.success(l.message);const e=F.value.find(a=>a.id===w.value.parent_id);if(e){const a=e.subcategories.find(u=>u.id===w.value.id);a&&(a.name=w.value.name)}const s=document.getElementById("editSubCatModal");bootstrap.Modal.getInstance(s).hide(),w.value={id:null,name:"",parent_id:null}}else N.value=l.message||"Failed to update subcategory"}catch(l){console.error(l),N.value=l.response?.data?.message||"An error occurred while updating"}finally{P.value=!1}},le=l=>{if(!F.value||F.value.length===0){c.error("No Units data to download");return}const e=j.value.trim()?Q.value:F.value;if(e.length===0){c.error("No Units found to download");return}try{l==="pdf"?Le(e):l==="excel"?Ne(e):l==="csv"?Ve(e):c.error("Invalid download type")}catch(s){console.error("Download failed:",s),c.error(`Download failed: ${s.message}`)}},Ve=l=>{console.log("Data are",l);try{const e=["category","subcategory","active"],s=l.map(n=>{const S=n.subcategories&&n.subcategories.length>0?n.subcategories.map(se=>se.name).join(", "):"";return[`"${n.name||""}"`,`"${S}"`,`${n.active?1:0}`]}),o=[e.join(","),...s.map(n=>n.join(","))].join(`
`),a=new Blob([o],{type:"text/csv;charset=utf-8;"}),u=URL.createObjectURL(a),r=document.createElement("a");r.setAttribute("href",u),r.setAttribute("download",`Categories_${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(r),r.click(),document.body.removeChild(r),c.success("CSV downloaded successfully")}catch(e){console.error("CSV generation error:",e),c.error(`CSV generation failed: ${e.message}`,{autoClose:5e3})}},Le=l=>{try{const e=new Ze("p","mm","a4");e.setFontSize(18),e.setFont("helvetica","bold"),e.text("Menu Categories Report",60,20),e.setFontSize(10),e.setFont("helvetica","normal");const s=new Date().toLocaleString();e.text(`Generated on: ${s}`,14,28),e.text(`Total Categories: ${l.length}`,14,34);const o=["Category","Subcategories","Active"],a=l.map(r=>{const n=r.subcategories&&r.subcategories.length>0?r.subcategories.map(S=>S.name).join(", "):"";return[r.name||"",n,r.active?"1":"0"]});Ye(e,{head:[o],body:a,startY:40,styles:{fontSize:9,cellPadding:3,halign:"left",lineColor:[0,0,0],lineWidth:.1},headStyles:{fillColor:[41,128,185],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]},margin:{left:14,right:14},didDrawPage:r=>{const n=e.internal.getNumberOfPages(),S=e.internal.pageSize.height;e.setFontSize(8),e.text(`Page ${r.pageNumber} of ${n}`,r.settings.margin.left,S-10)}});const u=`Categories_${new Date().toISOString().split("T")[0]}.pdf`;e.save(u),c.success("PDF downloaded successfully")}catch(e){console.error("PDF generation error:",e),c.error(`PDF generation failed: ${e.message}`,{autoClose:5e3})}},Ne=l=>{try{if(typeof qe>"u")throw new Error("XLSX library is not loaded");const e=l.map(n=>{const S=n.subcategories&&n.subcategories.length>0?n.subcategories.map(se=>se.name).join(", "):"";return{Category:n.name||"",Subcategory:S,Active:n.active?"1":"0"}}),s=W.book_new(),o=W.json_to_sheet(e);o["!cols"]=[{wch:25},{wch:40},{wch:10}],W.book_append_sheet(s,o,"Menu Categories");const a=[{Info:"Generated On",Value:new Date().toLocaleString()},{Info:"Total Categories",Value:l.length},{Info:"Exported By",Value:"Menu Categories Management"}],u=W.json_to_sheet(a);W.book_append_sheet(s,u,"Report Info");const r=`Categories_${new Date().toISOString().split("T")[0]}.xlsx`;Ge(s,r),c.success("Excel downloaded successfully",{autoClose:2500})}catch(e){console.error("Excel generation error:",e),c.error(`Excel generation failed: ${e.message}`,{autoClose:5e3})}},je=l=>{if(!l||l.length<=1){c.error("The imported file is empty.");return}l[0];const s=l.slice(1).map(n=>({category:n[0]||"",subcategory:n[1]||null,active:n[2]=="0"?0:1})),o=s.filter(n=>n.category).map(n=>n.category.trim().toLowerCase()),a=o.filter((n,S)=>o.indexOf(n)!==S);if(a.length>0){c.error(`Duplicate parent category names found in CSV: ${[...new Set(a)].join(", ")}`);return}const u=F.value.filter(n=>!n.parent_id).map(n=>n.name.trim().toLowerCase()),r=s.filter(n=>n.category).filter(n=>u.includes(n.category.trim().toLowerCase()));if(r.length>0){const n=r.map(S=>S.category).join(", ");c.error(`Parent categories already exist in the table: ${n}`);return}A.post("/api/menu-categories/import",{categories:s}).then(()=>{c.success("Categories imported successfully"),K()}).catch(n=>{console.error(n),c.error("Import failed")})};return(l,e)=>{const s=ve("ConfirmModal"),o=ve("Button");return i(),oe(He,null,{default:U(()=>[C(D(Oe),{title:"Menu Category"}),t("div",at,[e[48]||(e[48]=t("h4",{class:"mb-3"},"Categories",-1)),t("div",lt,[(i(!0),d(M,null,H(he.value,a=>(i(),d("div",{key:a.label,class:"col-md-6 col-xl-4"},[t("div",st,[t("div",ot,[t("div",null,[t("div",nt,m(a.value),1),t("div",it,m(a.label),1)]),t("div",{class:B(["p-3 rounded-3 d-flex align-items-center justify-content-center",a.iconBg])},[(i(),oe(ze(a.icon),{class:B(a.iconColor),size:"28"},null,8,["class"]))],2)])])]))),128))]),t("div",rt,[t("div",ut,[t("div",ct,[e[27]||(e[27]=t("h4",{class:"mb-0"},"Categories",-1)),t("div",dt,[t("div",mt,[e[21]||(e[21]=t("i",{class:"bi bi-search"},null,-1)),e[22]||(e[22]=t("input",{type:"email",name:"email",autocomplete:"email",style:{position:"absolute",left:"-9999px",width:"1px",height:"1px"},tabindex:"-1","aria-hidden":"true"},null,-1)),ue.value?G((i(),d("input",{id:J,"onUpdate:modelValue":e[0]||(e[0]=a=>j.value=a),key:re.value,class:"form-control search-input",placeholder:"Search",type:"search",autocomplete:"new-password",name:J,role:"presentation",onFocus:e[1]||(e[1]=(...a)=>l.handleFocus&&l.handleFocus(...a))},null,32)),[[ne,j.value]]):(i(),d("input",vt))]),C(Xe,{modelValue:h.value,"onUpdate:modelValue":e[2]||(e[2]=a=>h.value=a),title:"Menu Categories","modal-id":"categoryFilterModal","modal-size":"modal-lg","sort-options":Z.value.sortOptions,"status-options":Z.value.statusOptions,"stock-status-options":Z.value.stockStatusOptions,"show-price-range":!0,"price-label":"Total Value Range",onApply:_e,onClear:ke},{customFilters:U(({filters:a})=>[t("div",pt,[e[24]||(e[24]=t("label",{class:"form-label fw-semibold text-dark"},[t("i",{class:"fas fa-sitemap me-2 text-muted"}),R("Subcategories ")],-1)),G(t("select",{"onUpdate:modelValue":u=>a.hasSubcategories=u,class:"form-select"},[e[23]||(e[23]=t("option",{value:""},"All",-1)),(i(!0),d(M,null,H(Z.value.hasSubcategoriesOptions,u=>(i(),d("option",{key:u.value,value:u.value},m(u.label),9,bt))),128))],8,gt),[[Ue,a.hasSubcategories]])])]),_:1},8,["modelValue","sort-options","status-options","stock-status-options"]),t("button",{"data-bs-toggle":"modal","data-bs-target":"#addCatModal",onClick:e[3]||(e[3]=a=>{f.value=null,Be(),we()}),class:"d-flex align-items-center gap-1 px-4 btn-sm py-2 rounded-pill btn btn-primary text-white"},[C(D(tt),{class:"w-4 h-4"}),e[25]||(e[25]=R(" Add Category ",-1))]),C(Je,{label:"Import",sampleHeaders:["category","subcategory","active"],sampleData:[["Dairy","TestSubCat",1],["Bakery","Bread",1],["Beverages","Juices",0]],onOnImport:je}),t("div",ft,[e[26]||(e[26]=t("button",{class:"btn btn-outline-secondary btn-sm rounded-pill py-2 px-4 dropdown-toggle","data-bs-toggle":"dropdown"}," Export ",-1)),t("ul",yt,[t("li",null,[t("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:e[4]||(e[4]=a=>le("pdf"))},"Export as PDF")]),t("li",null,[t("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:e[5]||(e[5]=a=>le("excel"))},"Export as Excel")]),t("li",null,[t("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:e[6]||(e[6]=a=>le("csv"))}," Export as CSV ")])])])])]),t("div",ht,[t("table",Ct,[e[29]||(e[29]=t("thead",{class:"border-top small text-muted"},[t("tr",null,[t("th",null,"S.#"),t("th",null,"Category"),t("th",null,"Sub Category"),t("th",null,"Icon"),t("th",null,"Total value"),t("th",null,"Total Item"),t("th",null,"Out of Stock"),t("th",null,"Low Stock"),t("th",null,"In Stock"),t("th",null,"Status"),t("th",{class:"text-center"},"Action")])],-1)),t("tbody",null,[(i(!0),d(M,null,H(Ce.value,(a,u)=>(i(),d("tr",{key:a.id},[t("td",null,m(u+1),1),t("td",_t,m(a.name),1),t("td",kt,[a.subcategories&&a.subcategories.length?(i(),d("div",wt,[(i(!0),d(M,null,H(a.subcategories,r=>(i(),d("div",{key:r.id,class:"d-flex justify-content-between align-items-center",style:{gap:"5px"}},[t("span",null,m(r.name),1),t("button",{"data-bs-toggle":"modal",onClick:()=>{Me(a,r)},title:"Edit",class:"p-2 rounded-full text-blue-600 hover:bg-blue-100"},[C(D(fe),{class:"w-4 h-4"})],8,St)]))),128))])):(i(),d("span",xt,"â€“"))]),t("td",null,[t("div",It,[a.image_url?(i(),d("img",{key:0,src:a.image_url,alt:a.name,class:"rounded",style:{width:"32px",height:"32px","object-fit":"cover"}},null,8,Ft)):(i(),d("span",$t,"ðŸ“¦"))])]),t("td",null,m(D(ye)(a.total_value)),1),t("td",null,m(a.total_menu_items),1),t("td",null,m(a.out_of_stock),1),t("td",null,m(a.low_stock),1),t("td",null,m(a.in_stock),1),t("td",null,[t("span",{class:B(["badge",a.active?"bg-success rounded-pill":"bg-danger rounded-pill"])},m(a.active?"Active":"Inactive"),3)]),t("td",Dt,[t("div",Mt,[t("button",{"data-bs-toggle":"modal","data-bs-target":"#modalUnitForm",onClick:()=>{Ie(a)},title:"Edit",class:"p-2 rounded-full text-blue-600 hover:bg-blue-100"},[C(D(fe),{class:"w-4 h-4"})],8,Bt),C(s,{title:"Confirm Delete",message:`Are you sure you want to delete ${a.name}?`,showDeleteButton:!0,onConfirm:()=>{Fe(a)},onCancel:()=>{}},null,8,["message","onConfirm"])])])]))),128)),Q.value.length===0?(i(),d("tr",Et,[...e[28]||(e[28]=[t("td",{colspan:"10",class:"text-center text-muted py-4"}," No categories found. ",-1)])])):I("",!0)])])])])]),t("div",Vt,[t("div",Lt,[t("div",Nt,[t("div",jt,[t("h5",Tt,m(f.value?"Edit Menu Category":"Add Menu Category"),1),t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close",onClick:te},[...e[30]||(e[30]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",Pt,[t("div",At,[f.value?I("",!0):(i(),d(M,{key:0},[t("div",Ot,[e[33]||(e[33]=t("label",{class:"form-label d-block mb-2"},"Is this a subcategory?",-1)),t("div",zt,[t("div",Ut,[t("input",{class:"form-check-input",type:"radio",checked:y.value,onClick:e[7]||(e[7]=a=>V()),onChange:e[8]||(e[8]=a=>{y.value=!0,k.value=null}),name:"isSub"},null,40,Ht),e[31]||(e[31]=t("label",{class:"form-check-label"},"Yes",-1))]),t("div",Rt,[t("input",{class:"form-check-input",type:"radio",checked:!y.value,onClick:e[9]||(e[9]=a=>V()),onChange:e[10]||(e[10]=a=>{y.value=!1,k.value=null}),name:"isSub"},null,40,Wt),e[32]||(e[32]=t("label",{class:"form-check-label"},"No",-1))])])]),y.value?(i(),d("div",Kt,[e[34]||(e[34]=t("label",{class:"form-label"},"Category",-1)),C(D(We),{modelValue:k.value,"onUpdate:modelValue":e[11]||(e[11]=a=>k.value=a),options:X.value,optionLabel:"name",optionValue:"id",placeholder:"Select Category",class:B(["w-100",{"is-invalid":p.value?.parent_id}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","class"]),p.value?.parent_id?(i(),d("small",Xt,m(p.value.parent_id[0]),1)):I("",!0)])):I("",!0)],64)),t("div",Zt,[e[36]||(e[36]=t("label",{class:"form-label d-block mb-2"},"Manual Icon",-1)),t("div",Yt,[t("button",qt,[t("div",Gt,[t("img",{src:v.value.icon,alt:"icon",class:"me-2 rounded",width:"30",height:"30"},null,8,Jt),t("span",null,m(v.value.label),1)]),e[35]||(e[35]=t("i",{class:"bi bi-caret-down-fill"},null,-1))]),t("ul",Qt,[(i(),d(M,null,H(E,a=>t("li",{key:a.label},[t("a",{class:"dropdown-item d-flex align-items-center",href:"javascript:void(0)",onClick:u=>Se(a)},[t("img",{src:a.icon,alt:"icon",class:"me-2 rounded",width:"30",height:"30"},null,8,ta),t("span",null,m(a.label),1)],8,ea)])),64))])])]),!y.value||f.value?(i(),d("div",aa,[e[37]||(e[37]=t("label",{class:"form-label"},"Category Name",-1)),f.value?G((i(),d("input",{key:0,type:"text","onUpdate:modelValue":e[12]||(e[12]=a=>b.value[0].label=a),class:B(["form-control",{"is-invalid":p.value.name}]),placeholder:"Enter category name"},null,2)),[[ne,b.value[0].label]]):(i(),oe(D(be),{key:1,modelValue:b.value,"onUpdate:modelValue":e[13]||(e[13]=a=>b.value=a),options:ee,optionLabel:"label",optionValue:"value",filter:!0,display:"chip",class:B([{"is-invalid":p.value.name},"w-100"]),placeholder:"Select or add categories...",appendTo:"self",onKeydown:pe(ge(de,["prevent"]),["enter"]),onBlur:de,onFilter:e[14]||(e[14]=a=>q.value=a.value)},{option:U(({option:a})=>[R(m(a.label),1)]),_:1},8,["modelValue","class","onKeydown"])),p.value.name?(i(),d("small",la,m(p.value.name[0]),1)):I("",!0)])):I("",!0),y.value&&!f.value?(i(),d("div",sa,[e[38]||(e[38]=t("label",{class:"form-label"},"Subcategory Name(s)",-1)),C(D(be),{modelValue:_.value,"onUpdate:modelValue":e[15]||(e[15]=a=>_.value=a),options:L.value,optionLabel:"label",optionValue:"value",filter:!0,display:"chip",class:B([{"is-invalid":p.value?.subcategories||p.value?.name},"w-100"]),placeholder:"Select or add subcategories...",appendTo:"self",onFilter:e[16]||(e[16]=a=>O.value=a.value||""),onKeydown:pe(ge(ae,["prevent"]),["enter"]),onBlur:ae},{option:U(({option:a})=>[t("div",null,m(a.label),1)]),footer:U(()=>[t("div",oa,[C(o,{label:"Add Custom",severity:"secondary",variant:"text",size:"small",icon:"pi pi-plus",onClick:ae,disabled:!O.value.trim()},null,8,["onClick","disabled"]),t("div",na,[C(o,{label:"Select All",severity:"secondary",variant:"text",size:"small",icon:"pi pi-check",onClick:$e},null,8,["onClick"]),C(o,{label:"Clear All",severity:"danger",variant:"text",size:"small",icon:"pi pi-times",onClick:De},null,8,["onClick"])])])]),_:1},8,["modelValue","options","class","onKeydown"]),p.value?.subcategories?(i(),d("div",ia,m(p.value.subcategories[0]),1)):I("",!0),p.value?.name?(i(),d("div",ra,m(p.value.name[0]),1)):I("",!0)])):I("",!0),f.value&&l.parentCategory?(i(),d("div",ua,[e[39]||(e[39]=t("label",{class:"form-label"},"Parent Category",-1)),t("input",{type:"text",class:"form-control",value:l.parentCategory.label,disabled:""},null,8,ca)])):I("",!0),t("div",da,[e[42]||(e[42]=t("label",{class:"form-label d-block mb-2"},"Active",-1)),t("div",ma,[t("div",va,[t("input",{class:"form-check-input",type:"radio",checked:x.value,onChange:e[17]||(e[17]=a=>x.value=!0),name:"active"},null,40,pa),e[40]||(e[40]=t("label",{class:"form-check-label"},"Yes",-1))]),t("div",ga,[t("input",{class:"form-check-input",type:"radio",checked:!x.value,onChange:e[18]||(e[18]=a=>x.value=!1),name:"active"},null,40,ba),e[41]||(e[41]=t("label",{class:"form-check-label"},"No",-1))])])])]),e[44]||(e[44]=t("hr",{class:"my-4"},null,-1)),t("div",fa,[t("button",{class:"btn btn-primary rounded-pill btn-sm py-2 px-4",disabled:$.value,onClick:e[19]||(e[19]=a=>xe())},[$.value?(i(),d(M,{key:0},[e[43]||(e[43]=t("span",{class:"spinner-border spinner-border-sm me-2"},null,-1)),R(" "+m((f.value,"Saving...")),1)],64)):(i(),d(M,{key:1},[R(m((f.value,"Save")),1)],64))],8,ya),t("button",{class:"btn btn-secondary btn-sm py-2 rounded-pill px-4 ms-2","data-bs-dismiss":"modal",onClick:te}," Cancel ")])])])])]),t("div",ha,[t("div",Ca,[t("div",_a,[t("div",{class:"modal-header"},[e[46]||(e[46]=t("h5",{class:"modal-title",id:"editSubCatModalLabel"}," Edit Subcategory ",-1)),t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close",onClick:V},[...e[45]||(e[45]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",ka,[t("div",wa,[e[47]||(e[47]=t("label",{for:"subCategoryName",class:"form-label"},"Subcategory Name",-1)),G(t("input",{type:"text",class:B(["form-control",{"is-invalid":N.value}]),id:"subCategoryName","onUpdate:modelValue":e[20]||(e[20]=a=>w.value.name=a),disabled:P.value},null,10,Sa),[[ne,w.value.name]]),t("small",xa,m(N.value),1)]),t("button",{type:"button",class:"btn btn-primary rounded-pill px-4",onClick:Ee,disabled:P.value},m(P.value?"Saving...":"Save"),9,Ia)])])])])])]),_:1})}}},Wa=Te(Fa,[["__scopeId","data-v-e39ba1ac"]]);export{Wa as default};
