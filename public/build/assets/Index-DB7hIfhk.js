import{_ as ge}from"./Master-CXzRQq-r.js";import{_ as _e,r as S,c as L,y as fe,o as le,I as xe,n as we,f as d,b as u,d as T,u as c,h as Se,w as ke,e,m as v,l as f,J as Q,F as p,t as i,g as M,K as E,p as De}from"./app-BHYyRJnL.js";import{u as Te}from"./useFormatters-wi1aVjp-.js";import{s as O}from"./index-CmEobXQy.js";import{E as Re,a as Pe,u as z,w as Ce}from"./xlsx-CpHCO-2F.js";import"./index-B0N7947y.js";import"./createLucideIcon-DmJxs4Lg.js";import"./index-CpMR2yR9.js";import"./index-Bs9GfHmp.js";import"./sun-soDtTQcu.js";import"./index-ZEA6XP_E.js";import"./index-uhINJth7.js";const Le={class:"page-wrapper"},Ae={class:"card border-0 shadow-sm rounded-4 mb-4"},je={class:"card-body"},Me={class:"row g-3"},Oe={class:"col-md-3"},Ie={class:"col-md-3"},Ne={key:0,class:"col-md-3"},Ve={key:1,class:"col-md-2"},$e={key:2,class:"col-md-2"},Ue={key:3,class:"col-md-3"},Ye={key:4,class:"col-md-2"},Fe={key:5,class:"col-md-2"},qe={class:"row g-3 mb-4"},Qe={class:"col-md-6 col-xl-3"},Ee={class:"card border-0 shadow-sm rounded-4"},ze={class:"card-body d-flex align-items-center justify-content-between"},Je={class:"mb-0 fw-bold"},Be={class:"col-md-6 col-xl-3"},Ge={class:"card border-0 shadow-sm rounded-4"},Ke={class:"card-body d-flex align-items-center justify-content-between"},Xe={class:"mb-0 fw-bold"},He={class:"col-md-6 col-xl-3"},We={class:"card border-0 shadow-sm rounded-4"},Ze={class:"card-body d-flex align-items-center justify-content-between"},et={class:"mb-0 fw-bold"},tt={class:"col-md-6 col-xl-3"},st={class:"card border-0 shadow-sm rounded-4"},lt={class:"card-body d-flex align-items-center justify-content-between"},at={class:"mb-0 fw-bold"},ot={class:"col-md-6 col-xl-3"},nt={class:"card border-0 shadow-sm rounded-4"},it={class:"card-body d-flex align-items-center justify-content-between"},dt={class:"mb-0 fw-bold"},ut={class:"col-md-6 col-xl-3"},rt={class:"card border-0 shadow-sm rounded-4"},ct={class:"card-body d-flex align-items-center justify-content-between"},mt={class:"mb-0 fw-bold"},vt={class:"col-md-6 col-xl-3"},yt={class:"card border-0 shadow-sm rounded-4"},pt={class:"card-body d-flex align-items-center justify-content-between"},ht={class:"mb-0 fw-bold"},bt={class:"col-md-6 col-xl-3"},gt={class:"card border-0 shadow-sm rounded-4"},_t={class:"card-body d-flex align-items-center justify-content-between"},ft={class:"mb-0 fw-bold"},xt={class:"col-md-6 col-xl-3"},wt={class:"card border-0 shadow-sm rounded-4"},St={class:"card-body d-flex align-items-center justify-content-between"},kt={class:"mb-0 fw-bold"},Dt={class:"col-md-6 col-xl-3"},Tt={class:"card border-0 shadow-sm rounded-4"},Rt={class:"card-body d-flex align-items-center justify-content-between"},Pt={class:"mb-0 fw-bold"},Ct={class:"col-md-6 col-xl-3"},Lt={class:"card border-0 shadow-sm rounded-4"},At={class:"card-body d-flex align-items-center justify-content-between"},jt={class:"mb-0 fw-bold"},Mt={class:"col-md-6 col-xl-3"},Ot={class:"card border-0 shadow-sm rounded-4"},It={class:"card-body d-flex align-items-center justify-content-between"},Nt={class:"mb-0 fw-bold"},Vt={class:"col-md-6 col-xl-3"},$t={class:"card border-0 shadow-sm rounded-4"},Ut={class:"card-body d-flex align-items-center justify-content-between"},Yt={class:"mb-0 fw-bold"},Ft={class:"col-md-6 col-xl-3"},qt={class:"card border-0 shadow-sm rounded-4"},Qt={class:"card-body d-flex align-items-center justify-content-between"},Et={class:"mb-0 fw-bold"},zt={class:"col-md-6 col-xl-3"},Jt={class:"card border-0 shadow-sm rounded-4"},Bt={class:"card-body d-flex align-items-center justify-content-between"},Gt={class:"mb-0 fw-bold"},Kt={class:"col-md-6 col-xl-3"},Xt={class:"card border-0 shadow-sm rounded-4"},Ht={class:"card-body d-flex align-items-center justify-content-between"},Wt={class:"mb-0 fw-bold"},Zt={class:"col-md-6 col-xl-3"},es={class:"card border-0 shadow-sm rounded-4"},ts={class:"card-body d-flex align-items-center justify-content-between"},ss={class:"mb-0 fw-bold"},ls={class:"col-md-6 col-xl-3"},as={class:"card border-0 shadow-sm rounded-4"},os={class:"card-body d-flex align-items-center justify-content-between"},ns={class:"mb-0 fw-bold"},is={class:"col-md-6 col-xl-3"},ds={class:"card border-0 shadow-sm rounded-4"},us={class:"card-body d-flex align-items-center justify-content-between"},rs={class:"mb-0 fw-bold"},cs={class:"col-md-6 col-xl-3"},ms={class:"card border-0 shadow-sm rounded-4"},vs={class:"card-body d-flex align-items-center justify-content-between"},ys={class:"mb-0 fw-bold"},ps={class:"col-md-6 col-xl-3"},hs={class:"card border-0 shadow-sm rounded-4"},bs={class:"card-body d-flex align-items-center justify-content-between"},gs={class:"mb-0 fw-bold"},_s={class:"col-md-6 col-xl-3"},fs={class:"card border-0 shadow-sm rounded-4"},xs={class:"card-body d-flex align-items-center justify-content-between"},ws={class:"mb-0 fw-bold"},Ss={class:"col-md-6 col-xl-3"},ks={class:"card border-0 shadow-sm rounded-4"},Ds={class:"card-body d-flex align-items-center justify-content-between"},Ts={class:"mb-0 fw-bold"},Rs={class:"col-md-6 col-xl-3"},Ps={class:"card border-0 shadow-sm rounded-4"},Cs={class:"card-body d-flex align-items-center justify-content-between"},Ls={class:"mb-0 fw-bold"},As={key:0,class:"alert alert-warning border-0 rounded-4 shadow-sm"},js={class:"card border-0 shadow-sm rounded-4 mt-3"},Ms={class:"card-body"},Os={class:"table-responsive"},Is={class:"table table-hover align-middle"},Ns={class:"small text-muted"},Vs={key:0},$s={key:1},Us={key:2},Ys={key:3},Fs={key:4},qs={key:5,style:{width:"150px"}},Qs={key:6,style:{width:"100px"}},Es={key:7,style:{width:"100px"}},zs={key:0},Js={key:1},Bs={key:2,style:{width:"100px"}},Gs={key:3},Ks={key:4,style:{width:"150px"}},Xs={key:5,style:{width:"150px"}},Hs={key:6,style:{width:"130px"}},Ws={key:7,style:{width:"150px"}},Zs={key:8,style:{width:"120px"}},el={key:9,style:{width:"100px"}},tl={class:"fw-semibold"},sl={key:0,class:"small"},ll={key:1,class:"small"},al={class:"fw-bold text-success"},ol={key:2,class:"small"},nl={class:"fw-semibold"},il={key:0,class:"fw-semibold"},dl={key:1,class:"small"},ul={key:0,class:"text-muted"},rl={key:1,class:"text-secondary"},cl={key:2,class:"small"},ml={class:"fw-bold text-success"},vl={key:3,class:"small"},yl={key:4},pl={key:0,class:"badge bg-success-subtle text-success px-3 py-2 rounded-pill"},hl={key:1,class:"badge bg-warning-subtle text-warning px-3 py-2 rounded-pill"},bl={key:2,class:"badge bg-secondary-subtle text-secondary px-3 py-2 rounded-pill"},gl={class:"fw-semibold"},_l={class:"fw-semibold"},fl={key:0,class:"badge bg-success-subtle text-success"},xl={key:1,class:"badge bg-warning-subtle text-warning"},wl={key:2,class:"badge bg-danger-subtle text-danger"},Sl={class:"fw-semibold"},kl={class:"fw-semibold"},Dl={key:0,class:"table-active fw-bold border-top border-3"},Tl={class:"text-success"},Rl={key:1,class:"table-active fw-bold border-top border-3"},Pl={key:2},Cl={key:3},Ll={class:"row g-3"},Al={class:"col-lg-8"},jl={class:"card border-0 shadow-sm rounded-4 h-100"},Ml={class:"card-body"},Ol={class:"fw-semibold mb-2"},Il={class:"chart"},Nl={viewBox:"0 0 840 280"},Vl=["y1","y2"],$l=["x","y"],Ul=["x","y"],Yl=["d"],Fl=["d"],ql={key:2},Ql={key:3,x:"430",y:"140","text-anchor":"middle",fill:"#6b7280"},El={class:"col-lg-4"},zl={class:"card border-0 shadow-sm rounded-4 mb-3"},Jl={class:"card-body"},Bl={class:"stack-row"},Gl={class:"stack-val"},Kl={class:"progress thin"},Xl={class:"card border-0 shadow-sm rounded-4"},Hl={class:"card-body"},Wl={class:"stack"},Zl={class:"stack-row"},ea={class:"stack-val"},ta={class:"stack-row"},sa={class:"stack-val"},la={class:"stack-row"},aa={class:"stack-val"},oa={class:"stack-row"},na={__name:"Index",setup(ia){const{formatNumber:w,formatCurrencySymbol:n,dateFmt:k}=Te(),s=S({type:"sales",timeRange:"monthly",selectedMonth:"",selectedYear:"",selectedDate:"",selectedYear:"",dateFrom:"",dateTo:"",orderType:"",paymentType:""}),ae=[{label:"Sales Analytics",value:"sales"},{label:"Purchase Analytics",value:"purchase"},{label:"Sales vs Purchase",value:"comparison"},{label:"Stock Analysis",value:"stock"},{label:"Cashier Performance",value:"userSales"},{label:"Category Analysis",value:"category"}],oe=[{label:"Daily",value:"daily"},{label:"Monthly",value:"monthly"},{label:"Yearly",value:"yearly"},{label:"Custom Range",value:"custom"}],R=S(!1),D=S(""),ne=S(Date.now()),ie=`search-${Math.random().toString(36).substr(2,9)}`,de=S(!1),$=S(""),_=S({}),U=S([]),P=S([]),J=S([]),r=S({}),B=S("Just now"),G=S(0),ue=L(()=>{const m=[],t=["January","February","March","April","May","June","July","August","September","October","November","December"];for(let a=1;a<=12;a++){const l=String(a).padStart(2,"0");m.push({value:l,label:t[a-1]})}return m}),K=L(()=>{const m=new Date().getFullYear(),t=[];for(let a=m;a>=m-10;a--)t.push(a);return t}),X=L(()=>({sales:"Sales Over Time",purchase:"Purchase Over Time",comparison:"Sales vs Purchase",stock:"Stock Trend",userSales:"Cashier Performance",category:"Category Distribution"})[s.value.type]||"Chart"),H=L(()=>{if(s.value.timeRange==="daily")return s.value.selectedDate?`Date: ${s.value.selectedDate}`:"Select a date";if(s.value.timeRange==="monthly"){const t=["January","February","March","April","May","June","July","August","September","October","November","December"][parseInt(s.value.selectedMonth)-1]||"";return s.value.selectedMonth&&s.value.selectedYear?`${t} ${s.value.selectedYear}`:"Select month and year"}return s.value.timeRange==="yearly"?s.value.selectedYear?`Year: ${s.value.selectedYear}`:"Select a year":s.value.dateFrom&&s.value.dateTo?`${s.value.dateFrom} to ${s.value.dateTo}`:"Select dates"});function re(m,t,a,l={l:50,r:20,t:40,b:50}){if(!m?.length)return{paths:[],xLabels:[],yLabels:[]};const b=m.map((y,x)=>x),o=m.map(y=>+y.total||+y.sales||+y.purchase||+y.value||0),g=m.map(y=>+y.purchase||0),N=0,ye=Math.max(1,b.length-1),pe=[...o,...g].filter(y=>y>0),W=0,Z=Math.max(1,...pe),he=Math.max(1,t-l.l-l.r),Y=Math.max(1,a-l.t-l.b),A=y=>l.l+(y-N)/(ye-N)*he,j=y=>l.t+Y-(y-W)/(Z-W)*Y;let F="";if(b.length===1){const y=A(0),x=j(o[0]);F=`M${y},${x} L${y+.01},${x}`}else F=b.map((y,x)=>`${x?"L":"M"}${A(y)},${j(o[x])}`).join(" ");let q="";if(g.some(y=>y>0))if(b.length===1){const y=A(0),x=j(g[0]);q=`M${y},${x} L${y+.01},${x}`}else q=b.map((y,x)=>`${x?"L":"M"}${A(y)},${j(g[x])}`).join(" ");const be=m.map((y,x)=>{let V;if(y.date){const se=new Date(y.date);y.date.length===7&&y.date.includes("-")?V=se.toLocaleDateString("en-US",{month:"short"}):V=se.toLocaleDateString("en-US",{weekday:"short"})}else V=`Day ${x+1}`;return{x:A(x),y:l.t+Y+20,text:V}}),ee=5,te=[];for(let y=0;y<=ee;y++){const x=Z/ee*y;te.push({x:l.l-10,y:j(x),text:Math.round(x).toLocaleString()})}return{salesPath:F,purchasePath:q,xLabels:be,yLabels:te}}const C=L(()=>re(U.value,840,280)),h=L(()=>{const m=$.value.trim().toLowerCase();return s.value.type!=="sales"?m?(P.value||[]).filter(t=>[t.name,t.cashierName,t.categoryName,t.metric].filter(Boolean).join(" ").toLowerCase().includes(m)):P.value||[]:m?(P.value||[]).filter(t=>[String(t.id),t.customer_name].filter(Boolean).join(" ").toLowerCase().includes(m)):P.value||[]}),ce=()=>{s.value.selectedMonth="",s.value.selectedYear="",s.value.selectedDate="",s.value.dateFrom="",s.value.dateTo=""},I=async()=>{if(s.value.timeRange==="daily"&&!s.value.selectedDate){D.value="Please select a date";return}if(s.value.timeRange==="monthly"&&(!s.value.selectedMonth||!s.value.selectedYear)){D.value="Please select both month and year";return}if(s.value.timeRange==="monthly"&&!s.value.selectedMonth){D.value="Please select a month";return}if(s.value.timeRange==="yearly"&&!s.value.selectedYear){D.value="Please select a year";return}if(s.value.timeRange==="custom"&&(!s.value.dateFrom||!s.value.dateTo)){D.value="Please select both start and end dates";return}R.value=!0,D.value="";try{const{data:m}=await De.get("/api/analytics",{params:{type:s.value.type,timeRange:s.value.timeRange,selectedMonth:s.value.selectedMonth,selectedYear:s.value.selectedYear,selectedDate:s.value.selectedDate,dateFrom:s.value.dateFrom,dateTo:s.value.dateTo,orderType:s.value.orderType,paymentType:s.value.paymentType}});_.value=m.kpi||{},U.value=m.chartData||[],P.value=m.tableData||[],J.value=m.distributionData||[],r.value=m.totalsSummary||{},G.value=P.value.length,B.value=new Date().toLocaleTimeString()}catch(m){console.error(m),D.value=m.response?.data?.message||"Failed to load analytics"}finally{R.value=!1}};fe(()=>[s.value.type,s.value.timeRange,s.value.selectedMonth,s.value.selectedYear,s.value.selectedDate],()=>{s.value.type&&s.value.timeRange&&(s.value.timeRange==="daily"&&s.value.selectedDate||s.value.timeRange==="monthly"&&s.value.selectedMonth&&s.value.selectedYear||s.value.timeRange==="yearly"&&s.value.selectedYear||s.value.timeRange==="custom"&&s.value.dateFrom&&s.value.dateTo)&&I()}),le(()=>window.feather?.replace()),xe(()=>window.feather?.replace()),le(async()=>{$.value="",ne.value=Date.now(),await we(),setTimeout(()=>{de.value=!0;const m=document.getElementById(ie);m&&(m.value="",$.value="")},100)});const me=()=>{try{const m=new Re("l","mm","a4");m.setFontSize(18),m.setFont("helvetica","bold"),m.text(`${X.value}`,14,20),m.setFontSize(10),m.setFont("helvetica","normal");const t=new Date().toLocaleString();m.text(`Generated on: ${t}`,14,28),m.text(`Period: ${H.value}`,14,34),m.text(`Total Records: ${h.value.length}`,14,40);let a=[],l=[];if(s.value.type==="sales"){if(s.value.timeRange==="monthly"?(a=["S.#","Day","Orders","Items","Qty","Sub Total","Tax","Service","Delivery","Sales Disc.","Approved Disc.","Promo Disc.","Total"],l=h.value.map((o,g)=>[g+1,"Day "+new Date(o.order_date).getDate(),o.order_count,o.item_count,o.total_qty,n(o.sub_total),n(o.tax),n(o.service_charges),n(o.delivery_charges),n(o.sales_discount),n(o.approved_discounts),n(o.promo_discount),n(o.total_amount)])):s.value.timeRange==="yearly"?(a=["S.#","Month","Orders","Items","Qty","Sub Total","Tax","Service","Delivery","Sales Disc.","Approved Disc.","Promo Disc.","Total"],l=h.value.map((o,g)=>[g+1,new Date(o.order_month+"-01").toLocaleDateString("en-US",{month:"long",year:"numeric"}),o.order_count,o.item_count,o.total_qty,n(o.sub_total),n(o.tax),n(o.service_charges),n(o.delivery_charges),n(o.sales_discount),n(o.approved_discounts),n(o.promo_discount),n(o.total_amount)])):(a=["S.#","Order ID","Customer","Items","Qty","Sub Total","Tax","Service","Delivery","Sales Disc.","Approved Disc.","Promo Disc.","Promos","Promo Type","Total","Date"],l=h.value.map((o,g)=>[g+1,o.id,o.customer_name||"-",o.item_count,o.total_qty,n(o.sub_total),n(o.tax),n(o.service_charges),n(o.delivery_charges),n(o.sales_discount),n(o.approved_discounts),n(o.promo_discount),o.promo_names||"-",o.promo_types||"-",n(o.total_amount),k(o.order_date)])),r.value&&h.value.length>0){const o=s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?["TOTAL","-","-",r.value.item_count,r.value.total_qty,n(r.value.sub_total),n(r.value.tax),n(r.value.service_charges),n(r.value.delivery_charges),n(r.value.sales_discount),n(r.value.approved_discounts),n(r.value.promo_discount),n(r.value.total_amount)]:["TOTAL","-","-",r.value.item_count,r.value.total_qty,n(r.value.sub_total),n(r.value.tax),n(r.value.service_charges),n(r.value.delivery_charges),n(r.value.sales_discount),n(r.value.approved_discounts),n(r.value.promo_discount),"-","-",n(r.value.total_amount),"-"];l.push(o)}}else if(s.value.type==="purchase"){if(s.value.timeRange==="monthly"?(a=["S.#","Day","Purchases","Quantity","Unit Price","Sub Total","Suppliers","Total Amount"],l=h.value.map((o,g)=>[g+1,"Day "+new Date(o.purchase_date).getDate(),o.purchase_count,o.quantity,n(o.total_unit_price),n(o.sub_total),o.supplier_names||"-",n(o.total_amount)])):s.value.timeRange==="yearly"?(a=["S.#","Month","Purchases","Quantity","Unit Price","Sub Total","Suppliers","Total Amount"],l=h.value.map((o,g)=>[g+1,new Date(o.purchase_month+"-01").toLocaleDateString("en-US",{month:"long",year:"numeric"}),o.purchase_count,o.quantity,n(o.total_unit_price),n(o.sub_total),o.supplier_names||"-",n(o.total_amount)])):(a=["S.#","Purchase ID","Supplier","Product","Quantity","Unit Price","Sub Total","Expiry","Purchase Date","Status"],l=h.value.map((o,g)=>[g+1,o.purchase_id,o.supplier_name||"-",o.product_name||"-",o.quantity,n(o.unit_price),n(o.sub_total),o.expiry_date?k(o.expiry_date):"N/A",k(o.purchase_date),o.status||"-"])),r.value&&h.value.length>0){const o=s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?["TOTAL","-","-",r.value.quantity,n(r.value.total_unit_price),n(r.value.sub_total),"-",n(r.value.total_amount)]:["TOTAL","-","-","-",r.value.quantity,n(r.value.total_unit_price),n(r.value.sub_total),"-","-","-"];l.push(o)}}else s.value.type==="comparison"?(a=["S.#","Metric","Sales","Purchase","Difference"],l=h.value.map((o,g)=>[g+1,o.metric,n(o.sales),n(o.purchase),n(o.difference)])):s.value.type==="stock"?(a=["S.#","Item","Current Stock","Min Level","Status"],l=h.value.map((o,g)=>[g+1,o.name,o.currentStock,o.minLevel,o.currentStock>o.minLevel?"In Stock":o.currentStock>0?"Low Stock":"Out of Stock"])):s.value.type==="userSales"?(a=["S.#","Cashier Name","Orders","Total Sales","Avg Sale"],l=h.value.map((o,g)=>[g+1,o.cashierName,o.orderCount,n(o.totalSales),n(o.avgSale)])):s.value.type==="category"&&(a=["S.#","Category","Qty Sold","Revenue","% of Total"],l=h.value.map((o,g)=>[g+1,o.categoryName,o.qty,n(o.revenue),o.percentage+"%"]));Pe(m,{head:[a],body:l,startY:46,styles:{fontSize:7,cellPadding:2,halign:"left",lineColor:[0,0,0],lineWidth:.1},headStyles:{fillColor:[41,128,185],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]},margin:{left:14,right:14},didDrawPage:o=>{const g=m.internal.getNumberOfPages(),N=m.internal.pageSize.height;m.setFontSize(8),m.text(`Page ${o.pageNumber} of ${g}`,o.settings.margin.left,N-10)}});const b=`${s.value.type}_Analytics_${new Date().toISOString().split("T")[0]}.pdf`;m.save(b)}catch(m){console.error("PDF generation error:",m),D.value=`PDF generation failed: ${m.message}`}},ve=()=>{let m=[];if(s.value.type==="sales"){if(s.value.timeRange==="monthly"?m=h.value.map((l,b)=>({"S.#":b+1,Day:"Day "+new Date(l.order_date).getDate(),Orders:l.order_count,"Item Count":l.item_count,"Total Qty":l.total_qty,"Sub Total":l.sub_total,Tax:l.tax,"Service Charge":l.service_charges,"Delivery Charge":l.delivery_charges,"Sales Discount":l.sales_discount,"Approved Discount":l.approved_discounts,"Promo Discount":l.promo_discount,"Total Amount":l.total_amount})):s.value.timeRange==="yearly"?m=h.value.map((l,b)=>({"S.#":b+1,Month:new Date(l.order_month+"-01").toLocaleDateString("en-US",{month:"long",year:"numeric"}),Orders:l.order_count,"Item Count":l.item_count,"Total Qty":l.total_qty,"Sub Total":l.sub_total,Tax:l.tax,"Service Charge":l.service_charges,"Delivery Charge":l.delivery_charges,"Sales Discount":l.sales_discount,"Approved Discount":l.approved_discounts,"Promo Discount":l.promo_discount,"Total Amount":l.total_amount})):m=h.value.map((l,b)=>({"S.#":b+1,"Order ID":l.id,"Customer Name":l.customer_name,"Item Count":l.item_count,"Total Qty":l.total_qty,"Sub Total":l.sub_total,Tax:l.tax,"Service Charge":l.service_charges,"Delivery Charge":l.delivery_charges,"Sales Discount":l.sales_discount,"Approved Discount":l.approved_discounts,"Promo Discount":l.promo_discount,"Applied Promos":l.promo_names,"Promo Type":l.promo_types,"Total Amount":l.total_amount,Date:k(l.order_date)})),r.value){const l=s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?{"S.#":"TOTAL",[s.value.timeRange==="monthly"?"Day":"Month"]:"-",Orders:"-","Item Count":r.value.item_count,"Total Qty":r.value.total_qty,"Sub Total":r.value.sub_total,Tax:r.value.tax,"Service Charge":r.value.service_charges,"Delivery Charge":r.value.delivery_charges,"Sales Discount":r.value.sales_discount,"Approved Discount":r.value.approved_discounts,"Promo Discount":r.value.promo_discount,"Total Amount":r.value.total_amount}:{"S.#":"TOTAL","Order ID":"-","Customer Name":"-","Item Count":r.value.item_count,"Total Qty":r.value.total_qty,"Sub Total":r.value.sub_total,Tax:r.value.tax,"Service Charge":r.value.service_charges,"Delivery Charge":r.value.delivery_charges,"Sales Discount":r.value.sales_discount,"Approved Discount":r.value.approved_discounts,"Promo Discount":r.value.promo_discount,"Applied Promos":"-","Promo Type":"-","Total Amount":r.value.total_amount,Date:"-"};m.push(l)}}else if(s.value.type==="purchase"){if(s.value.timeRange==="monthly"?m=h.value.map((l,b)=>({"S.#":b+1,Day:"Day "+new Date(l.purchase_date).getDate(),Purchases:l.purchase_count,Quantity:l.quantity,"Unit Price":l.total_unit_price,"Sub Total":l.sub_total,Suppliers:l.supplier_names,"Total Amount":l.total_amount})):s.value.timeRange==="yearly"?m=h.value.map((l,b)=>({"S.#":b+1,Month:new Date(l.purchase_month+"-01").toLocaleDateString("en-US",{month:"long",year:"numeric"}),Purchases:l.purchase_count,Quantity:l.quantity,"Unit Price":l.total_unit_price,"Sub Total":l.sub_total,Suppliers:l.supplier_names,"Total Amount":l.total_amount})):m=h.value.map((l,b)=>({"S.#":b+1,"Purchase ID":l.purchase_id,"Supplier Name":l.supplier_name,"Product Name":l.product_name,Quantity:l.quantity,"Unit Price":l.unit_price,"Sub Total":l.sub_total,"Expiry Date":l.expiry_date?k(l.expiry_date):"N/A","Purchase Date":k(l.purchase_date),Status:l.status})),r.value){const l=s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?{"S.#":"TOTAL",[s.value.timeRange==="monthly"?"Day":"Month"]:"-",Purchases:"-",Quantity:r.value.quantity,"Unit Price":r.value.total_unit_price,"Sub Total":r.value.sub_total,Suppliers:"-","Total Amount":r.value.total_amount}:{"S.#":"TOTAL","Purchase ID":"-","Supplier Name":"-","Product Name":"-",Quantity:r.value.quantity,"Unit Price":r.value.total_unit_price,"Sub Total":r.value.sub_total,"Expiry Date":"-","Purchase Date":"-",Status:"-"};m.push(l)}}else s.value.type==="comparison"?m=h.value.map((l,b)=>({"S.#":b+1,Metric:l.metric,Sales:l.sales,Purchase:l.purchase,Difference:l.difference})):s.value.type==="stock"?m=h.value.map((l,b)=>({"S.#":b+1,Item:l.name,"Current Stock":l.currentStock,"Min Level":l.minLevel,Status:l.currentStock>l.minLevel?"In Stock":l.currentStock>0?"Low Stock":"Out of Stock"})):s.value.type==="userSales"?m=h.value.map((l,b)=>({"S.#":b+1,"Cashier Name":l.cashierName,Orders:l.orderCount,"Total Sales":l.totalSales,"Avg Sale":l.avgSale})):s.value.type==="category"&&(m=h.value.map((l,b)=>({"S.#":b+1,Category:l.categoryName,"Qty Sold":l.qty,Revenue:l.revenue,"% of Total":l.percentage+"%"})));const t=z.json_to_sheet(m),a=z.book_new();z.book_append_sheet(a,t,s.value.type),Ce(a,`${s.value.type}-analytics-${Date.now()}.xlsx`)};return(m,t)=>(u(),d(p,null,[T(c(Se),{title:"Analytics"}),T(ge,null,{default:ke(()=>[e("div",Le,[e("div",{class:"d-flex flex-wrap gap-2 align-items-center justify-content-between mb-3"},[t[9]||(t[9]=e("h4",{class:"mb-1"},"Analytics & Reports",-1)),t[10]||(t[10]=e("div",null,null,-1)),e("div",{class:"dropdown"},[t[8]||(t[8]=e("button",{class:"btn btn-outline-secondary rounded-pill px-4 dropdown-toggle","data-bs-toggle":"dropdown"},[e("i",{class:"fas fa-download me-2"}),f("Export ")],-1)),e("ul",{class:"dropdown-menu dropdown-menu-end shadow rounded-4 py-2"},[e("li",null,[e("a",{class:"dropdown-item py-2",href:"javascript:void(0)",onClick:me}," Export as PDF ")]),e("li",null,[e("a",{class:"dropdown-item py-2",href:"javascript:void(0)",onClick:ve}," Export as Excel ")])])])]),e("div",Ae,[e("div",je,[e("div",Me,[e("div",Oe,[t[11]||(t[11]=e("label",{class:"form-label fw-semibold text-dark"},[e("i",{class:"fas fa-chart-bar me-2 text-muted"}),f("Analytics Type ")],-1)),T(c(O),{modelValue:s.value.type,"onUpdate:modelValue":t[0]||(t[0]=a=>s.value.type=a),options:ae,optionLabel:"label",optionValue:"value",placeholder:"Select Analytics Type",class:"w-100"},null,8,["modelValue"])]),e("div",Ie,[t[12]||(t[12]=e("label",{class:"form-label fw-semibold text-dark"},[e("i",{class:"fas fa-calendar-alt me-2 text-muted"}),f("Time Range ")],-1)),T(c(O),{modelValue:s.value.timeRange,"onUpdate:modelValue":t[1]||(t[1]=a=>s.value.timeRange=a),options:oe,optionLabel:"label",optionValue:"value",placeholder:"Select Time Range",onChange:ce,class:"w-100"},null,8,["modelValue"])]),s.value.timeRange==="daily"?(u(),d("div",Ne,[t[13]||(t[13]=e("label",{class:"form-label fw-semibold text-dark"},[e("i",{class:"fas fa-calendar me-2 text-muted"}),f("Select Date ")],-1)),T(c(Q),{modelValue:s.value.selectedDate,"onUpdate:modelValue":t[2]||(t[2]=a=>s.value.selectedDate=a),placeholder:"Choose Date",format:"yyyy-MM-dd","enable-time-picker":!1,"single-calendar":""},null,8,["modelValue"])])):v("",!0),s.value.timeRange==="monthly"?(u(),d("div",Ve,[t[14]||(t[14]=e("label",{class:"form-label fw-semibold text-dark"},[e("i",{class:"fas fa-calendar me-2 text-muted"}),f("Select Month ")],-1)),T(c(O),{modelValue:s.value.selectedMonth,"onUpdate:modelValue":t[3]||(t[3]=a=>s.value.selectedMonth=a),options:ue.value,optionLabel:"label",optionValue:"value",placeholder:"Choose Month",class:"w-100"},null,8,["modelValue","options"])])):v("",!0),s.value.timeRange==="monthly"?(u(),d("div",$e,[t[15]||(t[15]=e("label",{class:"form-label fw-semibold text-dark"},[e("i",{class:"fas fa-calendar me-2 text-muted"}),f("Select Year ")],-1)),T(c(O),{modelValue:s.value.selectedYear,"onUpdate:modelValue":t[4]||(t[4]=a=>s.value.selectedYear=a),options:K.value,placeholder:"Choose Year",class:"w-100"},null,8,["modelValue","options"])])):v("",!0),s.value.timeRange==="yearly"?(u(),d("div",Ue,[t[16]||(t[16]=e("label",{class:"form-label fw-semibold text-dark"},[e("i",{class:"fas fa-calendar me-2 text-muted"}),f("Select Year ")],-1)),T(c(O),{modelValue:s.value.selectedYear,"onUpdate:modelValue":t[5]||(t[5]=a=>s.value.selectedYear=a),options:K.value,placeholder:"Choose Year",class:"w-100"},null,8,["modelValue","options"])])):v("",!0),s.value.timeRange==="custom"?(u(),d("div",Ye,[t[17]||(t[17]=e("label",{class:"form-label fw-semibold text-dark"},[e("i",{class:"fas fa-calendar me-2 text-muted"}),f("Start Date ")],-1)),T(c(Q),{modelValue:s.value.dateFrom,"onUpdate:modelValue":t[6]||(t[6]=a=>s.value.dateFrom=a),placeholder:"Select Start Date",format:"yyyy-MM-dd"},null,8,["modelValue"])])):v("",!0),s.value.timeRange==="custom"?(u(),d("div",Fe,[t[18]||(t[18]=e("label",{class:"form-label fw-semibold text-dark"},[e("i",{class:"fas fa-calendar me-2 text-muted"}),f("End Date ")],-1)),T(c(Q),{modelValue:s.value.dateTo,"onUpdate:modelValue":t[7]||(t[7]=a=>s.value.dateTo=a),placeholder:"Select End Date",format:"yyyy-MM-dd"},null,8,["modelValue"])])):v("",!0)])])]),e("div",qe,[s.value.type==="sales"?(u(),d(p,{key:0},[e("div",Qe,[e("div",Ee,[e("div",ze,[e("div",null,[e("h4",Je,i(c(n)(_.value.revenue||0)),1),t[19]||(t[19]=e("p",{class:"text-muted mb-0 small"},"Total Revenue",-1))]),t[20]||(t[20]=e("div",{class:"rounded-circle p-3 bg-success-subtle text-success d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-currency-pound fs-4"})],-1))])])]),e("div",Be,[e("div",Ge,[e("div",Ke,[e("div",null,[e("h4",Xe,i(c(w)(_.value.ordersCount)),1),t[21]||(t[21]=e("p",{class:"text-muted mb-0 small"},"Total Orders",-1))]),t[22]||(t[22]=e("div",{class:"rounded-circle p-3 bg-primary-subtle text-primary d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-receipt fs-4"})],-1))])])]),e("div",He,[e("div",We,[e("div",Ze,[e("div",null,[e("h4",et,i(c(n)(_.value.aov||0)),1),t[23]||(t[23]=e("p",{class:"text-muted mb-0 small"},"Avg. Order Value",-1))]),t[24]||(t[24]=e("div",{class:"rounded-circle p-3 bg-warning-subtle text-warning d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-graph-up fs-4"})],-1))])])]),e("div",tt,[e("div",st,[e("div",lt,[e("div",null,[e("h4",at,i(c(w)(_.value.itemsSold)),1),t[25]||(t[25]=e("p",{class:"text-muted mb-0 small"},"Items Sold",-1))]),t[26]||(t[26]=e("div",{class:"rounded-circle p-3 bg-danger-subtle text-danger d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-basket fs-4"})],-1))])])])],64)):v("",!0),s.value.type==="purchase"?(u(),d(p,{key:1},[e("div",ot,[e("div",nt,[e("div",it,[e("div",null,[e("h4",dt,i(c(n)(_.value.purchaseCost||0)),1),t[27]||(t[27]=e("p",{class:"text-muted mb-0 small"},"Total Purchase Cost",-1))]),t[28]||(t[28]=e("div",{class:"rounded-circle p-3 bg-info-subtle text-info d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-bag-check fs-4"})],-1))])])]),e("div",ut,[e("div",rt,[e("div",ct,[e("div",null,[e("h4",mt,i(c(w)(_.value.purchaseCount)),1),t[29]||(t[29]=e("p",{class:"text-muted mb-0 small"},"Total Purchases",-1))]),t[30]||(t[30]=e("div",{class:"rounded-circle p-3 bg-primary-subtle text-primary d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-box-seam fs-4"})],-1))])])]),e("div",vt,[e("div",yt,[e("div",pt,[e("div",null,[e("h4",ht,i(c(n)(_.value.avgPurchaseValue||0)),1),t[31]||(t[31]=e("p",{class:"text-muted mb-0 small"},"Avg. Purchase Value",-1))]),t[32]||(t[32]=e("div",{class:"rounded-circle p-3 bg-warning-subtle text-warning d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-graph-up fs-4"})],-1))])])]),e("div",bt,[e("div",gt,[e("div",_t,[e("div",null,[e("h4",ft,i(c(w)(_.value.itemsPurchased)),1),t[33]||(t[33]=e("p",{class:"text-muted mb-0 small"},"Items Purchased",-1))]),t[34]||(t[34]=e("div",{class:"rounded-circle p-3 bg-secondary-subtle text-secondary d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-boxes fs-4"})],-1))])])])],64)):v("",!0),s.value.type==="comparison"?(u(),d(p,{key:2},[e("div",xt,[e("div",wt,[e("div",St,[e("div",null,[e("h4",kt,i(c(n)(_.value.salesRevenue)),1),t[35]||(t[35]=e("p",{class:"text-muted mb-0 small"},"Sales Revenue",-1))]),t[36]||(t[36]=e("div",{class:"rounded-circle p-3 bg-success-subtle text-success d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-arrow-up-right fs-4"})],-1))])])]),e("div",Dt,[e("div",Tt,[e("div",Rt,[e("div",null,[e("h4",Pt,i(c(n)(_.value.purchaseCost)),1),t[37]||(t[37]=e("p",{class:"text-muted mb-0 small"},"Purchase Cost",-1))]),t[38]||(t[38]=e("div",{class:"rounded-circle p-3 bg-danger-subtle text-danger d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-arrow-down-left fs-4"})],-1))])])]),e("div",Ct,[e("div",Lt,[e("div",At,[e("div",null,[e("h4",jt,i(c(n)(_.value.grossProfit)),1),t[39]||(t[39]=e("p",{class:"text-muted mb-0 small"},"Gross Profit",-1))]),t[40]||(t[40]=e("div",{class:"rounded-circle p-3 bg-primary-subtle text-primary d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-graph-up fs-4"})],-1))])])]),e("div",Mt,[e("div",Ot,[e("div",It,[e("div",null,[e("h4",Nt,i(_.value.profitMargin)+"%",1),t[41]||(t[41]=e("p",{class:"text-muted mb-0 small"},"Profit Margin",-1))]),t[42]||(t[42]=e("div",{class:"rounded-circle p-3 bg-info-subtle text-info d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-percent fs-4"})],-1))])])])],64)):v("",!0),s.value.type==="stock"?(u(),d(p,{key:3},[e("div",Vt,[e("div",$t,[e("div",Ut,[e("div",null,[e("h4",Yt,i(c(w)(_.value.totalStock)),1),t[43]||(t[43]=e("p",{class:"text-muted mb-0 small"},"Total Items in Stock",-1))]),t[44]||(t[44]=e("div",{class:"rounded-circle p-3 bg-info-subtle text-info d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-box-seam fs-4"})],-1))])])]),e("div",Ft,[e("div",qt,[e("div",Qt,[e("div",null,[e("h4",Et,i(c(w)(_.value.lowStockItems)),1),t[45]||(t[45]=e("p",{class:"text-muted mb-0 small"},"Low Stock Items",-1))]),t[46]||(t[46]=e("div",{class:"rounded-circle p-3 bg-warning-subtle text-warning d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-exclamation-triangle fs-4"})],-1))])])]),e("div",zt,[e("div",Jt,[e("div",Bt,[e("div",null,[e("h4",Gt,i(c(w)(_.value.outOfStockItems)),1),t[47]||(t[47]=e("p",{class:"text-muted mb-0 small"},"Out of Stock",-1))]),t[48]||(t[48]=e("div",{class:"rounded-circle p-3 bg-danger-subtle text-danger d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-x-circle fs-4"})],-1))])])]),e("div",Kt,[e("div",Xt,[e("div",Ht,[e("div",null,[e("h4",Wt,i(c(n)(_.value.stockValue)),1),t[49]||(t[49]=e("p",{class:"text-muted mb-0 small"},"Total Stock Value",-1))]),t[50]||(t[50]=e("div",{class:"rounded-circle p-3 bg-success-subtle text-success d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-cash-coin fs-4"})],-1))])])])],64)):v("",!0),s.value.type==="userSales"?(u(),d(p,{key:4},[e("div",Zt,[e("div",es,[e("div",ts,[e("div",null,[e("h4",ss,i(c(n)(_.value.totalUserSales)),1),t[51]||(t[51]=e("p",{class:"text-muted mb-0 small"},"Total Sales",-1))]),t[52]||(t[52]=e("div",{class:"rounded-circle p-3 bg-success-subtle text-success d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-currency-pound fs-4"})],-1))])])]),e("div",ls,[e("div",as,[e("div",os,[e("div",null,[e("h4",ns,i(c(n)(_.value.avgCashierSales)),1),t[53]||(t[53]=e("p",{class:"text-muted mb-0 small"},"Avg. per Cashier",-1))]),t[54]||(t[54]=e("div",{class:"rounded-circle p-3 bg-primary-subtle text-primary d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-person-check fs-4"})],-1))])])]),e("div",is,[e("div",ds,[e("div",us,[e("div",null,[e("h4",rs,i(c(w)(_.value.activeCashiers)),1),t[55]||(t[55]=e("p",{class:"text-muted mb-0 small"},"Active Cashiers",-1))]),t[56]||(t[56]=e("div",{class:"rounded-circle p-3 bg-info-subtle text-info d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-people fs-4"})],-1))])])]),e("div",cs,[e("div",ms,[e("div",vs,[e("div",null,[e("h4",ys,i(c(n)(_.value.topCashierSales)),1),t[57]||(t[57]=e("p",{class:"text-muted mb-0 small"},"Top Cashier Sales",-1))]),t[58]||(t[58]=e("div",{class:"rounded-circle p-3 bg-warning-subtle text-warning d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-star fs-4"})],-1))])])])],64)):v("",!0),s.value.type==="category"?(u(),d(p,{key:5},[e("div",ps,[e("div",hs,[e("div",bs,[e("div",null,[e("h4",gs,i(c(w)(_.value.totalCategories)),1),t[59]||(t[59]=e("p",{class:"text-muted mb-0 small"},"Total Categories",-1))]),t[60]||(t[60]=e("div",{class:"rounded-circle p-3 bg-info-subtle text-info d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-tag fs-4"})],-1))])])]),e("div",_s,[e("div",fs,[e("div",xs,[e("div",null,[e("h4",ws,i(c(n)(_.value.categoryRevenue)),1),t[61]||(t[61]=e("p",{class:"text-muted mb-0 small"},"Total Revenue",-1))]),t[62]||(t[62]=e("div",{class:"rounded-circle p-3 bg-success-subtle text-success d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-currency-pound fs-4"})],-1))])])]),e("div",Ss,[e("div",ks,[e("div",Ds,[e("div",null,[e("h4",Ts,i(_.value.topCategory),1),t[63]||(t[63]=e("p",{class:"text-muted mb-0 small"},"Top Category",-1))]),t[64]||(t[64]=e("div",{class:"rounded-circle p-3 bg-primary-subtle text-primary d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-trophy fs-4"})],-1))])])]),e("div",Rs,[e("div",Ps,[e("div",Cs,[e("div",null,[e("h4",Ls,i(c(w)(_.value.totalCategorySales)),1),t[65]||(t[65]=e("p",{class:"text-muted mb-0 small"},"Total Items Sold",-1))]),t[66]||(t[66]=e("div",{class:"rounded-circle p-3 bg-warning-subtle text-warning d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-bag-check fs-4"})],-1))])])])],64)):v("",!0)]),D.value?(u(),d("div",As,i(D.value),1)):v("",!0),e("div",js,[e("div",Ms,[t[106]||(t[106]=e("div",{class:"d-flex flex-wrap gap-2 justify-content-between align-items-center mb-3"},[e("h6",{class:"fw-semibold mb-0"},"Detailed Data")],-1)),e("div",Os,[e("table",Is,[e("thead",Ns,[e("tr",null,[t[95]||(t[95]=e("th",{style:{width:"60px"}},"S.#",-1)),s.value.type==="sales"?(u(),d(p,{key:0},[s.value.timeRange==="monthly"?(u(),d("th",Vs,"Day")):s.value.timeRange==="yearly"?(u(),d("th",$s,"Month")):(u(),d("th",Us,"Order ID")),s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?(u(),d("th",Ys," Orders")):(u(),d("th",Fs,"Customer Name")),t[67]||(t[67]=e("th",{style:{width:"120px"}},"Sub Total",-1)),t[68]||(t[68]=e("th",{style:{width:"120px"}},"Tax",-1)),t[69]||(t[69]=e("th",{style:{width:"120px"}},"Service Charge",-1)),t[70]||(t[70]=e("th",{style:{width:"120px"}},"Delivery Charge",-1)),t[71]||(t[71]=e("th",{style:{width:"120px"}},"Sale Discount",-1)),t[72]||(t[72]=e("th",{style:{width:"120px"}},"Approved Discount",-1)),t[73]||(t[73]=e("th",{style:{width:"140px"}},"Promo Discount",-1)),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("th",qs,"Applied Promos")):v("",!0),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("th",Qs,"Promo Type")):v("",!0),t[74]||(t[74]=e("th",{style:{width:"140px"}},"Total Amount",-1)),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("th",Es,"Date")):v("",!0)],64)):v("",!0),s.value.type==="purchase"?(u(),d(p,{key:1},[s.value.timeRange==="monthly"?(u(),d("th",zs,"Day")):s.value.timeRange==="yearly"?(u(),d("th",Js,"Month")):(u(),d("th",Bs,"Purchase ID")),s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?(u(),d("th",Gs," Purchases")):(u(),d("th",Ks,"Supplier Name")),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("th",Xs,"Product Name")):v("",!0),t[75]||(t[75]=e("th",{style:{width:"100px"}},"Quantity",-1)),t[76]||(t[76]=e("th",{style:{width:"120px"}},"Unit Price",-1)),t[77]||(t[77]=e("th",{style:{width:"140px"}},"Sub Total",-1)),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("th",Hs,"Expiry Date")):v("",!0),s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?(u(),d("th",Ws,"Suppliers")):v("",!0),t[78]||(t[78]=e("th",{style:{width:"140px"}},"Total Amount",-1)),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("th",Zs,"Purchase Date")):v("",!0),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("th",el,"Status")):v("",!0)],64)):v("",!0),s.value.type==="comparison"?(u(),d(p,{key:2},[t[79]||(t[79]=e("th",null,"Metric",-1)),t[80]||(t[80]=e("th",{style:{width:"140px"}},"Sales",-1)),t[81]||(t[81]=e("th",{style:{width:"140px"}},"Purchase",-1)),t[82]||(t[82]=e("th",{style:{width:"140px"}},"Difference",-1))],64)):v("",!0),s.value.type==="stock"?(u(),d(p,{key:3},[t[83]||(t[83]=e("th",null,"Item",-1)),t[84]||(t[84]=e("th",{style:{width:"100px"}},"Stock",-1)),t[85]||(t[85]=e("th",{style:{width:"100px"}},"Min Level",-1)),t[86]||(t[86]=e("th",{style:{width:"120px"}},"Status",-1))],64)):v("",!0),s.value.type==="userSales"?(u(),d(p,{key:4},[t[87]||(t[87]=e("th",null,"Cashier Name",-1)),t[88]||(t[88]=e("th",{style:{width:"120px"}},"Orders",-1)),t[89]||(t[89]=e("th",{style:{width:"140px"}},"Total Sales",-1)),t[90]||(t[90]=e("th",{style:{width:"120px"}},"Avg Sale",-1))],64)):v("",!0),s.value.type==="category"?(u(),d(p,{key:5},[t[91]||(t[91]=e("th",null,"Category",-1)),t[92]||(t[92]=e("th",{style:{width:"120px"}},"Qty Sold",-1)),t[93]||(t[93]=e("th",{style:{width:"140px"}},"Revenue",-1)),t[94]||(t[94]=e("th",{style:{width:"100px"}},"% of Total",-1))],64)):v("",!0)])]),e("tbody",null,[(u(!0),d(p,null,M(h.value,(a,l)=>(u(),d("tr",{key:l},[e("td",null,i(l+1),1),s.value.type==="sales"?(u(),d(p,{key:0},[e("td",tl,[s.value.timeRange==="monthly"?(u(),d(p,{key:0},[f(i(new Date(a.order_date).toLocaleString("en-US",{month:"short"})+" "+String(new Date(a.order_date).getDate()).padStart(2,"0")),1)],64)):s.value.timeRange==="yearly"?(u(),d(p,{key:1},[f(i(new Date(a.order_month+"-01").toLocaleDateString("en-US",{month:"long",year:"numeric"})),1)],64)):(u(),d(p,{key:2},[f(i(a.id),1)],64))]),e("td",null,[s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?(u(),d(p,{key:0},[f(i(a.order_count)+" Orders ",1)],64)):(u(),d(p,{key:1},[f(i(a.customer_name),1)],64))]),e("td",null,i(c(n)(a.sub_total)),1),e("td",null,i(c(n)(a.tax)),1),e("td",null,i(c(n)(a.service_charges)),1),e("td",null,i(c(n)(a.delivery_charges)),1),e("td",null,i(c(n)(a.sales_discount)),1),e("td",null,i(c(n)(a.approved_discounts)),1),e("td",null,i(c(n)(a.promo_discount)),1),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("td",sl,i(a.promo_names),1)):v("",!0),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("td",ll,i(a.promo_types),1)):v("",!0),e("td",al,i(c(n)(a.total_amount)),1),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("td",ol,i(c(k)(a.order_date)),1)):v("",!0)],64)):v("",!0),s.value.type==="purchase"?(u(),d(p,{key:1},[e("td",nl,[s.value.timeRange==="monthly"?(u(),d(p,{key:0},[f(i(new Date(a.purchase_date).toLocaleString("en-US",{month:"short"})+" "+String(new Date(a.purchase_date).getDate()).padStart(2,"0")),1)],64)):s.value.timeRange==="yearly"?(u(),d(p,{key:1},[f(i(new Date(a.purchase_month+"-01").toLocaleDateString("en-US",{month:"long",year:"numeric"})),1)],64)):(u(),d(p,{key:2},[f(i(a.purchase_id),1)],64))]),e("td",null,[s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?(u(),d(p,{key:0},[f(i(a.purchase_count)+" Purchases ",1)],64)):(u(),d(p,{key:1},[f(i(a.supplier_name),1)],64))]),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("td",il,i(a.product_name),1)):v("",!0),e("td",null,i(c(w)(a.quantity)),1),e("td",null,i(c(n)(a.total_unit_price)),1),e("td",null,i(c(n)(a.sub_total)),1),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("td",dl,[a.expiry_date?(u(),d("span",ul,i(c(k)(a.expiry_date)),1)):(u(),d("span",rl,"N/A"))])):v("",!0),s.value.timeRange==="monthly"||s.value.timeRange==="yearly"?(u(),d("td",cl,i(a.supplier_names),1)):v("",!0),e("td",ml,i(c(n)(a.total_amount)),1),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("td",vl,i(c(k)(a.purchase_date)),1)):v("",!0),s.value.timeRange!=="monthly"&&s.value.timeRange!=="yearly"?(u(),d("td",yl,[a.status==="completed"?(u(),d("span",pl," Completed ")):a.status==="pending"?(u(),d("span",hl," Pending ")):(u(),d("span",bl,i(a.status),1))])):v("",!0)],64)):v("",!0),s.value.type==="comparison"?(u(),d(p,{key:2},[e("td",gl,i(a.metric),1),e("td",null,i(c(n)(a.sales)),1),e("td",null,i(c(n)(a.purchase)),1),e("td",{style:E({color:a.difference>0?"#10b981":"#ef4444"}),class:"fw-semibold"},i(c(n)(a.difference)),5)],64)):v("",!0),s.value.type==="stock"?(u(),d(p,{key:3},[e("td",_l,i(a.name),1),e("td",null,i(c(w)(a.currentStock)),1),e("td",null,i(c(w)(a.minLevel)),1),e("td",null,[a.currentStock>a.minLevel?(u(),d("span",fl," In Stock ")):a.currentStock>0?(u(),d("span",xl," Low Stock ")):(u(),d("span",wl," Out of Stock "))])],64)):v("",!0),s.value.type==="userSales"?(u(),d(p,{key:4},[e("td",Sl,i(a.cashierName),1),e("td",null,i(c(w)(a.orderCount)),1),e("td",null,i(c(n)(a.totalSales)),1),e("td",null,i(c(n)(a.avgSale)),1)],64)):v("",!0),s.value.type==="category"?(u(),d(p,{key:5},[e("td",kl,i(a.categoryName),1),e("td",null,i(c(w)(a.qty)),1),e("td",null,i(c(n)(a.revenue)),1),e("td",null,i(a.percentage)+"%",1)],64)):v("",!0)]))),128)),s.value.type==="sales"&&h.value.length>0?(u(),d("tr",Dl,[t[96]||(t[96]=e("td",{colspan:"0",class:"text-end"},"TOTALS",-1)),t[97]||(t[97]=e("td",{colspan:"0"},"-",-1)),t[98]||(t[98]=e("td",{colspan:"0"},"-",-1)),e("td",null,i(c(n)(r.value.sub_total)),1),e("td",null,i(c(n)(r.value.tax)),1),e("td",null,i(c(n)(r.value.service_charges)),1),e("td",null,i(c(n)(r.value.delivery_charges)),1),e("td",null,i(c(n)(r.value.sales_discount+r.value.approved_discounts)),1),e("td",null,i(c(n)(r.value.approved_discounts)),1),e("td",null,i(c(n)(r.value.promo_discount)),1),e("td",Tl,i(c(n)(r.value.total_amount)),1),t[99]||(t[99]=e("td",null,null,-1))])):v("",!0),s.value.type==="purchase"&&h.value.length>0?(u(),d("tr",Rl,[t[100]||(t[100]=e("td",{colspan:"0"},"TOTALS",-1)),t[101]||(t[101]=e("td",null,"-",-1)),t[102]||(t[102]=e("td",null,"-",-1)),e("td",null,i(c(w)(r.value.quantity)),1),e("td",null,i(c(n)(r.value.total_unit_price)),1),e("td",null,i(c(n)(r.value.sub_total)),1),t[103]||(t[103]=e("td",{colspan:"3"},null,-1))])):v("",!0),!R.value&&h.value.length===0?(u(),d("tr",Pl,[...t[104]||(t[104]=[e("td",{colspan:16,class:"text-center text-muted py-4"}," No data available for this period. ",-1)])])):v("",!0),R.value?(u(),d("tr",Cl,[...t[105]||(t[105]=[e("td",{colspan:5,class:"text-center text-muted py-4"},[e("i",{class:"fas fa-spinner fa-spin me-2"}),f("Loadingâ€¦ ")],-1)])])):v("",!0)])])])])]),e("div",Ll,[e("div",Al,[e("div",jl,[e("div",Ml,[e("h6",Ol,i(X.value),1),e("div",Il,[(u(),d("svg",Nl,[t[108]||(t[108]=e("line",{x1:"50",y1:"40",x2:"50",y2:"230",stroke:"#4b5563","stroke-width":"1"},null,-1)),t[109]||(t[109]=e("line",{x1:"50",y1:"230",x2:"820",y2:"230",stroke:"#4b5563","stroke-width":"1"},null,-1)),(u(),d(p,null,M(5,a=>e("g",{key:"grid"+a},[e("line",{x1:50,x2:820,y1:230-a*38,y2:230-a*38,stroke:"#374151","stroke-width":"0.5",opacity:"0.3"},null,8,Vl)])),64)),(u(!0),d(p,null,M(C.value.yLabels,(a,l)=>(u(),d("text",{key:"ylabel"+l,x:a.x,y:a.y+5,"text-anchor":"end",fill:"#9ca3af","font-size":"11"},i(a.text),9,$l))),128)),(u(!0),d(p,null,M(C.value.xLabels,(a,l)=>(u(),d("text",{key:"xlabel"+l,x:a.x,y:a.y,"text-anchor":"middle",fill:"#9ca3af","font-size":"11"},i(a.text),9,Ul))),128)),C.value.salesPath?(u(),d("path",{key:0,d:C.value.salesPath,fill:"none",stroke:"#10b981","stroke-width":"3","stroke-linecap":"round"},null,8,Yl)):v("",!0),s.value.type==="comparison"&&C.value.purchasePath?(u(),d("path",{key:1,d:C.value.purchasePath,fill:"none",stroke:"#ef4444","stroke-width":"3","stroke-linecap":"round"},null,8,Fl)):v("",!0),s.value.type==="comparison"?(u(),d("g",ql,[...t[107]||(t[107]=[e("circle",{cx:"750",cy:"20",r:"5",fill:"#10b981"},null,-1),e("text",{x:"760",y:"25",fill:"#9ca3af","font-size":"12"},"Sales",-1),e("circle",{cx:"820",cy:"20",r:"5",fill:"#ef4444"},null,-1),e("text",{x:"830",y:"25",fill:"#9ca3af","font-size":"12"},"Purchase",-1)])])):v("",!0),U.value.length?v("",!0):(u(),d("text",Ql," No data available "))]))])])])]),e("div",El,[e("div",zl,[e("div",Jl,[t[110]||(t[110]=e("h6",{class:"fw-semibold mb-3"},"Distribution",-1)),(u(!0),d(p,null,M(J.value,a=>(u(),d("div",{key:a.label,class:"stack"},[e("div",Bl,[e("span",null,i(a.label),1),e("span",Gl,i(a.value)+" ("+i(a.percentage)+"%)",1)]),e("div",Kl,[e("div",{class:"progress-bar",style:E({width:a.percentage+"%",backgroundColor:a.color})},null,4)])]))),128))])]),e("div",Xl,[e("div",Hl,[t[115]||(t[115]=e("h6",{class:"fw-semibold mb-3"},"Summary Info",-1)),e("div",Wl,[e("div",Zl,[t[111]||(t[111]=e("span",null,"Period",-1)),e("span",ea,i(c(k)(H.value)),1)]),e("div",ta,[t[112]||(t[112]=e("span",null,"Data Points",-1)),e("span",sa,i(G.value),1)]),e("div",la,[t[113]||(t[113]=e("span",null,"Last Updated",-1)),e("span",aa,i(B.value),1)]),e("div",oa,[t[114]||(t[114]=e("span",null,"Status",-1)),e("span",{class:"stack-val",style:E({color:R.value?"#f59e0b":"#10b981"})},i(R.value?"Loading...":"Active"),5)])])])])])])])]),_:1})],64))}},fa=_e(na,[["__scopeId","data-v-0533c7ae"]]);export{fa as default};
