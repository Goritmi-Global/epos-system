import{_ as V,A as L,r as f,c as x,f as l,m as r,b as d,e,l as u,t as a,F as R,g as K,u as v,k as g,Y as k,v as U,i as C,b5 as B,d as I,q as M}from"./app-DOXFdmcK.js";import q from"./StripePayment-CMc125io.js";import E from"./SplitPayment-BkA3R93a.js";import{u as F}from"./useFormatters-DHGdNh2A.js";const $={key:0,class:"modal fade show d-block",tabindex:"-1",style:{background:"rgba(0, 0, 0, 0.5)"}},j={class:"modal-dialog modal-lg modal-dialog-centered"},z={class:"modal-content rounded-4 s border-0"},G={class:"modal-header brand-gradient text-white py-3 position-sticky top-0 z-3"},Q={class:"modal-body p-3 p-md-4 body-scroll"},W={class:"row g-3"},Y={class:"col-12 col-md-6 d-flex"},H={class:"w-100 d-flex flex-column gap-3"},J={class:"card border-0 brand-card h-100"},X={class:"card-body"},Z={class:"row g-3"},_={class:"col-12 col-sm-6"},ee={class:"p-3 rounded-3 bg-light d-flex flex-column h-100"},te={class:"fw-semibold"},oe={class:"col-12 col-sm-6"},se={class:"p-3 rounded-3 bg-light d-flex flex-column h-100"},ae={class:"fw-semibold"},le={class:"badge brand-badge px-3 py-2"},de={key:0,class:"col-12 col-sm-6"},ne={class:"p-3 rounded-3 bg-light d-flex flex-column"},re={class:"fw-semibold"},ie={key:1,class:"col-12 col-sm-6"},ce={class:"p-3 rounded-3 bg-light d-flex flex-column"},me={class:"fw-semibold"},ue={key:2,class:"col-12 col-sm-6"},ve={class:"p-3 rounded-3 bg-light d-flex flex-column"},he={class:"fw-semibold"},be={class:"table-responsive compact-table"},pe={class:"table align-middle table-hover mb-0"},ye={class:"fw-semibold"},ge={key:0,class:"small text-muted"},fe={key:1,class:"small text-muted"},xe={key:2,class:"small text-warning fw-semibold"},Te={class:"text-center"},ke={class:"text-end"},Ce={class:"text-end fw-bold"},we={key:0},Ne={colspan:"4",class:"text-end text-muted"},De={key:0},Se={class:"text-end text-success"},Re={class:"fw-bold"},Ie={class:"text-end text-success"},Me={class:"col-12 col-md-6 d-flex"},Pe={class:"w-100"},Ae={class:"card border-0 brand-card h-100"},Oe={class:"card-body d-flex flex-column"},Ve={class:"segmented mt-1 mb-3",role:"tablist","aria-label":"Payment method"},Le={key:0,class:"pt-2 border-top"},Ke={key:0,class:"text-danger"},Ue={class:"mt-2"},Be={class:"form-check mt-3"},qe={class:"d-flex gap-2 mt-3"},Ee=["disabled"],Fe={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},$e={key:1,class:"bi bi-check2-circle"},je={key:1,class:"pt-3 border-top"},ze={class:"mt-2"},Ge={key:2,class:"pt-3 border-top"},Qe={__name:"ConfirmOrderModal",props:{show:Boolean,customer:String,deliveryLocation:String,phone:String,orderType:String,selectedTable:Object,orderItems:Array,grandTotal:Number,money:Function,cashReceived:Number,order_code:String,subTotal:Number,tax:Number,serviceCharges:Number,deliveryCharges:Number,note:[String,null],kitchenNote:[String,null],orderDate:String,orderTime:String,paymentMethod:String,change:Number,promoDiscount:{type:Number,default:0},promoId:{type:[Number,String,null],default:null},promoName:{type:[String,null],default:null},promoType:{type:[String,null],default:null},promoDiscountAmount:{type:Number,default:0},appliedPromos:{type:Array,default:()=>[]},approvedDiscounts:{type:Number,default:0},approvedDiscountDetails:{type:Array,default:()=>[]}},emits:["close","confirm","update:cashReceived"],setup(t,{emit:P}){const w=L(),{formatCurrencySymbol:h}=F(),i=t,T=f(!1),b=f({});console.log("ConfirmOrderModal props:",w.props);const N=P,n=f("Cash"),p=x({get:()=>i.cashReceived,set:c=>N("update:cashReceived",c)}),m=x(()=>n.value==="Cash"?p.value-i.grandTotal:0),D=x(()=>Array.isArray(i.orderItems)?i.orderItems.reduce((c,o)=>c+(Number(o.unit_price)||0)*(Number(o.qty)||0),0):0),y=f(!1),A=async()=>{if(b.value.cashReceived=null,!i.cashReceived||i.cashReceived<=0){b.value.cashReceived="Enter a valid cash amount.",M.error("Enter a valid cash amount.");return}if(i.cashReceived<i.grandTotal){b.value.cashReceived="Cash received cannot be less than total amount.",M.error("Cash received cannot be less than total amount.");return}y.value||(y.value=!0,N("confirm",{paymentMethod:n.value,cashReceived:p.value,changeAmount:m.value,items:i.orderItems,autoPrintKot:T.value,done:()=>{y.value=!1}}))},O=x(()=>i.orderType?i.orderType.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase()):"");return(c,o)=>t.show?(d(),l("div",$,[e("div",j,[e("div",z,[e("div",G,[o[8]||(o[8]=e("h5",{class:"modal-title fw-bold d-flex align-items-center gap-2 m-0"},[e("i",{class:"bi bi-receipt-cutoff"}),u(" Confirm Order ")],-1)),e("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110",onClick:o[0]||(o[0]=s=>c.$emit("close")),"data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[...o[7]||(o[7]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",Q,[e("div",W,[e("div",Y,[e("div",H,[e("div",J,[e("div",X,[o[17]||(o[17]=e("h6",{class:"fw-bold brand-text mb-3 d-flex align-items-center gap-2"},[e("i",{class:"bi bi-info-circle"}),u(" Order Summary ")],-1)),e("div",Z,[e("div",_,[e("div",ee,[o[9]||(o[9]=e("span",{class:"text-muted small"},"Customer",-1)),e("span",te,a(t.customer||"Walk In"),1)])]),e("div",oe,[e("div",se,[o[10]||(o[10]=e("span",{class:"text-muted small"},"Service",-1)),e("span",ae,[e("span",le,a(O.value),1)])])]),t.orderType==="Dine_in"?(d(),l("div",de,[e("div",ne,[o[11]||(o[11]=e("span",{class:"text-muted small"},"Table No",-1)),e("span",re,a(t.selectedTable?.name||"N/A"),1)])])):r("",!0),t.orderType==="Delivery"?(d(),l("div",ie,[e("div",ce,[o[12]||(o[12]=e("span",{class:"text-muted small"},"Delivery Location",-1)),e("span",me,a(t.deliveryLocation||"N/A"),1)])])):r("",!0),t.orderType==="Delivery"?(d(),l("div",ue,[e("div",ve,[o[13]||(o[13]=e("span",{class:"text-muted small"},"Phone No",-1)),e("span",he,a(t.phone||"N/A"),1)])])):r("",!0),e("div",be,[e("table",pe,[o[16]||(o[16]=e("thead",{class:"table-light"},[e("tr",null,[e("th",null,"#"),e("th",null,"Item"),e("th",{class:"text-center"}," Qty "),e("th",{class:"text-end"}," Price "),e("th",{class:"text-end"}," Total ")])],-1)),e("tbody",null,[(d(!0),l(R,null,K(t.orderItems,(s,S)=>(d(),l("tr",{key:s.id||S},[e("td",null,a(S+1),1),e("td",null,[e("div",ye,a(s.title),1),s.note?(d(),l("div",ge," Note: "+a(s.note),1)):r("",!0),s.kitchen_note?(d(),l("div",fe," Kitchen Note: "+a(s.kitchen_note),1)):r("",!0),s.item_kitchen_note?(d(),l("div",xe," ðŸ³ Item Note: "+a(s.item_kitchen_note),1)):r("",!0)]),e("td",Te,a(s.qty),1),e("td",ke,a(v(h)(s.unit_price)),1),e("td",Ce,a(v(h)((Number(s.unit_price)||0)*(Number(s.qty)||0))),1)]))),128))]),e("tfoot",null,[t.promoDiscount>0?(d(),l("tr",we,[e("td",Ne,[o[14]||(o[14]=u(" Promo ",-1)),t.promoName?(d(),l("span",De,"("+a(t.promoName)+")",1)):r("",!0)]),e("td",Se," -"+a(v(h)(t.promoDiscount)),1)])):r("",!0),e("tr",Re,[o[15]||(o[15]=e("td",{colspan:"4",class:"text-end"}," Grand Total ",-1)),e("td",Ie,a(v(h)(t.grandTotal)),1)])])])])])])])])]),e("div",Me,[e("div",Pe,[e("div",Ae,[e("div",Oe,[e("div",Ve,[g(e("input",{class:"segmented-input",type:"radio",id:"paymentCash",name:"payMethod",value:"Cash","onUpdate:modelValue":o[1]||(o[1]=s=>n.value=s)},null,512),[[k,n.value]]),o[20]||(o[20]=e("label",{class:"segmented-label",for:"paymentCash"},[e("i",{class:"bi bi-cash-coin me-1"}),u(" Cash ")],-1)),v(w).props?.onboarding?.payment_methods?.card_enabled?(d(),l(R,{key:0},[g(e("input",{class:"segmented-input",type:"radio",id:"paymentCard",name:"payMethod",value:"Card","onUpdate:modelValue":o[2]||(o[2]=s=>n.value=s)},null,512),[[k,n.value]]),o[18]||(o[18]=e("label",{class:"segmented-label",for:"paymentCard"},[e("i",{class:"bi bi-credit-card-2-front me-1"}),u(" Card ")],-1)),g(e("input",{class:"segmented-input",type:"radio",id:"paymentSplit",name:"payMethod",value:"Split","onUpdate:modelValue":o[3]||(o[3]=s=>n.value=s)},null,512),[[k,n.value]]),o[19]||(o[19]=e("label",{class:"segmented-label",for:"paymentSplit"},[e("i",{class:"bi bi-columns-gap me-1"}),u(" Split ")],-1))],64)):r("",!0)]),n.value==="Cash"?(d(),l("div",Le,[o[23]||(o[23]=e("div",{class:"pay-header d-flex align-items-center gap-2 mb-3"},[e("i",{class:"bi bi-credit-card-2-front-fill"}),e("h6",{class:"m-0"}," Cash Received ")],-1)),g(e("input",{type:"number","onUpdate:modelValue":o[4]||(o[4]=s=>p.value=s),class:C(["form-control rounded-3",{"is-invalid":b.value.cashReceived}])},null,2),[[U,p.value,void 0,{number:!0}]]),b.value.cashReceived?(d(),l("small",Ke,a(b.value.cashReceived),1)):r("",!0),e("div",Ue,[o[21]||(o[21]=e("strong",null,"Change:",-1)),e("span",{class:C([m.value]<0?"text-danger fw-bold":"text-success fw-bold")},a(v(h)(m.value)),3)]),e("div",Be,[g(e("input",{class:"form-check-input",type:"checkbox",id:"autoPrintKot","onUpdate:modelValue":o[5]||(o[5]=s=>T.value=s)},null,512),[[B,T.value]]),o[22]||(o[22]=e("label",{class:"form-check-label",for:"autoPrintKot"}," Auto Print KOT ",-1))]),e("div",qe,[e("button",{class:"btn btn-secondary btn-sm rounded-pill px-3 py-2",onClick:o[6]||(o[6]=s=>c.$emit("close"))}," Cancel "),e("button",{class:"btn btn-primary brand-btn rounded-pill btn-sm px-3 py-2 d-flex align-items-center gap-2",onClick:A,disabled:y.value},[y.value?(d(),l("span",Fe)):(d(),l("i",$e)),e("span",null,a(y.value?"Processing...":"Confirm & Place"),1)],8,Ee)])])):r("",!0),n.value==="Card"?(d(),l("div",je,[I(q,{order_code:t.order_code,show:t.show,customer:t.customer,phone:t.phone,"delivery-location":t.deliveryLocation,orderType:t.orderType,selectedTable:t.selectedTable,orderItems:t.orderItems,grandTotal:t.grandTotal,money:t.money,cashReceived:p.value,subTotal:D.value,tax:t.tax??0,serviceCharges:t.serviceCharges??0,deliveryCharges:t.deliveryCharges??0,note:t.note,"kitchen-note":t.kitchenNote,orderDate:t.orderDate??new Date().toISOString().split("T")[0],orderTime:t.orderTime??new Date().toTimeString().split(" ")[0],paymentMethod:n.value,change:m.value,"promo-discount":t.promoDiscount,"promo-id":t.promoId,"promo-name":t.promoName,"promo-type":t.promoType,"promo-discount-amount":t.promoDiscountAmount,"applied-promos":t.appliedPromos,"approved-discounts":t.approvedDiscounts,"approved-discount-details":t.approvedDiscountDetails},null,8,["order_code","show","customer","phone","delivery-location","orderType","selectedTable","orderItems","grandTotal","money","cashReceived","subTotal","tax","serviceCharges","deliveryCharges","note","kitchen-note","orderDate","orderTime","paymentMethod","change","promo-discount","promo-id","promo-name","promo-type","promo-discount-amount","applied-promos","approved-discounts","approved-discount-details"]),e("div",ze,[o[24]||(o[24]=e("strong",null,"Change:",-1)),e("span",{class:C(m.value<0?"text-danger fw-bold":"text-success fw-bold")},a(v(h)(m.value)),3)])])):r("",!0),n.value==="Split"?(d(),l("div",Ge,[I(E,{order_code:t.order_code,show:t.show,customer:t.customer,phone:t.phone,"delivery-location":t.deliveryLocation,orderType:t.orderType,selectedTable:t.selectedTable,orderItems:t.orderItems,grandTotal:t.grandTotal,money:t.money,cashReceived:p.value,subTotal:D.value,tax:t.tax??0,serviceCharges:t.serviceCharges??0,deliveryCharges:t.deliveryCharges??0,note:t.note,"kitchen-note":t.kitchenNote,orderDate:t.orderDate??new Date().toISOString().split("T")[0],orderTime:t.orderTime??new Date().toTimeString().split(" ")[0],paymentMethod:n.value,change:m.value,paymentType:n.value,"promo-discount":t.promoDiscount,"promo-id":t.promoId,"promo-name":t.promoName,"promo-type":t.promoType,"promo-discount-amount":t.promoDiscountAmount,"applied-promos":t.appliedPromos,"approved-discounts":t.approvedDiscounts,"approved-discount-details":t.approvedDiscountDetails},null,8,["order_code","show","customer","phone","delivery-location","orderType","selectedTable","orderItems","grandTotal","money","cashReceived","subTotal","tax","serviceCharges","deliveryCharges","note","kitchen-note","orderDate","orderTime","paymentMethod","change","paymentType","promo-discount","promo-id","promo-name","promo-type","promo-discount-amount","applied-promos","approved-discounts","approved-discount-details"])])):r("",!0),o[25]||(o[25]=e("div",{class:"mt-auto small text-muted pt-2"},[e("i",{class:"bi bi-shield-check me-1"}),u(" Secured checkout â€¢ Keep this window open until payment completes ")],-1))])])])])])])])])])):r("",!0)}},Xe=V(Qe,[["__scopeId","data-v-c4cdb4c5"]]);export{Xe as default};
