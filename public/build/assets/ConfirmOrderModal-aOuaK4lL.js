import{_ as A,r as f,D as x,g as d,i,o as n,b as e,f as u,t as a,F as O,v as V,d as g,x as p,W as C,y as K,n as k,al as U,a as D,m as R}from"./app-DgHj6V6q.js";import B from"./StripePayment-BQtgsiKO.js";import E from"./SplitPayment-Cc539mAs.js";import{u as F}from"./useFormatters-CPHeofEZ.js";const $={key:0,class:"modal fade show d-block",tabindex:"-1",style:{background:"rgba(0, 0, 0, 0.5)"}},q={class:"modal-dialog modal-lg modal-dialog-centered"},L={class:"modal-content rounded-4 s border-0"},j={class:"modal-header brand-gradient text-white py-3 position-sticky top-0 z-3"},z={class:"modal-body p-3 p-md-4 body-scroll"},W={class:"row g-3"},G={class:"col-12 col-md-6 d-flex"},Q={class:"w-100 d-flex flex-column gap-3"},H={class:"card border-0 brand-card h-100"},J={class:"card-body"},X={class:"row g-3"},Y={class:"col-12 col-sm-6"},Z={class:"p-3 rounded-3 bg-light d-flex flex-column h-100"},_={class:"fw-semibold"},ee={class:"col-12 col-sm-6"},te={class:"p-3 rounded-3 bg-light d-flex flex-column h-100"},oe={class:"fw-semibold"},se={class:"badge brand-badge px-3 py-2"},ae={key:0,class:"col-12 col-sm-6"},le={class:"p-3 rounded-3 bg-light d-flex flex-column"},de={class:"fw-semibold"},ne={class:"table-responsive compact-table"},re={class:"table align-middle table-hover mb-0"},ie={class:"fw-semibold"},ce={key:0,class:"small text-muted"},me={key:1,class:"small text-muted"},ue={class:"text-center"},ve={class:"text-end"},he={class:"text-end fw-bold"},be={key:0},ye={colspan:"4",class:"text-end text-muted"},ge={key:0},pe={class:"text-end text-success"},fe={class:"fw-bold"},xe={class:"text-end text-success"},Te={class:"col-12 col-md-6 d-flex"},Ce={class:"w-100"},ke={class:"card border-0 brand-card h-100"},we={class:"card-body d-flex flex-column"},Ne={class:"segmented mt-1 mb-3",role:"tablist","aria-label":"Payment method"},Se={key:0,class:"pt-2 border-top"},De={key:0,class:"text-danger"},Re={class:"mt-2"},Ie={class:"form-check mt-3"},Me={class:"d-flex gap-2 mt-3"},Pe=["disabled"],Ae={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},Oe={key:1,class:"bi bi-check2-circle"},Ve={key:1,class:"pt-3 border-top"},Ke={class:"mt-2"},Ue={key:2,class:"pt-3 border-top"},Be={__name:"ConfirmOrderModal",props:{show:Boolean,customer:String,orderType:String,selectedTable:Object,orderItems:Array,grandTotal:Number,money:Function,cashReceived:Number,order_code:String,tax:Number,serviceCharges:Number,deliveryCharges:Number,note:[String,null],kitchenNote:[String,null],orderDate:String,orderTime:String,paymentMethod:String,change:Number,promoDiscount:{type:Number,default:0},promoId:{type:[Number,String,null],default:null},promoName:{type:[String,null],default:null},promoType:{type:[String,null],default:null},promoDiscountAmount:{type:Number,default:0}},emits:["close","confirm","update:cashReceived"],setup(t,{emit:I}){const{formatCurrencySymbol:v}=F(),r=t,T=f(!1),h=f({}),w=I,l=f("Cash"),b=x({get:()=>r.cashReceived,set:c=>w("update:cashReceived",c)}),m=x(()=>l.value==="Cash"?b.value-r.grandTotal:0),N=x(()=>Array.isArray(r.orderItems)?r.orderItems.reduce((c,o)=>c+(Number(o.unit_price)||0)*(Number(o.qty)||0),0):0),y=f(!1),M=async()=>{if(h.value.cashReceived=null,!r.cashReceived||r.cashReceived<=0){h.value.cashReceived="Enter a valid cash amount.",R.error("Enter a valid cash amount.");return}if(r.cashReceived<r.grandTotal){h.value.cashReceived="Cash received cannot be less than total amount.",R.error("Cash received cannot be less than total amount.");return}y.value||(y.value=!0,w("confirm",{paymentMethod:l.value,cashReceived:b.value,changeAmount:m.value,items:r.orderItems,autoPrintKot:T.value,done:()=>{y.value=!1}}))},P=x(()=>r.orderType?r.orderType.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase()):"");return(c,o)=>t.show?(n(),d("div",$,[e("div",q,[e("div",L,[e("div",j,[o[8]||(o[8]=e("h5",{class:"modal-title fw-bold d-flex align-items-center gap-2 m-0"},[e("i",{class:"bi bi-receipt-cutoff"}),u(" Confirm Order ")],-1)),e("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110",onClick:o[0]||(o[0]=s=>c.$emit("close")),"data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[...o[7]||(o[7]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",z,[e("div",W,[e("div",G,[e("div",Q,[e("div",H,[e("div",J,[o[15]||(o[15]=e("h6",{class:"fw-bold brand-text mb-3 d-flex align-items-center gap-2"},[e("i",{class:"bi bi-info-circle"}),u(" Order Summary ")],-1)),e("div",X,[e("div",Y,[e("div",Z,[o[9]||(o[9]=e("span",{class:"text-muted small"},"Customer",-1)),e("span",_,a(t.customer||"Walk In"),1)])]),e("div",ee,[e("div",te,[o[10]||(o[10]=e("span",{class:"text-muted small"},"Service",-1)),e("span",oe,[e("span",se,a(P.value),1)])])]),t.orderType==="Dine_in"?(n(),d("div",ae,[e("div",le,[o[11]||(o[11]=e("span",{class:"text-muted small"},"Table No",-1)),e("span",de,a(t.selectedTable?.name||"N/A"),1)])])):i("",!0),e("div",ne,[e("table",re,[o[14]||(o[14]=e("thead",{class:"table-light"},[e("tr",null,[e("th",null,"#"),e("th",null,"Item"),e("th",{class:"text-center"}," Qty "),e("th",{class:"text-end"}," Price "),e("th",{class:"text-end"}," Total ")])],-1)),e("tbody",null,[(n(!0),d(O,null,V(t.orderItems,(s,S)=>(n(),d("tr",{key:s.id||S},[e("td",null,a(S+1),1),e("td",null,[e("div",ie,a(s.title),1),s.note?(n(),d("div",ce," Note: "+a(s.note),1)):i("",!0),s.kitchen_note?(n(),d("div",me," Kitchen Note: "+a(s.kitchen_note),1)):i("",!0)]),e("td",ue,a(s.qty),1),e("td",ve,a(g(v)(s.unit_price)),1),e("td",he,a(g(v)((Number(s.unit_price)||0)*(Number(s.qty)||0))),1)]))),128))]),e("tfoot",null,[t.promoDiscount>0?(n(),d("tr",be,[e("td",ye,[o[12]||(o[12]=u(" Promo ",-1)),t.promoName?(n(),d("span",ge,"("+a(t.promoName)+")",1)):i("",!0)]),e("td",pe," -"+a(g(v)(t.promoDiscount)),1)])):i("",!0),e("tr",fe,[o[13]||(o[13]=e("td",{colspan:"4",class:"text-end"}," Grand Total ",-1)),e("td",xe,a(g(v)(t.grandTotal)),1)])])])])])])])])]),e("div",Te,[e("div",Ce,[e("div",ke,[e("div",we,[e("div",Ne,[p(e("input",{class:"segmented-input",type:"radio",id:"paymentCash",name:"payMethod",value:"Cash","onUpdate:modelValue":o[1]||(o[1]=s=>l.value=s)},null,512),[[C,l.value]]),o[16]||(o[16]=e("label",{class:"segmented-label",for:"paymentCash"},[e("i",{class:"bi bi-cash-coin me-1"}),u(" Cash ")],-1)),p(e("input",{class:"segmented-input",type:"radio",id:"paymentCard",name:"payMethod",value:"Card","onUpdate:modelValue":o[2]||(o[2]=s=>l.value=s)},null,512),[[C,l.value]]),o[17]||(o[17]=e("label",{class:"segmented-label",for:"paymentCard"},[e("i",{class:"bi bi-credit-card-2-front me-1"}),u(" Card ")],-1)),p(e("input",{class:"segmented-input",type:"radio",id:"paymentSplit",name:"payMethod",value:"Split","onUpdate:modelValue":o[3]||(o[3]=s=>l.value=s)},null,512),[[C,l.value]]),o[18]||(o[18]=e("label",{class:"segmented-label",for:"paymentSplit"},[e("i",{class:"bi bi-columns-gap me-1"}),u(" Split ")],-1))]),l.value==="Cash"?(n(),d("div",Se,[o[21]||(o[21]=e("div",{class:"pay-header d-flex align-items-center gap-2 mb-3"},[e("i",{class:"bi bi-credit-card-2-front-fill"}),e("h6",{class:"m-0"}," Cash Received ")],-1)),p(e("input",{type:"number","onUpdate:modelValue":o[4]||(o[4]=s=>b.value=s),class:k(["form-control rounded-3",{"is-invalid":h.value.cashReceived}])},null,2),[[K,b.value,void 0,{number:!0}]]),h.value.cashReceived?(n(),d("small",De,a(h.value.cashReceived),1)):i("",!0),e("div",Re,[o[19]||(o[19]=e("strong",null,"Change:",-1)),e("span",{class:k([m.value]<0?"text-danger fw-bold":"text-success fw-bold")},a(g(v)(m.value)),3)]),e("div",Ie,[p(e("input",{class:"form-check-input",type:"checkbox",id:"autoPrintKot","onUpdate:modelValue":o[5]||(o[5]=s=>T.value=s)},null,512),[[U,T.value]]),o[20]||(o[20]=e("label",{class:"form-check-label",for:"autoPrintKot"}," Auto Print KOT ",-1))]),e("div",Me,[e("button",{class:"btn btn-secondary btn-sm rounded-pill px-3 py-2",onClick:o[6]||(o[6]=s=>c.$emit("close"))}," Cancel "),e("button",{class:"btn btn-primary brand-btn rounded-pill btn-sm px-3 py-2 d-flex align-items-center gap-2",onClick:M,disabled:y.value},[y.value?(n(),d("span",Ae)):(n(),d("i",Oe)),e("span",null,a(y.value?"Processing...":"Confirm & Place"),1)],8,Pe)])])):i("",!0),l.value==="Card"?(n(),d("div",Ve,[D(B,{order_code:t.order_code,show:t.show,customer:t.customer,orderType:t.orderType,selectedTable:t.selectedTable,orderItems:t.orderItems,grandTotal:t.grandTotal,money:t.money,cashReceived:b.value,subTotal:N.value,tax:t.tax??0,serviceCharges:t.serviceCharges??0,deliveryCharges:t.deliveryCharges??0,note:t.note,"kitchen-note":t.kitchenNote,orderDate:t.orderDate??new Date().toISOString().split("T")[0],orderTime:t.orderTime??new Date().toTimeString().split(" ")[0],paymentMethod:l.value,change:m.value,"promo-discount":t.promoDiscount,"promo-id":t.promoId,"promo-name":t.promoName,"promo-type":t.promoType,"promo-discount-amount":t.promoDiscountAmount},null,8,["order_code","show","customer","orderType","selectedTable","orderItems","grandTotal","money","cashReceived","subTotal","tax","serviceCharges","deliveryCharges","note","kitchen-note","orderDate","orderTime","paymentMethod","change","promo-discount","promo-id","promo-name","promo-type","promo-discount-amount"]),e("div",Ke,[o[22]||(o[22]=e("strong",null,"Change:",-1)),e("span",{class:k(m.value<0?"text-danger fw-bold":"text-success fw-bold")},a(g(v)(m.value)),3)])])):i("",!0),l.value==="Split"?(n(),d("div",Ue,[D(E,{order_code:t.order_code,show:t.show,customer:t.customer,orderType:t.orderType,selectedTable:t.selectedTable,orderItems:t.orderItems,grandTotal:t.grandTotal,money:t.money,cashReceived:b.value,subTotal:N.value,tax:t.tax??0,serviceCharges:t.serviceCharges??0,deliveryCharges:t.deliveryCharges??0,note:t.note,"kitchen-note":t.kitchenNote,orderDate:t.orderDate??new Date().toISOString().split("T")[0],orderTime:t.orderTime??new Date().toTimeString().split(" ")[0],paymentMethod:l.value,change:m.value,paymentType:l.value,"promo-discount":t.promoDiscount,"promo-id":t.promoId,"promo-name":t.promoName,"promo-type":t.promoType,"promo-discount-amount":t.promoDiscountAmount},null,8,["order_code","show","customer","orderType","selectedTable","orderItems","grandTotal","money","cashReceived","subTotal","tax","serviceCharges","deliveryCharges","note","kitchen-note","orderDate","orderTime","paymentMethod","change","paymentType","promo-discount","promo-id","promo-name","promo-type","promo-discount-amount"])])):i("",!0),o[23]||(o[23]=e("div",{class:"mt-auto small text-muted pt-2"},[e("i",{class:"bi bi-shield-check me-1"}),u(" Secured checkout â€¢ Keep this window open until payment completes ")],-1))])])])])])])])])])):i("",!0)}},Le=A(Be,[["__scopeId","data-v-19eff4cc"]]);export{Le as default};
