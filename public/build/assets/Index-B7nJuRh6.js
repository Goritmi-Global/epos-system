import{_ as qe,r as d,c as Y,o as ce,n as Ke,I as Xe,P as Ye,y as _e,E as Ce,a as me,b as i,w as G,d as k,e as t,u as O,h as Ge,f as r,F as I,g as z,t as u,i as U,j as Ze,m as C,k as Z,v as ve,l as E,S as we,T as Je,U as ke,x as xe,p as D,q as c}from"./app-CLCV5sLN.js";import{_ as We}from"./Master-CTC_8TGC.js";import{s as Se}from"./index-5P-MiQin.js";import{F as Qe}from"./FilterModal-Dy6LCoeo.js";import{E as et,a as tt,X as at,u as J,w as lt}from"./xlsx-1Rd_lHfi.js";import{u as st}from"./useFormatters-Bbi50N_3.js";import{I as ot}from"./importFile-DV3LS74l.js";import{S as nt}from"./shapes-C-ZPKVzM.js";import{P as it}from"./package-DxlveRaY.js";import{T as rt}from"./triangle-alert-B_yIcK8b.js";import{C as ut}from"./circle-x-D6W2CXm1.js";import{P as dt}from"./plus-HcOj3fDz.js";import{P as Me}from"./pencil-CwV097nl.js";import"./index-SLzSP3BC.js";import"./createLucideIcon-Doa7hx-B.js";import"./index-sMxCkKBm.js";import"./index-BW3SiLbr.js";import"./sun-DcZXAqBL.js";import"./index-BusAS_-o.js";import"./index-Dt8Vwvus.js";import"./index-BBGBVa25.js";const ct={class:"page-wrapper"},mt={class:"row g-3"},vt={class:"card border-0 shadow-sm rounded-4"},pt={class:"card-body d-flex align-items-center justify-content-between"},gt={class:"fw-bold fs-4"},bt={class:"text-muted fs-6"},ft={class:"card border-0 shadow-lg rounded-4 mt-0"},yt={class:"card-body"},ht={class:"d-flex flex-wrap gap-2 justify-content-between align-items-center mb-3"},_t={class:"d-flex flex-wrap gap-2 align-items-center"},Ct={class:"search-wrap"},wt={key:1,class:"form-control search-input",placeholder:"Search",disabled:"",type:"text"},kt={class:"col-12"},xt=["onUpdate:modelValue"],St=["value"],Mt={class:"dropdown"},Ft={class:"dropdown-menu dropdown-menu-end shadow rounded-4 py-2"},It={class:"table-responsive"},Et={class:"table table-striped"},$t={key:0},Lt={key:1},Nt={colspan:"11",class:"text-center text-muted py-4"},Pt={class:"fw-semibold"},Vt={class:"text-truncate",style:{"max-width":"260px"}},Dt={key:0},Bt=["onClick"],jt={key:1},Tt={class:"rounded d-inline-flex align-items-center justify-content-center img-chip"},At=["src","alt"],Ot={key:1,class:"fs-5"},Ut={class:"text-center"},Rt={class:"text-center"},zt={class:"d-inline-flex align-items-center gap-3"},Ht=["onClick"],qt={key:0},Kt={colspan:"11",class:"text-center text-muted py-4"},Xt={key:0,class:"mt-4 d-flex justify-content-between align-items-center"},Yt={class:"text-muted small"},Gt={class:"modal fade",id:"viewCatModal",tabindex:"-1","aria-hidden":"true"},Zt={class:"modal-dialog modal-dialog-centered"},Jt={class:"modal-content rounded-4"},Wt={key:0,class:"modal-body"},Qt={class:"fs-4"},ea={key:0},ta={key:0},aa={key:1},la={key:1,class:"modal-body text-center"},sa={class:"modal fade",id:"addCatModal",tabindex:"-1","aria-hidden":"true"},oa={class:"modal-dialog modal-lg modal-dialog-centered"},na={class:"modal-content rounded-4"},ia={class:"modal-header"},ra={class:"modal-title fw-semibold"},ua={class:"modal-body"},da={class:"row g-3"},ca={class:"col-lg-6"},ma={class:"d-flex align-items-center gap-3"},va={class:"form-check"},pa=["checked"],ga={class:"form-check"},ba=["checked"],fa={key:0,class:"col-lg-6"},ya=["value"],ha={key:0,class:"text-danger"},_a={class:"col-lg-6"},Ca={class:"dropdown w-100"},wa={class:"btn btn-outline-secondary w-100 d-flex justify-content-between align-items-center rounded-3","data-bs-toggle":"dropdown"},ka={class:"d-flex align-items-center"},xa=["src"],Sa={class:"dropdown-menu w-100 shadow rounded-3"},Ma=["onClick"],Fa=["src"],Ia={key:1,class:"col-12"},Ea={key:2,class:"text-danger"},$a={key:2,class:"col-12"},La={class:"p-3 d-flex justify-content-between"},Na={class:"d-flex gap-2"},Pa={key:0,class:"text-danger"},Va={key:1,class:"text-danger"},Da={key:3,class:"col-12"},Ba=["value"],ja={class:"col-12"},Ta={class:"d-flex align-items-center gap-3"},Aa={class:"form-check"},Oa=["checked"],Ua={class:"form-check"},Ra=["checked"],za={class:"mt-4"},Ha=["disabled"],qa={class:"modal fade",id:"editSubCatModal",tabindex:"-1","aria-labelledby":"editSubCatModalLabel","aria-hidden":"true"},Ka={class:"modal-dialog"},Xa={class:"modal-content"},Ya={class:"modal-header"},Ga={class:"modal-body"},Za={class:"mb-3"},Ja=["disabled"],Wa={class:"text-danger"},Qa=["disabled"],el={key:0,class:"spinner-border spinner-border-sm text-light",role:"status"},tl={__name:"Index",setup(al){const{formatCurrencySymbol:Fe}=st(),y=d([]),H=d([]),pe=d([]),W={sortBy:"",status:"",hasSubcategories:"",stockStatus:"",valueMin:null,valueMax:null},g=d({...W}),le=d({...W});Y(()=>{const a=[...se.value];switch(g.value.sortBy){case"name_asc":return a.sort((s,o)=>(s.name||"").localeCompare(o.name||""));case"name_desc":return a.sort((s,o)=>(o.name||"").localeCompare(s.name||""));case"value_desc":return a.sort((s,o)=>(o.total_value||0)-(s.total_value||0));case"value_asc":return a.sort((s,o)=>(s.total_value||0)-(o.total_value||0));case"items_desc":return a.sort((s,o)=>(o.primary_inventory_items_count||0)-(s.primary_inventory_items_count||0));case"items_asc":return a.sort((s,o)=>(s.primary_inventory_items_count||0)-(o.primary_inventory_items_count||0));default:return a}});const Q=Y(()=>({sortOptions:[{value:"name_asc",label:"Name: A to Z"},{value:"name_desc",label:"Name: Z to A"},{value:"value_desc",label:"Value: High to Low"},{value:"value_asc",label:"Value: Low to High"}],statusOptions:[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"}],hasSubcategoriesOptions:[{value:"yes",label:"Has Subcategories"},{value:"no",label:"No Subcategories"}],stockStatusOptions:[{value:"in_stock",label:"In Stock"},{value:"low_stock",label:"Low Stock"},{value:"out_of_stock",label:"Out of Stock"},{value:"has_items",label:"Has Items"},{value:"no_items",label:"No Items"}]})),Ie=()=>{g.value={...W},le.value={...W}},se=Y(()=>H.value),Ee=()=>{le.value={...g.value},w.value.current_page=1,M(1)},w=d({current_page:1,last_page:1,per_page:10,total:0,from:0,to:0,links:[]}),h=d(null),S=d([]),ee=async()=>{try{const{data:a}=await D.get("/categories",{params:{per_page:1e4}});pe.value=a.data||[]}catch(a){console.error("Failed to fetch all categories:",a)}},M=async(a=null)=>{try{L.value=!0;const e={q:$.value,page:a||w.value.current_page,per_page:w.value.per_page,sort_by:g.value.sortBy||"",status:g.value.status||"",has_subcategories:g.value.hasSubcategories||"",stock_status:g.value.stockStatus||"",value_min:g.value.valueMin||"",value_max:g.value.valueMax||""},{data:s}=await D.get("/categories",{params:e});H.value=s.data||[],w.value={current_page:s.current_page,last_page:s.last_page,per_page:s.per_page,total:s.total,from:s.from,to:s.to,links:s.links}}catch(e){console.error("Failed to fetch categories:",e),c.error("Failed to load categories")}finally{L.value=!1}},$e=a=>{if(!a)return;const s=new URLSearchParams(a.split("?")[1]).get("page");s&&M(parseInt(s))};ce(async()=>{$.value="",be.value=Date.now(),await Ke(),setTimeout(()=>{fe.value=!0;const e=document.getElementById(oe);e&&(e.value="",$.value="")},100),ee(),M();const a=document.getElementById("categoryFilterModal");a&&a.addEventListener("hidden.bs.modal",()=>{g.value={...le.value}})});const ge=Y(()=>H.value.filter(a=>a.parent_id===null)),Le=Y(()=>{const a=pe.value.filter(e=>e.parent_id===null);return[{label:"Categories",value:a.length,icon:nt,iconBg:"bg-light-primary",iconColor:"text-primary"},{label:"Total Active",value:a.filter(e=>e.active).length,icon:it,iconBg:"bg-light-success",iconColor:"text-success"},{label:"Low Stock",value:a.filter(e=>!e.active).length,icon:rt,iconBg:"bg-light-warning",iconColor:"text-warning"},{label:"Out of Stock",value:a.filter(e=>!e.parent_id).length,icon:ut,iconBg:"bg-light-danger",iconColor:"text-danger"}]}),$=d(""),be=d(Date.now()),oe=`search-${Math.random().toString(36).substr(2,9)}`,fe=d(!1),L=d(!1);ce(()=>window.feather?.replace()),Xe(()=>window.feather?.replace());const _=d(!1),ne=d(""),N=d(!0),F=d(null),f=d({label:"Produce (Veg/Fruit)",value:"/assets/img/vegetable.png",file:null}),q=[{label:"Produce (Veg/Fruit)",value:"/assets/img/vegetable.png"},{label:"Meat",value:"/assets/img/meat.png"},{label:"Poultry",value:"/assets/img/poultry.png"},{label:"Dairy",value:"/assets/img/dairy.png"},{label:"Grains & Rice",value:"/assets/img/rice.png"},{label:"Spices & Herbs",value:"/assets/img/spice.png"},{label:"Oils & Fats",value:"/assets/img/olive-oil.png"},{label:"Sauces & Condiments",value:"/assets/img/sauces.png"},{label:"Nuts & Seeds",value:"/assets/img/nuts.png"},{label:"Other",value:"/assets/img/other.png"}],K=d([{label:"Produce (Veg/Fruit)",value:"Produce (Veg/Fruit)",icon:"/assets/img/vegetable.png",selected:!1},{label:"Meat",value:"Meat",icon:"/assets/img/meat.png",selected:!1},{label:"Poultry",value:"Poultry",icon:"/assets/img/poultry.png",selected:!1},{label:"Dairy",value:"Dairy",icon:"/assets/img/dairy.png",selected:!1},{label:"Grains & Rice",value:"Grains & Rice",icon:"/assets/img/rice.png",selected:!1},{label:"Flour & Baking",value:"Flour & Baking",icon:"/assets/img/flour.png",selected:!1},{label:"Spices & Herbs",value:"Spices & Herbs",icon:"/assets/img/spice.png",selected:!1},{label:"Oils & Fats",value:"Oils & Fats",icon:"/assets/img/olive-oil.png",selected:!1},{label:"Sauces & Condiments",value:"Sauces & Condiments",icon:"/assets/img/sauces.png",selected:!1},{label:"Nuts & Seeds",value:"Nuts & Seeds",icon:"/assets/img/nuts.png",selected:!1},{label:"Other",value:"Other",icon:"/assets/img/other.png",selected:!1}]),Ne=async(a,e)=>{try{const s=await fetch(a);if(!s.ok)return console.error("âŒ Fetch failed:",s.status,s.statusText),null;const o=await s.blob();return new File([o],e,{type:o.type})}catch(s){return console.error("âŒ Error converting URL to File:",s),null}},ie=()=>{_.value=!1,y.value=[],N.value=!0,F.value=null,ne.value="",f.value={label:q[0].label,value:q[0].value,file:null},K.value=K.value.map(a=>({...a,selected:!1})),h.value=null},P=d(!1),p=d({}),Pe=async()=>{if(_.value&&!F.value){p.value.parent_id=["Please select a parent category"],c.error(p.value.parent_id[0]),P.value=!1;return}X(),P.value=!0;try{if(f.value.value&&!f.value.file){const e=f.value.label.toLowerCase().replace(/[^a-z0-9]/g,"-")+".jpg",s=await Ne(f.value.value,e);s&&(f.value.file=s)}if(h.value){const e=new FormData;let s="";if(_.value?s=ne.value?.trim():s=y.value[0]?.label?.trim()||y.value[0]?.name?.trim()||(typeof y.value[0]=="string"?y.value[0].trim():""),!s){p.value.name=["Category name cannot be empty"],c.error("Category name cannot be empty"),P.value=!1;return}e.append("name",s),e.append("active",N.value?"1":"0"),e.append("parent_id",F.value||""),e.append("_method","PUT"),f.value.file&&f.value.file instanceof File&&e.append("icon",f.value.file),!F.value&&te.value&&te.value.split(",").map(l=>l.trim()).filter(l=>l.length>0).forEach((l,v)=>{const m=h.value.subcategories?.find(n=>n.name.toLowerCase()===l.toLowerCase());e.append(`subcategories[${v}][name]`,l),m?(e.append(`subcategories[${v}][id]`,m.id),e.append(`subcategories[${v}][active]`,m.active?"1":"0")):e.append(`subcategories[${v}][active]`,"1")}),await D.post(`/categories/${h.value.id}`,e,{headers:{"Content-Type":"multipart/form-data"}}),c.success("Category updated successfully"),await M(),await ee()}else{const e=new FormData;let s=[];if(_.value){if(S.value.length===0){p.value.subcategories=["Please add at least one subcategory"],c.error("Please add at least one subcategory"),P.value=!1;return}s=S.value.map(o=>({name:typeof o=="string"?o:o.label,active:N.value,parent_id:F.value}))}else{if(y.value.length===0){p.value.name=["Please add at least one category"],c.error("Please add at least one category"),P.value=!1;return}s=y.value.map(o=>({name:typeof o=="string"?o:o.label,active:N.value,parent_id:null}))}e.append("isSubCategory",_.value?"1":"0"),s.forEach((o,l)=>{e.append(`categories[${l}][name]`,o.name),e.append(`categories[${l}][active]`,o.active?"1":"0"),o.parent_id&&e.append(`categories[${l}][parent_id]`,o.parent_id)}),f.value.file&&f.value.file instanceof File&&e.append("icon",f.value.file),await D.post("/categories",e,{headers:{"Content-Type":"multipart/form-data"}}),c.success("Category created successfully"),await M(),await ee()}bootstrap.Modal.getInstance(document.getElementById("addCatModal"))?.hide(),ie(),h.value=null,await M()}catch(a){if(a.response?.status===422&&a.response?.data?.errors){const e=a.response.data.errors;let s=[];p.value={},Object.keys(e).forEach(o=>{let l=o.replace(/^categories\.\d+\./,"");p.value[l]=e[o],Array.isArray(e[o])&&e[o].forEach(v=>{s.push(v)})}),s.length>0?c.error(s.join(`
`)):c.error("Validation failed. Please check your input.")}else{const e=a.response?.data?.message||"Failed to save category";c.error(e+" âŒ")}}finally{P.value=!1}},X=()=>{p.value={}},te=d(""),Ve=a=>{X(),h.value=a,_.value=!!a.parent_id,F.value=a.parent_id||null;const e=q.find(l=>l.value===a.icon);f.value=e||q[0],_.value?ne.value=a.name:y.value=[{label:a.name,value:a.name,id:a.id}],N.value=a.active,a.subcategories&&a.subcategories.length>0?(R.value=a.subcategories.map(l=>({label:l.name,value:l.id?l.id.toString():`temp_${Date.now()}_${Math.random()}`})),S.value=a.subcategories.map(l=>l.id?l.id.toString():`temp_${Date.now()}_${Math.random()}`),te.value=a.subcategories.map(l=>l.name).join(", ")):(R.value=[],S.value=[],te.value="");const s=document.getElementById("addCatModal");new bootstrap.Modal(s).show()},re=d(""),ye=()=>{const a=(re.value||"").trim();a&&(K.value.some(e=>e.label.toLowerCase()===a.toLowerCase())||K.value.push({label:a,value:a}),y.value.includes(a)||(y.value=[...y.value,a]),re.value="")},De=async a=>{if(a?.id)try{await D.delete(`/categories/${a.id}`),c.success("Category deleted successfully"),await M(),await ee()}catch(e){console.error("âŒ Delete error:",e.response?.data||e.message),c.error("Failed to delete category âŒ")}},V=d(null),R=d([]),ae=d(""),ue=()=>{const a=ae.value?.trim();a&&(R.value.some(e=>e.value.toLowerCase()===a.toLowerCase())||R.value.push({label:a,value:a}),S.value.includes(a)||S.value.push(a),ae.value="")},Be=()=>{S.value=R.value.map(a=>a.value)},je=()=>{S.value=[]},x=d({id:null,name:"",parent_id:null}),Te=(a,e)=>{x.value={id:e.id,name:e.name,parent_id:a.id};const s=document.getElementById("editSubCatModal");bootstrap.Modal.getOrCreateInstance(s).show()},B=d(!1),j=d(""),Ae=async()=>{if(B.value=!0,!x.value.name.trim()){j.value="Subcategory name cannot be empty";return}B.value=!0,j.value="";try{const{data:a}=await D.put(`/api/categories/subcategories/${x.value.id}`,{name:x.value.name.trim()});if(a.success){c.success(a.message);const e=H.value.find(l=>l.id===x.value.parent_id);if(e){const l=e.subcategories.find(v=>v.id===x.value.id);l&&(l.name=x.value.name)}const s=document.getElementById("editSubCatModal");bootstrap.Modal.getInstance(s).hide(),x.value={id:null,name:"",parent_id:null}}else j.value=a.message||"Failed to update subcategory"}catch(a){console.error(a),j.value=a.response?.data?.message||"An error occurred while updating"}finally{B.value=!1}};ce(()=>{const a=document.getElementById("editSubCatModal");a&&a.addEventListener("hidden.bs.modal",()=>{j.value="",x.value={id:null,name:"",parent_id:null}})}),Ye(()=>{const a=document.getElementById("editSubCatModal");a&&a.removeEventListener("hidden.bs.modal",()=>{})});let he=null;_e($,()=>{clearTimeout(he),he=setTimeout(()=>{w.value.current_page=1,M(1)},500)}),_e(()=>g.value,()=>{w.value.current_page=1,M(1)},{deep:!0});const Oe=async()=>{try{L.value=!0;const a={q:$.value.trim(),per_page:1e4,page:1,sort_by:g.value.sortBy||"",status:g.value.status||"",has_subcategories:g.value.hasSubcategories||"",stock_status:g.value.stockStatus||"",value_min:g.value.valueMin||"",value_max:g.value.valueMax||""},e=await D.get("/categories",{params:a});return console.log("ðŸ“¦ Export data received:",{total:e.data.total,items:e.data.data.length}),e.data.data.filter(s=>s.parent_id===null)||[]}catch(a){return console.error("âŒ Error fetching export data:",a),c.error("Failed to load data for export"),[]}finally{L.value=!1}},de=async a=>{try{L.value=!0;const e=await Oe();if(!e||e.length===0){c.error("No categories found to download"),L.value=!1;return}console.log(`ðŸ“¥ Exporting ${e.length} categories as ${a.toUpperCase()}`),a==="pdf"?Re(e):a==="excel"?ze(e):a==="csv"?Ue(e):c.error("Invalid download type")}catch(e){console.error("Download failed:",e),c.error(`Download failed: ${e.message}`)}finally{L.value=!1}},Ue=a=>{try{const e=["category","subcategory","active"],s=a.map(n=>{const b=A=>A==null?'""':(A=String(A).replace(/"/g,'""'),`"${A}"`),T=n.subcategories&&n.subcategories.length>0?n.subcategories.map(A=>A.name).join(", "):"";return[b(n.name),b(T),n.active?"Yes":"No"]}),o=[e.join(","),...s.map(n=>n.join(","))].join(`
`),l=new Blob([o],{type:"text/csv;charset=utf-8;"}),v=URL.createObjectURL(l),m=document.createElement("a");m.setAttribute("href",v),m.setAttribute("download",`Categories_${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(v),c.success(`CSV downloaded successfully (${a.length} categories)`,{autoClose:2500})}catch(e){console.error("CSV generation error:",e),c.error(`CSV generation failed: ${e.message}`,{autoClose:5e3})}},Re=a=>{try{const e=new et("p","mm","a4");e.setFontSize(18),e.setFont("helvetica","bold"),e.text("Inventory Categories Report",14,20),e.setFontSize(10),e.setFont("helvetica","normal");const s=new Date().toLocaleString();e.text(`Generated on: ${s}`,14,28),e.text(`Total Categories: ${a.length}`,14,34);const o=["Category","Subcategory","Active"],l=a.map(m=>{const n=m.subcategories&&m.subcategories.length>0?m.subcategories.map(b=>b.name).join(", "):"";return[m.name||"",n,m.active?"Yes":"No"]});tt(e,{head:[o],body:l,startY:40,styles:{fontSize:9,cellPadding:2,halign:"left",lineColor:[0,0,0],lineWidth:.1},headStyles:{fillColor:[41,128,185],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]},margin:{left:14,right:14},didDrawPage:m=>{const n=e.internal.getNumberOfPages(),b=e.internal.pageSize.height;e.setFontSize(8),e.text(`Page ${m.pageNumber} of ${n}`,m.settings.margin.left,b-10)}});const v=`Categories_${new Date().toISOString().split("T")[0]}.pdf`;e.save(v),c.success(`PDF downloaded successfully (${a.length} categories)`,{autoClose:2500})}catch(e){console.error("PDF generation error:",e),c.error(`PDF generation failed: ${e.message}`,{autoClose:5e3})}},ze=a=>{try{if(typeof at>"u")throw new Error("XLSX library is not loaded");const e=a.map(n=>{const b=n.subcategories&&n.subcategories.length>0?n.subcategories.map(T=>T.name).join(", "):"";return{Category:n.name||"",Subcategory:b,Active:n.active?"Yes":"No"}}),s=J.book_new(),o=J.json_to_sheet(e);o["!cols"]=[{wch:25},{wch:40},{wch:10}],J.book_append_sheet(s,o,"Categories");const l=[{Info:"Generated On",Value:new Date().toLocaleString()},{Info:"Total Records",Value:a.length},{Info:"Exported By",Value:"Inventory Management System"}],v=J.json_to_sheet(l);J.book_append_sheet(s,v,"Report Info");const m=`Categories_${new Date().toISOString().split("T")[0]}.xlsx`;lt(s,m),c.success(`Excel file downloaded successfully (${a.length} categories)`,{autoClose:2500})}catch(e){console.error("Excel generation error:",e),c.error(`Excel generation failed: ${e.message}`,{autoClose:5e3})}},He=a=>{if(!a||a.length<=1){c.error("The imported file is empty.");return}a[0];const s=a.slice(1).map(n=>({category:n[0]||"",subcategory:n[1]||null,active:n[2]=="no"?0:1})),o=s.filter(n=>n.category).map(n=>n.category.trim().toLowerCase()),l=o.filter((n,b)=>o.indexOf(n)!==b);if(l.length>0){c.error(`Duplicate category names found in CSV: ${[...new Set(l)].join(", ")}`);return}const v=ge.value.map(n=>n.name.trim().toLowerCase()),m=s.filter(n=>n.category).filter(n=>v.includes(n.category.trim().toLowerCase()));if(m.length>0){const n=m.map(b=>b.category).join(", ");c.error(`Categories already exist in the table: ${n}`);return}D.post("/api/categories/import",{categories:s}).then(()=>{c.success("Categories imported successfully");const n=document.querySelector(".modal.show");if(n){const b=bootstrap.Modal.getInstance(n);b&&b.hide()}setTimeout(()=>{document.querySelectorAll(".modal-backdrop").forEach(T=>T.remove()),document.body.classList.remove("modal-open"),document.body.style.overflow="",document.body.style.paddingRight=""},100),M()}).catch(n=>{console.error(n),c.error("Import failed"),setTimeout(()=>{document.querySelectorAll(".modal-backdrop").forEach(T=>T.remove()),document.body.classList.remove("modal-open"),document.body.style.overflow="",document.body.style.paddingRight=""},100)})};return(a,e)=>{const s=Ce("ConfirmModal"),o=Ce("Button");return i(),me(We,null,{default:G(()=>[k(O(Ge),{title:"Inventory Category"}),t("div",ct,[e[57]||(e[57]=t("h4",{class:"mb-3"},"Inventory Categories",-1)),t("div",mt,[(i(!0),r(I,null,z(Le.value,l=>(i(),r("div",{key:l.label,class:"col-md-6 col-xl-3"},[t("div",vt,[t("div",pt,[t("div",null,[t("div",gt,u(l.value),1),t("div",bt,u(l.label),1)]),t("div",{class:U(["p-3 rounded-3 d-flex align-items-center justify-content-center",l.iconBg])},[(i(),me(Ze(l.icon),{class:U(l.iconColor),size:"28"},null,8,["class"]))],2)])])]))),128))]),t("div",ft,[t("div",yt,[t("div",ht,[e[28]||(e[28]=t("h4",{class:"mb-0"},"Categories",-1)),t("div",_t,[t("div",Ct,[e[22]||(e[22]=t("i",{class:"bi bi-search"},null,-1)),e[23]||(e[23]=t("input",{type:"email",name:"email",autocomplete:"email",style:{position:"absolute",left:"-9999px",width:"1px",height:"1px"},tabindex:"-1","aria-hidden":"true"},null,-1)),fe.value?Z((i(),r("input",{id:oe,"onUpdate:modelValue":e[0]||(e[0]=l=>$.value=l),key:be.value,class:"form-control search-input",placeholder:"Search",type:"search",autocomplete:"new-password",name:oe,role:"presentation",onFocus:e[1]||(e[1]=(...l)=>a.handleFocus&&a.handleFocus(...l))},null,32)),[[ve,$.value]]):(i(),r("input",wt))]),k(Qe,{modelValue:g.value,"onUpdate:modelValue":e[2]||(e[2]=l=>g.value=l),title:"Inventory Categories","modal-id":"categoryFilterModal","modal-size":"modal-lg","sort-options":Q.value.sortOptions,"status-options":Q.value.statusOptions,"show-stock-status":!1,"stock-status-options":Q.value.stockStatusOptions,"show-price-range":!0,"price-label":"Total Value Range",onApply:Ee,onClear:Ie},{customFilters:G(({filters:l})=>[t("div",kt,[e[25]||(e[25]=t("label",{class:"form-label fw-semibold text-dark"},[t("i",{class:"fas fa-sitemap me-2 text-muted"}),E("Subcategories ")],-1)),Z(t("select",{"onUpdate:modelValue":v=>l.hasSubcategories=v,class:"form-select"},[e[24]||(e[24]=t("option",{value:""},"All",-1)),(i(!0),r(I,null,z(Q.value.hasSubcategoriesOptions,v=>(i(),r("option",{key:v.value,value:v.value},u(v.label),9,St))),128))],8,xt),[[we,l.hasSubcategories]])])]),_:1},8,["modelValue","sort-options","status-options","stock-status-options"]),t("button",{"data-bs-toggle":"modal","data-bs-target":"#addCatModal",onClick:e[3]||(e[3]=()=>{X?.(),h.value&&(h.value.value=null),ie?.()}),class:"d-flex align-items-center gap-1 px-4 py-2 btn-sm rounded-pill btn btn-primary text-white"},[k(O(dt),{class:"w-4 h-4"}),e[26]||(e[26]=E(" Add Category ",-1))]),k(ot,{label:"Import",sampleHeaders:["category","subcategory","active"],sampleData:[["Dairy","TestSubCat","yes"],["Bakery","Bread","yes"],["Beverages","Juices","no"]],onOnImport:He}),t("div",Mt,[e[27]||(e[27]=t("button",{class:"btn btn-outline-secondary rounded-pill py-2 btn-sm px-4 dropdown-toggle","data-bs-toggle":"dropdown"}," Export ",-1)),t("ul",Ft,[t("li",null,[t("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:e[4]||(e[4]=l=>de("pdf"))},"Export as PDF")]),t("li",null,[t("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:e[5]||(e[5]=l=>de("excel"))},"Export as Excel")]),t("li",null,[t("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:e[6]||(e[6]=l=>de("csv"))}," Export as CSV ")])])])])]),t("div",It,[t("table",Et,[e[30]||(e[30]=t("thead",{class:"border-top small text-muted"},[t("tr",null,[t("th",null,"S.#"),t("th",null,"Category"),t("th",null,"Sub Category"),t("th",null,"Icon"),t("th",null,"Total value"),t("th",null,"Total Item"),t("th",null,"Out of Stock"),t("th",null,"Low Stock"),t("th",null,"In Stock"),t("th",{class:"text-center"},"Status"),t("th",{class:"text-center"},"Action")])],-1)),t("tbody",null,[L.value?(i(),r("tr",$t,[...e[29]||(e[29]=[t("td",{colspan:"11",class:"text-center py-5"},[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")]),t("p",{class:"text-muted mt-2 mb-0"},"Loading categories...")],-1)])])):!L.value&&H.value.length===0?(i(),r("tr",Lt,[t("td",Nt,u($.value.trim()?"No categories found matching your search.":"No categories available."),1)])):(i(),r(I,{key:2},[(i(!0),r(I,null,z(se.value,(l,v)=>(i(),r("tr",{key:l.id},[t("td",null,u(w.value.from+v),1),t("td",Pt,u(l.name),1),t("td",Vt,[l.subcategories&&l.subcategories.length?(i(),r("div",Dt,[(i(!0),r(I,null,z(l.subcategories,m=>(i(),r("div",{key:m.id,class:"d-flex justify-content-between align-items-center",style:{gap:"5px"}},[t("span",null,u(m.name),1),t("button",{class:"p-2 rounded-full text-blue-600 hover:bg-blue-100",onClick:n=>Te(l,m),title:"Edit Subcategory"},[k(O(Me),{class:"w-4 h-4"})],8,Bt)]))),128))])):(i(),r("span",jt,"â€“"))]),t("td",null,[t("div",Tt,[l.image_url?(i(),r("img",{key:0,src:l.image_url,alt:l.name,class:"rounded",style:{width:"32px",height:"32px","object-fit":"cover"}},null,8,At)):(i(),r("span",Ot,"ðŸ“¦"))])]),t("td",null,u(O(Fe)(l.total_value)),1),t("td",null,u(l.primary_inventory_items_count),1),t("td",null,u(l.out_of_stock),1),t("td",null,u(l.low_stock),1),t("td",null,u(l.in_stock),1),t("td",Ut,[t("span",{class:U(l.active?"inline-block px-3 py-1 text-xs font-semibold text-white bg-success rounded-full text-center w-20":"inline-block px-3 py-1 text-xs font-semibold text-white bg-danger rounded-full text-center w-20")},u(l.active?"Active":"Inactive"),3)]),t("td",Rt,[t("div",zt,[t("button",{"data-bs-toggle":"modal","data-bs-target":"#modalUnitForm",onClick:()=>{Ve(l)},title:"Edit",class:"p-2 rounded-full text-blue-600 hover:bg-blue-100"},[k(O(Me),{class:"w-4 h-4"})],8,Ht),k(s,{title:"Confirm Delete",message:`Are you sure you want to delete ${l.name}?`,showDeleteButton:!0,onConfirm:()=>{De(l)},onCancel:()=>{}},null,8,["message","onConfirm"])])])]))),128)),se.value.length===0?(i(),r("tr",qt,[t("td",Kt,u($.value.trim()?"No categories found matching your search.":"No categories found."),1)])):C("",!0)],64))])])]),w.value.last_page>1?(i(),r("div",Xt,[t("div",Yt," Showing "+u(w.value.from)+" to "+u(w.value.to)+" of "+u(w.value.total)+" entries ",1),k(Je,{pagination:w.value.links,isApiDriven:!0,onPageChanged:$e},null,8,["pagination"])])):C("",!0)])]),t("div",Gt,[t("div",Zt,[t("div",Jt,[e[36]||(e[36]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title"},"Category Details"),t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})])])],-1)),V.value?(i(),r("div",Wt,[t("p",null,[e[31]||(e[31]=t("strong",null,"Name:",-1)),E(" "+u(V.value.name),1)]),t("p",null,[e[32]||(e[32]=t("strong",null,"Icon:",-1)),t("span",Qt,u(V.value.icon),1)]),t("p",null,[e[33]||(e[33]=t("strong",null,"Status:",-1)),E(" "+u(V.value.active?"Active":"Inactive"),1)]),V.value.parent?(i(),r("p",ea,[e[34]||(e[34]=t("strong",null,"Parent Category:",-1)),E(" "+u(V.value.parent.name),1)])):C("",!0),t("p",null,[e[35]||(e[35]=t("strong",null,"Sub-Categories: ",-1)),V.value.subcategories.length?(i(),r("span",ta,u(V.value.subcategories.map(l=>l.name).join(", ")),1)):(i(),r("span",aa,"None"))])])):(i(),r("div",la," Loading category details... ")),e[37]||(e[37]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ")],-1))])])]),t("div",sa,[t("div",oa,[t("div",na,[t("div",ia,[t("h5",ra,u(h.value?"Edit Category":"Add Raw Material Category"),1),e[38]||(e[38]=t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})])],-1))]),t("div",ua,[t("div",da,[h.value?C("",!0):(i(),r(I,{key:0},[t("div",ca,[e[41]||(e[41]=t("label",{class:"form-label d-block mb-2"},"Is this a subcategory?",-1)),t("div",ma,[t("div",va,[t("input",{class:"form-check-input",type:"radio",checked:_.value,onClick:e[7]||(e[7]=l=>X()),onChange:e[8]||(e[8]=l=>{_.value=!0,F.value=null}),name:"isSub"},null,40,pa),e[39]||(e[39]=t("label",{class:"form-check-label"},"Yes",-1))]),t("div",ga,[t("input",{class:"form-check-input",type:"radio",checked:!_.value,onClick:e[9]||(e[9]=l=>X()),onChange:e[10]||(e[10]=l=>{_.value=!1,F.value=null}),name:"isSub"},null,40,ba),e[40]||(e[40]=t("label",{class:"form-check-label"},"No",-1))])])]),_.value?(i(),r("div",fa,[e[43]||(e[43]=t("label",{class:"form-label d-block mb-2"},"Select Parent Category",-1)),Z(t("select",{"onUpdate:modelValue":e[11]||(e[11]=l=>F.value=l),class:U(["form-select",{"is-invalid":p.value?.parent_id}]),required:""},[e[42]||(e[42]=t("option",{disabled:"",value:null}," Choose Parent Category ",-1)),(i(!0),r(I,null,z(ge.value,l=>(i(),r("option",{key:l.id,value:l.id},u(l.name),9,ya))),128))],2),[[we,F.value]]),p.value?.parent_id?(i(),r("small",ha,u(p.value.parent_id[0]),1)):C("",!0)])):C("",!0)],64)),t("div",_a,[e[45]||(e[45]=t("label",{class:"form-label d-block mb-2"},"Manual Icon",-1)),t("div",Ca,[t("button",wa,[t("span",ka,[t("img",{src:f.value.value,alt:"icon",class:"me-2 rounded",style:{width:"24px",height:"24px","object-fit":"cover"}},null,8,xa),E(" "+u(f.value.label),1)]),e[44]||(e[44]=t("i",{class:"bi bi-caret-down-fill"},null,-1))]),t("ul",Sa,[(i(),r(I,null,z(q,l=>t("li",{key:l.label},[t("a",{class:"dropdown-item d-flex align-items-center",href:"javascript:void(0)",onClick:v=>f.value=l},[t("img",{src:l.value,alt:"icon",class:"me-2 rounded",style:{width:"24px",height:"24px","object-fit":"cover"}},null,8,Fa),E(" "+u(l.label),1)],8,Ma)])),64))])])]),!_.value||h.value?(i(),r("div",Ia,[e[46]||(e[46]=t("label",{class:"form-label"},"Category Name",-1)),h.value?Z((i(),r("input",{key:0,type:"text","onUpdate:modelValue":e[12]||(e[12]=l=>y.value[0].label=l),class:U(["form-control",{"is-invalid":p.value.name}]),placeholder:"Enter category name"},null,2)),[[ve,y.value[0].label]]):(i(),me(O(Se),{key:1,modelValue:y.value,"onUpdate:modelValue":e[13]||(e[13]=l=>y.value=l),options:K.value,optionLabel:"label",optionValue:"value",filter:!0,display:"chip",class:U([{"is-invalid":p.value.name},"w-100 select"]),placeholder:"Select or add categories...",appendTo:"self",onKeydown:ke(xe(ye,["prevent"]),["enter"]),onBlur:ye,onFilter:e[14]||(e[14]=l=>re.value=l.value)},{option:G(({option:l})=>[E(u(l.label),1)]),_:1},8,["modelValue","options","class","onKeydown"])),p.value.name?(i(),r("small",Ea,u(p.value.name[0]),1)):C("",!0)])):C("",!0),_.value&&!h.value?(i(),r("div",$a,[e[47]||(e[47]=t("label",{class:"form-label"},"Subcategory Name(s)",-1)),k(O(Se),{modelValue:S.value,"onUpdate:modelValue":e[15]||(e[15]=l=>S.value=l),options:R.value,optionLabel:"label",optionValue:"value",filter:!0,display:"chip",class:U([{"is-invalid":p.value?.subcategories||p.value?.name},"w-100"]),placeholder:"Select or add subcategories...",appendTo:"self",onFilter:e[16]||(e[16]=l=>ae.value=l.value||""),onKeydown:ke(xe(ue,["prevent"]),["enter"]),onBlur:ue},{option:G(({option:l})=>[t("div",null,u(l.label),1)]),footer:G(()=>[t("div",La,[k(o,{label:"Add Custom",severity:"secondary",variant:"text",size:"small",icon:"pi pi-plus",onClick:ue,disabled:!ae.value.trim()},null,8,["onClick","disabled"]),t("div",Na,[k(o,{label:"Select All",severity:"secondary",variant:"text",size:"small",icon:"pi pi-check",onClick:Be},null,8,["onClick"]),k(o,{label:"Clear All",severity:"danger",variant:"text",size:"small",icon:"pi pi-times",onClick:je},null,8,["onClick"])])])]),_:1},8,["modelValue","options","class","onKeydown"]),p.value?.subcategories?(i(),r("div",Pa,u(p.value.subcategories[0]),1)):C("",!0),p.value?.name?(i(),r("div",Va,u(p.value.name[0]),1)):C("",!0)])):C("",!0),h.value&&a.parentCategory?(i(),r("div",Da,[e[48]||(e[48]=t("label",{class:"form-label"},"Parent Category",-1)),t("input",{type:"text",class:"form-control",value:a.parentCategory.label,disabled:""},null,8,Ba)])):C("",!0),t("div",ja,[e[51]||(e[51]=t("label",{class:"form-label d-block mb-2"},"Active",-1)),t("div",Ta,[t("div",Aa,[t("input",{class:"form-check-input",type:"radio",checked:N.value,onChange:e[17]||(e[17]=l=>N.value=!0),name:"active"},null,40,Oa),e[49]||(e[49]=t("label",{class:"form-check-label"},"Yes",-1))]),t("div",Ua,[t("input",{class:"form-check-input",type:"radio",checked:!N.value,onChange:e[18]||(e[18]=l=>N.value=!1),name:"active"},null,40,Ra),e[50]||(e[50]=t("label",{class:"form-check-label"},"No",-1))])])])]),e[54]||(e[54]=t("hr",{class:"my-4"},null,-1)),t("div",za,[t("button",{class:"btn btn-primary btn-sm rounded-pill px-4",disabled:P.value,onClick:e[19]||(e[19]=l=>Pe())},[P.value?(i(),r(I,{key:0},[e[52]||(e[52]=t("span",{class:"spinner-border spinner-border-sm me-2"},null,-1)),e[53]||(e[53]=E(" Saving... ",-1))],64)):(i(),r(I,{key:1},[E(u((h.value,"Save")),1)],64))],8,Ha),t("button",{class:"btn btn-secondary rounded-pill btn-sm px-4 ms-2","data-bs-dismiss":"modal",onClick:ie}," Cancel ")])])])])]),t("div",qa,[t("div",Ka,[t("div",Xa,[t("div",Ya,[t("h5",{onClick:e[20]||(e[20]=l=>j.value=""),class:"modal-title",id:"editSubCatModalLabel"}," Edit Subcategory "),e[55]||(e[55]=t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})])],-1))]),t("div",Ga,[t("div",Za,[e[56]||(e[56]=t("label",{for:"subCategoryName",class:"form-label"},"Subcategory Name",-1)),Z(t("input",{type:"text",class:"form-control",id:"subCategoryName","onUpdate:modelValue":e[21]||(e[21]=l=>x.value.name=l),disabled:B.value},null,8,Ja),[[ve,x.value.name]]),t("small",Wa,u(j.value),1)]),t("button",{type:"button",class:"px-4 py-2 rounded-pill btn btn-primary text-white text-center d-flex align-items-center justify-content-center gap-2",onClick:Ae,disabled:B.value},[B.value?(i(),r("span",el)):C("",!0),t("span",null,u(B.value?"Saving...":"Save"),1)],8,Qa)])])])])])]),_:1})}}},xl=qe(tl,[["__scopeId","data-v-061465c4"]]);export{xl as default};
