import{_ as Xe,r as d,c as ae,o as de,n as Ye,I as Ge,Q as Ze,w as Je,E as _e,a as ce,b as n,d as G,e as C,f as t,u as U,h as Qe,g as i,F as E,i as q,t as u,j as R,k as We,l as k,m as Z,v as me,p as V,T as Ce,P as et,U as ke,y as we,q as B,s as c}from"./app-BWJIgFUk.js";import{_ as tt}from"./Master-CIAemtMp.js";import{s as xe}from"./index-Bmn5Fnlz.js";import{F as at}from"./FilterModal-JVylnsp0.js";import{E as lt,a as st,X as ot,u as J,w as nt}from"./xlsx-BS8XIOXE.js";import{u as it}from"./useFormatters-D4QMfBkH.js";import{I as rt}from"./importFile-D0INQ-rw.js";import{s as ut}from"./index-Dlg67k_X.js";import{u as dt}from"./useModal-vDbn_8lj.js";import{S as ct}from"./shapes-D_S0neF8.js";import{P as mt}from"./package-CXreqZPn.js";import{T as vt}from"./triangle-alert-Difj2UL2.js";import{C as pt}from"./circle-x-CjlZLeFL.js";import{P as gt}from"./plus-CXHrIUTn.js";import{P as Se}from"./pencil-BJi1dG4D.js";import"./index-N5It5Rdt.js";import"./createLucideIcon-BtxAcjLS.js";import"./PasswordVerificationModal-C7K_1d78.js";import"./index-566Dsl26.js";import"./index-DrwUNMx0.js";import"./sun-DRYQ-wZ1.js";import"./index-CTSD38n0.js";import"./index-zt3OxlBu.js";import"./index-DTkP46Ub.js";import"./index-j-pTVcvw.js";import"./index-CQSxWd0K.js";const bt={class:"page-wrapper"},ft={class:"row g-3"},yt={class:"card border-0 shadow-sm rounded-4"},ht={class:"card-body d-flex align-items-center justify-content-between"},_t={class:"fw-bold fs-4"},Ct={class:"text-muted fs-6"},kt={class:"card border-0 shadow-lg rounded-4 mt-0"},wt={class:"card-body"},xt={class:"d-flex flex-wrap gap-2 justify-content-between align-items-center mb-3"},St={class:"d-flex flex-wrap gap-2 align-items-center"},Mt={class:"search-wrap"},Ft={key:1,class:"form-control search-input",placeholder:"Search",disabled:"",type:"text"},It={class:"col-12"},$t=["onUpdate:modelValue"],Et=["value"],Vt={class:"table-responsive"},Nt={class:"table table-striped"},Pt={key:0},Dt={key:1},Lt={colspan:"11",class:"text-center text-muted py-4"},Bt={class:"fw-semibold"},jt={class:"text-truncate",style:{"max-width":"260px"}},Tt={key:0},At=["onClick"],Ot={key:1},Ut={class:"rounded d-inline-flex align-items-center justify-content-center img-chip"},Rt=["src","alt"],zt={key:1,class:"fs-5"},qt={class:"text-center"},Ht={class:"text-center"},Kt={class:"d-inline-flex align-items-center gap-3"},Xt=["onClick"],Yt={key:0},Gt={colspan:"11",class:"text-center text-muted py-4"},Zt={key:0,class:"mt-4 d-flex justify-content-between align-items-center"},Jt={class:"text-muted small"},Qt={class:"modal fade",id:"viewCatModal",tabindex:"-1","aria-hidden":"true"},Wt={class:"modal-dialog modal-dialog-centered"},ea={class:"modal-content rounded-4"},ta={key:0,class:"modal-body"},aa={class:"fs-4"},la={key:0},sa={key:0},oa={key:1},na={key:1,class:"modal-body text-center"},ia={class:"modal fade",id:"addCatModal",tabindex:"-1","aria-hidden":"true"},ra={class:"modal-dialog modal-lg modal-dialog-centered"},ua={class:"modal-content rounded-4"},da={class:"modal-header"},ca={class:"modal-title fw-semibold"},ma={class:"modal-body"},va={class:"row g-3"},pa={class:"col-lg-6"},ga={class:"d-flex align-items-center gap-3"},ba={class:"form-check"},fa=["checked"],ya={class:"form-check"},ha=["checked"],_a={key:0,class:"col-lg-6"},Ca=["value"],ka={key:0,class:"text-danger"},wa={class:"col-lg-6"},xa={class:"dropdown w-100"},Sa={class:"btn btn-outline-secondary w-100 d-flex justify-content-between align-items-center rounded-3","data-bs-toggle":"dropdown"},Ma={class:"d-flex align-items-center"},Fa=["src"],Ia={class:"dropdown-menu w-100 shadow rounded-3"},$a=["onClick"],Ea=["src"],Va={key:1,class:"col-12"},Na={key:2,class:"text-danger"},Pa={key:2,class:"col-12"},Da={class:"p-3 d-flex justify-content-between"},La={class:"d-flex gap-2"},Ba={key:0,class:"text-danger"},ja={key:1,class:"text-danger"},Ta={key:3,class:"col-12"},Aa=["value"],Oa={class:"col-12"},Ua={class:"d-flex align-items-center gap-3"},Ra={class:"form-check"},za=["checked"],qa={class:"form-check"},Ha=["checked"],Ka={class:"mt-4"},Xa=["disabled"],Ya={class:"modal fade",id:"editSubCatModal",tabindex:"-1","aria-labelledby":"editSubCatModalLabel","aria-hidden":"true"},Ga={class:"modal-dialog"},Za={class:"modal-content"},Ja={class:"modal-header"},Qa={class:"modal-body"},Wa={class:"mb-3"},el=["disabled"],tl={class:"text-danger"},al=["disabled"],ll={key:0,class:"spinner-border spinner-border-sm text-light",role:"status"},sl={__name:"Index",setup(ol){const{closeModal:Me}=dt();it();const f=d([]),H=d([]),ve=d([]),Q={sortBy:"",status:"",hasSubcategories:"",stockStatus:"",valueMin:null,valueMax:null},S=d({...Q}),h=d({...Q}),le=d(null),Fe=[{label:"PDF",value:"pdf"},{label:"Excel",value:"excel"},{label:"CSV",value:"csv"}],Ie=l=>{l.value&&(Re(l.value),le.value=null)},W=ae(()=>({sortOptions:[{value:"name_asc",label:"Name: A to Z"},{value:"name_desc",label:"Name: Z to A"}],statusOptions:[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"}],hasSubcategoriesOptions:[{value:"yes",label:"Has Subcategories"},{value:"no",label:"No Subcategories"}],stockStatusOptions:[{value:"in_stock",label:"In Stock"},{value:"low_stock",label:"Low Stock"},{value:"out_of_stock",label:"Out of Stock"},{value:"has_items",label:"Has Items"},{value:"no_items",label:"No Items"}]})),$e=()=>{S.value={...Q},h.value={...Q},w.value.current_page=1,w.value.per_page=10,F(1),Me("categoryFilterModal")},pe=ae(()=>H.value),Ee=()=>{h.value={...S.value},w.value.current_page=999999,F(1)},w=d({current_page:1,last_page:1,per_page:10,total:0,from:0,to:0,links:[]}),y=d(null),M=d([]),se=async()=>{try{const{data:l}=await B.get("/categories",{params:{per_page:1e4}});ve.value=l.data||[]}catch(l){console.error("Failed to fetch all categories:",l)}},F=async(l=null)=>{try{N.value=!0;const e={page:l||1,per_page:w.value.per_page};I.value?.trim()&&(e.q=I.value.trim()),h.value.sortBy&&(e.sort_by=h.value.sortBy),h.value.status&&(e.status=h.value.status),h.value.hasSubcategories&&(e.has_subcategories=h.value.hasSubcategories),h.value.stockStatus&&(e.stock_status=h.value.stockStatus),h.value.valueMin&&(e.value_min=h.value.valueMin),h.value.valueMax&&(e.value_max=h.value.valueMax);const{data:s}=await B.get("/categories",{params:e});H.value=s.data||[],w.value={current_page:s.current_page||1,last_page:s.last_page||1,per_page:s.per_page||10,total:s.total||0,from:s.from||0,to:s.to||0,links:s.links||[]}}catch(e){console.error("Failed to fetch categories:",e),c.error("Failed to load categories")}finally{N.value=!1}},Ve=l=>{if(!l)return;const s=new URLSearchParams(l.split("?")[1]).get("page");s&&F(parseInt(s))};de(async()=>{I.value="",be.value=Date.now(),await Ye(),setTimeout(()=>{fe.value=!0;const l=document.getElementById(oe);l&&(l.value="",I.value="")},100),se(),F()});const ge=ae(()=>H.value.filter(l=>l.parent_id===null)),Ne=ae(()=>{const l=ve.value.filter(e=>e.parent_id===null);return[{label:"Categories",value:l.length,icon:ct,iconBg:"bg-light-primary",iconColor:"text-primary"},{label:"Total Active",value:l.filter(e=>e.active).length,icon:mt,iconBg:"bg-light-success",iconColor:"text-success"},{label:"Low Stock",value:l.filter(e=>!e.active).length,icon:vt,iconBg:"bg-light-warning",iconColor:"text-warning"},{label:"Out of Stock",value:l.filter(e=>!e.parent_id).length,icon:pt,iconBg:"bg-light-danger",iconColor:"text-danger"}]}),I=d(""),be=d(Date.now()),oe=`search-${Math.random().toString(36).substr(2,9)}`,fe=d(!1),N=d(!1);de(()=>window.feather?.replace()),Ge(()=>window.feather?.replace());const _=d(!1),ne=d(""),P=d(!0),$=d(null),b=d({label:"Produce (Veg/Fruit)",value:"/assets/img/vegetable.png",file:null}),K=[{label:"Produce (Veg/Fruit)",value:"/assets/img/vegetable.png"},{label:"Meat",value:"/assets/img/meat.png"},{label:"Poultry",value:"/assets/img/poultry.png"},{label:"Dairy",value:"/assets/img/dairy.png"},{label:"Grains & Rice",value:"/assets/img/rice.png"},{label:"Spices & Herbs",value:"/assets/img/spice.png"},{label:"Oils & Fats",value:"/assets/img/olive-oil.png"},{label:"Sauces & Condiments",value:"/assets/img/sauces.png"},{label:"Nuts & Seeds",value:"/assets/img/nuts.png"},{label:"Other",value:"/assets/img/other.png"}],X=d([{label:"Produce (Veg/Fruit)",value:"Produce (Veg/Fruit)",icon:"/assets/img/vegetable.png",selected:!1},{label:"Meat",value:"Meat",icon:"/assets/img/meat.png",selected:!1},{label:"Poultry",value:"Poultry",icon:"/assets/img/poultry.png",selected:!1},{label:"Dairy",value:"Dairy",icon:"/assets/img/dairy.png",selected:!1},{label:"Grains & Rice",value:"Grains & Rice",icon:"/assets/img/rice.png",selected:!1},{label:"Flour & Baking",value:"Flour & Baking",icon:"/assets/img/flour.png",selected:!1},{label:"Spices & Herbs",value:"Spices & Herbs",icon:"/assets/img/spice.png",selected:!1},{label:"Oils & Fats",value:"Oils & Fats",icon:"/assets/img/olive-oil.png",selected:!1},{label:"Sauces & Condiments",value:"Sauces & Condiments",icon:"/assets/img/sauces.png",selected:!1},{label:"Nuts & Seeds",value:"Nuts & Seeds",icon:"/assets/img/nuts.png",selected:!1},{label:"Other",value:"Other",icon:"/assets/img/other.png",selected:!1}]),Pe=async(l,e)=>{try{const s=await fetch(l);if(!s.ok)return console.error("âŒ Fetch failed:",s.status,s.statusText),null;const r=await s.blob();return new File([r],e,{type:r.type})}catch(s){return console.error("âŒ Error converting URL to File:",s),null}},ie=()=>{_.value=!1,f.value=[],P.value=!0,$.value=null,ne.value="",b.value={label:K[0].label,value:K[0].value,file:null},X.value=X.value.map(l=>({...l,selected:!1})),y.value=null},D=d(!1),p=d({}),De=async()=>{if(_.value&&!$.value){p.value.parent_id=["Please select a parent category"],c.error(p.value.parent_id[0]),D.value=!1;return}Y(),D.value=!0;try{if(b.value.value&&!b.value.file){const e=b.value.label.toLowerCase().replace(/[^a-z0-9]/g,"-")+".jpg",s=await Pe(b.value.value,e);s&&(b.value.file=s)}if(y.value){const e=new FormData;let s="";if(_.value?s=ne.value?.trim():s=f.value[0]?.label?.trim()||f.value[0]?.name?.trim()||(typeof f.value[0]=="string"?f.value[0].trim():""),!s){p.value.name=["Category name cannot be empty"],c.error("Category name cannot be empty"),D.value=!1;return}e.append("name",s),e.append("active",P.value?"1":"0"),e.append("parent_id",$.value||""),e.append("_method","PUT"),b.value.file&&b.value.file instanceof File&&e.append("icon",b.value.file),!$.value&&ee.value&&ee.value.split(",").map(a=>a.trim()).filter(a=>a.length>0).forEach((a,v)=>{const m=y.value.subcategories?.find(o=>o.name.toLowerCase()===a.toLowerCase());e.append(`subcategories[${v}][name]`,a),m?(e.append(`subcategories[${v}][id]`,m.id),e.append(`subcategories[${v}][active]`,m.active?"1":"0")):e.append(`subcategories[${v}][active]`,"1")}),await B.post(`/categories/${y.value.id}`,e,{headers:{"Content-Type":"multipart/form-data"}}),c.success("Category updated successfully"),await F()}else{const e=new FormData;let s=[];if(_.value){if(M.value.length===0){p.value.subcategories=["Please add at least one subcategory"],c.error("Please add at least one subcategory"),D.value=!1;return}s=M.value.map(r=>({name:typeof r=="string"?r:r.label,active:P.value,parent_id:$.value}))}else{if(f.value.length===0){p.value.name=["Please add at least one category"],c.error("Please add at least one category"),D.value=!1;return}s=f.value.map(r=>({name:typeof r=="string"?r:r.label,active:P.value,parent_id:null}))}e.append("isSubCategory",_.value?"1":"0"),s.forEach((r,a)=>{e.append(`categories[${a}][name]`,r.name),e.append(`categories[${a}][active]`,r.active?"1":"0"),r.parent_id&&e.append(`categories[${a}][parent_id]`,r.parent_id)}),b.value.file&&b.value.file instanceof File&&e.append("icon",b.value.file),await B.post("/categories",e,{headers:{"Content-Type":"multipart/form-data"}}),c.success("Category created successfully"),await F(),await se()}bootstrap.Modal.getInstance(document.getElementById("addCatModal"))?.hide(),ie(),y.value=null,await F()}catch(l){if(l.response?.status===422&&l.response?.data?.errors){const e=l.response.data.errors;let s=[];p.value={},Object.keys(e).forEach(r=>{let a=r.replace(/^categories\.\d+\./,"");p.value[a]=e[r],Array.isArray(e[r])&&e[r].forEach(v=>{s.push(v)})}),s.length>0?c.error(s.join(`
`)):c.error("Validation failed. Please check your input.")}else{const e=l.response?.data?.message||"Failed to save category";c.error(e+" âŒ")}}finally{D.value=!1}},Y=()=>{p.value={}},ee=d(""),Le=l=>{Y(),y.value=l,_.value=!!l.parent_id,$.value=l.parent_id||null;const e=K.find(a=>a.value===l.icon);b.value=e||K[0],_.value?ne.value=l.name:f.value=[{label:l.name,value:l.name,id:l.id}],P.value=l.active,l.subcategories&&l.subcategories.length>0?(z.value=l.subcategories.map(a=>({label:a.name,value:a.id?a.id.toString():`temp_${Date.now()}_${Math.random()}`})),M.value=l.subcategories.map(a=>a.id?a.id.toString():`temp_${Date.now()}_${Math.random()}`),ee.value=l.subcategories.map(a=>a.name).join(", ")):(z.value=[],M.value=[],ee.value="");const s=document.getElementById("addCatModal");new bootstrap.Modal(s).show()},re=d(""),ye=()=>{const l=(re.value||"").trim();l&&(X.value.some(e=>e.label.toLowerCase()===l.toLowerCase())||X.value.push({label:l,value:l}),f.value.includes(l)||(f.value=[...f.value,l]),re.value="")},Be=async l=>{if(l?.id)try{const e=await B.delete(`/categories/${l.id}`);e.data.success?(c.success(e.data.message),await F(),await se()):c.error(e.data.message)}catch(e){console.error("âŒ Delete error:",e.response?.data||e.message);const s=e.response?.data?.message||"Failed to delete category";c.error(s)}},L=d(null),z=d([]),te=d(""),ue=()=>{const l=te.value?.trim();l&&(z.value.some(e=>e.value.toLowerCase()===l.toLowerCase())||z.value.push({label:l,value:l}),M.value.includes(l)||M.value.push(l),te.value="")},je=()=>{M.value=z.value.map(l=>l.value)},Te=()=>{M.value=[]},x=d({id:null,name:"",parent_id:null}),Ae=(l,e)=>{x.value={id:e.id,name:e.name,parent_id:l.id};const s=document.getElementById("editSubCatModal");bootstrap.Modal.getOrCreateInstance(s).show()},j=d(!1),T=d(""),Oe=async()=>{if(j.value=!0,!x.value.name.trim()){T.value="Subcategory name cannot be empty";return}j.value=!0,T.value="";try{const{data:l}=await B.put(`/api/categories/subcategories/${x.value.id}`,{name:x.value.name.trim()});if(l.success){c.success(l.message);const e=H.value.find(a=>a.id===x.value.parent_id);if(e){const a=e.subcategories.find(v=>v.id===x.value.id);a&&(a.name=x.value.name)}const s=document.getElementById("editSubCatModal");bootstrap.Modal.getInstance(s).hide(),x.value={id:null,name:"",parent_id:null}}else T.value=l.message||"Failed to update subcategory"}catch(l){console.error(l),T.value=l.response?.data?.message||"An error occurred while updating"}finally{j.value=!1}};de(()=>{const l=document.getElementById("editSubCatModal");l&&l.addEventListener("hidden.bs.modal",()=>{T.value="",x.value={id:null,name:"",parent_id:null}})}),Ze(()=>{const l=document.getElementById("editSubCatModal");l&&l.removeEventListener("hidden.bs.modal",()=>{})});let he=null;Je(I,()=>{clearTimeout(he),he=setTimeout(()=>{w.value.current_page=1,F(1)},500)});const Ue=async()=>{try{N.value=!0;const l={q:I.value.trim(),per_page:1e4,page:1,sort_by:S.value.sortBy||"",status:S.value.status||"",has_subcategories:S.value.hasSubcategories||"",stock_status:S.value.stockStatus||"",value_min:S.value.valueMin||"",value_max:S.value.valueMax||""},e=await B.get("/categories",{params:l});return console.log("ðŸ“¦ Export data received:",{total:e.data.total,items:e.data.data.length}),e.data.data.filter(s=>s.parent_id===null)||[]}catch(l){return console.error("âŒ Error fetching export data:",l),c.error("Failed to load data for export"),[]}finally{N.value=!1}},Re=async l=>{try{N.value=!0;const e=await Ue();if(!e||e.length===0){c.error("No categories found to download"),N.value=!1;return}console.log(`ðŸ“¥ Exporting ${e.length} categories as ${l.toUpperCase()}`),l==="pdf"?qe(e):l==="excel"?He(e):l==="csv"?ze(e):c.error("Invalid download type")}catch(e){console.error("Download failed:",e),c.error(`Download failed: ${e.message}`)}finally{N.value=!1}},ze=l=>{try{const e=["category","subcategory","active"],s=l.map(o=>{const g=O=>O==null?'""':(O=String(O).replace(/"/g,'""'),`"${O}"`),A=o.subcategories&&o.subcategories.length>0?o.subcategories.map(O=>O.name).join(", "):"";return[g(o.name),g(A),o.active?"Yes":"No"]}),r=[e.join(","),...s.map(o=>o.join(","))].join(`
`),a=new Blob([r],{type:"text/csv;charset=utf-8;"}),v=URL.createObjectURL(a),m=document.createElement("a");m.setAttribute("href",v),m.setAttribute("download",`Categories_${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(v),c.success(`CSV downloaded successfully (${l.length} categories)`,{autoClose:2500})}catch(e){console.error("CSV generation error:",e),c.error(`CSV generation failed: ${e.message}`,{autoClose:5e3})}},qe=l=>{try{const e=new lt("p","mm","a4");e.setFontSize(18),e.setFont("helvetica","bold"),e.text("Inventory Categories Report",14,20),e.setFontSize(10),e.setFont("helvetica","normal");const s=new Date().toLocaleString();e.text(`Generated on: ${s}`,14,28),e.text(`Total Categories: ${l.length}`,14,34);const r=["Category","Subcategory","Active"],a=l.map(m=>{const o=m.subcategories&&m.subcategories.length>0?m.subcategories.map(g=>g.name).join(", "):"";return[m.name||"",o,m.active?"Yes":"No"]});st(e,{head:[r],body:a,startY:40,styles:{fontSize:9,cellPadding:2,halign:"left",lineColor:[0,0,0],lineWidth:.1},headStyles:{fillColor:[41,128,185],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]},margin:{left:14,right:14},didDrawPage:m=>{const o=e.internal.getNumberOfPages(),g=e.internal.pageSize.height;e.setFontSize(8),e.text(`Page ${m.pageNumber} of ${o}`,m.settings.margin.left,g-10)}});const v=`Categories_${new Date().toISOString().split("T")[0]}.pdf`;e.save(v),c.success(`PDF downloaded successfully (${l.length} categories)`,{autoClose:2500})}catch(e){console.error("PDF generation error:",e),c.error(`PDF generation failed: ${e.message}`,{autoClose:5e3})}},He=l=>{try{if(typeof ot>"u")throw new Error("XLSX library is not loaded");const e=l.map(o=>{const g=o.subcategories&&o.subcategories.length>0?o.subcategories.map(A=>A.name).join(", "):"";return{Category:o.name||"",Subcategory:g,Active:o.active?"Yes":"No"}}),s=J.book_new(),r=J.json_to_sheet(e);r["!cols"]=[{wch:25},{wch:40},{wch:10}],J.book_append_sheet(s,r,"Categories");const a=[{Info:"Generated On",Value:new Date().toLocaleString()},{Info:"Total Records",Value:l.length},{Info:"Exported By",Value:"Inventory Management System"}],v=J.json_to_sheet(a);J.book_append_sheet(s,v,"Report Info");const m=`Categories_${new Date().toISOString().split("T")[0]}.xlsx`;nt(s,m),c.success(`Excel file downloaded successfully (${l.length} categories)`,{autoClose:2500})}catch(e){console.error("Excel generation error:",e),c.error(`Excel generation failed: ${e.message}`,{autoClose:5e3})}},Ke=l=>{if(!l||l.length<=1){c.error("The imported file is empty.");return}l[0];const s=l.slice(1).map(o=>({category:o[0]||"",subcategory:o[1]||null,active:o[2]=="no"?0:1})),r=s.filter(o=>o.category).map(o=>o.category.trim().toLowerCase()),a=r.filter((o,g)=>r.indexOf(o)!==g);if(a.length>0){c.error(`Duplicate category names found in CSV: ${[...new Set(a)].join(", ")}`);return}const v=ge.value.map(o=>o.name.trim().toLowerCase()),m=s.filter(o=>o.category).filter(o=>v.includes(o.category.trim().toLowerCase()));if(m.length>0){const o=m.map(g=>g.category).join(", ");c.error(`Categories already exist in the table: ${o}`);return}B.post("/api/categories/import",{categories:s}).then(()=>{c.success("Categories imported successfully");const o=document.querySelector(".modal.show");if(o){const g=bootstrap.Modal.getInstance(o);g&&g.hide()}setTimeout(()=>{document.querySelectorAll(".modal-backdrop").forEach(A=>A.remove()),document.body.classList.remove("modal-open"),document.body.style.overflow="",document.body.style.paddingRight=""},100),F()}).catch(o=>{console.error(o),c.error("Import failed"),setTimeout(()=>{document.querySelectorAll(".modal-backdrop").forEach(A=>A.remove()),document.body.classList.remove("modal-open"),document.body.style.overflow="",document.body.style.paddingRight=""},100)})};return(l,e)=>{const s=_e("ConfirmModal"),r=_e("Button");return n(),ce(tt,null,{default:G(()=>[C(U(Qe),{title:"Inventory Category"}),t("div",bt,[e[54]||(e[54]=t("h4",{class:"mb-3"},"Inventory Categories",-1)),t("div",ft,[(n(!0),i(E,null,q(Ne.value,a=>(n(),i("div",{key:a.label,class:"col-md-6 col-xl-3"},[t("div",yt,[t("div",ht,[t("div",null,[t("div",_t,u(a.value),1),t("div",Ct,u(a.label),1)]),t("div",{class:R(["p-3 rounded-3 d-flex align-items-center justify-content-center",a.iconBg])},[(n(),ce(We(a.icon),{class:R(a.iconColor),size:"28"},null,8,["class"]))],2)])])]))),128))]),t("div",kt,[t("div",wt,[t("div",xt,[e[25]||(e[25]=t("h4",{class:"mb-0"},"Categories",-1)),t("div",St,[t("div",Mt,[e[20]||(e[20]=t("i",{class:"bi bi-search"},null,-1)),e[21]||(e[21]=t("input",{type:"email",name:"email",autocomplete:"email",style:{position:"absolute",left:"-9999px",width:"1px",height:"1px"},tabindex:"-1","aria-hidden":"true"},null,-1)),fe.value?Z((n(),i("input",{id:oe,"onUpdate:modelValue":e[0]||(e[0]=a=>I.value=a),key:be.value,class:"form-control search-input",placeholder:"Search",type:"search",autocomplete:"new-password",name:oe,role:"presentation",onFocus:e[1]||(e[1]=(...a)=>l.handleFocus&&l.handleFocus(...a))},null,32)),[[me,I.value]]):(n(),i("input",Ft))]),C(at,{modelValue:S.value,"onUpdate:modelValue":e[2]||(e[2]=a=>S.value=a),title:"Inventory Categories","modal-id":"categoryFilterModal","modal-size":"modal-lg","sort-options":W.value.sortOptions,"status-options":W.value.statusOptions,"show-stock-status":!1,"stock-status-options":W.value.stockStatusOptions,"show-price-range":!1,"price-label":"Total Value Range",onApply:Ee,onClear:$e},{customFilters:G(({filters:a})=>[t("div",It,[e[23]||(e[23]=t("label",{class:"form-label fw-semibold text-dark text-muted"},[t("i",{class:"fas fa-sitemap me-2 text-muted"}),V("Subcategories ")],-1)),Z(t("select",{"onUpdate:modelValue":v=>a.hasSubcategories=v,class:"form-select"},[e[22]||(e[22]=t("option",{value:""},"All",-1)),(n(!0),i(E,null,q(W.value.hasSubcategoriesOptions,v=>(n(),i("option",{key:v.value,value:v.value},u(v.label),9,Et))),128))],8,$t),[[Ce,a.hasSubcategories]])])]),_:1},8,["modelValue","sort-options","status-options","stock-status-options"]),t("button",{"data-bs-toggle":"modal","data-bs-target":"#addCatModal",onClick:e[3]||(e[3]=()=>{Y?.(),y.value&&(y.value.value=null),ie?.()}),class:"d-flex align-items-center gap-1 px-4 py-2 btn-sm rounded-pill btn btn-primary text-white"},[C(U(gt),{class:"w-4 h-4"}),e[24]||(e[24]=V(" Add Category ",-1))]),C(rt,{label:"Import",sampleHeaders:["category","subcategory","active"],sampleData:[["Dairy","TestSubCat","yes"],["Bakery","Bread","yes"],["Beverages","Juices","no"]],onOnImport:Ke}),C(U(ut),{modelValue:le.value,"onUpdate:modelValue":e[4]||(e[4]=a=>le.value=a),options:Fe,optionLabel:"label",optionValue:"value",placeholder:"Export",class:"export-dropdown",onChange:Ie},null,8,["modelValue"])])]),t("div",Vt,[t("table",Nt,[e[27]||(e[27]=t("thead",{class:"border-top small text-muted"},[t("tr",null,[t("th",null,"S.#"),t("th",null,"Category"),t("th",null,"Sub Category"),t("th",null,"Icon"),t("th",null,"Total Item"),t("th",null,"Out of Stock"),t("th",null,"Low Stock"),t("th",null,"In Stock"),t("th",{class:"text-center"},"Status"),t("th",{class:"text-center"},"Action")])],-1)),t("tbody",null,[N.value?(n(),i("tr",Pt,[...e[26]||(e[26]=[t("td",{colspan:"11",class:"text-center py-5"},[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")]),t("p",{class:"text-muted mt-2 mb-0"},"Loading categories...")],-1)])])):!N.value&&H.value.length===0?(n(),i("tr",Dt,[t("td",Lt,u(I.value.trim()?"No categories found matching your search.":"No categories available."),1)])):(n(),i(E,{key:2},[(n(!0),i(E,null,q(pe.value,(a,v)=>(n(),i("tr",{key:a.id},[t("td",null,u(w.value.from+v),1),t("td",Bt,u(a.name),1),t("td",jt,[a.subcategories&&a.subcategories.length?(n(),i("div",Tt,[(n(!0),i(E,null,q(a.subcategories,m=>(n(),i("div",{key:m.id,class:"d-flex justify-content-between align-items-center",style:{gap:"5px"}},[t("span",null,u(m.name),1),t("button",{class:"p-2 rounded-full text-blue-600 hover:bg-blue-100",onClick:o=>Ae(a,m),title:"Edit Subcategory"},[C(U(Se),{class:"w-4 h-4"})],8,At)]))),128))])):(n(),i("span",Ot,"â€“"))]),t("td",null,[t("div",Ut,[a.image_url?(n(),i("img",{key:0,src:a.image_url,alt:a.name,class:"rounded",style:{width:"32px",height:"32px","object-fit":"cover"}},null,8,Rt)):(n(),i("span",zt,"ðŸ“¦"))])]),t("td",null,u(a.primary_inventory_items_count),1),t("td",null,u(a.out_of_stock),1),t("td",null,u(a.low_stock),1),t("td",null,u(a.in_stock),1),t("td",qt,[t("span",{class:R(a.active?"inline-block px-3 py-1 text-xs font-semibold text-white bg-success rounded-full text-center w-20":"inline-block px-3 py-1 text-xs font-semibold text-white bg-danger rounded-full text-center w-20")},u(a.active?"Active":"Inactive"),3)]),t("td",Ht,[t("div",Kt,[t("button",{"data-bs-toggle":"modal","data-bs-target":"#modalUnitForm",onClick:()=>{Le(a)},title:"Edit",class:"p-2 rounded-full text-blue-600 hover:bg-blue-100"},[C(U(Se),{class:"w-4 h-4"})],8,Xt),C(s,{title:"Confirm Delete",message:`Are you sure you want to delete ${a.name}?`,showDeleteButton:!0,onConfirm:()=>{Be(a)},onCancel:()=>{}},null,8,["message","onConfirm"])])])]))),128)),pe.value.length===0?(n(),i("tr",Yt,[t("td",Gt,u(I.value.trim()?"No categories found matching your search.":"No categories found."),1)])):k("",!0)],64))])])]),w.value.last_page>1?(n(),i("div",Zt,[t("div",Jt," Showing "+u(w.value.from)+" to "+u(w.value.to)+" of "+u(w.value.total)+" entries ",1),C(et,{pagination:w.value.links,isApiDriven:!0,onPageChanged:Ve},null,8,["pagination"])])):k("",!0)])]),t("div",Qt,[t("div",Wt,[t("div",ea,[e[33]||(e[33]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title"},"Category Details"),t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})])])],-1)),L.value?(n(),i("div",ta,[t("p",null,[e[28]||(e[28]=t("strong",null,"Name:",-1)),V(" "+u(L.value.name),1)]),t("p",null,[e[29]||(e[29]=t("strong",null,"Icon:",-1)),t("span",aa,u(L.value.icon),1)]),t("p",null,[e[30]||(e[30]=t("strong",null,"Status:",-1)),V(" "+u(L.value.active?"Active":"Inactive"),1)]),L.value.parent?(n(),i("p",la,[e[31]||(e[31]=t("strong",null,"Parent Category:",-1)),V(" "+u(L.value.parent.name),1)])):k("",!0),t("p",null,[e[32]||(e[32]=t("strong",null,"Sub-Categories: ",-1)),L.value.subcategories.length?(n(),i("span",sa,u(L.value.subcategories.map(a=>a.name).join(", ")),1)):(n(),i("span",oa,"None"))])])):(n(),i("div",na," Loading category details... ")),e[34]||(e[34]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ")],-1))])])]),t("div",ia,[t("div",ra,[t("div",ua,[t("div",da,[t("h5",ca,u(y.value?"Edit Category":"Add Raw Material Category"),1),e[35]||(e[35]=t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})])],-1))]),t("div",ma,[t("div",va,[y.value?k("",!0):(n(),i(E,{key:0},[t("div",pa,[e[38]||(e[38]=t("label",{class:"form-label d-block mb-2"},"Is this a subcategory?",-1)),t("div",ga,[t("div",ba,[t("input",{class:"form-check-input",type:"radio",checked:_.value,onClick:e[5]||(e[5]=a=>Y()),onChange:e[6]||(e[6]=a=>{_.value=!0,$.value=null}),name:"isSub"},null,40,fa),e[36]||(e[36]=t("label",{class:"form-check-label"},"Yes",-1))]),t("div",ya,[t("input",{class:"form-check-input",type:"radio",checked:!_.value,onClick:e[7]||(e[7]=a=>Y()),onChange:e[8]||(e[8]=a=>{_.value=!1,$.value=null}),name:"isSub"},null,40,ha),e[37]||(e[37]=t("label",{class:"form-check-label"},"No",-1))])])]),_.value?(n(),i("div",_a,[e[40]||(e[40]=t("label",{class:"form-label d-block mb-2"},"Select Parent Category",-1)),Z(t("select",{"onUpdate:modelValue":e[9]||(e[9]=a=>$.value=a),class:R(["form-select",{"is-invalid":p.value?.parent_id}]),required:""},[e[39]||(e[39]=t("option",{disabled:"",value:null}," Choose Parent Category ",-1)),(n(!0),i(E,null,q(ge.value,a=>(n(),i("option",{key:a.id,value:a.id},u(a.name),9,Ca))),128))],2),[[Ce,$.value]]),p.value?.parent_id?(n(),i("small",ka,u(p.value.parent_id[0]),1)):k("",!0)])):k("",!0)],64)),t("div",wa,[e[42]||(e[42]=t("label",{class:"form-label d-block mb-2"},"Manual Icon",-1)),t("div",xa,[t("button",Sa,[t("span",Ma,[t("img",{src:b.value.value,alt:"icon",class:"me-2 rounded",style:{width:"24px",height:"24px","object-fit":"cover"}},null,8,Fa),V(" "+u(b.value.label),1)]),e[41]||(e[41]=t("i",{class:"bi bi-caret-down-fill"},null,-1))]),t("ul",Ia,[(n(),i(E,null,q(K,a=>t("li",{key:a.label},[t("a",{class:"dropdown-item d-flex align-items-center",href:"javascript:void(0)",onClick:v=>b.value=a},[t("img",{src:a.value,alt:"icon",class:"me-2 rounded",style:{width:"24px",height:"24px","object-fit":"cover"}},null,8,Ea),V(" "+u(a.label),1)],8,$a)])),64))])])]),!_.value||y.value?(n(),i("div",Va,[e[43]||(e[43]=t("label",{class:"form-label"},"Category Name",-1)),y.value?Z((n(),i("input",{key:0,type:"text","onUpdate:modelValue":e[10]||(e[10]=a=>f.value[0].label=a),class:R(["form-control",{"is-invalid":p.value.name}]),placeholder:"Enter category name"},null,2)),[[me,f.value[0].label]]):(n(),ce(U(xe),{key:1,modelValue:f.value,"onUpdate:modelValue":e[11]||(e[11]=a=>f.value=a),options:X.value,optionLabel:"label",optionValue:"value",filter:!0,display:"chip",class:R([{"is-invalid":p.value.name},"w-100 select"]),placeholder:"Select or add categories...",appendTo:"self",onKeydown:ke(we(ye,["prevent"]),["enter"]),onBlur:ye,onFilter:e[12]||(e[12]=a=>re.value=a.value)},{option:G(({option:a})=>[V(u(a.label),1)]),_:1},8,["modelValue","options","class","onKeydown"])),p.value.name?(n(),i("small",Na,u(p.value.name[0]),1)):k("",!0)])):k("",!0),_.value&&!y.value?(n(),i("div",Pa,[e[44]||(e[44]=t("label",{class:"form-label"},"Subcategory Name(s)",-1)),C(U(xe),{modelValue:M.value,"onUpdate:modelValue":e[13]||(e[13]=a=>M.value=a),options:z.value,optionLabel:"label",optionValue:"value",filter:!0,display:"chip",class:R([{"is-invalid":p.value?.subcategories||p.value?.name},"w-100"]),placeholder:"Select or add subcategories...",appendTo:"self",onFilter:e[14]||(e[14]=a=>te.value=a.value||""),onKeydown:ke(we(ue,["prevent"]),["enter"]),onBlur:ue},{option:G(({option:a})=>[t("div",null,u(a.label),1)]),footer:G(()=>[t("div",Da,[C(r,{label:"Add Custom",severity:"secondary",variant:"text",size:"small",icon:"pi pi-plus",onClick:ue,disabled:!te.value.trim()},null,8,["onClick","disabled"]),t("div",La,[C(r,{label:"Select All",severity:"secondary",variant:"text",size:"small",icon:"pi pi-check",onClick:je},null,8,["onClick"]),C(r,{label:"Clear All",severity:"danger",variant:"text",size:"small",icon:"pi pi-times",onClick:Te},null,8,["onClick"])])])]),_:1},8,["modelValue","options","class","onKeydown"]),p.value?.subcategories?(n(),i("div",Ba,u(p.value.subcategories[0]),1)):k("",!0),p.value?.name?(n(),i("div",ja,u(p.value.name[0]),1)):k("",!0)])):k("",!0),y.value&&l.parentCategory?(n(),i("div",Ta,[e[45]||(e[45]=t("label",{class:"form-label"},"Parent Category",-1)),t("input",{type:"text",class:"form-control",value:l.parentCategory.label,disabled:""},null,8,Aa)])):k("",!0),t("div",Oa,[e[48]||(e[48]=t("label",{class:"form-label d-block mb-2"},"Active",-1)),t("div",Ua,[t("div",Ra,[t("input",{class:"form-check-input",type:"radio",checked:P.value,onChange:e[15]||(e[15]=a=>P.value=!0),name:"active"},null,40,za),e[46]||(e[46]=t("label",{class:"form-check-label"},"Yes",-1))]),t("div",qa,[t("input",{class:"form-check-input",type:"radio",checked:!P.value,onChange:e[16]||(e[16]=a=>P.value=!1),name:"active"},null,40,Ha),e[47]||(e[47]=t("label",{class:"form-check-label"},"No",-1))])])])]),e[51]||(e[51]=t("hr",{class:"my-4"},null,-1)),t("div",Ka,[t("button",{class:"btn btn-primary btn-sm rounded-pill px-4",disabled:D.value,onClick:e[17]||(e[17]=a=>De())},[D.value?(n(),i(E,{key:0},[e[49]||(e[49]=t("span",{class:"spinner-border spinner-border-sm me-2"},null,-1)),e[50]||(e[50]=V(" Saving... ",-1))],64)):(n(),i(E,{key:1},[V(u((y.value,"Save")),1)],64))],8,Xa),t("button",{class:"btn btn-secondary rounded-pill btn-sm px-4 ms-2","data-bs-dismiss":"modal",onClick:ie}," Cancel ")])])])])]),t("div",Ya,[t("div",Ga,[t("div",Za,[t("div",Ja,[t("h5",{onClick:e[18]||(e[18]=a=>T.value=""),class:"modal-title",id:"editSubCatModalLabel"}," Edit Subcategory "),e[52]||(e[52]=t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})])],-1))]),t("div",Qa,[t("div",Wa,[e[53]||(e[53]=t("label",{for:"subCategoryName",class:"form-label"},"Subcategory Name",-1)),Z(t("input",{type:"text",class:"form-control",id:"subCategoryName","onUpdate:modelValue":e[19]||(e[19]=a=>x.value.name=a),disabled:j.value},null,8,el),[[me,x.value.name]]),t("small",tl,u(T.value),1)]),t("button",{type:"button",class:"px-4 py-2 rounded-pill btn btn-primary text-white text-center d-flex align-items-center justify-content-center gap-2",onClick:Oe,disabled:j.value},[j.value?(n(),i("span",ll)):k("",!0),t("span",null,u(j.value?"Saving...":"Save"),1)],8,al)])])])])])]),_:1})}}},Nl=Xe(sl,[["__scopeId","data-v-be674843"]]);export{Nl as default};
