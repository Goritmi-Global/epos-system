import{_ as Se,r as m,c as f,o as le,n as Pe,w as Ne,g as c,b as u,e as h,u as y,h as je,d as oe,f as e,t as n,l as E,m as H,v as Ee,p as L,F as T,i as P,T as ne,j as D,y as Ae,P as Ke,s as g}from"./app-CYYlfszq.js";import{_ as Me}from"./Master-B6Go9fCb.js";import{u as Ve}from"./useFormatters-RJKnQoSm.js";import{F as Be}from"./FilterModal-C-YUVCAT.js";import{E as Le,a as We,X as qe,u as A,w as ze}from"./xlsx-CrmoAxyJ.js";import{s as Re}from"./index-B7NINf2j.js";import{E as Ue}from"./eye-BWVg-PFm.js";import{P as re}from"./printer-byref887.js";import{C as Xe}from"./clock-CVuymJ1Q.js";import{c as He}from"./createLucideIcon-D217t_iT.js";import{C as Ge}from"./circle-check-big-DXkkqcPI.js";import{C as Je}from"./circle-x-7DjUoTGQ.js";import"./index-C-KxnP12.js";import"./index-DJNrC0mS.js";import"./index-Dz-aUUP8.js";import"./sun-B21gpqoz.js";import"./index-BzmJYhwS.js";import"./index-B3Pqd2wp.js";import"./index-BxpxhNZZ.js";import"./index-BuSNz9fi.js";/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=He("loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]]),Ye={class:"page-wrapper"},Ze={class:"row g-4"},et={class:"col-md-6 col-xl-3"},tt={class:"card border-0 shadow-sm rounded-4"},st={class:"card-body d-flex align-items-center justify-content-between"},at={class:"mb-0 fw-bold"},lt={class:"col-md-6 col-xl-3"},ot={class:"card border-0 shadow-sm rounded-4"},nt={class:"card-body d-flex align-items-center justify-content-between"},rt={class:"mb-0 fw-bold"},it={class:"col-md-6 col-xl-3"},dt={class:"card border-0 shadow-sm rounded-4"},ct={class:"card-body d-flex align-items-center justify-content-between"},ut={class:"mb-0 fw-bold"},mt={class:"col-md-6 col-xl-3"},pt={class:"card border-0 shadow-sm rounded-4"},bt={class:"card-body d-flex align-items-center justify-content-between"},vt={class:"mb-0 fw-bold"},gt={class:"col-md-6 col-xl-3"},ht={class:"card border-0 shadow-sm rounded-4"},_t={class:"card-body d-flex align-items-center justify-content-between"},yt={class:"mb-0 fw-bold"},ft={class:"col-md-6 col-xl-3"},xt={class:"card border-0 shadow-sm rounded-4"},wt={class:"card-body d-flex align-items-center justify-content-between"},kt={class:"mb-0 fw-bold"},Tt={class:"card border-0 shadow-lg rounded-4"},Ct={class:"card-body"},Ot={class:"d-flex flex-wrap gap-2 justify-content-between align-items-center mb-3"},It={class:"d-flex flex-wrap gap-2 align-items-center"},$t={class:"search-wrap"},Dt={key:1,class:"form-control search-input",placeholder:"Search",disabled:"",type:"text"},Ft={class:"col-md-6"},St=["onUpdate:modelValue"],Pt=["value"],Nt={class:"col-md-6 mt-3"},jt=["onUpdate:modelValue"],Et=["value"],At={class:"mb-4"},Kt={class:"d-flex gap-2 flex-wrap"},Mt=["onClick"],Vt={class:"table-responsive"},Bt={class:"table table-hover align-middle mb-0"},Lt={key:0},Wt={class:"fw-semibold"},qt={class:"badge bg-info text-white rounded-pill"},zt={class:"d-flex justify-content-center align-items-center gap-2"},Rt=["onClick"],Ut=["onClick"],Xt={key:0},Ht={colspan:"11",class:"text-center text-muted py-4"},Gt={class:"d-flex flex-column align-items-center justify-content-center py-3"},Jt={class:"small text-secondary mt-1"},Qt={key:0,class:"mt-4 d-flex justify-content-between align-items-center"},Yt={class:"text-muted small"},Zt={class:"modal fade",id:"orderItemsModal",tabindex:"-1","aria-hidden":"true"},es={class:"modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable"},ts={class:"modal-content rounded-4 shadow border-0 dark:bg-[#212121]"},ss={class:"modal-header border-0 dark:bg-[#181818]"},as={class:"d-flex align-items-center gap-3 dark:text-white"},ls={class:"modal-title fw-bold mb-1"},os={class:"opacity-75"},ns={class:"modal-body p-4"},rs={key:0,class:"rounded-3 p-4"},is={class:"row mb-4"},ds={class:"col-md-3"},cs={class:"dark:text-white"},us={class:"col-md-3"},ms={class:"dark:text-white"},ps={class:"col-md-3"},bs={class:"col-md-3"},vs={class:"dark:text-white"},gs={class:"fw-bold mb-3 text-primary dark:text-blue-400"},hs={class:"table-responsive"},_s={class:"table table-hover align-middle rounded-3 overflow-hidden dark:text-gray-200"},ys={class:"px-3"},fs={class:"fw-semibold"},xs={class:"badge bg-secondary"},ws={class:"text-muted dark:text-gray-400"},ks={class:"d-flex justify-content-center align-items-center gap-2"},Ts=["onClick"],Cs=["onClick"],Os=["onClick"],Is=["onClick"],$s={class:"modal-footer border-0 dark:bg-[#212121]"},Ds={class:"modal fade",id:"ingredientsModal",tabindex:"-1","aria-hidden":"true"},Fs={class:"modal-dialog modal-dialog-centered"},Ss={class:"modal-content rounded-4 shadow border-0 dark:bg-[#212121]"},Ps={class:"modal-header border-0 dark:bg-[#181818]"},Ns={class:"d-flex align-items-center gap-3 dark:text-white"},js={class:"opacity-75"},Es={class:"modal-body p-4"},As={key:0},Ks={class:"list-group list-group-flush"},Ms={key:1,class:"text-center text-muted py-4 dark:text-gray-400"},Vs={__name:"Index",setup(Bs){const{dateFmt:K}=Ve(),_=m([]),C=m(!1),b=m(null),G=m(!1),N=m(null),F=m("All"),ie=m([{label:"All",value:"All",icon:"bi-list-ul"},{label:"Waiting",value:"Waiting",icon:"bi-hourglass-split"},{label:"In Progress",value:"In Progress",icon:"bi-gear"},{label:"Done",value:"Done",icon:"bi-check-circle"},{label:"Cancelled",value:"Cancelled",icon:"bi-x-circle"}]),x=m({status_counts:{All:0,Waiting:0,"In Progress":0,Done:0,Cancelled:0},kpis:{total_tables:0,total_items:0,pending_items:0,in_progress_items:0,done_items:0,cancelled_items:0}}),de=l=>{F.value=l,l==="All"?p.value.status="":p.value.status=l,v.value.current_page=1,O(1)},W=m(null),ce=[{label:"PDF",value:"pdf"},{label:"Excel",value:"excel"},{label:"CSV",value:"csv"}],ue=l=>{l.value&&(ke(l.value),W.value=null)},J=f(()=>x.value.status_counts),me=l=>{switch(l){case"Waiting":return"bg-warning text-dark";case"In Progress":return"bg-info text-white";case"Done":return"bg-success";case"Cancelled":return"bg-danger";default:return"bg-secondary"}},v=m({current_page:1,last_page:1,per_page:10,total:0,from:0,to:0,links:[]}),O=async(l=null)=>{C.value=!0;try{const t={q:I.value,page:l||v.value.current_page,per_page:v.value.per_page,sort_by:p.value.sortBy||"",order_type:p.value.orderType||"",status:p.value.status||"",date_from:p.value.dateFrom||"",date_to:p.value.dateTo||""};Object.keys(t).forEach(a=>{(t[a]===void 0||t[a]==="")&&delete t[a]});const s=await axios.get("/api/kots/all-orders",{params:t});console.log("Fetched KOT Orders:",s.data),s.data.statistics&&(x.value=s.data.statistics),_.value=(s.data.data||[]).map(a=>{const o=a.pos_order_type?.order,d=o?.items||[];return{id:o?.id||a.id,kot_id:a.id,created_at:o?.created_at||a.created_at,customer_name:o?.customer_name||"Walk In",total_amount:o?.total_amount||0,sub_total:o?.sub_total||0,status:a.status||"Waiting",type:{order_type:a.pos_order_type?.order_type,table_number:a.pos_order_type?.table_number},payment:o?.payment,items:(a.items||[]).map(i=>{const r=d.find(k=>k.title===i.item_name||k.product_id===i.product_id);return{...i,title:i.item_name,price:r?.price||0,quantity:i.quantity||1,variant_name:i.variant_name||"-",item_kitchen_note:i.item_kitchen_note||"",ingredients:i.ingredients||[]}}),item_count:a.items?.length||0}}),v.value={current_page:s.data.current_page,last_page:s.data.last_page,per_page:s.data.per_page,total:s.data.total,from:s.data.from,to:s.data.to,links:s.data.links}}catch(t){console.error("Error fetching orders:",t),_.value=[],g.error("Failed to load KOT orders")}finally{C.value=!1}},pe=l=>{if(!l)return;const s=new URLSearchParams(l.split("?")[1]).get("page");s&&O(parseInt(s))};le(async()=>{I.value="",Q.value=Date.now(),await Pe(),setTimeout(()=>{Y.value=!0;const t=document.getElementById(q);t&&(t.value="",I.value="")},100),O();const l=document.getElementById("kotFilterModal");l&&l.addEventListener("hidden.bs.modal",()=>{w.value={sortBy:p.value.sortBy||"",orderType:p.value.orderType||"",status:p.value.status||"",dateFrom:p.value.dateFrom||"",dateTo:p.value.dateTo||""}})});const I=m(""),Q=m(Date.now()),q=`search-${Math.random().toString(36).substr(2,9)}`,Y=m(!1),w=m({sortBy:"",orderType:"",status:"",dateFrom:"",dateTo:""}),p=m({sortBy:"",orderType:"",status:"",dateFrom:"",dateTo:""});m("All"),m("All"),m(["All","Eat In","Delivery","Takeaway","Collection"]),m(["All","Waiting","In Progress","Done","Cancelled"]);const be=l=>{w.value={...w.value,...l},p.value={...w.value},v.value.current_page=1,O(1),bootstrap.Modal.getInstance(document.getElementById("kotFilterModal"))?.hide(),console.log("Filters applied:",w.value)},ve=()=>{w.value={sortBy:"",orderType:"",status:"",dateFrom:"",dateTo:""},p.value={sortBy:"",orderType:"",status:"",dateFrom:"",dateTo:""},v.value.current_page=1,v.value.per_page=10,O(1),console.log("Filters cleared")},Z=f(()=>_.value),z=f(()=>({sortOptions:[{value:"order_desc",label:"Total Amount: High to Low"},{value:"order_asc",label:"Total Amount: Low to High"},{value:"date_desc",label:"Date: Newest First"},{value:"date_asc",label:"Date: Oldest First"}],orderTypeOptions:[{value:"Eat In",label:"Eat In"},{value:"Delivery",label:"Delivery"},{value:"Takeaway",label:"Takeaway"},{value:"Collection",label:"Collection"}],statusOptions:[{value:"Waiting",label:"Waiting"},{value:"In Progress",label:"In Progress"},{value:"Done",label:"Done"},{value:"Cancelled",label:"Cancelled"}]})),ge=f(()=>x.value.kpis.total_tables),he=f(()=>x.value.kpis.total_items),_e=f(()=>x.value.kpis.pending_items),ye=f(()=>x.value.kpis.in_progress_items),fe=f(()=>x.value.kpis.done_items),xe=f(()=>x.value.kpis.cancelled_items),R=l=>{switch(l){case"Done":return"bg-success";case"Cancelled":return"bg-danger";case"Waiting":return"bg-warning text-dark";case"In Progress":return"bg-info text-white";default:return"bg-secondary"}},ee=l=>{const t=JSON.parse(JSON.stringify(l)),s=t?.customer_name||"Walk-in Customer",a=t?.type?.order_type||"Eat In",o=t?.type?.table_number,d=t?.payment,i=t?.items||[],r=i.reduce((S,B)=>S+Number(B.price||0)*Number(B.quantity||0),0),k=t?.total_amount||r,j=t?.created_at?new Date(t.created_at):new Date,Ie=j.toISOString().split("T")[0],$e=j.toTimeString().split(" ")[0],X=(d?.payment_method||"cash").toLowerCase();let V="";X==="split"?V=`Payment Type: Split (Cash: £${Number(d?.cash_amount??0).toFixed(2)}, Card: £${Number(d?.card_amount??0).toFixed(2)})`:X==="card"||X==="stripe"?V=`Payment Type: Card${d?.card_brand?` (${d.card_brand}`:""}${d?.last4?` •••• ${d.last4}`:""}${d?.card_brand?")":""}`:V=`Payment Type: ${d?.payment_method||"Cash"}`;const De=`
    <html>
    <head>
      <title>Kitchen Order Ticket</title>
      <style>
        @page { size: 80mm auto; margin: 0; }
        html, body {
          width: 80mm;
          margin: 0;
          padding: 8px;
          font-family: monospace, Arial, sans-serif;
          font-size: 12px;
          line-height: 1.4;
        }
        .header { text-align: center; margin-bottom: 10px; }
        .order-info { margin: 10px 0; }
        .order-info div { margin-bottom: 3px; }
        .payment-info { margin-top: 8px; margin-bottom: 8px; }
        table { width: 100%; border-collapse: collapse; margin: 10px 0; }
        th, td { padding: 4px 0; text-align: left; }
        th { border-bottom: 1px solid #000; }
        td:last-child, th:last-child { text-align: right; }
        .totals { margin-top: 10px; border-top: 1px dashed #000; padding-top: 8px; }
        .footer { text-align: center; margin-top: 10px; font-size: 11px; }
      </style>
    </head>
    <body>
      <div class="header">
        <h2>KITCHEN ORDER TICKET</h2>
      </div>
      
      <div class="order-info">
        <div>KOT ID: #${t.id}</div>
        <div>Date: ${Ie}</div>
        <div>Time: ${$e}</div>
        <div>Customer: ${s}</div>
        <div>Order Type: ${a}</div>
        ${o?`<div>Table: ${o}</div>`:""}
        
        <div class="payment-info">
          <div>${V}</div>
        </div>
        
        <div>Status: ${t.status}</div>
      </div>

      <table>
        <thead>
          <tr>
            <th>Item</th>
            <th>Qty</th>
            <th>Price</th>
          </tr>
        </thead>
        <tbody>
         ${i.map(S=>{const B=Number(S.quantity)||1,Fe=Number(S.price)||0;return`
      <tr>
        <td>${S.title||S.item_name||"Unknown Item"}</td>
        <td>${B}</td>
        <td>£${Fe.toFixed(2)}</td>
      </tr>
    `}).join("")}
        </tbody>
      </table>

      <div class="totals">
        <div>Subtotal: £${Number(r).toFixed(2)}</div>
        <div>Total: £${Number(k).toFixed(2)}</div>
        ${d?.cash_received?`<div>Cash Received: £${Number(d.cash_received).toFixed(2)}</div>`:""}
        ${d?.change?`<div>Change: £${Number(d.change).toFixed(2)}</div>`:""}
      </div>

      <div class="footer">
        Kitchen Copy - Thank you!
      </div>
    </body>
    </html>
  `,$=window.open("","_blank","width=400,height=600");if(!$){alert("Please allow popups for this site to print KOT");return}$.document.open(),$.document.write(De),$.document.close(),$.onload=()=>{$.print(),$.close()}},U=m([]),te=m(!1);le(async()=>{te.value=!0;try{const l=await axios.get("/api/printers");console.log("Printers:",l.data.data),U.value=l.data.data.filter(t=>t.is_connected===!0||t.status==="OK").map(t=>({label:`${t.name}`,value:t.name,driver:t.driver,port:t.port}))}catch(l){console.error("Failed to fetch printers:",l)}finally{te.value=!1}});let se=null;Ne(I,()=>{clearTimeout(se),se=setTimeout(()=>{v.value.current_page=1,O(1)},500)});const we=l=>{b.value=l,G.value=!0;const t=document.getElementById("orderItemsModal");t&&new bootstrap.Modal(t).show()},ae=()=>{G.value=!1,b.value=null;const l=document.getElementById("orderItemsModal");if(l){const t=bootstrap.Modal.getInstance(l);t&&t.hide()}},M=async(l,t,s)=>{try{const a=await axios.put(`/api/kots/pos/kot-item/${t.id}/status`,{status:s}),o=_.value.findIndex(d=>d.kot_id===l.kot_id);if(o!==-1){const d=_.value[o].items.findIndex(i=>i.id===t.id);d!==-1&&(_.value[o].items[d].status=a.data.status,_.value[o].status=a.data.order_status,_.value=[..._.value])}await O(v.value.current_page),g.success(`"${t.item_name}" marked as ${s}`)}catch(a){console.error("Failed to update KOT item status:",a),g.error(a.response?.data?.message||"Failed to update status")}},ke=async l=>{if(!_.value||_.value.length===0){g.error("No kitchen orders data to download");return}try{C.value=!0;const t={q:I.value,sort_by:p.value.sortBy||"",order_type:p.value.orderType||"",status:p.value.status||"",date_from:p.value.dateFrom||"",date_to:p.value.dateTo||"",export:"all"};Object.keys(t).forEach(o=>{(t[o]===void 0||t[o]==="")&&delete t[o]});const a=((await axios.get("/api/kots/all-orders",{params:t})).data.data||[]).map(o=>{const d=o.pos_order_type?.order,i=d?.items||[];return{id:d?.id||o.id,kot_id:o.id,created_at:d?.created_at||o.created_at,customer_name:d?.customer_name||"Walk In",total_amount:d?.total_amount||0,sub_total:d?.sub_total||0,status:o.status||"Waiting",type:{order_type:o.pos_order_type?.order_type,table_number:o.pos_order_type?.table_number},payment:d?.payment,items:(o.items||[]).map(r=>{const k=i.find(j=>j.title===r.item_name||j.product_id===r.product_id);return{...r,title:r.item_name,price:k?.price||0,quantity:r.quantity||1,variant_name:r.variant_name||"-",item_kitchen_note:r.item_kitchen_note||"",ingredients:r.ingredients||[]}}),item_count:o.items?.length||0}});if(a.length===0){g.error("No kitchen orders found to download");return}l==="pdf"?Ce(a):l==="excel"?Oe(a):l==="csv"?Te(a):g.error("Invalid download type")}catch(t){console.error("Download failed:",t),g.error(`Download failed: ${t.message}`)}finally{C.value=!1}},Te=l=>{try{const t=["KOT ID","Order ID","Customer Name","Order Type","Table Number","Items Count","Status","Total Amount","Date"],s=l.map(r=>[`"${r.kot_id||""}"`,`"${r.id||""}"`,`"${r.customer_name||"Walk In"}"`,`"${r.type?.order_type||"-"}"`,`"${r.type?.table_number||"-"}"`,`"${r.item_count||0}"`,`"${r.status||""}"`,`"${Number(r.total_amount||0).toFixed(2)}"`,`"${r.created_at?K(r.created_at):""}"`]),a=[t.join(","),...s.map(r=>r.join(","))].join(`
`),o=new Blob([a],{type:"text/csv;charset=utf-8;"}),d=URL.createObjectURL(o),i=document.createElement("a");i.setAttribute("href",d),i.setAttribute("download",`Kitchen_Orders_${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(i),i.click(),document.body.removeChild(i),g.success("CSV downloaded successfully")}catch(t){console.error("CSV generation error:",t),g.error(`CSV generation failed: ${t.message}`)}},Ce=l=>{try{const t=new Le("l","mm","a4");t.setFontSize(18),t.setFont("helvetica","bold"),t.text("Kitchen Orders Report",14,20),t.setFontSize(10),t.setFont("helvetica","normal");const s=new Date().toLocaleString();t.text(`Generated on: ${s}`,14,28),t.text(`Total Orders: ${l.length}`,14,34);const a=["KOT ID","Order ID","Customer","Type","Table","Items","Status","Amount","Date"],o=l.map(i=>[i.kot_id||"",i.id||"",i.customer_name||"Walk In",i.type?.order_type||"-",i.type?.table_number||"-",i.item_count||0,i.status||"",`£${Number(i.total_amount||0).toFixed(2)}`,i.created_at?K(i.created_at):""]);We(t,{head:[a],body:o,startY:40,styles:{fontSize:8,cellPadding:2,halign:"left",lineColor:[0,0,0],lineWidth:.1},headStyles:{fillColor:[41,128,185],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]},margin:{left:14,right:14},didDrawPage:i=>{const r=t.internal.getNumberOfPages(),k=t.internal.pageSize.height;t.setFontSize(8),t.text(`Page ${i.pageNumber} of ${r}`,i.settings.margin.left,k-10)}});const d=`Kitchen_Orders_${new Date().toISOString().split("T")[0]}.pdf`;t.save(d),g.success("PDF downloaded successfully")}catch(t){console.error("PDF generation error:",t),g.error(`PDF generation failed: ${t.message}`)}},Oe=l=>{try{if(typeof qe>"u")throw new Error("XLSX library is not loaded");const t=l.map(r=>({"KOT ID":r.kot_id||"","Order ID":r.id||"","Customer Name":r.customer_name||"Walk In","Order Type":r.type?.order_type||"-","Table Number":r.type?.table_number||"-","Items Count":r.item_count||0,Status:r.status||"","Total Amount":Number(r.total_amount||0).toFixed(2),Date:r.created_at||""})),s=A.book_new(),a=A.json_to_sheet(t);a["!cols"]=[{wch:10},{wch:10},{wch:20},{wch:12},{wch:12},{wch:12},{wch:12},{wch:12},{wch:18}],A.book_append_sheet(s,a,"Kitchen Orders");const o=[{Info:"Generated On",Value:new Date().toLocaleString()},{Info:"Total Orders",Value:l.length},{Info:"Exported By",Value:"Kitchen Management System"}],d=A.json_to_sheet(o);A.book_append_sheet(s,d,"Report Info");const i=`Kitchen_Orders_${new Date().toISOString().split("T")[0]}.xlsx`;ze(s,i),g.success("Excel file downloaded successfully")}catch(t){console.error("Excel generation error:",t),g.error(`Excel generation failed: ${t.message}`)}};return(l,t)=>(u(),c(T,null,[h(y(je),{title:"Kitchen Orders"}),h(Me,null,{default:oe(()=>[e("div",Ye,[t[28]||(t[28]=e("h4",{class:"fw-semibold mb-3"},"Kitchen Order Tickets",-1)),e("div",Ze,[e("div",et,[e("div",tt,[e("div",st,[e("div",null,[e("h3",at,n(ge.value),1),t[5]||(t[5]=e("p",{class:"text-muted mb-0 small"},"Total Tables",-1))]),t[6]||(t[6]=e("div",{class:"rounded-circle p-3 bg-primary-subtle text-primary d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-table fs-4"})],-1))])])]),e("div",lt,[e("div",ot,[e("div",nt,[e("div",null,[e("h3",rt,n(he.value),1),t[7]||(t[7]=e("p",{class:"text-muted mb-0 small"},"Total Items",-1))]),t[8]||(t[8]=e("div",{class:"rounded-circle p-3 bg-success-subtle text-success d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-basket fs-4"})],-1))])])]),e("div",it,[e("div",dt,[e("div",ct,[e("div",null,[e("h3",ut,n(_e.value),1),t[9]||(t[9]=e("p",{class:"text-muted mb-0 small"},"Pending Items",-1))]),t[10]||(t[10]=e("div",{class:"rounded-circle p-3 bg-warning-subtle text-warning d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-hourglass-split fs-4"})],-1))])])]),e("div",mt,[e("div",pt,[e("div",bt,[e("div",null,[e("h3",vt,n(ye.value),1),t[11]||(t[11]=e("p",{class:"text-muted mb-0 small"},"In Progress",-1))]),t[12]||(t[12]=e("div",{class:"rounded-circle p-3 bg-info-subtle text-info d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-gear fs-4"})],-1))])])]),e("div",gt,[e("div",ht,[e("div",_t,[e("div",null,[e("h3",yt,n(fe.value),1),t[13]||(t[13]=e("p",{class:"text-muted mb-0 small"},"Completed Items",-1))]),t[14]||(t[14]=e("div",{class:"rounded-circle p-3 bg-success-subtle text-success d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-check-circle fs-4"})],-1))])])]),e("div",ft,[e("div",xt,[e("div",wt,[e("div",null,[e("h3",kt,n(xe.value),1),t[15]||(t[15]=e("p",{class:"text-muted mb-0 small"},"Cancelled Items",-1))]),t[16]||(t[16]=e("div",{class:"rounded-circle p-3 bg-danger-subtle text-danger d-flex align-items-center justify-content-center",style:{width:"56px",height:"56px"}},[e("i",{class:"bi bi-x-circle fs-4"})],-1))])])])]),e("div",Tt,[e("div",Ct,[e("div",Ot,[t[23]||(t[23]=e("h5",{class:"mb-0 fw-semibold"},"Kitchen Orders",-1)),e("div",It,[e("div",$t,[t[17]||(t[17]=e("i",{class:"bi bi-search"},null,-1)),t[18]||(t[18]=e("input",{type:"email",name:"email",autocomplete:"email",style:{position:"absolute",left:"-9999px",width:"1px",height:"1px"},tabindex:"-1","aria-hidden":"true"},null,-1)),Y.value?H((u(),c("input",{id:q,"onUpdate:modelValue":t[0]||(t[0]=s=>I.value=s),key:Q.value,class:"form-control search-input",placeholder:"Search",type:"search",autocomplete:"new-password",name:q,role:"presentation",onFocus:t[1]||(t[1]=(...s)=>l.handleFocus&&l.handleFocus(...s))},null,32)),[[Ee,I.value]]):(u(),c("input",Dt))]),h(Be,{modelValue:w.value,"onUpdate:modelValue":t[2]||(t[2]=s=>w.value=s),title:"Kitchen Orders","modal-id":"kotFilterModal","modal-size":"modal-lg","sort-options":z.value.sortOptions,"show-date-range":!0,onApply:be,showDateRange:!1,"show-stock-status":!1,onClear:ve},{customFilters:oe(({filters:s})=>[e("div",Ft,[t[20]||(t[20]=e("label",{class:"form-label fw-semibold text-dark"},[e("i",{class:"fas fa-concierge-bell me-2 text-muted"}),L("Order Type ")],-1)),H(e("select",{"onUpdate:modelValue":a=>s.orderType=a,class:"form-select"},[t[19]||(t[19]=e("option",{value:""},"All",-1)),(u(!0),c(T,null,P(z.value.orderTypeOptions,a=>(u(),c("option",{key:a.value,value:a.value},n(a.label),9,Pt))),128))],8,St),[[ne,s.orderType]])]),e("div",Nt,[t[22]||(t[22]=e("label",{class:"form-label fw-semibold text-dark"},[e("i",{class:"fas fa-tasks me-2 text-muted"}),L("Order Status ")],-1)),H(e("select",{"onUpdate:modelValue":a=>s.status=a,class:"form-select"},[t[21]||(t[21]=e("option",{value:""},"All",-1)),(u(!0),c(T,null,P(z.value.statusOptions,a=>(u(),c("option",{key:a.value,value:a.value},n(a.label),9,Et))),128))],8,jt),[[ne,s.status]])])]),_:1},8,["modelValue","sort-options"]),h(y(Re),{modelValue:W.value,"onUpdate:modelValue":t[3]||(t[3]=s=>W.value=s),options:ce,optionLabel:"label",optionValue:"value",placeholder:"Export",class:"export-dropdown",onChange:ue},null,8,["modelValue"])])]),e("div",At,[e("div",Kt,[(u(!0),c(T,null,P(ie.value,s=>(u(),c("button",{key:s.value,onClick:a=>de(s.value),class:D(["btn btn-sm rounded-pill px-4 py-2 d-flex align-items-center gap-2",F.value===s.value?"btn-primary text-white shadow-sm":"btn-outline-secondary"]),style:{"min-width":"120px",transition:"all 0.2s ease"}},[e("i",{class:D(s.icon)},null,2),e("span",null,n(s.label),1),s.value!=="All"?(u(),c("span",{key:0,class:D(["badge rounded-pill ms-1",F.value===s.value?"bg-white text-primary":me(s.value)]),style:{"min-width":"24px"}},n(J.value[s.value]||0),3)):(u(),c("span",{key:1,class:D(["badge rounded-pill ms-1",F.value===s.value?"bg-white text-primary":"bg-secondary"]),style:{"min-width":"24px"}},n(J.value.All),3))],10,Mt))),128))])]),e("div",Vt,[e("table",Bt,[t[27]||(t[27]=e("thead",{class:"border-top small text-muted"},[e("tr",null,[e("th",null,"#"),e("th",null,"KOT ID"),e("th",null,"Order ID"),e("th",null,"Customer"),e("th",null,"Order Type"),e("th",null,"Table"),e("th",null,"Items Count"),e("th",null,"Status"),e("th",null,"Date"),e("th",null,"Total Amount"),e("th",{class:"text-center"},"Actions")])],-1)),e("tbody",null,[C.value?(u(),c("tr",Lt,[...t[24]||(t[24]=[e("td",{colspan:"11",class:"text-center py-5"},[e("div",{class:"d-flex flex-column align-items-center justify-content-center"},[e("div",{class:"spinner-border mb-3",role:"status",style:{color:"#1B1670",width:"3rem",height:"3rem","border-width":"0.3em"}},[e("span",{class:"visually-hidden"},"Loading...")]),e("div",{class:"fw-semibold text-muted"},"Loading KOT orders...")])],-1)])])):(u(),c(T,{key:1},[(u(!0),c(T,null,P(Z.value,(s,a)=>(u(),c("tr",{key:s.kot_id},[e("td",null,n((v.value.current_page-1)*v.value.per_page+a+1),1),e("td",Wt,n(s.kot_id),1),e("td",null,n(s.id),1),e("td",null,n(s.customer_name),1),e("td",null,n(s.type?.order_type||"-"),1),e("td",null,n(s.type?.table_number||"-"),1),e("td",null,[e("span",qt,n(s.item_count)+" items ",1)]),e("td",null,[e("span",{class:D(["badge","rounded-pill",R(s.status)]),style:{"min-width":"90px",display:"inline-flex","justify-content":"center","align-items":"center",height:"25px"}},n(s.status),3)]),e("td",null,n(y(K)(s.created_at)),1),e("td",null,n(s?.payment?.amount_received),1),e("td",null,[e("div",zt,[e("button",{onClick:o=>we(s),title:"View Items",class:"p-2 rounded-full text-primary hover:bg-gray-100"},[h(y(Ue),{class:"w-5 h-5"})],8,Rt),U.value.length>0?(u(),c("button",{key:0,class:"p-2 rounded-full text-gray-600 hover:bg-gray-100",onClick:Ae(o=>ee(s),["prevent"]),title:"Print"},[h(y(re),{class:"w-5 h-5"})],8,Ut)):E("",!0)])])]))),128)),!C.value&&Z.value.length===0?(u(),c("tr",Xt,[e("td",Ht,[e("div",Gt,[t[25]||(t[25]=e("i",{class:"bi bi-inbox",style:{"font-size":"2rem",opacity:"0.5","margin-bottom":"0.5rem"}},null,-1)),t[26]||(t[26]=e("div",{class:"fw-semibold"},"No KOT orders found",-1)),e("div",Jt,n(F.value==="All"?"Try adjusting your filters or date range":`No orders with status "${F.value}"`),1)])])])):E("",!0)],64))])])]),!C.value&&v.value.last_page>1?(u(),c("div",Qt,[e("div",Yt," Showing "+n(v.value.from)+" to "+n(v.value.to)+" of "+n(v.value.total)+" items ",1),h(Ke,{pagination:v.value.links,isApiDriven:!0,onPageChanged:pe},null,8,["pagination"])])):E("",!0)])])]),e("div",Zt,[e("div",es,[e("div",ts,[e("div",ss,[e("div",as,[t[29]||(t[29]=e("div",{class:"rounded-circle p-3 bg-white bg-opacity-25 dark:bg-white dark:bg-opacity-10"},[e("i",{class:"bi bi-list-task fs-4"})],-1)),e("div",null,[e("h5",ls," Order Items - KOT #"+n(b.value?.kot_id),1),e("small",os," Order #"+n(b.value?.id)+" | "+n(b.value?.customer_name),1)])]),e("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition transform hover:scale-110",onClick:ae,"data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[...t[30]||(t[30]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",ns,[b.value?(u(),c("div",rs,[e("div",is,[e("div",ds,[t[31]||(t[31]=e("small",{class:"text-muted d-block dark:text-gray-400"},"Order Type",-1)),e("strong",cs,n(b.value.type?.order_type||"-"),1)]),e("div",us,[t[32]||(t[32]=e("small",{class:"text-muted d-block dark:text-gray-400"},"Table Number",-1)),e("strong",ms,n(b.value.type?.table_number||"-"),1)]),e("div",ps,[t[33]||(t[33]=e("small",{class:"text-muted d-block dark:text-gray-400"},"Order Status",-1)),e("span",{class:D(["badge","rounded-pill",R(b.value.status)])},n(b.value.status),3)]),e("div",bs,[t[34]||(t[34]=e("small",{class:"text-muted d-block dark:text-gray-400"},"Date",-1)),e("strong",vs,n(y(K)(b.value.created_at)),1)])]),t[37]||(t[37]=e("hr",{class:"my-3 dark:border-gray-600"},null,-1)),e("h6",gs,[t[35]||(t[35]=e("i",{class:"bi bi-basket me-2"},null,-1)),L("Order Items ("+n(b.value.item_count)+") ",1)]),e("div",hs,[e("table",_s,[t[36]||(t[36]=e("thead",null,[e("tr",null,[e("th",{class:"px-3"},"#"),e("th",null,"Item Name"),e("th",null,"Variant"),e("th",null,"Quantity"),e("th",null,"Kitchen Note"),e("th",null,"Status"),e("th",{class:"text-center"},"Actions")])],-1)),e("tbody",null,[(u(!0),c(T,null,P(b.value.items,(s,a)=>(u(),c("tr",{key:s.id,class:"dark:border-gray-700"},[e("td",ys,n(a+1),1),e("td",fs,n(s.item_name),1),e("td",null,n(s.variant_name),1),e("td",null,[e("span",xs,n(s.quantity),1)]),e("td",null,[e("small",ws,n(s.item_kitchen_note.substring(s.item_kitchen_note.indexOf("No"))),1)]),e("td",null,[e("span",{class:D(["badge","rounded-pill",R(s.status)]),style:{"min-width":"80px"}},n(s.status),3)]),e("td",null,[e("div",ks,[e("button",{onClick:o=>M(b.value,s,"Waiting"),title:"Waiting",class:"btn btn-sm p-1 text-warning dark:text-yellow-400 dark:hover:bg-gray-700"},[h(y(Xe),{class:"w-4 h-4"})],8,Ts),e("button",{onClick:o=>M(b.value,s,"In Progress"),title:"In Progress",class:"btn btn-sm p-1 text-info dark:text-blue-400 dark:hover:bg-gray-700"},[h(y(Qe),{class:"w-4 h-4"})],8,Cs),e("button",{onClick:o=>M(b.value,s,"Done"),title:"Done",class:"btn btn-sm p-1 text-success dark:text-green-400 dark:hover:bg-gray-700"},[h(y(Ge),{class:"w-4 h-4"})],8,Os),e("button",{onClick:o=>M(b.value,s,"Cancelled"),title:"Cancelled",class:"btn btn-sm p-1 text-danger dark:text-red-400 dark:hover:bg-gray-700"},[h(y(Je),{class:"w-4 h-4"})],8,Is)])])]))),128))])])])])):E("",!0)]),e("div",$s,[e("button",{type:"button",class:"btn btn-secondary rounded-pill px-4 py-2",onClick:ae}," Close "),U.value.length>0?(u(),c("button",{key:0,class:"btn btn-primary rounded-pill px-4",onClick:t[4]||(t[4]=s=>ee(b.value))},[h(y(re),{class:"w-4 h-4 me-2",style:{display:"inline-block"}}),t[38]||(t[38]=L(" Print Order ",-1))])):E("",!0)])])])]),e("div",Ds,[e("div",Fs,[e("div",Ss,[e("div",Ps,[e("div",Ns,[t[40]||(t[40]=e("div",{class:"rounded-circle p-2 bg-white bg-opacity-25 dark:bg-white dark:bg-opacity-10"},[e("i",{class:"bi bi-egg-fried fs-5"})],-1)),e("div",null,[t[39]||(t[39]=e("h5",{class:"modal-title fw-bold mb-0"},"Ingredients",-1)),e("small",js,n(N.value?.item_name),1)])]),t[41]||(t[41]=e("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})])],-1))]),e("div",Es,[N.value&&N.value.ingredients&&N.value.ingredients.length>0?(u(),c("div",As,[e("ul",Ks,[(u(!0),c(T,null,P(N.value.ingredients,(s,a)=>(u(),c("li",{key:a,class:"list-group-item d-flex align-items-center gap-2 dark:bg-transparent dark:text-gray-200 dark:border-gray-700"},[t[42]||(t[42]=e("i",{class:"bi bi-check-circle-fill text-success"},null,-1)),e("span",null,n(s),1)]))),128))])])):(u(),c("div",Ms,[...t[43]||(t[43]=[e("i",{class:"bi bi-info-circle fs-3 mb-2"},null,-1),e("p",{class:"mb-0"},"No ingredients available",-1)])]))]),t[44]||(t[44]=e("div",{class:"modal-footer border-0 dark:bg-[#212121]"},[e("button",{type:"button",class:"btn btn-secondary rounded-pill px-4 py-2","data-bs-dismiss":"modal"}," Close ")],-1))])])])]),_:1})],64))}},da=Se(Vs,[["__scopeId","data-v-168cde2e"]]);export{da as default};
