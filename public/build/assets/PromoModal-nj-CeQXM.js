import{u as x}from"./useFormatters-BBfJnlDF.js";import{_ as C,r as F,g as a,i as b,o as n,b as t,F as D,v as P,n as $,t as l,d as B}from"./app-CYEkE9GK.js";const M={key:0,class:"modal fade show",tabindex:"-1","aria-hidden":"true",style:{display:"block"}},N={class:"modal-dialog modal-lg modal-dialog-centered"},L={class:"modal-content rounded-4 border-0 shadow"},S={class:"modal-header border-0"},j={class:"modal-body"},A={key:0,class:"text-center py-5"},I={key:1},V={key:0,class:"alert alert-light text-center dark:bg-gray-800 dark:text-white border-0"},q={key:1,class:"promo-grid"},z=["onClick"],E={class:"promo-header d-flex align-items-center justify-content-between"},U={class:"fw-bold fs-6"},G={class:"badge bg-primary text-white small"},H={class:"promo-desc"},J={class:"promo-info small"},K={class:"promo-info small"},O={class:"promo-discount d-flex justify-content-between align-items-center mt-2"},Q={class:"fw-bold fs-5 text-danger"},R={class:"modal-footer border-0 justify-content-between"},T={key:0,class:"d-flex gap-2"},W={__name:"PromoModal",props:{show:Boolean,promos:{type:Array,default:()=>[]},orderItems:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["close","apply-promo","clear-promo"],setup(i,{emit:f}){const{formatCurrencySymbol:y}=x(),v=i,m=f,r=F(null),_=s=>{r.value=r.value?.id===s.id?null:s},g=()=>{r.value&&m("apply-promo",r.value)},h=()=>{r.value=null,m("clear-promo")},p=s=>s?new Date(s).toLocaleDateString():"-",d=s=>{const e=parseFloat(s);return isNaN(e)?"0.00":e.toFixed(2)},k=()=>v.orderItems.reduce((s,e)=>{const o=parseFloat(e.unit_price??e.price??0)||0,c=parseFloat(e.qty??0)||0;return s+o*c},0),w=s=>{const e=parseFloat(s.discount_amount??0)||0,o=k();if(s.min_purchase&&o<parseFloat(s.min_purchase))return d(0);if(s.type==="flat")return d(e);if(s.type==="percent"){const c=o*e/100,u=parseFloat(s.max_discount??0)||0;return u>0&&c>u?d(u):d(c)}return d(0)};return(s,e)=>i.show?(n(),a("div",M,[t("div",N,[t("div",L,[t("div",S,[e[3]||(e[3]=t("h5",{class:"modal-title fw-bold"},"Select a Promo",-1)),t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-100 transition transform hover:scale-110",onClick:e[0]||(e[0]=o=>s.$emit("close")),"data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[...e[2]||(e[2]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",j,[i.loading?(n(),a("div",A,[...e[4]||(e[4]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"mt-3 text-muted"},"Loading promotions...",-1)])])):(n(),a("div",I,[i.promos.length===0?(n(),a("div",V," No promotions available today ")):(n(),a("div",q,[(n(!0),a(D,null,P(i.promos,o=>(n(),a("div",{key:o.id,class:$(["promo-card",{selected:r.value?.id===o.id}]),onClick:c=>_(o)},[t("div",E,[t("span",U,l(o.name),1),t("span",G,l(o.type.toUpperCase()),1)]),t("p",H,l(o.description),1),t("div",J," Valid: "+l(p(o.start_date))+" → "+l(p(o.end_date)),1),t("div",K," Min: $"+l(d(o.min_purchase))+" | Max: $"+l(o.max_discount?d(o.max_discount):"—"),1),t("div",O,[e[5]||(e[5]=t("span",{class:"fw-semibold"},"Discount Amount:",-1)),t("span",Q,l(B(y)(w(o))),1)])],10,z))),128))]))]))]),t("div",R,[t("button",{class:"btn btn-secondary rounded-pill py-2 px-4",onClick:e[1]||(e[1]=o=>s.$emit("close"))},"Close"),r.value?(n(),a("div",T,[t("button",{class:"btn btn-success rounded-pill px-4",onClick:g},"Add"),t("button",{class:"btn btn-outline-danger rounded-pill",onClick:h},"Clear")])):b("",!0)])])]),e[6]||(e[6]=t("div",{class:"modal-backdrop fade show"},null,-1))])):b("",!0)}},Z=C(W,[["__scopeId","data-v-cb0d60b5"]]);export{Z as default};
