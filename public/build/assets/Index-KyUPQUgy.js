import{_ as Ve,a as re,b as d,d as Me,g as u,l as b,f as t,t as s,V as at,c as F,r as g,o as ot,n as Se,w as Ce,q as A,I as st,E as nt,e as x,u as k,h as it,F as T,i as X,j as _,k as rt,m as S,v as C,p as ie,W as dt,P as ut,X as ct,s as y}from"./app-DR8KNMKR.js";import{_ as pt}from"./Master-CDAihGCm.js";import{s as G}from"./index-D-wNi1xB.js";import{s as Ie}from"./index-BDj6XRXA.js";import{E as mt,a as vt,X as gt,u as W,w as yt}from"./xlsx-pGpJNtJ_.js";import{F as ft}from"./FilterModal-DzeDwtIr.js";import{s as bt}from"./index-CTSRqQAW.js";import{u as _t}from"./useModal-vDbn_8lj.js";import{u as ht}from"./useFormatters-DMXCh6bx.js";import{I as kt}from"./importFile-8ea_C5sF.js";import{P as xt}from"./package-CbdB5xw4.js";import{C as wt}from"./circle-x-CO4bKBgL.js";import{T as St}from"./triangle-alert-BU3NTLW-.js";import{c as de}from"./createLucideIcon-B2WAtkKL.js";import{P as Ct}from"./plus-DLEC6S_L.js";import{E as It}from"./eye-BCYcq801.js";import{P as Vt}from"./pencil-CB6eqCn5.js";import"./index-CLKGagE0.js";import"./PasswordVerificationModal-CwsPs3Zr.js";import"./index-YIqX59W4.js";import"./index-D1-aYu0b.js";import"./sun-g0Zz1s9o.js";import"./index-Dwzhpvva.js";import"./index-BOMKKwwB.js";import"./index-nqZoyhBR.js";import"./index-Bf3R-V2H.js";/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mt=de("calendar-clock",[["path",{d:"M16 14v2.2l1.6 1",key:"fo4ql5"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]]);/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const At=de("calendar-x-2",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 13V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"3spt84"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m17 22 5-5",key:"1k6ppv"}],["path",{d:"m17 17 5 5",key:"p7ous7"}]]);/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=de("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),Ut={key:0,class:"fixed inset-0 z-50 flex items-center justify-center custom-overlay"},$t={class:"bg-white rounded-xl shadow-xl w-full max-w-md p-6 animate-drop-in relative"},qt={class:"text-center text-lg font-medium text-gray-800 mb-2"},Et={class:"text-center text-sm text-gray-500 mb-6"},Dt={__name:"StockOutConfirmationModal",props:{show:Boolean,title:String,message:String},emits:["confirm","close"],setup(Q,{emit:le}){const P=le,j=()=>P("confirm"),I=()=>P("close");return(ue,E)=>(d(),re(at,null,{default:Me(()=>[Q.show?(d(),u("div",Ut,[t("div",$t,[t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110",onClick:I},[...E[0]||(E[0]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-danger",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])]),E[1]||(E[1]=t("div",{class:"flex justify-center mb-4"},[t("div",{class:"bg-gray-100 p-3 rounded-full"},[t("svg",{class:"w-8 h-8 text-danger",fill:"none",stroke:"currentColor","stroke-width":"2",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v2m0 4h.01M12 19a7 7 0 100-14 7 7 0 000 14z"})])])],-1)),t("h3",qt,s(Q.title),1),t("p",Et,s(Q.message),1),t("div",{class:"flex justify-center gap-3"},[t("button",{onClick:j,class:"btn btn-primary d-flex align-items-center gap-1 px-3 py-2 rounded-pill text-white"}," Yes, I'm sure "),t("button",{onClick:I,class:"btn btn-secondary d-flex align-items-center gap-1 px-3 py-2 rounded-pill text-white"}," Cancel ")])])])):b("",!0)]),_:1}))}},Pt=Ve(Dt,[["__scopeId","data-v-38680d1d"]]),Nt={class:"page-wrapper"},Tt={class:"row g-4"},jt={class:"card border-0 shadow-sm rounded-4"},Ot={class:"card-body d-flex align-items-center justify-content-between"},Lt={class:"fw-bold fs-4"},Bt={class:"text-muted fs-6"},Rt={class:"card border-0 shadow-lg rounded-4"},Qt={class:"card-body"},Ht={class:"d-flex flex-wrap gap-2 justify-content-between align-items-center mb-3"},Kt={class:"d-flex flex-wrap gap-2 align-items-center"},zt={class:"search-wrap"},Zt={key:1,class:"form-control search-input",placeholder:"Search",disabled:"",type:"text"},Xt={class:"table-responsive"},Gt={class:"table table-striped"},Wt={key:0},Yt={key:1},Jt={class:"fw-semibold"},el={class:"text-truncate",style:{"max-width":"260px"}},tl={class:"text-center"},ll={key:0,class:"badge bg-red-600 rounded-pill d-inline-block text-center",style:{"min-width":"100px"}},al={key:1,class:"badge bg-warning rounded-pill d-inline-block text-center",style:{"min-width":"100px"}},ol={key:2,class:"badge bg-success rounded-pill d-inline-block text-center",style:{"min-width":"100px"}},sl={class:"text-center"},nl={class:"d-inline-flex align-items-center gap-3"},il=["onClick"],rl=["onClick"],dl=["onClick"],ul={key:0},cl={key:0,class:"mt-4 d-flex justify-content-between align-items-center"},pl={class:"text-muted small"},ml={class:"modal fade",id:"addItemModal",tabindex:"-1","aria-hidden":"true"},vl={class:"modal-dialog modal-lg modal-dialog-centered",role:"document"},gl={class:"modal-content rounded-4"},yl={class:"modal-header"},fl={class:"modal-title fw-semibold"},bl={class:"modal-body"},_l={class:"row g-3"},hl={class:"col-md-6"},kl={key:0,class:"text-danger"},xl={class:"col-md-6"},wl={key:0,class:"text-danger"},Sl={key:0,class:"col-md-6"},Cl={key:0,class:"text-danger"},Il={class:"col-md-6"},Vl={key:0,class:"text-danger"},Ml={class:"col-md-6"},Al={key:0,class:"text-danger"},Fl={class:"col-md-6"},Ul={key:0,class:"text-danger"},$l={class:"col-md-6"},ql={key:0,class:"text-danger"},El={class:"col-12"},Dl={key:0,class:"text-danger"},Pl={class:"row g-3"},Nl={class:"col-md-3"},Tl={key:0,class:"text-danger"},jl={class:"col-md-3"},Ol={key:0,class:"text-danger"},Ll={class:"col-md-3"},Bl={key:0,class:"text-danger"},Rl={class:"col-md-3"},Ql={key:0,class:"text-danger"},Hl={class:"row g-4 mt-1"},Kl={class:"col-md-6"},zl={key:0,class:"text-danger"},Zl={class:"col-md-6"},Xl={key:0,class:"text-danger"},Gl={class:"col-md-4"},Wl=["src"],Yl={key:1,class:"placeholder"},Jl={key:0,class:"text-danger"},ea={class:"mt-4"},ta=["disabled"],la={class:"modal fade",id:"viewItemModal",tabindex:"-1","aria-hidden":"true"},aa={class:"modal-dialog modal-lg modal-dialog-centered"},oa={class:"modal-content border-0 shadow-lg rounded-4 overflow-hidden"},sa={class:"modal-header bg-light"},na={class:"d-flex align-items-center gap-2"},ia={key:0,class:"text-muted"},ra={class:"modal-body"},da={key:0,class:"row g-4"},ua={class:"col-12 col-md-7"},ca={class:"card border-0 shadow-sm rounded-4"},pa={class:"card-body"},ma={class:"fw-semibold mb-3"},va={class:"text-muted small mb-2"},ga={class:"row g-3 small"},ya={class:"col-6"},fa={class:"fw-semibold text-muted"},ba={class:"col-6"},_a={class:"fw-semibold text-muted"},ha={class:"col-6"},ka={class:"fw-semibold text-muted"},xa={class:"col-12"},wa={class:"fw-semibold text-muted"},Sa={class:"col-12"},Ca={class:"fw-semibold text-muted"},Ia={class:"d-flex flex-wrap gap-2 mt-2"},Va={class:"badge rounded-pill bg-primary text-white"},Ma={class:"badge rounded-pill bg-success text-white"},Aa={class:"badge rounded-pill bg-warning text-white"},Fa={class:"badge rounded-pill bg-secondary text-white"},Ua={class:"d-flex flex-wrap gap-2 mt-2"},$a={class:"d-flex flex-wrap gap-2 mt-2"},qa={class:"col-12 col-md-5"},Ea={class:"card border-0 shadow-sm rounded-4 h-100"},Da={class:"card-body d-flex flex-column align-items-center justify-content-center"},Pa={key:0,class:"w-100"},Na=["src"],Ta={class:"card-footer bg-transparent small d-flex justify-content-between"},ja={class:"badge bg-gray-500 rounded-pill text-white p-2"},Oa={class:"card-footer bg-transparent small d-flex justify-content-between"},La={class:"fw-semibold"},Ba={class:"card-footer bg-transparent small d-flex justify-content-between"},Ra={class:"fw-semibold"},Qa={class:"card border-0 shadow-lg rounded-4 overflow-hidden"},Ha={class:"table-responsive"},Ka={class:"table table-striped mb-0"},za={class:"fw-semibold"},Za={class:"fw-semibold"},Xa={class:"text-muted"},Ga={class:"text-muted"},Wa={class:"text-muted"},Ya={class:"text-center"},Ja={key:0},eo={class:"fw-semibold text-muted w-50"},to={class:"modal fade",id:"stockInModal",tabindex:"-1","aria-hidden":"true"},lo={class:"modal-dialog modal-lg modal-dialog-centered"},ao={class:"modal-content rounded-4"},oo={class:"modal-header"},so={class:"modal-title"},no={class:"modal-body"},io={class:"row g-3"},ro={class:"col-md-6"},uo={key:0,class:"text-danger"},co={class:"col-md-6"},po=["value"],mo={key:0,class:"text-danger"},vo={class:"col-md-6"},go={key:0,class:"text-danger"},yo={class:"col-md-6"},fo={class:"col-md-4"},bo={key:0,class:"text-danger"},_o={class:"col-md-4"},ho={key:0,class:"text-danger"},ko={class:"col-md-4"},xo={class:"col-md-12"},wo={key:0,class:"text-danger"},So={class:"col-md-12"},Co={class:"mt-4"},Io=["disabled"],Vo={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},Mo={class:"modal fade",id:"stockOutModal",tabindex:"-1","aria-hidden":"true"},Ao={class:"modal-dialog modal-lg modal-dialog-centered"},Fo={class:"modal-content rounded-4"},Uo={class:"modal-header"},$o={class:"modal-title"},qo={class:"modal-body"},Eo={class:"row g-3"},Do={class:"col-md-6"},Po={class:"col-md-6"},No=["value"],To={key:0,class:"text-danger"},jo={class:"col-md-6"},Oo={class:"col-md-6"},Lo={key:0,class:"text-danger"},Bo={class:"col-md-12"},Ro={class:"mt-4 text-end"},Qo=["disabled"],Ho={__name:"Index",props:{inventories:Array,allergies:Array,tags:Array,units:Array,suppliers:Array,categories:Array},setup(Q){const{closeModal:le}=_t(),{formatCurrencySymbol:P,dateFmt:j}=ht(),I=Q,ue=F(()=>I.categories.filter(l=>!l.parent_id)),E=F(()=>I.categories.filter(l=>l.parent_id===n.value.category_id)),U=g(!1),V=g({current_page:1,last_page:1,per_page:10,total:0,from:0,to:0,links:[]}),O=g(I.inventories?.data||[]),ae=g(null),Ae=[{label:"PDF",value:"pdf"},{label:"Excel",value:"excel"},{label:"CSV",value:"csv"}],Fe=l=>{l.value&&(Ke(l.value),ae.value=null)},Y=F(()=>O.value),$=async(l=null)=>{U.value=!0;try{const e={page:l||1,per_page:V.value.per_page||10};q.value?.trim()&&(e.q=q.value.trim()),f.value.category&&(e.category=f.value.category),f.value.supplier&&(e.supplier=f.value.supplier),f.value.stockStatus&&(e.stockStatus=f.value.stockStatus),f.value.priceMin&&(e.priceMin=f.value.priceMin),f.value.priceMax&&(e.priceMax=f.value.priceMax),f.value.sortBy&&(e.sortBy=f.value.sortBy);const i=await A.get("inventory/api-inventories",{params:e});O.value=i.data.data||[],V.value={current_page:i.data.current_page||1,last_page:i.data.last_page||1,per_page:i.data.per_page||10,total:i.data.total||0,from:i.data.from||0,to:i.data.to||0,links:i.data.links||[]},U.value=!1}catch(e){console.error("❌ Fetch inventories error:",e),y.error("Failed to load inventories"),U.value=!1}},Ue=async()=>{try{U.value=!0;const l=q.value?.trim()||f.value.category||f.value.supplier||f.value.stockStatus||f.value.priceMin||f.value.priceMax||f.value.sortBy,e={per_page:1e4,page:1};return l&&(q.value?.trim()&&(e.q=q.value.trim()),f.value.category&&(e.category=f.value.category),f.value.supplier&&(e.supplier=f.value.supplier),f.value.stockStatus&&(e.stockStatus=f.value.stockStatus),f.value.priceMin&&(e.priceMin=f.value.priceMin),f.value.priceMax&&(e.priceMax=f.value.priceMax),f.value.sortBy&&(e.sortBy=f.value.sortBy)),(await A.get("inventory/api-inventories",{params:e})).data.data||[]}catch(l){return console.error("❌ Error fetching export data:",l),y.error("Failed to load data for export"),[]}finally{U.value=!1}},$e=l=>{if(!l)return;const i=new URLSearchParams(l.split("?")[1]).get("page");i&&$(parseInt(i))};ot(async()=>{q.value="",ce.value=Date.now(),await Se(),setTimeout(()=>{pe.value=!0;const l=document.getElementById(oe);l&&(l.value="",q.value="")},100),$(),H()});const q=g(""),ce=g(Date.now()),oe=`search-${Math.random().toString(36).substr(2,9)}`,pe=g(!1);g("");const L=g({sortBy:"",category:"",supplier:"",stockStatus:"",priceMin:null,priceMax:null,dateFrom:"",dateTo:""}),f=g({...L.value}),qe=()=>{f.value={...L.value},V.value.current_page=1,$(1)},Ee=()=>{L.value={sortBy:"",category:"",supplier:"",stockStatus:"",priceMin:null,priceMax:null,dateFrom:"",dateTo:""},f.value={...L.value},V.value.current_page=1,V.value.per_page=10,$(1),le("inventoryFilterModal")};let me=null;Ce(q,(l,e)=>{clearTimeout(me),me=setTimeout(()=>{V.value.current_page=1,$(1)},500)});const J=F(()=>({sortOptions:[{value:"stock_desc",label:"Stock: High to Low"},{value:"stock_asc",label:"Stock: Low to High"},{value:"name_asc",label:"Name: A to Z"},{value:"name_desc",label:"Name: Z to A"}],categories:I.categories||[],suppliers:I.suppliers||[],stockStatusOptions:[{value:"in_stock",label:"In Stock"},{value:"low_stock",label:"Low Stock"},{value:"out_of_stock",label:"Out of Stock"},{value:"expired",label:"Expired"},{value:"near_expiry",label:"Near Expiry"}]}));F(()=>Y.value.length);const ve=g([]),B=g({total_items:0,out_of_stock:0,low_stock:0,expired:0,near_expiry:0}),H=async()=>{try{const l=await A.get("/inventory/kpi-stats");B.value=l.data}catch(l){console.error("❌ Failed to fetch KPI stats:",l)}};F(()=>Y.value.filter(l=>l.availableStock>0&&l.availableStock<(l.minAlert||5)).length),F(()=>Y.value.filter(l=>l.availableStock<=0).length),F(()=>ve.value.filter(l=>{if(l.stock_type!=="stockin"||!l.expiry_date)return!1;const e=new Date(l.expiry_date),i=new Date;e.setHours(0,0,0,0),i.setHours(0,0,0,0);const a=e<i,v=(l.quantity||0)>(l.allocated_quantity||0);return a&&v}).length),F(()=>ve.value.filter(l=>{if(l.stock_type!=="stockin"||!l.expiry_date)return!1;const a=(new Date(l.expiry_date)-new Date)/(1e3*60*60*24),v=a>0&&a<=15,w=(l.quantity||0)>(l.allocated_quantity||0);return v&&w}).length);const De=F(()=>[{label:"Total Items",value:B.value.total_items??0,icon:xt,iconBg:"bg-soft-success",iconColor:"text-success"},{label:"Out of Stock",value:B.value.out_of_stock??0,icon:wt,iconBg:"bg-soft-danger",iconColor:"text-danger"},{label:"Low Stock",value:B.value.low_stock??0,icon:St,iconBg:"bg-soft-warning",iconColor:"text-warning"},{label:"Expired Stock",value:B.value.expired??0,icon:At,iconBg:"bg-soft-danger",iconColor:"text-danger"},{label:"Near Expire Stock",value:B.value.near_expiry??0,icon:Mt,iconBg:"bg-soft-info",iconColor:"text-info"}]);st(()=>window.feather?.replace?.());const o=g({}),n=g({id:null,name:"",category_id:null,subcategory_id:null,unit_id:null,supplier_id:null,minAlert:null,sku:"",description:"",nutrition:{calories:0,fat:0,protein:0,carbs:0},allergies:[],tags:[],imageFile:null,imageUrl:null}),ee=g(!1),Pe=async()=>{ee.value=!0,o.value={};const l=new FormData;if(l.append("name",(n.value.name||"").trim()),n.value.category_id&&l.append("category_id",n.value.category_id),E.value.length&&n.value.subcategory_id&&l.append("subcategory_id",n.value.subcategory_id),n.value.unit_id&&l.append("unit_id",n.value.unit_id),n.value.minAlert!==null&&n.value.minAlert!==""&&l.append("minAlert",n.value.minAlert),n.value.supplier_id&&l.append("supplier_id",n.value.supplier_id),l.append("sku",n.value.sku||""),l.append("description",n.value.description||""),l.append("nutrition[calories]",n.value.nutrition.calories),l.append("nutrition[fat]",n.value.nutrition.fat),l.append("nutrition[protein]",n.value.nutrition.protein),l.append("nutrition[carbs]",n.value.nutrition.carbs),(n.value.allergies||[]).forEach((e,i)=>l.append(`allergies[${i}]`,e)),(n.value.tags||[]).forEach((e,i)=>l.append(`tags[${i}]`,e)),n.value.imageFile){const e=(n.value.imageFile.type?.split("/")?.[1]||"webp").replace("jpeg","jpg");l.append("image",n.value.imageFile,`image.${e}`)}try{n.value.id?(await A.post(`/inventory/${n.value.id}?_method=PUT`,l,{headers:{"Content-Type":"multipart/form-data"}}),y.success(" Inventory Item updated successfully")):(await A.post("/inventory",l,{headers:{"Content-Type":"multipart/form-data"}}),y.success(" Inventory Item created successfully")),se(),await $();const e=document.getElementById("addItemModal");bootstrap.Modal.getInstance(e)?.hide()}catch(e){e?.response?.status===422&&e.response.data?.errors?(o.value=e.response.data.errors,y.error("Please fill in all required fields correctly.")):(console.error("❌ Error saving:",e.response?.data||e.message),y.error("Failed to save Inventory Item"))}finally{ee.value=!1}};Ce(n,l=>{Object.keys(o.value).forEach(e=>{if(e.includes(".")){const[i,a]=e.split(".");l[i]&&l[i][a]!==""&&delete o.value[e]}else{const i=l[e];i!=null&&i!==""&&(!Array.isArray(i)||i.length>0)&&delete o.value[e]}})},{deep:!0});const Ne=l=>{const e=v=>v===""||v===null||v===void 0?null:Number(v);let i=null,a=null;if(l.category&&typeof l.category=="object"){const v=l.category;v.parent_id?(a=e(v.id),i=e(v.parent_id)):(i=e(v.id),a=null)}else i=e(l.category_id),a=e(l.subcategory_id);n.value={id:l.id,name:l.name??"",category_id:i,subcategory_id:a,unit_id:e(l.unit_id),supplier_id:e(l.supplier_id),minAlert:l.minAlert??0,sku:l.sku??"",description:l.description??"",nutrition:l.nutrition??{calories:0,protein:0,fat:0,carbs:0},allergies:l.allergy_ids??[],tags:l.tag_ids??[],imageFile:null,imageUrl:l.image_url??null},Se(()=>{E.value.some(w=>w.id===n.value.subcategory_id)||(n.value.subcategory_id=null)})};function se(){n.value={id:null,name:"",category_id:null,subcategory_id:null,unit_id:null,minAlert:"",supplier_id:null,sku:"",description:"",nutrition:{calories:"",fat:"",protein:"",carbs:""},allergies:[],tags:[],imageFile:null,imageUrl:null}}const h=g({}),Te=async l=>{try{const e=await A.get(`/inventory/${l.id}`);h.value=e.data,await Je(l.id)}catch(e){console.error("Error fetching item:",e)}};function K(){const l=Number(p.value.quantity||0),e=Number(p.value.price||0);p.value.value=l*e}const p=g({product_id:null,name:"",category_id:null,supplier_id:null,available_quantity:0,quantity:0,price:0,value:0,expiry_date:"",description:"",operation_type:"purchase",stock_type:"stockin",purchase_date:new Date().toISOString().slice(0,10),user_id:1}),D=g(!1),z=g();function ge(){p.value.quantity=0,p.value.price=0,p.value.value=0,p.value.expiry_date="",p.value.description=""}const ye=()=>{o.value={}};async function je(){console.log(p.value),D.value=!0,K();try{await A.post("/stock_entries",p.value),y.success(" Stock In saved successfully"),ge(),bootstrap.Modal.getInstance(document.getElementById("stockInModal"))?.hide(),await $(),await H()}catch(l){l?.response?.status===422&&l.response.data?.errors?(o.value=l.response.data.errors,y.error("Please fill in all required fields correctly.")):(y.error("Something went wrong. Please try again.",{autoClose:3e3}),console.error(l))}finally{D.value=!1}}const Oe=g(null),Le=g(null);g(null);const R=g(!1),ne=g(null),Be=l=>{ne.value=l,R.value=!0},Re=()=>{if(R.value=!1,!ne.value){console.error("❌ No item selected for stock out"),y.error("No item selected");return}Qe(ne.value)};async function Qe(l){if(!l){console.error("❌ No item provided to confirmStockOut");return}try{console.log(" Attempting stock out for item:",l);const i=(await A.get(`/stock_entries/total/${l.id}`)).data||{},a=i.available||0;if(console.log(" Stock data received:",i),console.log(" Available quantity:",a),a<=0){y.warning(`No available stock for "${l.name}". Current stock: ${a}`,{autoClose:4e3}),R.value=!1;return}const v={product_id:l.id,name:l.name,category_id:l.category?.id,available_quantity:a,quantity:a,price:0,value:0,description:"Auto full stock-out",operation_type:"inventory_stockout",stock_type:"stockout",purchase_date:new Date().toISOString().slice(0,10),user_id:1};console.log(" Submitting stock out payload:",v),await A.post("/stock_entries",v),y.success(`Successfully stocked out ${a} units of "${l.name}"`,{autoClose:3e3}),await $(),await H()}catch(e){console.error("❌ Stock out error:",e),console.error("❌ Error response:",e.response?.data),e?.response?.data?.errors?.quantity?y.error(e.response.data.errors.quantity[0]):y.error("Stock out failed. Please try again.")}finally{R.value=!1}}async function He(){if(D.value=!0,K(),p.value.quantity>p.value.available_quantity){o.value.quantity=["The quantity should not exceed the available quantity."],y.error("The quantity should not exceed the available quantity."),D.value=!1;return}else o.value.quantity=null;try{await A.post("/stock_entries",p.value),y.success("Stock Out saved successfully"),ge(),bootstrap.Modal.getInstance(document.getElementById("stockOutModal"))?.hide(),await $(),await H()}catch(l){l?.response?.status===422&&l.response.data?.errors?(o.value=l.response.data.errors,y.error("Please fill in all required fields correctly.")):(y.error("Something went wrong. Please try again.",{autoClose:3e3}),console.error(l))}finally{D.value=!1}}const Ke=async l=>{if(!O.value||O.value.length===0){y.error("No inventory data to download");return}try{U.value=!0;const e=await Ue();if(!e.length){y.error("No inventory items found to download"),U.value=!1;return}l==="pdf"?Ze(e):l==="excel"?Xe(e):l==="csv"?ze(e):y.error("Invalid download type")}catch(e){console.error("Download failed:",e),y.error(`Download failed: ${e.message}`)}finally{U.value=!1}},ze=l=>{try{const e=["name","sku","category","min_alert","unit","preferred_supplier","min_stock_alert","available_stock","calories","fat","protein","carbs","allergies","tags"],i=l.map(r=>{let c="";return r.nutrition&&typeof r.nutrition=="object"?c=Object.entries(r.nutrition).map(([M,N])=>`${M}: ${N}`).join("; "):typeof r.nutrition=="string"&&(c=r.nutrition),[`"${(r.name||"").replace(/"/g,'""')}"`,`"${(r.sku||"").replace(/"/g,'""')}"`,`"${(r.category?.name||"").replace(/"/g,'""')}"`,`"${r.minAlert||""}"`,`"${(r.unit_name||"").replace(/"/g,'""')}"`,`"${(r.supplier_name||"").replace(/"/g,'""')}"`,`"${r.minAlert||""}"`,`"${r.availableStock||""}"`,`"${r.nutrition?.calories||0}"`,`"${r.nutrition?.protein||0}"`,`"${r.nutrition?.fat||0}"`,`"${r.nutrition?.carbs||0}"`,`"${Array.isArray(r.allergies)?r.allergies.join(", "):r.allergies||""}"`,`"${Array.isArray(r.tags)?r.tags.join(", "):r.tags||""}"`]}),a=[e.join(","),...i.map(r=>r.join(","))].join(`
`),v=new Blob([a],{type:"text/csv;charset=utf-8;"}),w=URL.createObjectURL(v),m=document.createElement("a");m.setAttribute("href",w),m.setAttribute("download",`inventory_items_${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(w),y.success(`CSV downloaded successfully (${l.length} items)`,{autoClose:2500})}catch(e){console.error("CSV generation error:",e),y.error(`CSV generation failed: ${e.message}`,{autoClose:5e3})}},Ze=l=>{try{const e=new mt("l","mm","a4");e.setFontSize(18),e.setFont("helvetica","bold"),e.text("Inventory Items Report",14,15),e.setFontSize(10),e.setFont("helvetica","normal");const i=new Date().toLocaleString();e.text(`Generated on: ${i}`,14,22),e.text(`Total Items: ${l.length}`,14,28);const a=["Name","SKU","Category","Min Alert","Unit","Preferred Supplier","Min Stock Alert","Available Stock","Calories","Fat","Protein","Carbs","Allergies","Tags"],v=l.map(m=>[m.name||"",m.sku||"",m.category?.name||"",m.minAlert||"",m.unit_name||"",m.supplier_name||"",m.minAlert||"",m.availableStock!==void 0?Number(m.availableStock).toFixed(2):"",m.nutrition?.calories||"",m.nutrition?.fat||"",m.nutrition?.protein||"",m.nutrition?.carbs||"",Array.isArray(m.allergies)?m.allergies.join(", "):m.allergies||"",Array.isArray(m.tags)?m.tags.join(", "):m.tags||""]);vt(e,{head:[a],body:v,startY:35,styles:{fontSize:8,cellPadding:2,halign:"left",lineColor:[0,0,0],lineWidth:.1},headStyles:{fillColor:[41,128,185],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]},margin:{left:14,right:14},didDrawPage:m=>{const r=e.internal.getNumberOfPages(),c=e.internal.pageSize.height;e.setFontSize(8),e.text(`Page ${m.pageNumber} of ${r}`,m.settings.margin.left,c-10)}});const w=`inventory_items_${new Date().toISOString().split("T")[0]}.pdf`;e.save(w),y.success(`PDF downloaded successfully (${l.length} items)`,{autoClose:2500})}catch(e){console.error("PDF generation error:",e),y.error(`PDF generation failed: ${e.message}`,{autoClose:5e3})}},Xe=l=>{try{if(typeof gt>"u")throw new Error("XLSX library is not loaded");const e=l.map(r=>({Name:r.name||"",SKU:r.sku||"",Category:r.category?.name||"",Min_Alert:r.minAlert||"",Unit:r.unit_name||"",Preferred_Supplier:r.supplier_name||"",Min_Stock_Alert:r.minAlert||"",Available_Stock:r.availableStock||"",Calories:r.nutrition?.calories||"",Fat:r.nutrition?.fat||"",Protein:r.nutrition?.protein||"",Carbs:r.nutrition?.carbs||"",Allergies:Array.isArray(r.allergies)?r.allergies.join(", "):r.allergies||"",Tags:Array.isArray(r.tags)?r.tags.join(", "):r.tags||""})),i=W.book_new(),a=W.json_to_sheet(e);a["!cols"]=[{wch:25},{wch:15},{wch:20},{wch:12},{wch:15},{wch:25},{wch:15},{wch:18},{wch:10},{wch:10},{wch:10},{wch:10},{wch:25},{wch:25}],W.book_append_sheet(i,a,"Inventory Items");const v=[{Info:"Generated On",Value:new Date().toLocaleString()},{Info:"Total Records",Value:l.length},{Info:"Exported By",Value:"Inventory Management System"}],w=W.json_to_sheet(v);W.book_append_sheet(i,w,"Report Info");const m=`inventory_items_${new Date().toISOString().split("T")[0]}.xlsx`;yt(i,m),y.success(`Excel file downloaded successfully (${l.length} items)`,{autoClose:2500})}catch(e){console.error("Excel generation error:",e),y.error(`Excel generation failed: ${e.message}`,{autoClose:5e3})}},fe=g(!1),Ge=g(!1),be=g(null);function We(l){be.value=n.value.imageUrl,be.value&&(Ge.value=!0)}function Ye({file:l}){n.value.imageFile=l,n.value.imageUrl=URL.createObjectURL(l)}g("");const _e=g(0),he=g(0),ke=g(0),xe=g(0),Z=g([]);async function Je(l){try{const{data:e}=await A.get(`/stock_entries/by-item/${l}`),i=e?.data||{};console.log(i),Z.value=i.records||[],_e.value=i.near_count??0,he.value=i.expired_count??0,ke.value=i.near_qty??0,xe.value=i.expired_qty??0}catch(e){console.error(e),Z.value=[],_e.value=he.value=0,ke.value=xe.value=0}}function et(l){return l==="expired"?"Expired":l==="near"?"Near Expire":"Active"}function tt(l){return l==="expired"?"bg-danger":l==="near"?"bg-warning":"bg-success"}const te=F(()=>{const l=Z.value||[];let e=0,i=0,a=0,v=0,w=0;const m=new Date;m.setHours(0,0,0,0);for(const r of l){const c=parseFloat(r?.quantity??0);if(e+=c,i+=Number(r?.price??0),a+=Number(r?.value??0),!r?.expiry_date)v+=c;else{const we=new Date(r.expiry_date);we.setHours(0,0,0,0),we>=m&&(v+=c)}const M=parseFloat(r?.allocated_quantity??0),N=Math.max(0,c-M);(!r?.expiry_date||new Date(r.expiry_date)>=m)&&(w+=N)}return{totalQty:Number(e.toFixed(2)),totalPrice:Number(i.toFixed(2)),totalValue:Number(a.toFixed(2)),notExpiredQty:Number(v.toFixed(2)),availableQty:Number(w.toFixed(2))}}),lt=l=>{if(!l||l.length<=1){y.error("The imported file is empty.");return}const e=l[0];console.log("headers are ",e);const i=l.slice(1);console.log("rows data",i);const a=i.map(c=>({name:c[0]||"",sku:c[1]||"",description:c[2]||"",category:c[3]||"",min_alert:c[4]||"",unit:c[5]||"",preferred_supplier:c[6]||"",purchase_price:c[7]||"",stock:parseInt(c[8])||0,active:c[9]||1,calories:parseFloat(c[10])||0,fat:parseFloat(c[11])||0,protein:parseFloat(c[12])||0,carbs:parseFloat(c[13])||0,allergies:c[14]||"",tags:c[15]||""})),v=a.map(c=>c.name.trim().toLowerCase()),w=v.filter((c,M)=>v.indexOf(c)!==M);if(w.length>0){y.error(`Duplicate item names found in CSV: ${[...new Set(w)].join(", ")}`);return}const m=Y.value.map(c=>c.name.trim().toLowerCase()),r=a.filter(c=>m.includes(c.name.trim().toLowerCase()));if(r.length>0){const c=r.map(M=>M.name).join(", ");y.error(`Items already exist in the table: ${c}`);return}A.post("/api/inventory/import",{items:a}).then(()=>{y.success("Items imported successfully");const c=document.querySelector(".modal.show");if(c){const M=bootstrap.Modal.getInstance(c);M&&M.hide()}setTimeout(()=>{document.querySelectorAll(".modal-backdrop").forEach(N=>N.remove()),document.body.classList.remove("modal-open"),document.body.style.overflow="",document.body.style.paddingRight=""},100),$(),H()}).catch(c=>{console.error(c),y.error("Import failed"),setTimeout(()=>{document.querySelectorAll(".modal-backdrop").forEach(N=>N.remove()),document.body.classList.remove("modal-open"),document.body.style.overflow="",document.body.style.paddingRight=""},100)})};return(l,e)=>{const i=nt("VueDatePicker");return d(),re(pt,null,{default:Me(()=>[x(k(it),{title:"inventory Item"}),t("div",Nt,[e[101]||(e[101]=t("h4",{class:"mb-3"},"Overall Inventory",-1)),t("div",Tt,[(d(!0),u(T,null,X(De.value,a=>(d(),u("div",{key:a.label,class:"col-md-6 col-xl-3"},[t("div",jt,[t("div",Ot,[t("div",null,[t("div",Lt,s(a.value),1),t("div",Bt,s(a.label),1)]),t("div",{class:_(["icon-chip",a.iconBg])},[(d(),re(rt(a.icon),{class:_(a.iconColor),size:"26"},null,8,["class"]))],2)])])]))),128))]),t("div",Rt,[t("div",Qt,[t("div",Ht,[e[41]||(e[41]=t("h4",{class:"mb-0"},"Stock",-1)),t("div",Kt,[t("div",zt,[e[38]||(e[38]=t("i",{class:"bi bi-search"},null,-1)),e[39]||(e[39]=t("input",{type:"email",name:"email",autocomplete:"email",style:{position:"absolute",left:"-9999px",width:"1px",height:"1px"},tabindex:"-1","aria-hidden":"true"},null,-1)),pe.value?S((d(),u("input",{id:oe,"onUpdate:modelValue":e[0]||(e[0]=a=>q.value=a),key:ce.value,class:"form-control search-input",placeholder:"Search",type:"search",autocomplete:"new-password",name:oe,role:"presentation",onFocus:e[1]||(e[1]=(...a)=>l.handleFocus&&l.handleFocus(...a))},null,32)),[[C,q.value]]):(d(),u("input",Zt))]),x(ft,{modelValue:L.value,"onUpdate:modelValue":e[2]||(e[2]=a=>L.value=a),title:"Inventory Items","modal-id":"inventoryFilterModal","modal-size":"modal-lg",categories:J.value.categories,suppliers:J.value.suppliers,"sort-options":J.value.sortOptions,"stock-status-options":J.value.stockStatusOptions,"show-price-range":!0,"show-date-range":!1,priceRangeLabel:"Stock Value Range",onApply:qe,onClear:Ee},null,8,["modelValue","categories","suppliers","sort-options","stock-status-options"]),t("button",{"data-bs-toggle":"modal","data-bs-target":"#addItemModal",class:"d-flex align-items-center gap-1 px-4 py-2 btn-sm rounded-pill btn btn-primary text-white",onClick:e[3]||(e[3]=a=>{se(),o.value={},z.value="Create"})},[x(k(Ct),{class:"w-4 h-4"}),e[40]||(e[40]=ie(" Add Item ",-1))]),x(kt,{label:"Import",sampleHeaders:["name","sku","description","category","min_alert","unit","preferred_supplier","purchase_price","stock","active","calories","fat","protein","carbs","allergies","tags"],sampleData:[["Milk","SKU-001","Sample one Description","Dairy",5,"Kilogram (kg)","Fresh Fruits Co.",200,350,1,150,33,23,44,"Eggs","Fairtrade"],["Honey","SKU-002","Sample Two Description","Sweets",5,"Kilogram (kg)","Green Veggies Ltd.",159,100,1,150,33,23,44,"Eggs","Fairtrade"]],onOnImport:lt}),x(k(bt),{modelValue:ae.value,"onUpdate:modelValue":e[4]||(e[4]=a=>ae.value=a),options:Ae,optionLabel:"label",optionValue:"value",placeholder:"Export",class:"export-dropdown",onChange:Fe},null,8,["modelValue"])])]),t("div",Xt,[t("table",Gt,[e[44]||(e[44]=t("thead",{class:"border-top small text-muted"},[t("tr",null,[t("th",null,"S.#"),t("th",null,"Items"),t("th",null,"Image"),t("th",null,"Category"),t("th",null,"Unit"),t("th",null,"Available Stock"),t("th",null,"Stock Value"),t("th",{class:"text-center"},"Availability"),t("th",{class:"text-center"},"Action")])],-1)),U.value?(d(),u("tbody",Wt,[...e[42]||(e[42]=[t("tr",null,[t("td",{colspan:"10",class:"text-center py-5"},[t("div",{class:"spinner-border",role:"status","aria-label":"Loading"})])],-1)])])):(d(),u("tbody",Yt,[(d(!0),u(T,null,X(O.value,(a,v)=>(d(),u("tr",{key:a.id},[t("td",null,s(V.value.from+v),1),t("td",Jt,s(a.name),1),t("td",null,[x(dt,{file:a.image_url||"/assets/img/default.png",alt:a.name,width:50,height:50,custom_class:"cursor-pointer"},null,8,["file","alt"])]),t("td",el,s(a.category?.name),1),t("td",null,s(a.unit_name),1),t("td",null,s(a.availableStock?a.availableStock.toFixed(2):0),1),t("td",null,s(a.stockValue||0),1),t("td",tl,[a.availableStock===0?(d(),u("span",ll,"Out of stock")):a.availableStock<=a.minAlert?(d(),u("span",al,"Low-stock")):(d(),u("span",ol,"In-stock"))]),t("td",sl,[t("div",nl,[t("button",{onClick:w=>Be(a),title:"Stock Out",class:"p-2 rounded-full text-red-600 hover:bg-red-100"},[x(k(Ft),{class:"w-4 h-4"})],8,il),x(Pt,{show:R.value,title:"Confirm Stock Out",message:"Are you sure you want to stock out this item?",onConfirm:Re,onClose:e[5]||(e[5]=w=>R.value=!1)},null,8,["show"]),t("button",{onClick:w=>Te(a),"data-bs-toggle":"modal","data-bs-target":"#viewItemModal",title:"View Item",class:"p-2 rounded-full text-primary hover:bg-gray-100"},[x(k(It),{class:"w-4 h-4"})],8,rl),t("button",{onClick:()=>{Ne(a),o.value={},z.value="Edit"},"data-bs-toggle":"modal","data-bs-target":"#addItemModal",title:"Edit",class:"p-2 rounded-full text-blue-600 hover:bg-blue-100"},[x(k(Vt),{class:"w-4 h-4"})],8,dl)])])]))),128)),O.value.length===0?(d(),u("tr",ul,[...e[43]||(e[43]=[t("td",{colspan:"10",class:"text-center text-muted py-4"}," No items found. ",-1)])])):b("",!0)]))])]),!U.value&&V.value.last_page>1?(d(),u("div",cl,[t("div",pl," Showing "+s(V.value.from)+" to "+s(V.value.to)+" of "+s(V.value.total)+" entries ",1),x(ut,{pagination:V.value.links,isApiDriven:!0,onPageChanged:$e},null,8,["pagination"])])):b("",!0)])]),t("div",ml,[t("div",vl,[t("div",gl,[t("div",yl,[t("h5",fl,s(z.value==="Edit"?"Edit Item":"Add New Item"),1),e[45]||(e[45]=t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})])],-1))]),t("div",bl,[t("div",_l,[t("div",hl,[e[46]||(e[46]=t("label",{class:"form-label"},"Product Name",-1)),S(t("input",{"onUpdate:modelValue":e[6]||(e[6]=a=>n.value.name=a),type:"text",class:_(["form-control",{"is-invalid":o.value.name}]),placeholder:"e.g., Chicken Breast"},null,2),[[C,n.value.name]]),o.value.name?(d(),u("small",kl,s(o.value.name[0]),1)):b("",!0)]),t("div",xl,[e[47]||(e[47]=t("label",{class:"form-label"},"Category",-1)),x(k(G),{modelValue:n.value.category_id,"onUpdate:modelValue":[e[7]||(e[7]=a=>n.value.category_id=a),e[8]||(e[8]=a=>n.value.subcategory_id=null)],options:ue.value,optionLabel:"name",optionValue:"id",placeholder:"Select Category",class:_(["w-100 select",{"is-invalid":o.value.category_id}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","class"]),o.value.category_id?(d(),u("small",wl,s(o.value.category_id[0]),1)):b("",!0)]),E.value.length?(d(),u("div",Sl,[e[48]||(e[48]=t("label",{class:"form-label"},"Subcategory",-1)),x(k(G),{modelValue:n.value.subcategory_id,"onUpdate:modelValue":e[9]||(e[9]=a=>n.value.subcategory_id=a),options:E.value,optionLabel:"name",optionValue:"id",placeholder:"Select Subcategory",class:_(["w-100 select",{"is-invalid":o.value.subcategory_id}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","class"]),o.value.subcategory_id?(d(),u("small",Cl,s(o.value.subcategory_id[0]),1)):b("",!0)])):b("",!0),t("div",Il,[e[49]||(e[49]=t("label",{class:"form-label d-block"},"Minimum Stock Alert Level",-1)),S(t("input",{"onUpdate:modelValue":e[10]||(e[10]=a=>n.value.minAlert=a),type:"number",min:"0",class:_(["form-control",{"is-invalid":o.value.minAlert}]),placeholder:"e.g., 5"},null,2),[[C,n.value.minAlert]]),o.value.minAlert?(d(),u("small",Vl,s(o.value.minAlert[0]),1)):b("",!0)]),t("div",Ml,[e[50]||(e[50]=t("label",{class:"form-label"},"Unit Type",-1)),x(k(G),{modelValue:n.value.unit_id,"onUpdate:modelValue":e[11]||(e[11]=a=>n.value.unit_id=a),options:I.units,optionLabel:"name",optionValue:"id",placeholder:"Select Unit",class:_(["w-100 select",{"is-invalid":o.value.unit_id}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","class"]),o.value.unit_id?(d(),u("small",Al,s(o.value.unit_id[0]),1)):b("",!0)]),t("div",Fl,[e[51]||(e[51]=t("label",{class:"form-label"},"Preferred Supplier",-1)),x(k(G),{modelValue:n.value.supplier_id,"onUpdate:modelValue":e[12]||(e[12]=a=>n.value.supplier_id=a),options:I.suppliers,optionLabel:"name",optionValue:"id",placeholder:"Select Supplier",class:_(["w-100 select",{"is-invalid":o.value.supplier_id}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","class"]),o.value.supplier_id?(d(),u("small",Ul,s(o.value.supplier_id[0]),1)):b("",!0)]),t("div",$l,[e[52]||(e[52]=t("label",{class:"form-label"},"SKU (Optional)",-1)),S(t("input",{"onUpdate:modelValue":e[13]||(e[13]=a=>n.value.sku=a),type:"text",class:_(["form-control",{"is-invalid":o.value.sku}]),placeholder:"Stock Keeping Unit"},null,2),[[C,n.value.sku]]),o.value.sku?(d(),u("small",ql,s(o.value.sku[0]),1)):b("",!0)]),t("div",El,[e[53]||(e[53]=t("label",{class:"form-label"},"Description",-1)),S(t("textarea",{"onUpdate:modelValue":e[14]||(e[14]=a=>n.value.description=a),rows:"4",class:_(["form-control",{"is-invalid":o.value.description}]),placeholder:"Notes about this product"},null,2),[[C,n.value.description]]),o.value.description?(d(),u("small",Dl,s(o.value.description[0]),1)):b("",!0)])]),e[63]||(e[63]=t("h6",{class:"mb-3"}," Nutrition Information (per unit) ",-1)),t("div",Pl,[t("div",Nl,[e[54]||(e[54]=t("label",{class:"form-label"},"Calories",-1)),S(t("input",{"onUpdate:modelValue":e[15]||(e[15]=a=>n.value.nutrition.calories=a),type:"number",min:"0",class:_(["form-control",{"is-invalid":o.value["nutrition.calories"]}])},null,2),[[C,n.value.nutrition.calories]]),o.value["nutrition.calories"]?(d(),u("small",Tl,s(o.value["nutrition.calories"][0]),1)):b("",!0)]),t("div",jl,[e[55]||(e[55]=t("label",{class:"form-label"},"Fat (g)",-1)),S(t("input",{"onUpdate:modelValue":e[16]||(e[16]=a=>n.value.nutrition.fat=a),type:"number",min:"0",class:_(["form-control",{"is-invalid":o.value["nutrition.fat"]}])},null,2),[[C,n.value.nutrition.fat]]),o.value["nutrition.fat"]?(d(),u("small",Ol,s(o.value["nutrition.fat"][0]),1)):b("",!0)]),t("div",Ll,[e[56]||(e[56]=t("label",{class:"form-label"},"Protein (g)",-1)),S(t("input",{"onUpdate:modelValue":e[17]||(e[17]=a=>n.value.nutrition.protein=a),type:"number",min:"0",class:_(["form-control",{"is-invalid":o.value["nutrition.protein"]}])},null,2),[[C,n.value.nutrition.protein]]),o.value["nutrition.protein"]?(d(),u("small",Bl,s(o.value["nutrition.protein"][0]),1)):b("",!0)]),t("div",Rl,[e[57]||(e[57]=t("label",{class:"form-label"},"Carbs (g)",-1)),S(t("input",{"onUpdate:modelValue":e[18]||(e[18]=a=>n.value.nutrition.carbs=a),type:"number",min:"0",class:_(["form-control",{"is-invalid":o.value["nutrition.carbs"]}])},null,2),[[C,n.value.nutrition.carbs]]),o.value["nutrition.carbs"]?(d(),u("small",Ql,s(o.value["nutrition.carbs"][0]),1)):b("",!0)])]),t("div",Hl,[t("div",Kl,[e[58]||(e[58]=t("label",{class:"form-label d-block"},"Allergies",-1)),x(k(Ie),{modelValue:n.value.allergies,"onUpdate:modelValue":e[19]||(e[19]=a=>n.value.allergies=a),options:I.allergies,optionLabel:"name",optionValue:"id",filter:"",placeholder:"Select Allergies",class:_(["w-full md:w-80 select",{"is-invalid":o.value.allergies}]),appendTo:"self",display:"chip"},null,8,["modelValue","options","class"]),o.value.allergies?(d(),u("small",zl,s(o.value.allergies[0]),1)):b("",!0)]),t("div",Zl,[e[59]||(e[59]=t("label",{class:"form-label d-block"},"Tags",-1)),x(k(Ie),{modelValue:n.value.tags,"onUpdate:modelValue":e[20]||(e[20]=a=>n.value.tags=a),options:I.tags,optionLabel:"name",optionValue:"id",filter:"",placeholder:"Select Tags",class:_(["w-full md:w-80 select",{"is-invalid":o.value.tags}]),appendTo:"self",display:"chip"},null,8,["modelValue","options","class"]),o.value.tags?(d(),u("small",Xl,s(o.value.tags[0]),1)):b("",!0)])]),t("div",Gl,[t("div",{class:_(["logo-card",{"is-invalid":o.value.image}])},[t("div",{class:"logo-frame",onClick:e[21]||(e[21]=a=>n.value.imageUrl&&We())},[n.value.imageUrl?(d(),u("img",{key:0,src:n.value.imageUrl,alt:"Image"},null,8,Wl)):(d(),u("div",Yl,[...e[60]||(e[60]=[t("i",{class:"bi bi-image"},null,-1)])]))]),e[61]||(e[61]=t("small",{class:"text-muted mt-2 d-block"},"Upload Image",-1)),x(ct,{show:fe.value,onClose:e[22]||(e[22]=a=>fe.value=!1),onCropped:Ye},null,8,["show"])],2),o.value.image?(d(),u("small",Jl,s(o.value.image[0]),1)):b("",!0)]),t("div",ea,[t("button",{class:"btn btn-primary btn-sm rounded-pill px-5 py-2",disabled:ee.value,onClick:Pe},[ee.value?(d(),u(T,{key:0},[e[62]||(e[62]=t("span",{class:"spinner-border spinner-border-sm me-2"},null,-1)),ie(" "+s((z.value==="Edit","Saving...")),1)],64)):(d(),u(T,{key:1},[ie(s((z.value==="Edit","Save")),1)],64))],8,ta),t("button",{class:"btn btn-secondary rounded-pill px-4 ms-2","data-bs-dismiss":"modal",onClick:se}," Cancel ")])])])])]),t("div",la,[t("div",aa,[t("div",oa,[t("div",sa,[t("div",na,[e[65]||(e[65]=t("i",{class:"bi bi-box-seam text-primary fs-4"},null,-1)),t("div",null,[e[64]||(e[64]=t("h5",{class:"modal-title fw-semibold mb-0"}," View Inventory Item ",-1)),h.value?.sku?(d(),u("small",ia,"SKU: "+s(h.value.sku),1)):b("",!0)])]),e[66]||(e[66]=t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})])],-1))]),t("div",ra,[h.value?(d(),u("div",da,[t("div",ua,[t("div",ca,[t("div",pa,[t("h5",ma,s(h.value.name),1),t("p",va," SKU: "+s(h.value.sku),1),t("div",ga,[t("div",ya,[e[67]||(e[67]=t("div",{class:"text-muted"}," Category ",-1)),t("div",fa,s(h.value.category_name||"—"),1)]),t("div",ba,[e[68]||(e[68]=t("div",{class:"text-muted"}," Unit ",-1)),t("div",_a,s(h.value.unit_name),1)]),t("div",ha,[e[69]||(e[69]=t("div",{class:"text-muted"}," Min Alert ",-1)),t("div",ka,s(h.value.minAlert),1)]),t("div",xa,[e[70]||(e[70]=t("div",{class:"text-muted"}," Supplier ",-1)),t("div",wa,s(h.value.supplier_name),1)]),t("div",Sa,[e[71]||(e[71]=t("div",{class:"text-muted"}," Description ",-1)),t("div",Ca,s(h.value.description||"—"),1)])]),e[72]||(e[72]=t("h6",{class:"fw-semibold"}," Nutrition (per 100g) ",-1)),t("div",Ia,[t("span",Va,"Calories: "+s(h.value.nutrition?.calories??"—"),1),t("span",Ma,"Protein: "+s(h.value.nutrition?.protein??"—"),1),t("span",Aa,"Fat: "+s(h.value.nutrition?.fat??"—"),1),t("span",Fa,"Carbs: "+s(h.value.nutrition?.carbs??"—"),1)]),e[73]||(e[73]=t("hr",null,null,-1)),e[74]||(e[74]=t("h6",{class:"fw-semibold"},"Tags",-1)),t("div",Ua,[(d(!0),u(T,null,X(h.value.tags,a=>(d(),u("span",{key:a,class:"badge rounded-pill bg-info text-white"},s(a),1))),128))]),e[75]||(e[75]=t("hr",null,null,-1)),e[76]||(e[76]=t("h6",{class:"fw-semibold"}," Allergies ",-1)),t("div",$a,[(d(!0),u(T,null,X(h.value.allergies,a=>(d(),u("span",{key:a,class:"badge rounded-pill bg-danger text-white"},s(a),1))),128))])])])]),t("div",qa,[t("div",Ea,[t("div",Da,[h.value.image_url?(d(),u("div",Pa,[t("img",{src:h.value.image_url,alt:"Item Image",class:"w-100 rounded-3",style:{"object-fit":"cover"}},null,8,Na)])):b("",!0)]),t("div",Ta,[e[77]||(e[77]=t("span",{class:"text-muted"},"Stocked In",-1)),t("span",ja,s(te.value.availableQty),1)]),t("div",Oa,[e[78]||(e[78]=t("span",{class:"text-muted"},"Updated On",-1)),t("span",La,s(k(j)(h.value.updated_at)),1)]),t("div",Ba,[e[79]||(e[79]=t("span",{class:"text-muted"},"Added By",-1)),t("span",Ra,s(h.value.user),1)])])])])):b("",!0),t("div",Qa,[e[84]||(e[84]=t("div",{class:"card-header bg-white d-flex justify-content-between align-items-center"},[t("h5",{class:"mb-0"},"Stock History")],-1)),t("div",Ha,[t("table",Ka,[e[83]||(e[83]=t("thead",{class:"table-primary"},[t("tr",null,[t("th",{style:{width:"80px"}},"S.#"),t("th",null,"Qty"),t("th",null,"Price"),t("th",null,"Value"),t("th",null,"Description"),t("th",null,"Purchase Date"),t("th",null,"Expiry Date"),t("th",{class:"text-center"}," Status ")])],-1)),t("tbody",null,[(d(!0),u(T,null,X(Z.value,(a,v)=>(d(),u("tr",{key:a.id},[t("td",za,s(v+1),1),t("td",null,s(a.quantity),1),t("td",null,s(k(P)(a.price)),1),t("td",Za,s(k(P)(a.value)),1),t("td",Xa,s(a.description||"—"),1),t("td",Ga,s(k(j)(a.purchase_date)),1),t("td",Wa,s(k(j)(a.expiry_date)),1),t("td",Ya,[t("span",{style:{"min-width":"100px"},class:_(["badge rounded-pill d-inline-block text-center",tt(a.status)])},s(et(a.status)),3)])]))),128)),Z.value.length?b("",!0):(d(),u("tr",Ja,[...e[80]||(e[80]=[t("td",{colspan:"9",class:"text-center text-muted py-4"}," No items found. ",-1)])]))]),t("tfoot",null,[t("tr",null,[e[81]||(e[81]=t("th",null,"Totals",-1)),t("th",null,s(te.value.totalQty),1),t("th",null,s(k(P)(te.value.totalPrice)),1),t("th",eo,s(k(P)(te.value.totalValue)),1),e[82]||(e[82]=t("th",{colspan:"4"},null,-1))])])])])])])])])]),t("div",to,[t("div",lo,[t("div",ao,[t("div",oo,[t("h5",so," Stock In: "+s(p.value.name),1),t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close",onClick:ye},[...e[85]||(e[85]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",no,[t("div",io,[t("div",ro,[e[86]||(e[86]=t("label",{class:"form-label"},"Product Name",-1)),S(t("input",{type:"text","onUpdate:modelValue":e[23]||(e[23]=a=>p.value.name=a),class:_(["form-control",{"is-invalid":o.value.name}]),readonly:""},null,2),[[C,p.value.name]]),o.value.name?(d(),u("small",uo,s(o.value.name[0]),1)):b("",!0)]),t("div",co,[e[87]||(e[87]=t("label",{class:"form-label"},"Category",-1)),t("input",{type:"text",value:Le.value,class:"form-control",readonly:""},null,8,po),o.value.category_id?(d(),u("small",mo,s(o.value.category_id[0]),1)):b("",!0)]),t("div",vo,[e[88]||(e[88]=t("label",{class:"form-label"},"Supplier",-1)),x(k(G),{modelValue:p.value.supplier_id,"onUpdate:modelValue":e[24]||(e[24]=a=>p.value.supplier_id=a),options:I.suppliers,optionLabel:"name",optionValue:"id",placeholder:"Select Supplier",class:_(["w-100",{"is-invalid":o.value.supplier_id}]),appendTo:"self"},null,8,["modelValue","options","class"]),o.value.supplier_id?(d(),u("small",go,s(o.value.supplier_id[0]),1)):b("",!0)]),t("div",yo,[e[89]||(e[89]=t("label",{class:"form-label"},"Available Quantity",-1)),S(t("input",{type:"number","onUpdate:modelValue":e[25]||(e[25]=a=>p.value.available_quantity=a),class:"form-control",readonly:""},null,512),[[C,p.value.available_quantity]])]),t("div",fo,[e[90]||(e[90]=t("label",{class:"form-label"},"Quantity",-1)),S(t("input",{type:"number","onUpdate:modelValue":e[26]||(e[26]=a=>p.value.quantity=a),class:_(["form-control",{"is-invalid":o.value.quantity}]),min:"0",onInput:e[27]||(e[27]=a=>K())},null,34),[[C,p.value.quantity]]),o.value.quantity?(d(),u("small",bo,s(o.value.quantity[0]),1)):b("",!0)]),t("div",_o,[e[91]||(e[91]=t("label",{class:"form-label"},"Price",-1)),S(t("input",{type:"number","onUpdate:modelValue":e[28]||(e[28]=a=>p.value.price=a),class:_(["form-control",{"is-invalid":o.value.price}]),min:"0",onInput:e[29]||(e[29]=a=>K())},null,34),[[C,p.value.price]]),o.value.price?(d(),u("small",ho,s(o.value.price[0]),1)):b("",!0)]),t("div",ko,[e[92]||(e[92]=t("label",{class:"form-label"},"Value",-1)),S(t("input",{type:"text","onUpdate:modelValue":e[30]||(e[30]=a=>p.value.value=a),class:"form-control",readonly:""},null,512),[[C,p.value.value]])]),t("div",xo,[e[93]||(e[93]=t("label",{class:"form-label"},"Expiry Date",-1)),x(i,{modelValue:p.value.expiry_date,"onUpdate:modelValue":e[31]||(e[31]=a=>p.value.expiry_date=a),format:k(j),"min-date":new Date,class:_({"is-invalid":o.value.expiry_date}),enableTimePicker:!1,placeholder:"Select date"},null,8,["modelValue","format","min-date","class"]),o.value.expiry_date?(d(),u("small",wo,s(o.value.expiry_date[0]),1)):b("",!0)]),t("div",So,[e[94]||(e[94]=t("label",{class:"form-label"},"Notes / Reason",-1)),S(t("textarea",{"onUpdate:modelValue":e[32]||(e[32]=a=>p.value.description=a),rows:"3",class:"form-control"},null,512),[[C,p.value.description]])])]),t("div",Co,[t("button",{class:"d-flex align-items-center justify-content-center gap-2 px-4 py-2 rounded-pill btn btn-primary text-white",disabled:D.value,onClick:je},[D.value?(d(),u("span",Vo)):b("",!0),t("span",null,s(D.value?"Saving...":"Stock In"),1)],8,Io)])])])])]),t("div",Mo,[t("div",Ao,[t("div",Fo,[t("div",Uo,[t("h5",$o," Stock Out : "+s(p.value.name),1),t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close",onClick:ye},[...e[95]||(e[95]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",qo,[t("div",Eo,[t("div",Do,[e[96]||(e[96]=t("label",{class:"form-label"},"Product Name",-1)),S(t("input",{type:"text","onUpdate:modelValue":e[33]||(e[33]=a=>p.value.name=a),class:"form-control",readonly:""},null,512),[[C,p.value.name]])]),t("div",Po,[e[97]||(e[97]=t("label",{class:"form-label"},"Category",-1)),t("input",{type:"text",value:Oe.value,class:"form-control",readonly:""},null,8,No),o.value.category_id?(d(),u("small",To,s(o.value.category_id[0]),1)):b("",!0)]),t("div",jo,[e[98]||(e[98]=t("label",{class:"form-label"},"Available Quantity",-1)),S(t("input",{type:"number","onUpdate:modelValue":e[34]||(e[34]=a=>p.value.available_quantity=a),class:"form-control",readonly:""},null,512),[[C,p.value.available_quantity]])]),t("div",Oo,[e[99]||(e[99]=t("label",{class:"form-label"},"Quantity",-1)),S(t("input",{type:"number","onUpdate:modelValue":e[35]||(e[35]=a=>p.value.quantity=a),class:_(["form-control",{"is-invalid":o.value.quantity}]),min:"0",onInput:e[36]||(e[36]=a=>K())},null,34),[[C,p.value.quantity]]),o.value.quantity?(d(),u("small",Lo,s(o.value.quantity[0]),1)):b("",!0)]),t("div",Bo,[e[100]||(e[100]=t("label",{class:"form-label"},"Notes / Reason",-1)),S(t("textarea",{"onUpdate:modelValue":e[37]||(e[37]=a=>p.value.description=a),rows:"3",class:"form-control"},null,512),[[C,p.value.description]])])]),t("div",Ro,[t("button",{class:"d-flex align-items-center gap-1 px-4 py-2 rounded-pill btn btn-danger text-white",disabled:D.value,onClick:He}," Stock Out ",8,Qo)])])])])])])]),_:1})}}},bs=Ve(Ho,[["__scopeId","data-v-2558cfc5"]]);export{bs as default};
