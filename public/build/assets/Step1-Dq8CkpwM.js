import{_ as $,r as m,c as D,R as N,o as T,y as _,f as r,b as c,m as p,e as o,d as w,w as b,t as i,i as x,u as C,p as V,q as z}from"./app-BHYyRJnL.js";import{s as k}from"./index-CmEobXQy.js";import"./index-CpMR2yR9.js";import"./index-Bs9GfHmp.js";import"./index-ZEA6XP_E.js";import"./index-uhINJth7.js";const I={key:0,class:"fw-bold mb-3"},q={class:"section p-3 p-md-4"},M={class:"row g-3"},R={class:"col-12"},W={key:0,class:"d-flex align-items-center gap-2"},Z=["alt","src"],A={key:1},G={class:"d-flex align-items-center gap-2"},H=["alt","src"],J={key:0,class:"text-danger"},K={class:"col-md-6"},P={key:0,class:"text-danger"},Q={class:"col-md-6"},X={key:0,class:"d-flex align-items-center gap-2"},Y=["alt","src"],ee={key:1},te={class:"d-flex align-items-center gap-2"},ae=["alt","src"],oe={key:0,class:"text-danger"},se={__name:"Step1",props:{model:Object,formErrors:Object,isOnboarding:{type:Boolean,default:!1}},emits:["save"],setup(s,{emit:L}){const U=L,g=s,d=m(null),f=m(null),u=m([]),y=m([]),j=m([{label:"English",value:"en",flag:"https://flagcdn.com/w20/gb.png"}]),h=D(()=>j.value.map(t=>({name:t.label,code:t.value,flag:t.flag}))),l=N({country_code:"",country_name:"",timezone_id:"",language:"en",languages_supported:[]}),E=(t,e="24x18")=>`https://flagcdn.com/${e}/${String(t||"").toLowerCase()}.png`,v=()=>{U("save",{step:1,data:{...l}})},O=async()=>{try{const{data:t}=await V.get("/api/countries");u.value=t.map(e=>({name:e.name??e.label,code:String(e.code??e.iso2??e.value??"").toUpperCase()}))}catch(t){console.error("fetchCountries error:",t),z.warning(t.response?.data?.message||"Failed to load countries")}},F=async t=>{if(t)try{const{data:e}=await V.get(`/api/country/${t}`);y.value=e.timezones.map(n=>({label:`${n.gmt}`,value:n.id,is_default:n.is_default}));const a=y.value.find(n=>n.is_default);l.timezone_id=a?a.value:"",v()}catch(e){console.error("fetchCountryDetails error:",e),z.warning(e.response?.data?.message||"Failed to fetch country details")}},S=()=>{if(!u.value.length)return;const t=g.model?.country_code||l.country_code;d.value=u.value.find(e=>String(e.code).toUpperCase()===String(t).toUpperCase())||null,d.value&&(l.country_code=d.value.code,l.country_name=d.value.name)},B=()=>{const t=g.model?.language||l.language;f.value=h.value.find(e=>e.code===t)||h.value[0]};return T(async()=>{await O(),S(),B()}),_([u,()=>g.model?.country_code],()=>{S()}),_(d,t=>{!t||!t.code||(l.country_code=t.code,l.country_name=t.name,F(t.code),v())}),_(f,t=>{t&&(l.language=t.code,v())}),(t,e)=>(c(),r("div",null,[g.isOnboarding?(c(),r("h5",I,"Step 1 of 9 - Welcome & Language Selection")):p("",!0),o("div",q,[o("div",M,[o("div",R,[e[3]||(e[3]=o("label",{class:"form-label d-flex align-items-center gap-2"},"Country",-1)),w(C(k),{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=a=>d.value=a),options:u.value,optionLabel:"name",filter:!0,pt:{root:{class:"bg-white"},listContainer:{class:"bg-white text-black"},option:{class:"text-black"},header:{class:"bg-white text-black"},pcFilterContainer:{class:"bg-white p-2 border-b border-gray-200"},pcFilter:{class:"!bg-white w-full border border-gray-300 rounded px-3 py-2 focus:ring-2 focus:ring-blue-300 !text-black"},pcFilterIconContainer:{class:"text-gray-500"}},placeholder:"Select a Country",class:x(["w-100 bg-white",{"is-invalid":s.formErrors.country_name||s.formErrors.country_code}])},{value:b(({value:a,placeholder:n})=>[a?(c(),r("div",W,[o("img",{alt:a.name,src:E(a.code),width:"18",height:"14",style:{"object-fit":"cover"}},null,8,Z),o("span",null,i(a.name),1)])):(c(),r("span",A,i(n),1))]),option:b(({option:a})=>[o("div",G,[o("img",{alt:a.name,src:E(a.code),width:"18",height:"14",style:{"object-fit":"cover"}},null,8,H),o("span",null,i(a.name),1)])]),_:1},8,["modelValue","options","class"]),s.formErrors?.country_name||s.formErrors?.country_code?(c(),r("small",J,i(s.formErrors.country_name?.[0]||s.formErrors.country_code?.[0]),1)):p("",!0)]),o("div",K,[e[4]||(e[4]=o("label",{class:"form-label d-flex align-items-center gap-2"},"Time Zone",-1)),w(C(k),{modelValue:l.timezone_id,"onUpdate:modelValue":e[1]||(e[1]=a=>l.timezone_id=a),options:y.value,optionLabel:"label",optionValue:"value",pt:{listContainer:{class:"bg-white text-black"},option:{class:"text-black hover:bg-gray-100"}},placeholder:"Select a Timezone",class:x(["w-100",{"is-invalid":s.formErrors.timezone}])},null,8,["modelValue","options","class"]),s.formErrors?.timezone_id?(c(),r("small",P,i(s.formErrors.timezone_id[0]),1)):p("",!0)]),o("div",Q,[e[5]||(e[5]=o("label",{class:"form-label d-flex align-items-center gap-2"},"Language",-1)),w(C(k),{modelValue:f.value,"onUpdate:modelValue":e[2]||(e[2]=a=>f.value=a),options:h.value,optionLabel:"name",filter:!1,pt:{listContainer:{class:"bg-white text-black"},option:{class:"text-black hover:bg-gray-100"},header:{class:"bg-white text-black"}},placeholder:"Select a Language",class:x(["w-100",{"is-invalid":s.formErrors.language}])},{value:b(({value:a,placeholder:n})=>[a?(c(),r("div",X,[o("img",{alt:a.name,src:a.flag,width:"18",height:"14",style:{"object-fit":"cover"}},null,8,Y),o("span",null,i(a.name),1)])):(c(),r("span",ee,i(n),1))]),option:b(({option:a})=>[o("div",te,[o("img",{alt:a.name,src:a.flag,width:"18",height:"14",style:{"object-fit":"cover"}},null,8,ae),o("span",null,i(a.name),1)])]),_:1},8,["modelValue","options","class"]),s.formErrors?.language?(c(),r("small",oe,i(s.formErrors.language[0]),1)):p("",!0)])])])]))}},ue=$(se,[["__scopeId","data-v-35d0e429"]]);export{ue as default};
