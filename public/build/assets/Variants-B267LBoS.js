import{_ as K,r as u,o as X,n as J,c as M,a as E,b as o,d as I,e as p,f as e,u as g,h as Q,g as n,F as C,i as L,j as c,k as W,t as i,m as V,v as w,p as B,l as b,C as N,q as f,s as d}from"./app-V2s1lVwu.js";import{_ as ee}from"./Master-WElJ1C4A.js";import{s as P}from"./index-MBvvLjiN.js";import{P as te}from"./package-DUAJPvM6.js";import{C as ae}from"./circle-check-big-aK5XXc8q.js";import{C as se}from"./circle-x-IjGY2f6Z.js";import{P as le}from"./plus-BKVyIOGe.js";import{P as oe}from"./pencil-Wnn9pGcO.js";import{T as re}from"./trash-2-MM-roqNr.js";import"./index-DoagSzzV.js";import"./createLucideIcon-Coq8DOvK.js";import"./index-Cak9KJ6C.js";import"./index-DzFuXtkm.js";import"./sun-DZ5FTXo1.js";import"./index-BkYT2TiQ.js";import"./index-BF4Ii756.js";const ne={class:"page-wrapper"},ie={class:"row g-3 mb-4"},de={class:"card border-0 shadow-sm rounded-4"},ue={class:"card-body d-flex align-items-center"},ce={class:"mb-0 fw-bold"},pe={class:"text-muted mb-0 small"},ve={class:"card border-0 shadow-lg rounded-4"},me={class:"card-body"},ge={class:"d-flex flex-wrap gap-2 justify-content-between align-items-center mb-3"},be={class:"d-flex flex-wrap gap-2 align-items-center"},fe={class:"search-wrap"},_e={key:1,class:"form-control search-input rounded-pill",placeholder:"Search variants...",disabled:"",type:"text"},he={class:"table-responsive"},ye={class:"table table-striped"},xe={key:0},Ce={class:"fw-semibold"},Ve={class:"badge bg-secondary px-3 py-2 rounded-pill"},we={class:"text-center"},ke={class:"text-center"},Se={class:"d-inline-flex align-items-center gap-3"},Me=["onClick"],Ie=["title"],Be={title:"Delete",class:"p-2 rounded-full text-red-600 hover:bg-red-100"},Fe={key:2},Te={class:"modal fade",id:"variantModal",tabindex:"-1","aria-hidden":"true"},Ae={class:"modal-dialog modal-lg modal-dialog-centered"},$e={class:"modal-content rounded-4"},De={class:"modal-header"},Ee={class:"modal-title fw-semibold"},Le={class:"modal-body"},Ne={class:"row g-3"},Pe={class:"col-12"},je={key:0,class:"text-danger d-block"},Ue={class:"col-12"},Oe={key:0,class:"text-danger"},Ge={class:"col-md-6"},Ze={key:0,class:"text-danger"},qe={class:"col-md-6"},Re={key:0,class:"text-danger d-block"},Ye={class:"col-12"},ze={key:0,class:"text-danger"},He={class:"mt-4"},Ke=["disabled"],Xe={__name:"Variants",setup(Je){const v=u([]),F=u([]),r=u({name:"",variant_group_id:null,price_modifier:0,description:"",status:"active",sort_order:0}),m=u(null),h=u(!1),y=u(!1),l=u({}),j=[{label:"Active",value:"active"},{label:"Inactive",value:"inactive"}],k=async()=>{y.value=!0;try{const a=await f.get("/api/variants/all");v.value=a.data.data}catch(a){console.error("Failed to fetch variants:",a),d.error("Failed to load variants")}finally{y.value=!1}},U=async()=>{try{const a=await f.get("/api/variant-groups/all");F.value=a.data.data}catch(a){console.error("Failed to fetch variant groups:",a),d.error("Failed to load variant groups")}};X(async()=>{_.value="",T.value=Date.now(),await J(),setTimeout(()=>{A.value=!0;const a=document.getElementById(S);a&&(a.value="",_.value="")},100),k(),U()});const O=M(()=>[{label:"Total Variants",value:v.value.length,icon:te,iconBg:"bg-light-primary",iconColor:"text-primary"},{label:"Active Variants",value:v.value.filter(a=>a.status==="active").length,icon:ae,iconBg:"bg-light-success",iconColor:"text-success"},{label:"Inactive Variants",value:v.value.filter(a=>a.status==="inactive").length,icon:se,iconBg:"bg-light-danger",iconColor:"text-danger"}]),_=u(""),T=u(Date.now()),S=`search-${Math.random().toString(36).substr(2,9)}`,A=u(!1),$=M(()=>{const a=_.value.trim().toLowerCase();return a?v.value.filter(t=>t.name.toLowerCase().includes(a)||t.variant_group?.name.toLowerCase().includes(a)):v.value}),G=a=>{a.target.setAttribute("autocomplete","off")},Z=M(()=>F.value.filter(a=>a.status==="active").map(a=>({label:a.name,value:a.id}))),x=()=>{r.value={name:"",variant_group_id:null,price_modifier:0,description:"",status:"active",sort_order:0},m.value=null,l.value={}},q=a=>{m.value=a,r.value={name:a.name,variant_group_id:a.variant_group_id,price_modifier:parseFloat(a.price_modifier)||0,description:a.description||"",status:a.status,sort_order:a.sort_order||0};const t=document.getElementById("variantModal");new bootstrap.Modal(t).show()},R=async()=>{if(!r.value.variant_group_id){d.error("Please select a variant group");return}h.value=!0,l.value={};try{m.value?(await f.post(`/api/variants/${m.value.id}`,r.value),d.success("Variant updated successfully")):(await f.post("/api/variants",r.value),d.success("Variant created successfully")),bootstrap.Modal.getInstance(document.getElementById("variantModal"))?.hide(),x(),await k()}catch(a){if(console.error("❌ Error:",a.response?.data||a.message),a.response?.status===422&&a.response?.data?.errors){l.value=a.response.data.errors;const t=Object.values(a.response.data.errors).flat();d.error(t.join(`
`))}else{const t=a.response?.data?.message||"Failed to save variant";d.error(t)}}finally{h.value=!1}},Y=async a=>{const t=a.status==="active"?"inactive":"active";try{await f.patch(`/api/variants/${a.id}/toggle-status`,{status:t}),a.status=t,d.success(`Status changed to ${t}`)}catch(s){console.error("Failed to update status:",s),d.error("Failed to update status")}},z=async a=>{if(a?.id)try{await f.delete(`/api/variants/${a.id}`),d.success("Variant deleted successfully"),await k()}catch(t){console.error("❌ Delete error:",t.response?.data||t.message);const s=t.response?.data?.message||"Failed to delete variant";d.error(s)}};return(a,t)=>(o(),E(ee,null,{default:I(()=>[p(g(Q),{title:"Variants"}),e("div",ne,[t[21]||(t[21]=e("h4",{class:"fw-semibold mb-3"},"Variants Management",-1)),e("div",ie,[(o(!0),n(C,null,L(O.value,s=>(o(),n("div",{key:s.label,class:"col-md-6 col-xl-3"},[e("div",de,[e("div",ue,[e("div",{class:c([[s.iconBg,s.iconColor],"rounded-circle p-3 d-flex align-items-center justify-content-center me-3"]),style:{width:"56px",height:"56px"}},[(o(),E(W(s.icon),{class:"w-6 h-6"}))],2),e("div",null,[e("h3",ce,i(s.value),1),e("p",pe,i(s.label),1)])])])]))),128))]),e("div",ve,[e("div",me,[e("div",ge,[t[9]||(t[9]=e("h5",{class:"mb-0 fw-semibold"},"Variants",-1)),e("div",be,[e("div",fe,[t[6]||(t[6]=e("i",{class:"bi bi-search"},null,-1)),t[7]||(t[7]=e("input",{type:"email",name:"email",autocomplete:"email",style:{position:"absolute",left:"-9999px",width:"1px",height:"1px"},tabindex:"-1","aria-hidden":"true"},null,-1)),A.value?V((o(),n("input",{id:S,"onUpdate:modelValue":t[0]||(t[0]=s=>_.value=s),key:T.value,class:"form-control search-input rounded-pill",placeholder:"Search variants...",type:"search",autocomplete:"new-password",name:S,role:"presentation",onFocus:G},null,32)),[[w,_.value]]):(o(),n("input",_e))]),e("button",{"data-bs-toggle":"modal","data-bs-target":"#variantModal",onClick:x,class:"d-flex align-items-center gap-1 px-4 py-2 rounded-pill btn btn-primary text-white"},[p(g(le),{class:"w-4 h-4"}),t[8]||(t[8]=B(" Add Variant ",-1))])])]),e("div",he,[e("table",ye,[t[12]||(t[12]=e("thead",{class:"border-top small text-muted"},[e("tr",null,[e("th",null,"S.#"),e("th",null,"Name"),e("th",null,"Group"),e("th",{class:"text-center"},"Status"),e("th",{class:"text-center"},"Actions")])],-1)),e("tbody",null,[y.value?(o(),n("tr",xe,[...t[10]||(t[10]=[e("td",{colspan:"6",class:"text-center py-4"},[e("div",{class:"spinner-border text-primary",role:"status"},[e("span",{class:"visually-hidden"},"Loading...")])],-1)])])):(o(!0),n(C,{key:1},L($.value,(s,H)=>(o(),n("tr",{key:s.id},[e("td",null,i(H+1),1),e("td",Ce,i(s.name),1),e("td",null,[e("span",Ve,i(s.variant_group?.name||"N/A"),1)]),e("td",we,[e("span",{class:c(s.status==="active"?"badge bg-success px-4 py-2 rounded-pill":"badge bg-danger px-4 py-2 rounded-pill")},i(s.status==="active"?"Active":"Inactive"),3)]),e("td",ke,[e("div",Se,[e("button",{onClick:D=>q(s),title:"Edit",class:"p-2 rounded-full text-blue-600 hover:bg-blue-100"},[p(g(oe),{class:"w-4 h-4"})],8,Me),p(N,{title:"Confirm Status Change",message:`Are you sure you want to set ${s.name} to ${s.status==="active"?"Inactive":"Active"}?`,showStatusButton:!0,confirmText:"Yes, Change",cancelText:"Cancel",status:s.status,onConfirm:D=>Y(s)},{trigger:I(()=>[e("button",{class:c(["relative inline-flex items-center w-8 h-4 rounded-full transition-colors duration-300 focus:outline-none",s.status==="active"?"bg-green-500 hover:bg-green-600":"bg-red-400 hover:bg-red-500"]),title:s.status==="active"?"Set Inactive":"Set Active"},[e("span",{class:c(["absolute left-0.5 top-0.5 w-3 h-3 bg-white rounded-full shadow transform transition-transform duration-300",s.status==="active"?"translate-x-4":"translate-x-0"])},null,2)],10,Ie)]),_:2},1032,["message","status","onConfirm"]),p(N,{title:"Confirm Delete",message:`Are you sure you want to delete ${s.name}?`,confirmText:"Yes, Delete",cancelText:"Cancel",onConfirm:D=>z(s)},{trigger:I(()=>[e("button",Be,[p(g(re),{class:"w-4 h-4"})])]),_:1},8,["message","onConfirm"])])])]))),128)),!y.value&&$.value.length===0?(o(),n("tr",Fe,[...t[11]||(t[11]=[e("td",{colspan:"6",class:"text-center text-muted py-4"}," No variants found. ",-1)])])):b("",!0)])])])])]),e("div",Te,[e("div",Ae,[e("div",$e,[e("div",De,[e("h5",Ee,i(m.value?"Edit Variant":"Add New Variant"),1),e("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110",onClick:x,"data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[...t[13]||(t[13]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",Le,[e("div",Ne,[e("div",Pe,[t[14]||(t[14]=e("label",{class:"form-label"},"Variant Group ",-1)),p(g(P),{modelValue:r.value.variant_group_id,"onUpdate:modelValue":t[1]||(t[1]=s=>r.value.variant_group_id=s),options:Z.value,optionLabel:"label",optionValue:"value",placeholder:"Select a group",class:c(["form-select",{"is-invalid":l.value.variant_group_id}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","class"]),l.value.variant_group_id?(o(),n("small",je,i(l.value.variant_group_id[0]),1)):b("",!0)]),e("div",Ue,[t[15]||(t[15]=e("label",{class:"form-label"},"Variant Name ",-1)),V(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>r.value.name=s),type:"text",class:c(["form-control",{"is-invalid":l.value.name}]),placeholder:"e.g., Small, Medium, Large, Hot, Cold"},null,2),[[w,r.value.name]]),l.value.name?(o(),n("small",Oe,i(l.value.name[0]),1)):b("",!0)]),e("div",Ge,[t[16]||(t[16]=e("label",{class:"form-label"},"Status",-1)),p(g(P),{modelValue:r.value.status,"onUpdate:modelValue":t[3]||(t[3]=s=>r.value.status=s),options:j,optionLabel:"label",optionValue:"value",class:c(["form-select",{"is-invalid":l.value.status}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","class"]),l.value.status?(o(),n("small",Ze,i(l.value.status[0]),1)):b("",!0)]),e("div",qe,[t[17]||(t[17]=e("label",{class:"form-label"},"Sort Order",-1)),V(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>r.value.sort_order=s),type:"number",min:"0",class:c(["form-control",{"is-invalid":l.value.sort_order}]),placeholder:"0"},null,2),[[w,r.value.sort_order,void 0,{number:!0}]]),l.value.sort_order?(o(),n("small",Re,i(l.value.sort_order[0]),1)):b("",!0)]),e("div",Ye,[t[18]||(t[18]=e("label",{class:"form-label"},"Description (Optional)",-1)),V(e("textarea",{"onUpdate:modelValue":t[5]||(t[5]=s=>r.value.description=s),class:c(["form-control",{"is-invalid":l.value.description}]),rows:"3",placeholder:"Enter variant description..."},null,2),[[w,r.value.description]]),l.value.description?(o(),n("small",ze,i(l.value.description[0]),1)):b("",!0)])]),e("div",He,[e("button",{class:"btn btn-primary rounded-pill px-4",disabled:h.value,onClick:R},[h.value?(o(),n(C,{key:0},[t[19]||(t[19]=e("span",{class:"spinner-border spinner-border-sm me-2"},null,-1)),t[20]||(t[20]=B(" Saving... ",-1))],64)):(o(),n(C,{key:1},[B(i((m.value,"Save")),1)],64))],8,Ke),e("button",{class:"btn btn-secondary rounded-pill px-4 ms-2","data-bs-dismiss":"modal",onClick:x}," Cancel ")])])])])])])]),_:1}))}},mt=K(Xe,[["__scopeId","data-v-6333d53b"]]);export{mt as default};
