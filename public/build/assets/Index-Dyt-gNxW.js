import{_ as tt,r as x,y as vt,p as $,q as m,f as c,m as w,b as d,e as t,F as R,g as P,d as j,u as g,t as r,k as et,v as st,o as yt,n as _t,c as J,I as xt,a as K,w as St,h as wt,i as L,j as Ct,l as C}from"./app-BPm8Jqa8.js";import{_ as kt}from"./Master-B-oa1_ok.js";import{u as Tt}from"./useFormatters-SHi38_16.js";import{E as Z,a as T,u as U,w as Ft}from"./xlsx-DiILdRon.js";import{s as Dt}from"./index-Ddx3-wbt.js";import{P as Rt}from"./percent-BdcF9Ygw.js";import{c as lt}from"./createLucideIcon-CtC6jb4d.js";import{C as Pt}from"./calendar-BDkXBP5t.js";import{E as $t}from"./eye-BumU2KNP.js";import"./index-CkTwpF0O.js";import"./index-z4fDpXBL.js";import"./index-Cydqvc8x.js";import"./sun-BfHbTYSR.js";import"./index-CYhawANY.js";/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const It=lt("lock-open",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const At=lt("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),zt={key:0,class:"fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center z-50 p-4"},Mt={class:"relative bg-white rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden flex flex-col max-h-[90vh]"},Bt={class:"px-6 py-4 overflow-y-auto check-list-body flex-1"},Nt={class:"mb-6"},Et={class:"space-y-3 bg-gray-50 p-4 check-list-item rounded-lg max-h-64 overflow-y-auto grid grid-cols-2 gap-4"},Lt=["for"],jt={class:"text-sm font-medium text-gray-700 block"},Ot={key:0,class:"text-xs text-gray-500"},Yt={class:"mt-4 flex gap-2"},Vt={class:"flex justify-end gap-2 border-t border-gray-100 px-6 py-3 bg-gray-50"},Zt=["disabled"],Ut=["disabled"],Xt={key:0,class:"spinner-border spinner-border-sm"},Gt={__name:"CloseShiftModal",props:{show:{type:Boolean,default:!1},shiftId:{type:Number,required:!0},expectedClosingCash:{type:Number,default:0}},emits:["cancel","closed"],setup(O,{emit:a}){const S=O,B=a,F=x(!1),A=x([]),D=x({}),I=x("");vt(()=>S.show,async v=>{v&&await f()});const f=async()=>{try{const v=await $.get("/shift/checklist-items",{params:{type:"end"}});A.value=v.data.data,D.value={},A.value.forEach(b=>{D.value[b.id]=!1})}catch(v){console.error("Failed to fetch closing checklist items:",v),m.error("Failed to load closing checklist items")}},u=async()=>{if(I.value.trim())try{const v=await $.post("/shift/checklist-items/custom",{name:I.value,type:"end"});if(v.data.success){const b=v.data.data;A.value.push(b),D.value[b.id]=!0,I.value="",m.success("Custom checklist added successfully")}}catch(v){console.error("Failed to add custom checklist:",v),m.error("Failed to add custom checklist")}},z=async()=>{try{F.value=!0;const v=Object.keys(D.value).filter(k=>D.value[k]===!0),b=await $.patch(`/api/shift/${S.shiftId}/close`,{checklists:v});b.data.success&&(m.success(b.data.message||"Shift closed successfully!"),B("closed",b.data),b.data.redirect&&(window.location.href=b.data.redirect))}catch(v){console.error("Failed to close shift:",v),m.error(v.response?.data?.message||"Failed to close shift")}finally{F.value=!1}};return(v,b)=>O.show?(d(),c("div",zt,[t("div",Mt,[b[4]||(b[4]=t("div",{class:"px-6 py-4 border-b border-gray-100"},[t("h2",{class:"text-xl font-semibold text-gray-800"},"Close Shift"),t("p",{class:"text-sm mt-1 text-gray-600"}," Complete closing checklist items and add notes before closing the shift. ")],-1)),t("div",Bt,[t("div",Nt,[b[2]||(b[2]=t("h3",{class:"text-sm font-semibold text-white mb-3"}," Daily Closing Checklist ",-1)),b[3]||(b[3]=t("p",{class:"text-xs text-gray-600 mb-4"}," Complete all required checks before closing. You can add your own checks too. ",-1)),t("div",Et,[(d(!0),c(R,null,P(A.value,(k,N)=>(d(),c("div",{key:"item-"+N,class:"flex items-start gap-2"},[j(g(Dt),{modelValue:D.value[k.id],"onUpdate:modelValue":Y=>D.value[k.id]=Y,inputId:"check-"+N,binary:"",class:"cursor-pointer"},null,8,["modelValue","onUpdate:modelValue","inputId"]),t("label",{for:"check-"+N,class:"flex-1 cursor-pointer"},[t("span",jt,r(k.name),1),k.description?(d(),c("span",Ot,r(k.description),1)):w("",!0)],8,Lt)]))),128))]),t("div",Yt,[et(t("input",{"onUpdate:modelValue":b[0]||(b[0]=k=>I.value=k),type:"text",class:"form-control flex-1",placeholder:"Add your own check..."},null,512),[[st,I.value]]),t("button",{onClick:u,class:"btn btn-outline-secondary px-4 py-2 rounded-lg text-sm"}," Add ")])])]),t("div",Vt,[t("button",{onClick:b[1]||(b[1]=k=>v.$emit("cancel")),disabled:F.value,class:"btn btn-secondary py-2 px-4 rounded-pill"}," Cancel ",8,Zt),t("button",{onClick:z,disabled:F.value,class:"btn btn-danger py-2 px-4 rounded-pill flex items-center justify-center gap-2 transition disabled:opacity-50 disabled:cursor-not-allowed"},[F.value?(d(),c("span",Xt)):w("",!0),t("span",null,r(F.value?"Closing...":"Close Shift"),1)],8,Ut)])])])):w("",!0)}},qt=tt(Gt,[["__scopeId","data-v-9c478f0a"]]),Ht={class:"page-wrapper"},Qt={class:"row g-3"},Wt={class:"card border-0 shadow-sm rounded-4"},Jt={class:"card-body d-flex align-items-center"},Kt={class:"mb-0 fw-bold"},te={class:"text-muted mb-0 small"},ee={class:"card border-0 shadow-lg rounded-4 mt-0"},se={class:"card-body"},le={class:"d-flex flex-wrap gap-2 justify-content-between align-items-center mb-3"},oe={class:"d-flex flex-wrap gap-2 align-items-center"},ae={class:"search-wrap"},ne={key:1,class:"form-control search-input",placeholder:"Search",disabled:"",type:"text"},re={class:"dropdown"},ie={class:"dropdown-menu dropdown-menu-end shadow rounded-4 py-2"},de={class:"table-responsive"},ce={class:"table table-striped"},ue={class:"text-center"},he={class:"text-center"},me={class:"d-inline-flex align-items-center gap-3"},ge=["onClick"],pe=["onClick","title"],fe={key:0},be={key:0,class:"fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center z-50 p-4"},ve={class:"relative bg-white rounded-4 shadow-lg border-0 overflow-hidden"},ye={class:"modal-header align-items-center"},_e={class:"d-flex align-items-center gap-2"},xe={class:"d-flex flex-column"},Se={class:"text-muted"},we={class:"modal-body p-4 bg-light"},Ce={class:"row g-4"},ke={class:"col-lg-12"},Te={class:"card border-0 shadow-sm rounded-4 h-100"},Fe={class:"card-body"},De={key:0,class:"table-responsive"},Re={class:"table table-hover align-middle text-center mb-0"},Pe={class:"badge bg-primary rounded-pill"},$e={class:"fw-semibold"},Ie={key:1,class:"text-center py-5"},Ae={key:1,class:"fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center z-50 p-4"},ze={class:"relative bg-white rounded-4 shadow-lg border-0 max-w-2xl overflow-hidden max-h-[85vh] flex flex-col mt-5"},Me={class:"modal-header align-items-center"},Be={class:"d-flex align-items-center gap-2"},Ne={class:"d-flex flex-column"},Ee={class:"text-muted"},Le={key:0,class:"modal-body p-4 bg-light overflow-y-auto"},je={class:"row g-4"},Oe={class:"col-lg-12"},Ye={class:"card border-0 shadow-sm rounded-4 h-100"},Ve={class:"card-body"},Ze={class:"row"},Ue={class:"col-md-6"},Xe={class:"mb-2"},Ge={class:"mb-2"},qe={class:"mb-0"},He={class:"col-md-6"},Qe={class:"mb-2"},We={class:"badge bg-primary"},Je={class:"mb-0"},Ke={class:"col-md-6"},ts={class:"card border-0 shadow-sm rounded-4 h-100"},es={class:"card-body"},ss={class:"table-responsive"},ls={class:"table table-sm align-middle"},os={class:"text-end"},as={class:"text-end"},ns={class:"text-end"},rs={class:"text-end text-danger"},is={class:"border-top"},ds={class:"text-end"},cs={class:"col-md-6"},us={class:"card border-0 shadow-sm rounded-4 h-100"},hs={class:"card-body"},ms={class:"table-responsive"},gs={class:"table table-sm align-middle mb-0"},ps={class:"text-end"},fs={class:"text-end"},bs={class:"fw-bold border-top"},vs={class:"text-end"},ys={key:0,class:"col-12"},_s={class:"card border-0 shadow-sm rounded-4"},xs={class:"card-body"},Ss={class:"table-responsive"},ws={class:"table table-hover align-middle text-center mb-0"},Cs={class:"text-end pe-3"},ks={key:1,class:"col-12"},Ts={class:"card border-0 shadow-sm rounded-4"},Fs={class:"card-body"},Ds={class:"table-responsive"},Rs={class:"table table-hover align-middle text-center mb-0"},Ps={class:"badge bg-primary rounded-pill"},$s={class:"text-end pe-3"},Is={key:2,class:"col-12"},As={class:"card border-0 shadow-sm rounded-4"},zs={class:"card-body"},Ms={class:"table-responsive"},Bs={class:"table table-hover align-middle text-center mb-0"},Ns={class:"text-end pe-3"},Es={class:"modal-footer border-top-0 px-4 pb-4"},Ls={key:2,class:"fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center z-50 p-4"},js={class:"relative bg-white rounded-4 shadow-lg border-0 max-w-2xl overflow-hidden max-h-[85vh] flex flex-col mt-5"},Os={class:"modal-header align-items-center"},Ys={class:"d-flex align-items-center gap-2"},Vs={class:"d-flex flex-column"},Zs={class:"text-muted"},Us={key:0,class:"modal-body p-4 bg-light overflow-y-auto max-h-[70vh]"},Xs={class:"row g-4"},Gs={class:"col-lg-12"},qs={class:"card border-0 shadow-sm rounded-4 h-100"},Hs={class:"card-body"},Qs={class:"row"},Ws={class:"col-md-6"},Js={class:"mb-2"},Ks={class:"mb-2"},tl={class:"mb-0"},el={class:"col-md-6"},sl={class:"mb-2"},ll={class:"mb-2"},ol={class:"badge bg-danger"},al={class:"mb-0"},nl={class:"col-md-6"},rl={class:"card border-0 shadow-sm rounded-4 h-100"},il={class:"card-body"},dl={class:"table-responsive"},cl={class:"table table-sm align-middle"},ul={class:"text-end"},hl={class:"text-end"},ml={class:"text-end"},gl={class:"text-end text-danger"},pl={class:"border-top"},fl={class:"text-end"},bl={class:"text-end"},vl={class:"col-md-6"},yl={class:"card border-0 shadow-sm rounded-4 h-100"},_l={class:"card-body"},xl={class:"table-responsive"},Sl={class:"table table-sm align-middle mb-0"},wl={class:"text-end"},Cl={class:"text-end"},kl={class:"text-end fw-bold"},Tl={class:"text-end fw-bold"},Fl={class:"text-end fw-bold"},Dl={key:0,class:"col-12"},Rl={class:"card border-0 shadow-sm rounded-4"},Pl={class:"card-body"},$l={class:"table-responsive"},Il={class:"table table-hover align-middle text-center mb-0"},Al={class:"text-end pe-3"},zl={key:1,class:"col-12"},Ml={class:"card border-0 shadow-sm rounded-4"},Bl={class:"card-body"},Nl={class:"table-responsive"},El={class:"table table-hover align-middle text-center mb-0"},Ll={class:"badge bg-primary rounded-pill"},jl={class:"text-end pe-3"},Ol={key:2,class:"col-12"},Yl={class:"card border-0 shadow-sm rounded-4"},Vl={class:"card-body"},Zl={class:"table-responsive"},Ul={class:"table table-hover align-middle text-center mb-0"},Xl={class:"text-end pe-3"},Gl={key:3,class:"col-12"},ql={class:"card border-0 shadow-sm rounded-4"},Hl={class:"card-body"},Ql={class:"table-responsive"},Wl={class:"table table-hover align-middle text-center mb-0"},Jl={class:"fw-bold text-danger"},Kl={class:"modal-footer border-top-0 px-4 pb-4"},to={__name:"Index",setup(O){const{formatCurrencySymbol:a}=Tt(),S=x([]),B=x(!1),F=x([]),A=x(null),D=x(!1),I=x(!1),f=x(null),u=x(null),z=x(!1),v=x(null),b=async()=>{try{const i=await $.get("api/shift/all");S.value=i.data.data}catch(i){console.error("Failed to fetch shifts:",i),m.error("Failed to load shifts")}},k=i=>{i.status==="open"?(v.value=i,z.value=!0):N(i)},N=async i=>{try{const e=await $.patch(`/api/shift/${i.id}/reopen`,{status:"open"});e.data.success?(m.success(e.data.message||"Shift reopened successfully."),i.status="open",await b(),e.data.redirect&&(window.location.href=e.data.redirect)):m.error("Unexpected response from server.")}catch(e){console.error("Failed to reopen shift:",e),m.error(e.response?.data?.message||"Failed to reopen shift.")}},Y=async i=>{A.value=i.id,B.value=!0;try{const e=await $.get(`/api/shift/${i.id}/details`);F.value=e.data.data||[]}catch(e){console.error("Failed to fetch shift details:",e),m.error("Failed to load shift details")}},X=()=>{B.value=!1,F.value=[]};yt(async()=>{M.value="",G.value=Date.now(),await _t(),setTimeout(()=>{q.value=!0;const i=document.getElementById(V);i&&(i.value="",M.value="")},100),b()});const ot=J(()=>{const i=new Date().toISOString().split("T")[0];return[{label:"Total Shifts",value:S.value.length,icon:Rt,iconBg:"bg-light-primary",iconColor:"text-primary"},{label:"Open Shifts",value:S.value.filter(e=>e.status==="open").length,icon:It,iconBg:"bg-light-success",iconColor:"text-success"},{label:"Closed Shifts",value:S.value.filter(e=>e.status==="closed").length,icon:At,iconBg:"bg-light-warning",iconColor:"text-warning"},{label:"Today’s Shifts",value:S.value.filter(e=>e.start_time?new Date(e.start_time).toISOString().split("T")[0]===i:!1).length,icon:Pt,iconBg:"bg-light-danger",iconColor:"text-danger"}]}),M=x(""),G=x(Date.now()),V=`search-${Math.random().toString(36).substr(2,9)}`,q=x(!1),H=J(()=>{const i=M.value.trim().toLowerCase();return i?S.value.filter(e=>String(e.id).includes(i)||e.started_by&&e.started_by.toLowerCase().includes(i)||e.ended_by&&e.ended_by.toLowerCase().includes(i)||e.status&&e.status.toLowerCase().includes(i)||e.start_time&&e.start_time.toLowerCase().includes(i)||String(e.sales_total).includes(i)):S.value}),at=i=>i?new Date(i).toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit"}):"N/A";xt(()=>window.feather?.replace());const nt=i=>{z.value=!1,v.value=null,b()},rt=()=>{z.value=!1,v.value=null},it=i=>parseFloat(i.opening_cash||0)+parseFloat(i.sales_total||0),E=i=>{if(i==="x-report"){const l=S.value.find(s=>s.status==="open");if(!l){m.warning("No open shift found. X Report can only be generated for open shifts.");return}ht(l);return}if(i==="z-report"){const l=S.value.find(s=>s.status==="closed");if(!l){m.warning("No closed shift found. Z Report can only be generated for closed shifts.");return}gt(l);return}if(!S.value||S.value.length===0){m.error("No Shifts data to download");return}const e=M.value.trim()?H.value:S.value;if(e.length===0){m.error("No Shifts found to download");return}try{i==="pdf"?ct(e):i==="excel"?ut(e):i==="csv"?dt(e):m.error("Invalid download type")}catch(l){console.error("Download failed:",l),m.error(`Download failed: ${l.message}`)}},dt=i=>{try{const e=["Shift ID","Started By","Ended By","Status","Start Time","End Time","Sales Total"],l=i.map(_=>{const n=_.start_time?new Date(_.start_time).toLocaleString("en-GB"):"N/A",h=_.end_time?new Date(_.end_time).toLocaleString("en-GB"):"N/A",bt=_.sales_total?a(_.sales_total):"0.00";return[`"${_.id||""}"`,`"${_.started_by||""}"`,`"${_.ended_by||""}"`,`"${_.status||""}"`,`"${n}"`,`"${h}"`,`"${bt}"`]}),s=[e.join(","),...l.map(_=>_.join(","))].join(`
`),o=new Blob([s],{type:"text/csv;charset=utf-8;"}),p=URL.createObjectURL(o),y=document.createElement("a");y.setAttribute("href",p),y.setAttribute("download",`shifts_${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(y),y.click(),document.body.removeChild(y),m.success("CSV downloaded successfully",{autoClose:2500})}catch(e){console.error("CSV generation error:",e),m.error(`CSV generation failed: ${e.message}`,{autoClose:5e3})}},ct=i=>{try{const e=new Z("p","mm","a4");e.setFontSize(18),e.setFont("helvetica","bold"),e.text("Shifts Report",75,20),e.setFontSize(10),e.setFont("helvetica","normal");const l=new Date().toLocaleString();e.text(`Generated on: ${l}`,14,28),e.text(`Total Shifts: ${i.length}`,14,34);const s=["Shift ID","Started By","Ended By","Status","Start Time","End Time","Sales Total"],o=i.map(y=>{const _=y.start_time?new Date(y.start_time).toLocaleString("en-GB"):"N/A",n=y.end_time?new Date(y.end_time).toLocaleString("en-GB"):"N/A",h=y.sales_total?a(y.sales_total):"0.00";return[y.id||"",y.started_by||"",y.ended_by||"",y.status||"",_,n,h]});T(e,{head:[s],body:o,startY:40,styles:{fontSize:8,cellPadding:2,halign:"left",lineColor:[0,0,0],lineWidth:.1},headStyles:{fillColor:[41,128,185],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]},margin:{left:14,right:14},didDrawPage:y=>{const _=e.internal.getNumberOfPages(),n=e.internal.pageSize.height;e.setFontSize(8),e.text(`Page ${y.pageNumber} of ${_}`,y.settings.margin.left,n-10)}});const p=`shifts_${new Date().toISOString().split("T")[0]}.pdf`;e.save(p),m.success("PDF downloaded successfully",{autoClose:2500})}catch(e){console.error("PDF generation error:",e),m.error(`PDF generation failed: ${e.message}`,{autoClose:5e3})}},ut=i=>{try{const e=i.map(p=>{const y=p.start_time?new Date(p.start_time).toLocaleString("en-GB"):"N/A",_=p.end_time?new Date(p.end_time).toLocaleString("en-GB"):"N/A",n=p.sales_total?a(p.sales_total):"0.00";return{"Shift ID":p.id||"","Started By":p.started_by||"","Ended By":p.ended_by||"",Status:p.status||"","Start Time":y,"End Time":_,"Sales Total":n}}),l=U.json_to_sheet(e),s=U.book_new();U.book_append_sheet(s,l,"Shifts");const o=`shifts_${new Date().toISOString().split("T")[0]}.xlsx`;Ft(s,o),m.success("Excel downloaded successfully",{autoClose:2500})}catch(e){console.error("Excel generation error:",e),m.error(`Excel generation failed: ${e.message}`,{autoClose:5e3})}},ht=async i=>{if(i.status!=="open"){m.warning("X Report can only be generated for open shifts");return}try{const e=await $.get(`/api/shift/${i.id}/x-report`);e.data.success&&(f.value=e.data.data,D.value=!0,m.success("X Report generated successfully"))}catch(e){console.error("Failed to generate X Report:",e),m.error(e.response?.data?.message||"Failed to generate X Report")}},Q=()=>{D.value=!1,f.value=null},mt=async i=>{try{const e=await $.get(`/api/shift/${i}/x-report/pdf`);if(!e.data.success){m.error("Failed to generate X Report PDF");return}const l=e.data.data,s=new Z("p","mm","a4");s.setFontSize(18),s.setFont("helvetica","bold"),s.text(l.title,105,20,{align:"center"}),s.setFontSize(10),s.setFont("helvetica","normal"),s.text(`Generated: ${l.generatedDate}`,14,28),s.setFontSize(12),s.setFont("helvetica","bold"),s.text("Shift Information",14,38),s.setFontSize(10),s.setFont("helvetica","normal"),s.text(`Shift ID: ${l.shiftId}`,14,46),s.text(`Started By: ${l.startedBy}`,14,52),s.text(`Start Time: ${l.startTime}`,14,58),s.text(`Opening Cash: £${l.openingCash}`,14,64),s.setFontSize(12),s.setFont("helvetica","bold"),s.text("Sales Summary",14,75);const o=[["Total Orders",l.salesSummary.total_orders.toString()],["Subtotal","£"+a(l.salesSummary.subtotal)],["Tax","£"+a(l.salesSummary.total_tax)],["Discount","£"+a(l.salesSummary.total_discount)],["Total Sales","£"+a(l.salesSummary.total_sales)]];T(s,{head:[["Description","Amount"]],body:o,startY:0,theme:"grid",styles:{fontSize:9,cellPadding:3,halign:"left"},headStyles:{fillColor:[41,128,185],textColor:255,fontStyle:"bold",halign:"center"},alternateRowStyles:{fillColor:[245,245,245]},columnStyles:{1:{halign:"right"}},margin:{left:14,right:14}});let p=s.lastAutoTable.finalY+10;p>250&&(s.addPage(),p=14),s.setFontSize(12),s.setFont("helvetica","bold"),s.text("Cash Summary",14,p);const y=[["Opening Cash","£"+a(l.cashSummary.opening_cash)],["Cash Sales","£"+a(l.cashSummary.cash_sales)],["Expected Cash","£"+a(l.cashSummary.expected_cash)]];if(T(s,{head:[["Description","Amount"]],body:y,startY:p+5,theme:"grid",styles:{fontSize:9,cellPadding:3,halign:"left"},headStyles:{fillColor:[243,156,18],textColor:255,fontStyle:"bold",halign:"center"},alternateRowStyles:{fillColor:[255,243,205]},columnStyles:{1:{halign:"right"}},margin:{left:14,right:14}}),l.paymentMethods.length>0){p=s.lastAutoTable.finalY+10,p>250&&(s.addPage(),p=14),s.setFontSize(12),s.setFont("helvetica","bold"),s.text("Payment Methods",14,p);const _=l.paymentMethods.map(n=>[n.method,n.count.toString(),"£"+a(n.total)]);T(s,{head:[["Method","Count","Total"]],body:_,startY:p+5,theme:"grid",styles:{fontSize:9,cellPadding:3},headStyles:{fillColor:[52,152,219],textColor:255,fontStyle:"bold",halign:"center"},columnStyles:{1:{halign:"center"},2:{halign:"right"}},margin:{left:14,right:14}})}if(l.topItems.length>0){p=s.lastAutoTable.finalY+10,p>250&&(s.addPage(),p=14),s.setFontSize(12),s.setFont("helvetica","bold"),s.text("Top Selling Items",14,p);const _=l.topItems.map(n=>[n.name,n.total_qty.toString(),"£"+a(n.total_revenue)]);T(s,{head:[["Item","Qty","Revenue"]],body:_,startY:p+5,theme:"grid",styles:{fontSize:9,cellPadding:3},headStyles:{fillColor:[231,76,60],textColor:255,fontStyle:"bold",halign:"center"},columnStyles:{1:{halign:"center"},2:{halign:"right"}},margin:{left:14,right:14}})}s.save(e.data.fileName),m.success("X Report PDF downloaded successfully")}catch(e){console.error("Failed to download X Report PDF:",e),m.error(e.response?.data?.message||"Failed to download X Report PDF")}},gt=async i=>{if(i.status!=="closed"){m.warning("Z Report can only be generated for closed shifts");return}try{const e=await $.get(`/api/shift/${i.id}/z-report`);e.data.success&&(u.value=e.data.data,I.value=!0,m.success("Z Report generated successfully"))}catch(e){console.error("Failed to generate Z Report:",e),m.error(e.response?.data?.message||"Failed to generate Z Report")}},W=()=>{I.value=!1,u.value=null},pt=async i=>{try{const e=await $.get(`/api/shift/${i}/z-report/pdf`);if(!e.data.success){m.error("Failed to generate Z Report PDF");return}const l=e.data.data,s=new Z("p","mm","a4");let o=20;s.setFontSize(16),s.setFont("helvetica","bold"),s.text("Daily Summary Report",105,o,{align:"center"}),o+=6,s.setFontSize(12),s.text("All Brands",105,o,{align:"center"}),o+=6,s.setFontSize(10),s.setFont("helvetica","normal"),s.text(l.generatedDate,105,o,{align:"center"}),o+=10,s.setFillColor(0,0,0),s.rect(14,o,182,8,"F"),s.setTextColor(255,255,255),s.setFontSize(11),s.setFont("helvetica","bold"),s.text("Float Session",105,o+5.5,{align:"center"}),s.setTextColor(0,0,0),o+=12,s.setFontSize(9),s.setFont("helvetica","normal"),[["Started by",l.startedBy],["Started at",l.startTime],["Closed at",l.endTime],["Closed by",l.endedBy],["Opening Cash",a(l.cashReconciliation.opening_cash)],["Cash Expenses",a(l.cashReconciliation.cash_expenses||0)],["Cash Transfers ",a(l.cashReconciliation.cash_transfers||0)],["Cash Changed",a(l.cashReconciliation.cash_changed||0)],["Cash Sales ",a(l.cashReconciliation.cash_sales)],["Cash Refunds",a(l.cashReconciliation.cash_refunds||0)],["Estimated Closing Balance",a(l.cashReconciliation.expected_cash)]].forEach(([n,h])=>{s.text(n,16,o),s.text(h,190,o,{align:"right"}),o+=5}),o+=5,s.setFillColor(0,0,0),s.rect(14,o,182,8,"F"),s.setTextColor(255,255,255),s.setFont("helvetica","bold"),s.text("Float Session Journal",105,o+5.5,{align:"center"}),s.setTextColor(0,0,0),o+=12,s.setFont("helvetica","normal"),s.text("Deposits        Till Deposits",16,o),s.text("0.00",190,o,{align:"right"}),o+=5,s.text("Withdrawals Till Withdrawals",16,o),s.text("0.00",190,o,{align:"right"}),o+=5,s.text("Total",16,o),s.text("0.00",190,o,{align:"right"}),o+=10,s.setFillColor(0,0,0),s.rect(14,o,182,8,"F"),s.setTextColor(255,255,255),s.setFont("helvetica","bold"),s.text("Sales Summary",105,o+5.5,{align:"center"}),s.setTextColor(0,0,0),o+=12,s.setFont("helvetica","normal"),[["Sales Count",l.salesSummary.total_orders.toString()],["Average Ticket Size",a(l.salesSummary.avg_order_value)],["",""],["Retail Price",a(l.salesSummary.subtotal+l.salesSummary.total_tax)],["Discount *",a(l.salesSummary.total_discount)],["Refund **",a(0)],["Net Retail Price",a(l.salesSummary.total_sales)],["Net Charges ?",a(l.salesSummary.total_charges||0)],["Sale Price",a(l.salesSummary.subtotal)],["Tax ?",a(l.salesSummary.total_tax)],["Sale Price Inclusive of Tax",a(l.salesSummary.total_sales)],["",""],["Paid Amount",a(l.salesSummary.total_sales)],["Net Paid Amount",a(l.salesSummary.total_sales)],["Balance",a(0)]].forEach(([n,h])=>{n===""?o+=3:(s.text(n,16,o),s.text(h,190,o,{align:"right"}),o+=5)}),o>250&&(s.addPage(),o=20),o+=5,s.text("Net Cash Receipts",16,o),s.text(a(l.cashReconciliation.cash_sales),190,o,{align:"right"}),o+=5,l.paymentMethods.forEach(n=>{n.method.toLowerCase()!=="cash"&&(s.text(`Net ${n.method} Receipts`,16,o),s.text(a(n.net),190,o,{align:"right"}),o+=5)}),s.text("Net Online Payment Receipts",16,o);const _=l.paymentMethods.filter(n=>["online","card"].includes(n.method.toLowerCase())).reduce((n,h)=>n+h.net,0);s.text(a(_),190,o,{align:"right"}),o+=5,s.text("Net Other Receipts",16,o),s.text("£0.00",190,o,{align:"right"}),o+=8,s.text("Unpaid Sales Count",16,o),s.text(a(0),190,o,{align:"right"}),o+=5,s.text("Unpaid Sales Amount",16,o),s.text(a(0),190,o,{align:"right"}),o>220&&(s.addPage(),o=20),o+=10,s.setFillColor(0,0,0),s.rect(14,o,182,8,"F"),s.setTextColor(255,255,255),s.setFont("helvetica","bold"),s.text("Sales VAT",105,o+5.5,{align:"center"}),s.setTextColor(0,0,0),o+=12,T(s,{head:[["Tax %","Count","Sale*","Tax*"]],body:[["0.00 %","1","£1.00","£0.00"],["20.00 %",l.salesSummary.total_orders-1,a(l.salesSummary.subtotal-1),a(l.salesSummary.total_tax)]],foot:[["Total",l.salesSummary.total_orders,a(l.salesSummary.subtotal),a(l.salesSummary.total_tax)]],startY:o,theme:"grid",styles:{fontSize:9,cellPadding:3},headStyles:{fillColor:[0,0,0],textColor:255,fontStyle:"bold",halign:"center"},footStyles:{fillColor:[240,240,240],fontStyle:"bold"},columnStyles:{0:{halign:"left"},1:{halign:"center"},2:{halign:"right"},3:{halign:"right"}},margin:{left:14,right:14}}),o=s.lastAutoTable.finalY+10,l.salesSummary.total_refunds>0?(s.setFillColor(0,0,0),s.rect(14,o,182,8,"F"),s.setTextColor(255,255,255),s.text("Sale Refunds",105,o+5.5,{align:"center"}),s.setTextColor(0,0,0),o+=12):(s.setFillColor(0,0,0),s.rect(14,o,182,8,"F"),s.setTextColor(255,255,255),s.text("Sale Refunds",105,o+5.5,{align:"center"}),s.setTextColor(0,0,0),o+=12,s.setFont("helvetica","normal"),s.text("No Data Available",105,o,{align:"center"}),o+=10),o>230&&(s.addPage(),o=20),s.setFillColor(0,0,0),s.rect(14,o,182,8,"F"),s.setTextColor(255,255,255),s.text("Sale Cancellations",105,o+5.5,{align:"center"}),s.setTextColor(0,0,0),o+=12,(!l.cancelled_items||l.cancelled_items.length===0)&&(s.setFont("helvetica","normal"),s.text("No Data Available",105,o,{align:"center"}),o+=10),o>230&&(s.addPage(),o=20),s.setFillColor(0,0,0),s.rect(14,o,182,8,"F"),s.setTextColor(255,255,255),s.text("Venue Sales",105,o+5.5,{align:"center"}),s.setTextColor(0,0,0),o+=12,l.venue_sales&&l.venue_sales.length>0&&(T(s,{head:[["Venue","Count","Amount"]],body:l.venue_sales.map(n=>[n.venue,n.count,a(n.amount)]),foot:[["Total",l.venue_sales.reduce((n,h)=>n+h.count,0),a(l.venue_sales.reduce((n,h)=>n+h.amount,0))]],startY:o,theme:"grid",styles:{fontSize:9,cellPadding:3},headStyles:{fillColor:[0,0,0],textColor:255,fontStyle:"bold",halign:"center"},footStyles:{fillColor:[240,240,240],fontStyle:"bold"},columnStyles:{1:{halign:"center"},2:{halign:"right"}},margin:{left:14,right:14}}),o=s.lastAutoTable.finalY+10),o>230&&(s.addPage(),o=20),s.setFillColor(0,0,0),s.rect(14,o,182,8,"F"),s.setTextColor(255,255,255),s.text("Dispatch Sales",105,o+5.5,{align:"center"}),s.setTextColor(0,0,0),o+=12,l.dispatch_sales&&l.dispatch_sales.length>0&&(T(s,{head:[["Dispatch Type","Count","Amount"]],body:l.dispatch_sales.map(n=>[n.type,n.count,a(n.amount)]),foot:[["Total",l.dispatch_sales.reduce((n,h)=>n+h.count,0),a(l.dispatch_sales.reduce((n,h)=>n+h.amount,0))]],startY:o,theme:"grid",styles:{fontSize:9,cellPadding:3},headStyles:{fillColor:[0,0,0],textColor:255,fontStyle:"bold",halign:"center"},footStyles:{fillColor:[240,240,240],fontStyle:"bold"},columnStyles:{1:{halign:"center"},2:{halign:"right"}},margin:{left:14,right:14}}),o=s.lastAutoTable.finalY+10),o>210&&(s.addPage(),o=20),s.setFillColor(0,0,0),s.rect(14,o,182,8,"F"),s.setTextColor(255,255,255),s.text("Payment Method Sales",105,o+5.5,{align:"center"}),s.setTextColor(0,0,0),o+=12,T(s,{head:[["Pay Method","Receipts","Refunds","Net"]],body:l.paymentMethods.map(n=>[n.method,a(n.receipts),a(n.refunds),a(n.net)]),foot:[["Total",a(l.paymentMethods.reduce((n,h)=>n+h.receipts,0)),a(l.paymentMethods.reduce((n,h)=>n+h.refunds,0)),a(l.paymentMethods.reduce((n,h)=>n+h.net,0))]],startY:o,theme:"grid",styles:{fontSize:9,cellPadding:3},headStyles:{fillColor:[0,0,0],textColor:255,fontStyle:"bold",halign:"center"},footStyles:{fillColor:[240,240,240],fontStyle:"bold"},columnStyles:{0:{halign:"left"},1:{halign:"right"},2:{halign:"right"},3:{halign:"right"}},margin:{left:14,right:14}}),o=s.lastAutoTable.finalY+10,o>210&&(s.addPage(),o=20),s.setFillColor(0,0,0),s.rect(14,o,182,8,"F"),s.setTextColor(255,255,255),s.text("Menu Categories Summary",105,o+5.5,{align:"center"}),s.setTextColor(0,0,0),o+=12,l.menu_category_summary&&l.menu_category_summary.length>0&&(T(s,{head:[["Menu Category","Count","Amount*"]],body:l.menu_category_summary.map(n=>[n.category,n.count,a(n.amount)]),foot:[["Total",l.menu_category_summary.reduce((n,h)=>n+h.count,0),a(l.menu_category_summary.reduce((n,h)=>n+h.amount,0))]],startY:o,theme:"grid",styles:{fontSize:9,cellPadding:3},headStyles:{fillColor:[0,0,0],textColor:255,fontStyle:"bold",halign:"center"},footStyles:{fillColor:[240,240,240],fontStyle:"bold"},columnStyles:{1:{halign:"center"},2:{halign:"right"}},margin:{left:14,right:14}}),o=s.lastAutoTable.finalY+10),o>240&&(s.addPage(),o=20),s.setFillColor(0,0,0),s.rect(14,o,182,8,"F"),s.setTextColor(255,255,255),s.text("Covers Sales Summary",105,o+5.5,{align:"center"}),s.setTextColor(0,0,0),o+=12,s.setFont("helvetica","normal"),s.text("Total number of covers",16,o),s.text(l.covers_summary?.total_covers.toString()||"0",190,o,{align:"right"}),o+=5,s.text("Average revenue per cover",16,o),s.text(a(l.covers_summary?.avg_revenue_per_cover||0),190,o,{align:"right"}),o+=10,s.setFillColor(0,0,0),s.rect(14,o,182,8,"F"),s.setTextColor(255,255,255),s.text("Sale Discounts",105,o+5.5,{align:"center"}),s.setTextColor(0,0,0),o+=12,l.discounts_summary&&l.discounts_summary.length>0&&(T(s,{head:[["Discount Type","Count","Amount"]],body:l.discounts_summary.map(n=>[n.type,n.count,a(n.amount)]),foot:[["Total",l.discounts_summary.reduce((n,h)=>n+h.count,0),a(l.discounts_summary.reduce((n,h)=>n+h.amount,0))]],startY:o,theme:"grid",styles:{fontSize:9,cellPadding:3},headStyles:{fillColor:[0,0,0],textColor:255,fontStyle:"bold",halign:"center"},footStyles:{fillColor:[240,240,240],fontStyle:"bold"},columnStyles:{1:{halign:"center"},2:{halign:"right"}},margin:{left:14,right:14}}),o=s.lastAutoTable.finalY+10),o>230&&(s.addPage(),o=20),s.setFillColor(0,0,0),s.rect(14,o,182,8,"F"),s.setTextColor(255,255,255),s.text("Sale Charges",105,o+5.5,{align:"center"}),s.setTextColor(0,0,0),o+=12,l.charges_summary&&l.charges_summary.length>0&&(T(s,{head:[["Scheme","Count","Amount","Tax"]],body:l.charges_summary.map(n=>[n.scheme,n.count,a(n.amount),a(n.tax)]),foot:[["Total",l.charges_summary.reduce((n,h)=>n+h.count,0),a(l.charges_summary.reduce((n,h)=>n+h.amount,0)),a(l.charges_summary.reduce((n,h)=>n+h.tax,0))]],startY:o,theme:"grid",styles:{fontSize:9,cellPadding:3},headStyles:{fillColor:[0,0,0],textColor:255,fontStyle:"bold",halign:"center"},footStyles:{fillColor:[240,240,240],fontStyle:"bold"},columnStyles:{1:{halign:"center"},2:{halign:"right"},3:{halign:"right"}},margin:{left:14,right:14}}),o=s.lastAutoTable.finalY+10),s.save(e.data.fileName),m.success("Z Report PDF downloaded successfully")}catch(e){console.error("Failed to download Z Report PDF:",e),m.error(e.response?.data?.message||"Failed to download Z Report PDF")}},ft=async i=>{try{const e=await $.post(`/api/printers/${i}/z-report/print`);e.data.success?m.success("Z Report sent to printer successfully"):m.error(e.data.message||"Print failed")}catch(e){console.error("Print failed:",e),m.error("Unable to connect to the printer. Please ensure it is properly connected.")}};return(i,e)=>(d(),K(kt,null,{default:St(()=>[j(g(wt),{title:"Promo"}),t("div",Ht,[e[84]||(e[84]=t("h4",{class:"fw-semibold mb-3"},"Shift Management",-1)),t("div",Qt,[(d(!0),c(R,null,P(ot.value,l=>(d(),c("div",{key:l.label,class:"col-md-6 col-xl-3"},[t("div",Wt,[t("div",Jt,[t("div",{class:L([[l.iconBg,l.iconColor],"rounded-circle p-3 d-flex align-items-center justify-content-center me-3"]),style:{width:"56px",height:"56px"}},[(d(),K(Ct(l.icon),{class:"w-6 h-6"}))],2),t("div",null,[t("h3",Kt,r(l.value),1),t("p",te,r(l.label),1)])])])]))),128))]),t("div",ee,[t("div",se,[t("div",le,[e[14]||(e[14]=t("h5",{class:"mb-0 fw-semibold"},"shifts",-1)),t("div",oe,[t("div",ae,[e[10]||(e[10]=t("i",{class:"bi bi-search"},null,-1)),e[11]||(e[11]=t("input",{type:"email",name:"email",autocomplete:"email",style:{position:"absolute",left:"-9999px",width:"1px",height:"1px"},tabindex:"-1","aria-hidden":"true"},null,-1)),q.value?et((d(),c("input",{id:V,"onUpdate:modelValue":e[0]||(e[0]=l=>M.value=l),key:G.value,class:"form-control search-input",placeholder:"Search",type:"search",autocomplete:"new-password",name:V,role:"presentation",onFocus:e[1]||(e[1]=(...l)=>i.handleFocus&&i.handleFocus(...l))},null,32)),[[st,M.value]]):(d(),c("input",ne))]),t("div",re,[e[13]||(e[13]=t("button",{class:"btn btn-outline-secondary btn-sm rounded-pill py-2 px-4 dropdown-toggle","data-bs-toggle":"dropdown"}," Export ",-1)),t("ul",ie,[t("li",null,[t("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:e[2]||(e[2]=l=>E("pdf"))},"Export as PDF")]),t("li",null,[t("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:e[3]||(e[3]=l=>E("excel"))},"Export as Excel")]),t("li",null,[t("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:e[4]||(e[4]=l=>E("csv"))}," Export as CSV ")]),e[12]||(e[12]=t("li",null,[t("hr",{class:"dropdown-divider"})],-1)),t("li",null,[t("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:e[5]||(e[5]=l=>E("x-report"))}," Generate X Report ")]),t("li",null,[t("a",{class:"dropdown-item py-2",href:"javascript:;",onClick:e[6]||(e[6]=l=>E("z-report"))}," Generate Z Report ")])])])])]),t("div",de,[t("table",ce,[e[16]||(e[16]=t("thead",{class:"border-top small text-muted"},[t("tr",null,[t("th",null,"#"),t("th",null,"Shift ID"),t("th",null,"Started By"),t("th",null,"Start Time"),t("th",null,"Opening Cash"),t("th",null,"Closing Cash"),t("th",null,"Sales Total"),t("th",null,"Closed By"),t("th",{class:"text-center"},"Status"),t("th",{class:"text-center"},"Action")])],-1)),t("tbody",null,[(d(!0),c(R,null,P(H.value,(l,s)=>(d(),c("tr",{key:l.id},[t("td",null,r(s+1),1),t("td",null,"#"+r(l.id),1),t("td",null,r(l.started_by||"N/A"),1),t("td",null,r(at(l.start_time)),1),t("td",null,r(g(a)(l.opening_cash)),1),t("td",null,r(g(a)(l.closing_cash)),1),t("td",null,r(g(a)(l.sales_total)),1),t("td",null,r(l.ended_by||"N/A"),1),t("td",ue,[t("span",{class:L(l.status==="open"?"badge bg-success px-4 py-2 rounded-pill":"badge bg-danger px-4 py-2 rounded-pill")},r(l.status==="open"?"Open":"Closed"),3)]),t("td",he,[t("div",me,[t("button",{onClick:o=>Y(l),title:"View Shift",class:"p-2 rounded-full text-blue-600 hover:bg-blue-100"},[j(g($t),{class:"w-4 h-4"})],8,ge),t("button",{onClick:o=>k(l),class:L(["relative inline-flex items-center w-10 h-5 rounded-full transition-colors duration-300 focus:outline-none",l.status==="open"?"bg-green-500 hover:bg-green-600":"bg-red-400 hover:bg-red-500"]),title:l.status==="open"?"Close Shift":"Reopen Shift"},[t("span",{class:L(["absolute left-0.5 top-0.5 w-4 h-4 bg-white rounded-full shadow transform transition-transform duration-300",l.status==="open"?"translate-x-5":"translate-x-0"])},null,2)],10,pe)])])]))),128)),S.value.length?w("",!0):(d(),c("tr",fe,[...e[15]||(e[15]=[t("td",{colspan:"10",class:"text-center text-muted py-4"}," No shifts found. ",-1)])]))])])])])]),B.value?(d(),c("div",be,[t("div",ve,[t("div",ye,[t("div",_e,[e[18]||(e[18]=t("span",{class:"badge bg-primary rounded-circle p-2"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),t("div",xe,[e[17]||(e[17]=t("h5",{class:"modal-title mb-0"},"Shift Details",-1)),t("small",Se,"ID: "+r(A.value),1)])]),t("button",{onClick:X,class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","aria-label":"Close",title:"Close"},[...e[19]||(e[19]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-danger",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",we,[t("div",Ce,[t("div",ke,[t("div",Te,[t("div",Fe,[e[22]||(e[22]=t("h6",{class:"fw-semibold mb-3"},"Shift Information",-1)),F.value.length?(d(),c("div",De,[t("table",Re,[e[20]||(e[20]=t("thead",{class:"table-light"},[t("tr",null,[t("th",{class:"fw-semibold"},"Shift ID"),t("th",{class:"fw-semibold"},"Role"),t("th",{class:"fw-semibold"},"Start Date"),t("th",{class:"fw-semibold"},"Sales Amount")])],-1)),t("tbody",null,[(d(!0),c(R,null,P(F.value,(l,s)=>(d(),c("tr",{key:s},[t("td",null,r(A.value),1),t("td",null,[t("span",Pe,r(l.role||"N/A"),1)]),t("td",null,r(new Date(l.joined_at).toLocaleString()),1),t("td",$e,r(g(a)(l.sales_amount||0)),1)]))),128))])])])):(d(),c("div",Ie,[...e[21]||(e[21]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5",class:"text-muted mx-auto mb-3"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})],-1),t("p",{class:"text-muted mb-0"},"No details available for this shift.",-1)])]))])])])])]),t("div",{class:"modal-footer border-top-0 px-4 pb-4"},[t("button",{class:"btn btn-secondary px-4 rounded-pill",onClick:X}," Close ")])])])):w("",!0),D.value?(d(),c("div",Ae,[t("div",ze,[t("div",Me,[t("div",Be,[e[24]||(e[24]=t("span",{class:"badge bg-primary rounded-circle p-2"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),t("div",Ne,[e[23]||(e[23]=t("h5",{class:"modal-title mb-0"},"X Report",-1)),t("small",Ee,"Shift ID: "+r(f.value?.shift_id),1)])]),t("button",{onClick:Q,class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","aria-label":"Close",title:"Close"},[...e[25]||(e[25]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-danger",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),f.value?(d(),c("div",Le,[t("div",je,[t("div",Oe,[t("div",Ye,[t("div",Ve,[e[32]||(e[32]=t("h6",{class:"fw-semibold mb-3"},"Shift Information",-1)),t("div",Ze,[t("div",Ue,[t("p",Xe,[e[26]||(e[26]=t("strong",null,"Started By:",-1)),C(" "+r(f.value.started_by),1)]),t("p",Ge,[e[27]||(e[27]=t("strong",null,"Start Time:",-1)),C(" "+r(new Date(f.value.start_time).toLocaleString()),1)]),t("p",qe,[e[28]||(e[28]=t("strong",null,"Opening Cash:",-1)),C(" "+r(g(a)(f.value.opening_cash)),1)])]),t("div",He,[t("p",Qe,[e[29]||(e[29]=t("strong",null,"Status:",-1)),e[30]||(e[30]=C()),t("span",We,r(f.value.status),1)]),t("p",Je,[e[31]||(e[31]=t("strong",null,"Generated At:",-1)),C(" "+r(new Date(f.value.generated_at).toLocaleString()),1)])])])])])]),t("div",Ke,[t("div",ts,[t("div",es,[e[38]||(e[38]=t("h6",{class:"fw-semibold mb-3"},"Sales Summary",-1)),t("div",ss,[t("table",ls,[t("tr",null,[e[33]||(e[33]=t("td",null,"Total Orders:",-1)),t("td",os,r(f.value.sales_summary.total_orders),1)]),t("tr",null,[e[34]||(e[34]=t("td",null,"Subtotal:",-1)),t("td",as,r(g(a)(f.value.sales_summary.subtotal)),1)]),t("tr",null,[e[35]||(e[35]=t("td",null,"Tax:",-1)),t("td",ns,r(g(a)(f.value.sales_summary.total_tax)),1)]),t("tr",null,[e[36]||(e[36]=t("td",null,"Discount:",-1)),t("td",rs,"-"+r(g(a)(f.value.sales_summary.total_discount)),1)]),t("tr",is,[e[37]||(e[37]=t("td",null,"Total Sales:",-1)),t("td",ds,r(g(a)(f.value.sales_summary.total_sales)),1)])])])])])]),t("div",cs,[t("div",us,[t("div",hs,[e[42]||(e[42]=t("h6",{class:"fw-semibold mb-3"},"Cash Summary",-1)),t("div",ms,[t("table",gs,[t("tr",null,[e[39]||(e[39]=t("td",null,"Opening Cash:",-1)),t("td",ps,r(g(a)(f.value.cash_summary.opening_cash)),1)]),t("tr",null,[e[40]||(e[40]=t("td",null,"Cash Sales:",-1)),t("td",fs,r(g(a)(f.value.cash_summary.cash_sales)),1)]),t("tr",bs,[e[41]||(e[41]=t("td",null,"Expected Cash:",-1)),t("td",vs,r(g(a)(f.value.cash_summary.expected_cash)),1)])])])])])]),f.value.payment_methods.length?(d(),c("div",ys,[t("div",_s,[t("div",xs,[e[44]||(e[44]=t("h6",{class:"fw-semibold mb-3"},"Payment Methods",-1)),t("div",Ss,[t("table",ws,[e[43]||(e[43]=t("thead",{class:"table-light"},[t("tr",null,[t("th",{class:"fw-semibold"},"Method"),t("th",{class:"fw-semibold"},"Count"),t("th",{class:"fw-semibold text-end pe-3"},"Total")])],-1)),t("tbody",null,[(d(!0),c(R,null,P(f.value.payment_methods,(l,s)=>(d(),c("tr",{key:s},[t("td",null,r(l.method),1),t("td",null,r(l.count),1),t("td",Cs,r(g(a)(l.total)),1)]))),128))])])])])])])):w("",!0),f.value.sales_by_user.length?(d(),c("div",ks,[t("div",Ts,[t("div",Fs,[e[46]||(e[46]=t("h6",{class:"fw-semibold mb-3"},"Sales by User",-1)),t("div",Ds,[t("table",Rs,[e[45]||(e[45]=t("thead",{class:"table-light"},[t("tr",null,[t("th",{class:"fw-semibold"},"User"),t("th",{class:"fw-semibold"},"Role"),t("th",{class:"fw-semibold"},"Orders"),t("th",{class:"fw-semibold text-end pe-3"},"Total Sales")])],-1)),t("tbody",null,[(d(!0),c(R,null,P(f.value.sales_by_user,(l,s)=>(d(),c("tr",{key:s},[t("td",null,r(l.user_name),1),t("td",null,[t("span",Ps,r(l.role),1)]),t("td",null,r(l.orders_count),1),t("td",$s,r(g(a)(l.total_sales)),1)]))),128))])])])])])])):w("",!0),f.value.top_items.length?(d(),c("div",Is,[t("div",As,[t("div",zs,[e[48]||(e[48]=t("h6",{class:"fw-semibold mb-3"},"Top Selling Items",-1)),t("div",Ms,[t("table",Bs,[e[47]||(e[47]=t("thead",{class:"table-light"},[t("tr",null,[t("th",{class:"fw-semibold"},"Item"),t("th",{class:"fw-semibold"},"Quantity Sold"),t("th",{class:"fw-semibold text-end pe-3"},"Revenue")])],-1)),t("tbody",null,[(d(!0),c(R,null,P(f.value.top_items,(l,s)=>(d(),c("tr",{key:s},[t("td",null,r(l.name),1),t("td",null,r(l.total_qty),1),t("td",Ns,r(g(a)(l.total_revenue)),1)]))),128))])])])])])])):w("",!0)])])):w("",!0),t("div",Es,[t("button",{class:"btn btn-primary px-4 rounded-pill",onClick:e[7]||(e[7]=l=>mt(f.value.shift_id))},[...e[49]||(e[49]=[t("i",{class:"bi bi-download me-2"},null,-1),C("Download PDF ",-1)])]),t("button",{class:"btn btn-secondary px-4 rounded-pill",onClick:Q},"Close")])])])):w("",!0),I.value?(d(),c("div",Ls,[t("div",js,[t("div",Os,[t("div",Ys,[e[51]||(e[51]=t("span",{class:"badge bg-danger rounded-circle p-2"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),t("div",Vs,[e[50]||(e[50]=t("h5",{class:"modal-title mb-0"},"Z Report (End of Shift)",-1)),t("small",Zs,"Shift ID: "+r(u.value?.shift_id),1)])]),t("button",{onClick:W,class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","aria-label":"Close",title:"Close"},[...e[52]||(e[52]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-danger",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),u.value?(d(),c("div",Us,[t("div",Xs,[t("div",Gs,[t("div",qs,[t("div",Hs,[e[60]||(e[60]=t("h6",{class:"fw-semibold mb-3"},"Shift Information",-1)),t("div",Qs,[t("div",Ws,[t("p",Js,[e[53]||(e[53]=t("strong",null,"Started By:",-1)),C(" "+r(u.value.started_by),1)]),t("p",Ks,[e[54]||(e[54]=t("strong",null,"Start Time:",-1)),C(" "+r(new Date(u.value.start_time).toLocaleString()),1)]),t("p",tl,[e[55]||(e[55]=t("strong",null,"Ended By:",-1)),C(" "+r(u.value.ended_by),1)])]),t("div",el,[t("p",sl,[e[56]||(e[56]=t("strong",null,"End Time:",-1)),C(" "+r(new Date(u.value.end_time).toLocaleString()),1)]),t("p",ll,[e[57]||(e[57]=t("strong",null,"Status:",-1)),e[58]||(e[58]=C()),t("span",ol,r(u.value.status),1)]),t("p",al,[e[59]||(e[59]=t("strong",null,"Duration:",-1)),C(" "+r(u.value.duration),1)])])])])])]),t("div",nl,[t("div",rl,[t("div",il,[e[67]||(e[67]=t("h6",{class:"fw-semibold mb-3"},"Sales Summary",-1)),t("div",dl,[t("table",cl,[t("tr",null,[e[61]||(e[61]=t("td",null,"Total Orders:",-1)),t("td",ul,r(u.value.sales_summary.total_orders),1)]),t("tr",null,[e[62]||(e[62]=t("td",null,"Subtotal:",-1)),t("td",hl,r(g(a)(u.value.sales_summary.subtotal)),1)]),t("tr",null,[e[63]||(e[63]=t("td",null,"Tax:",-1)),t("td",ml,r(g(a)(u.value.sales_summary.total_tax)),1)]),t("tr",null,[e[64]||(e[64]=t("td",null,"Discount:",-1)),t("td",gl,"-"+r(g(a)(u.value.sales_summary.total_discount)),1)]),t("tr",pl,[e[65]||(e[65]=t("td",null,"Total Sales:",-1)),t("td",fl,r(g(a)(u.value.sales_summary.total_sales)),1)]),t("tr",null,[e[66]||(e[66]=t("td",null,"Avg Order Value:",-1)),t("td",bl,r(g(a)(u.value.sales_summary.avg_order_value)),1)])])])])])]),t("div",vl,[t("div",yl,[t("div",_l,[e[73]||(e[73]=t("h6",{class:"fw-semibold mb-3"},"Cash Reconciliation",-1)),t("div",xl,[t("table",Sl,[t("tr",null,[e[68]||(e[68]=t("td",null,"Opening Cash:",-1)),t("td",wl,r(g(a)(u.value.cash_reconciliation.opening_cash)),1)]),t("tr",null,[e[69]||(e[69]=t("td",null,"Cash Sales:",-1)),t("td",Cl,r(g(a)(u.value.cash_reconciliation.cash_sales)),1)]),t("tr",null,[e[70]||(e[70]=t("td",null,"Expected Cash:",-1)),t("td",kl,r(g(a)(u.value.cash_reconciliation.expected_cash)),1)]),t("tr",null,[e[71]||(e[71]=t("td",null,"Actual Cash:",-1)),t("td",Tl,r(g(a)(u.value.cash_reconciliation.actual_cash)),1)]),t("tr",{class:L(u.value.cash_reconciliation.variance>=0?"text-success":"text-danger")},[e[72]||(e[72]=t("td",null,"Variance:",-1)),t("td",Fl,r(u.value.cash_reconciliation.variance>=0?"+":"")+r(g(a)(u.value.cash_reconciliation.variance))+" ("+r(u.value.cash_reconciliation.variance_percentage)+"%) ",1)],2)])])])])]),u.value.payment_methods.length?(d(),c("div",Dl,[t("div",Rl,[t("div",Pl,[e[75]||(e[75]=t("h6",{class:"fw-semibold mb-3"},"Payment Methods",-1)),t("div",$l,[t("table",Il,[e[74]||(e[74]=t("thead",{class:"table-light"},[t("tr",null,[t("th",null,"Method"),t("th",null,"Count"),t("th",{class:"text-end pe-3"},"Total")])],-1)),t("tbody",null,[(d(!0),c(R,null,P(u.value.payment_methods,(l,s)=>(d(),c("tr",{key:s},[t("td",null,r(l.method),1),t("td",null,r(l.count),1),t("td",Al,r(g(a)(l.total)),1)]))),128))])])])])])])):w("",!0),u.value.sales_by_user.length?(d(),c("div",zl,[t("div",Ml,[t("div",Bl,[e[77]||(e[77]=t("h6",{class:"fw-semibold mb-3"},"Sales by User",-1)),t("div",Nl,[t("table",El,[e[76]||(e[76]=t("thead",{class:"table-light"},[t("tr",null,[t("th",null,"User"),t("th",null,"Role"),t("th",null,"Orders"),t("th",{class:"text-end pe-3"},"Total Sales")])],-1)),t("tbody",null,[(d(!0),c(R,null,P(u.value.sales_by_user,(l,s)=>(d(),c("tr",{key:s},[t("td",null,r(l.user_name),1),t("td",null,[t("span",Ll,r(l.role),1)]),t("td",null,r(l.orders_count),1),t("td",jl,r(g(a)(l.total_sales)),1)]))),128))])])])])])])):w("",!0),u.value.top_items.length?(d(),c("div",Ol,[t("div",Yl,[t("div",Vl,[e[79]||(e[79]=t("h6",{class:"fw-semibold mb-3"},"Top Selling Items ",-1)),t("div",Zl,[t("table",Ul,[e[78]||(e[78]=t("thead",{class:"table-light"},[t("tr",null,[t("th",null,"Item"),t("th",null,"Quantity Sold"),t("th",{class:"text-end pe-3"},"Revenue")])],-1)),t("tbody",null,[(d(!0),c(R,null,P(u.value.top_items,(l,s)=>(d(),c("tr",{key:s},[t("td",null,r(l.name),1),t("td",null,r(l.total_qty),1),t("td",Xl,r(g(a)(l.total_revenue)),1)]))),128))])])])])])])):w("",!0),u.value.stock_movement&&u.value.stock_movement.length?(d(),c("div",Gl,[t("div",ql,[t("div",Hl,[e[81]||(e[81]=t("h6",{class:"fw-semibold mb-3"},"Stock Movement",-1)),t("div",Ql,[t("table",Wl,[e[80]||(e[80]=t("thead",{class:"table-light"},[t("tr",null,[t("th",null,"Item"),t("th",null,"Opening Stock"),t("th",null,"Closing Stock"),t("th",null,"Sold")])],-1)),t("tbody",null,[(d(!0),c(R,null,P(u.value.stock_movement,(l,s)=>(d(),c("tr",{key:s},[t("td",null,r(l.item_name),1),t("td",null,r(l.start_stock),1),t("td",null,r(l.end_stock),1),t("td",Jl,r(l.sold),1)]))),128))])])])])])])):w("",!0)])])):w("",!0),t("div",Kl,[t("button",{class:"btn btn-danger px-4 rounded-pill",onClick:e[8]||(e[8]=l=>pt(u.value.shift_id))},[...e[82]||(e[82]=[t("i",{class:"bi bi-download me-2"},null,-1),C("Download PDF ",-1)])]),t("button",{class:"btn btn-primary px-4 rounded-pill ms-2",onClick:e[9]||(e[9]=l=>ft(u.value.shift_id))},[...e[83]||(e[83]=[t("i",{class:"bi bi-printer me-2"},null,-1),C("Print Z Report ",-1)])]),t("button",{class:"btn btn-secondary px-4 rounded-pill",onClick:W},"Close")])])])):w("",!0)]),j(qt,{show:z.value,shiftId:v.value?.id,expectedClosingCash:v.value?it(v.value):0,onCancel:rt,onClosed:nt},null,8,["show","shiftId","expectedClosingCash"])]),_:1}))}},fo=tt(to,[["__scopeId","data-v-43352552"]]);export{fo as default};
