import{_ as Ie,a as re,b as d,d as Ve,g as u,l as f,f as t,t as s,V as lt,c as F,r as g,o as at,n as we,w as Se,q as M,I as ot,E as st,e as k,u as h,h as nt,F as O,i as X,j as b,k as it,m as w,v as S,p as ie,W as rt,P as dt,X as ut,s as y}from"./app-V2s1lVwu.js";import{_ as ct}from"./Master-WElJ1C4A.js";import{s as G}from"./index-MBvvLjiN.js";import{s as Ce}from"./index-XvgJR8h_.js";import{E as pt,a as mt,X as vt,u as W,w as gt}from"./xlsx-CFUnkIXt.js";import{F as yt}from"./FilterModal-DUiOIWh-.js";import{s as ft}from"./index-UlX-uW-d.js";import{u as bt}from"./useFormatters-DBoQqG9N.js";import{I as _t}from"./importFile-BsAmPoU7.js";import{P as ht}from"./package-DUAJPvM6.js";import{C as kt}from"./circle-x-IjGY2f6Z.js";import{T as xt}from"./triangle-alert-CuDmUHe0.js";import{c as de}from"./createLucideIcon-Coq8DOvK.js";import{P as wt}from"./plus-BKVyIOGe.js";import{E as St}from"./eye-BC3cGgI1.js";import{P as Ct}from"./pencil-Wnn9pGcO.js";import"./index-DoagSzzV.js";import"./index-Cak9KJ6C.js";import"./index-DzFuXtkm.js";import"./sun-DZ5FTXo1.js";import"./index-BkYT2TiQ.js";import"./index-BF4Ii756.js";import"./index-DnuCJBtX.js";/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const It=de("calendar-clock",[["path",{d:"M16 14v2.2l1.6 1",key:"fo4ql5"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]]);/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vt=de("calendar-x-2",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 13V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"3spt84"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m17 22 5-5",key:"1k6ppv"}],["path",{d:"m17 17 5 5",key:"p7ous7"}]]);/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const At=de("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),Mt={key:0,class:"fixed inset-0 z-50 flex items-center justify-center custom-overlay"},Ft={class:"bg-white rounded-xl shadow-xl w-full max-w-md p-6 animate-drop-in relative"},Ut={class:"text-center text-lg font-medium text-gray-800 mb-2"},$t={class:"text-center text-sm text-gray-500 mb-6"},Et={__name:"StockOutConfirmationModal",props:{show:Boolean,title:String,message:String},emits:["confirm","close"],setup(R,{emit:T}){const D=T,V=()=>D("confirm"),Y=()=>D("close");return(Q,C)=>(d(),re(lt,null,{default:Ve(()=>[R.show?(d(),u("div",Mt,[t("div",Ft,[t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110",onClick:Y},[...C[0]||(C[0]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-danger",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])]),C[1]||(C[1]=t("div",{class:"flex justify-center mb-4"},[t("div",{class:"bg-gray-100 p-3 rounded-full"},[t("svg",{class:"w-8 h-8 text-danger",fill:"none",stroke:"currentColor","stroke-width":"2",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v2m0 4h.01M12 19a7 7 0 100-14 7 7 0 000 14z"})])])],-1)),t("h3",Ut,s(R.title),1),t("p",$t,s(R.message),1),t("div",{class:"flex justify-center gap-3"},[t("button",{onClick:V,class:"btn btn-primary d-flex align-items-center gap-1 px-3 py-2 rounded-pill text-white"}," Yes, I'm sure "),t("button",{onClick:Y,class:"btn btn-secondary d-flex align-items-center gap-1 px-3 py-2 rounded-pill text-white"}," Cancel ")])])])):f("",!0)]),_:1}))}},qt=Ie(Et,[["__scopeId","data-v-38680d1d"]]),Dt={class:"page-wrapper"},Pt={class:"row g-4"},Nt={class:"card border-0 shadow-sm rounded-4"},jt={class:"card-body d-flex align-items-center justify-content-between"},Ot={class:"fw-bold fs-4"},Tt={class:"text-muted fs-6"},Lt={class:"card border-0 shadow-lg rounded-4"},Bt={class:"card-body"},Rt={class:"d-flex flex-wrap gap-2 justify-content-between align-items-center mb-3"},Qt={class:"d-flex flex-wrap gap-2 align-items-center"},Ht={class:"search-wrap"},Kt={key:1,class:"form-control search-input",placeholder:"Search",disabled:"",type:"text"},zt={class:"table-responsive"},Zt={class:"table table-striped"},Xt={key:0},Gt={key:1},Wt={class:"fw-semibold"},Yt={class:"text-truncate",style:{"max-width":"260px"}},Jt={class:"text-center"},el={key:0,class:"badge bg-red-600 rounded-pill d-inline-block text-center",style:{"min-width":"100px"}},tl={key:1,class:"badge bg-warning rounded-pill d-inline-block text-center",style:{"min-width":"100px"}},ll={key:2,class:"badge bg-success rounded-pill d-inline-block text-center",style:{"min-width":"100px"}},al={class:"text-center"},ol={class:"d-inline-flex align-items-center gap-3"},sl=["onClick"],nl=["onClick"],il=["onClick"],rl={key:0},dl={key:0,class:"mt-4 d-flex justify-content-between align-items-center"},ul={class:"text-muted small"},cl={class:"modal fade",id:"addItemModal",tabindex:"-1","aria-hidden":"true"},pl={class:"modal-dialog modal-lg modal-dialog-centered",role:"document"},ml={class:"modal-content rounded-4"},vl={class:"modal-header"},gl={class:"modal-title fw-semibold"},yl={class:"modal-body"},fl={class:"row g-3"},bl={class:"col-md-6"},_l={key:0,class:"text-danger"},hl={class:"col-md-6"},kl={key:0,class:"text-danger"},xl={key:0,class:"col-md-6"},wl={key:0,class:"text-danger"},Sl={class:"col-md-6"},Cl={key:0,class:"text-danger"},Il={class:"col-md-6"},Vl={key:0,class:"text-danger"},Al={class:"col-md-6"},Ml={key:0,class:"text-danger"},Fl={class:"col-md-6"},Ul={key:0,class:"text-danger"},$l={class:"col-12"},El={key:0,class:"text-danger"},ql={class:"row g-3"},Dl={class:"col-md-3"},Pl={key:0,class:"text-danger"},Nl={class:"col-md-3"},jl={key:0,class:"text-danger"},Ol={class:"col-md-3"},Tl={key:0,class:"text-danger"},Ll={class:"col-md-3"},Bl={key:0,class:"text-danger"},Rl={class:"row g-4 mt-1"},Ql={class:"col-md-6"},Hl={key:0,class:"text-danger"},Kl={class:"col-md-6"},zl={key:0,class:"text-danger"},Zl={class:"col-md-4"},Xl=["src"],Gl={key:1,class:"placeholder"},Wl={key:0,class:"text-danger"},Yl={class:"mt-4"},Jl=["disabled"],ea={class:"modal fade",id:"viewItemModal",tabindex:"-1","aria-hidden":"true"},ta={class:"modal-dialog modal-lg modal-dialog-centered"},la={class:"modal-content border-0 shadow-lg rounded-4 overflow-hidden"},aa={class:"modal-header bg-light"},oa={class:"d-flex align-items-center gap-2"},sa={key:0,class:"text-muted"},na={class:"modal-body"},ia={key:0,class:"row g-4"},ra={class:"col-12 col-md-7"},da={class:"card border-0 shadow-sm rounded-4"},ua={class:"card-body"},ca={class:"fw-semibold mb-3"},pa={class:"text-muted small mb-2"},ma={class:"row g-3 small"},va={class:"col-6"},ga={class:"fw-semibold text-muted"},ya={class:"col-6"},fa={class:"fw-semibold text-muted"},ba={class:"col-6"},_a={class:"fw-semibold text-muted"},ha={class:"col-12"},ka={class:"fw-semibold text-muted"},xa={class:"col-12"},wa={class:"fw-semibold text-muted"},Sa={class:"d-flex flex-wrap gap-2 mt-2"},Ca={class:"badge rounded-pill bg-primary text-white"},Ia={class:"badge rounded-pill bg-success text-white"},Va={class:"badge rounded-pill bg-warning text-white"},Aa={class:"badge rounded-pill bg-secondary text-white"},Ma={class:"d-flex flex-wrap gap-2 mt-2"},Fa={class:"d-flex flex-wrap gap-2 mt-2"},Ua={class:"col-12 col-md-5"},$a={class:"card border-0 shadow-sm rounded-4 h-100"},Ea={class:"card-body d-flex flex-column align-items-center justify-content-center"},qa={key:0,class:"w-100"},Da=["src"],Pa={class:"card-footer bg-transparent small d-flex justify-content-between"},Na={class:"badge bg-gray-500 rounded-pill text-white p-2"},ja={class:"card-footer bg-transparent small d-flex justify-content-between"},Oa={class:"fw-semibold"},Ta={class:"card-footer bg-transparent small d-flex justify-content-between"},La={class:"fw-semibold"},Ba={class:"card border-0 shadow-lg rounded-4 overflow-hidden"},Ra={class:"table-responsive"},Qa={class:"table table-striped mb-0"},Ha={class:"fw-semibold"},Ka={class:"fw-semibold"},za={class:"text-muted"},Za={class:"text-muted"},Xa={class:"text-muted"},Ga={class:"text-center"},Wa={key:0},Ya={class:"fw-semibold text-muted w-50"},Ja={class:"modal fade",id:"stockInModal",tabindex:"-1","aria-hidden":"true"},eo={class:"modal-dialog modal-lg modal-dialog-centered"},to={class:"modal-content rounded-4"},lo={class:"modal-header"},ao={class:"modal-title"},oo={class:"modal-body"},so={class:"row g-3"},no={class:"col-md-6"},io={key:0,class:"text-danger"},ro={class:"col-md-6"},uo=["value"],co={key:0,class:"text-danger"},po={class:"col-md-6"},mo={key:0,class:"text-danger"},vo={class:"col-md-6"},go={class:"col-md-4"},yo={key:0,class:"text-danger"},fo={class:"col-md-4"},bo={key:0,class:"text-danger"},_o={class:"col-md-4"},ho={class:"col-md-12"},ko={key:0,class:"text-danger"},xo={class:"col-md-12"},wo={class:"mt-4"},So=["disabled"],Co={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},Io={class:"modal fade",id:"stockOutModal",tabindex:"-1","aria-hidden":"true"},Vo={class:"modal-dialog modal-lg modal-dialog-centered"},Ao={class:"modal-content rounded-4"},Mo={class:"modal-header"},Fo={class:"modal-title"},Uo={class:"modal-body"},$o={class:"row g-3"},Eo={class:"col-md-6"},qo={class:"col-md-6"},Do=["value"],Po={key:0,class:"text-danger"},No={class:"col-md-6"},jo={class:"col-md-6"},Oo={key:0,class:"text-danger"},To={class:"col-md-12"},Lo={class:"mt-4 text-end"},Bo=["disabled"],Ro={__name:"Index",props:{inventories:Array,allergies:Array,tags:Array,units:Array,suppliers:Array,categories:Array},setup(R){const{formatCurrencySymbol:T,dateFmt:D}=bt(),V=R,Y=F(()=>V.categories.filter(l=>!l.parent_id)),Q=F(()=>V.categories.filter(l=>l.parent_id===n.value.category_id)),C=g(!1),I=g({current_page:1,last_page:1,per_page:10,total:0,from:0,to:0,links:[]}),P=g(V.inventories?.data||[]),ae=g(null),Ae=[{label:"PDF",value:"pdf"},{label:"Excel",value:"excel"},{label:"CSV",value:"csv"}],Me=l=>{l.value&&(He(l.value),ae.value=null)},J=F(()=>P.value),U=async(l=null)=>{C.value=!0;try{console.log("üîç Fetching with params:",{q:q.value,page:l||I.value.current_page,per_page:I.value.per_page,filters:$.value});const e={q:q.value,page:l||I.value.current_page,per_page:I.value.per_page,category:$.value.category||void 0,supplier:$.value.supplier||void 0,stockStatus:$.value.stockStatus||void 0,priceMin:$.value.priceMin||void 0,priceMax:$.value.priceMax||void 0,sortBy:$.value.sortBy||void 0};Object.keys(e).forEach(a=>{(e[a]===void 0||e[a]==="")&&delete e[a]});const i=await M.get("inventory/api-inventories",{params:e});P.value=i.data.data||[],console.log("üìä Response pagination:",{current_page:i.data.current_page,last_page:i.data.last_page,per_page:i.data.per_page,total:i.data.total,data_length:P.value.length}),I.value={current_page:i.data.current_page,last_page:i.data.last_page,per_page:i.data.per_page,total:i.data.total,from:i.data.from,to:i.data.to,links:i.data.links},C.value=!1}catch(e){console.error("‚ùå Fetch inventories error:",e),y.error("Failed to load inventories"),C.value=!1}},Fe=async()=>{try{return C.value=!0,(await M.get("inventory/api-inventories",{params:{q:q.value,per_page:1e4,page:1}})).data.data||[]}catch(l){return console.error("‚ùå Error fetching export data:",l),y.error("Failed to load data for export"),[]}finally{C.value=!1}},Ue=l=>{if(!l)return;const i=new URLSearchParams(l.split("?")[1]).get("page");i&&U(parseInt(i))};at(async()=>{q.value="",ue.value=Date.now(),await we(),setTimeout(()=>{ce.value=!0;const e=document.getElementById(oe);e&&(e.value="",q.value="")},100),U(),H();const l=document.getElementById("inventoryFilterModal");l&&l.addEventListener("hidden.bs.modal",()=>{N.value={...$.value}})});const q=g(""),ue=g(Date.now()),oe=`search-${Math.random().toString(36).substr(2,9)}`,ce=g(!1);g("");const N=g({sortBy:"",category:"",supplier:"",stockStatus:"",priceMin:null,priceMax:null,dateFrom:"",dateTo:""}),$=g({...N.value}),$e=()=>{$.value={...N.value},I.value.current_page=1,U(1)},Ee=()=>{N.value={sortBy:"",category:"",supplier:"",stockStatus:"",priceMin:null,priceMax:null,dateFrom:"",dateTo:""},$.value={...N.value},I.value.current_page=1,I.value.per_page=10,U(1)};let pe=null;Se(q,(l,e)=>{clearTimeout(pe),pe=setTimeout(()=>{I.value.current_page=1,U(1)},500)});const ee=F(()=>({sortOptions:[{value:"stock_desc",label:"Stock: High to Low"},{value:"stock_asc",label:"Stock: Low to High"},{value:"name_asc",label:"Name: A to Z"},{value:"name_desc",label:"Name: Z to A"}],categories:V.categories||[],suppliers:V.suppliers||[],stockStatusOptions:[{value:"in_stock",label:"In Stock"},{value:"low_stock",label:"Low Stock"},{value:"out_of_stock",label:"Out of Stock"},{value:"expired",label:"Expired"},{value:"near_expiry",label:"Near Expiry"}]}));F(()=>J.value.length);const me=g([]),L=g({total_items:0,out_of_stock:0,low_stock:0,expired:0,near_expiry:0}),H=async()=>{try{const l=await M.get("/inventory/kpi-stats");L.value=l.data}catch(l){console.error("‚ùå Failed to fetch KPI stats:",l)}};F(()=>J.value.filter(l=>l.availableStock>0&&l.availableStock<(l.minAlert||5)).length),F(()=>J.value.filter(l=>l.availableStock<=0).length),F(()=>me.value.filter(l=>{if(l.stock_type!=="stockin"||!l.expiry_date)return!1;const e=new Date(l.expiry_date),i=new Date;e.setHours(0,0,0,0),i.setHours(0,0,0,0);const a=e<i,v=(l.quantity||0)>(l.allocated_quantity||0);return a&&v}).length),F(()=>me.value.filter(l=>{if(l.stock_type!=="stockin"||!l.expiry_date)return!1;const a=(new Date(l.expiry_date)-new Date)/(1e3*60*60*24),v=a>0&&a<=15,x=(l.quantity||0)>(l.allocated_quantity||0);return v&&x}).length);const qe=F(()=>[{label:"Total Items",value:L.value.total_items??0,icon:ht,iconBg:"bg-soft-success",iconColor:"text-success"},{label:"Out of Stock",value:L.value.out_of_stock??0,icon:kt,iconBg:"bg-soft-danger",iconColor:"text-danger"},{label:"Low Stock",value:L.value.low_stock??0,icon:xt,iconBg:"bg-soft-warning",iconColor:"text-warning"},{label:"Expired Stock",value:L.value.expired??0,icon:Vt,iconBg:"bg-soft-danger",iconColor:"text-danger"},{label:"Near Expire Stock",value:L.value.near_expiry??0,icon:It,iconBg:"bg-soft-info",iconColor:"text-info"}]);ot(()=>window.feather?.replace?.());const o=g({}),n=g({id:null,name:"",category_id:null,subcategory_id:null,unit_id:null,supplier_id:null,minAlert:null,sku:"",description:"",nutrition:{calories:0,fat:0,protein:0,carbs:0},allergies:[],tags:[],imageFile:null,imageUrl:null}),te=g(!1),De=async()=>{te.value=!0,o.value={};const l=new FormData;if(l.append("name",(n.value.name||"").trim()),n.value.category_id&&l.append("category_id",n.value.category_id),Q.value.length&&n.value.subcategory_id&&l.append("subcategory_id",n.value.subcategory_id),n.value.unit_id&&l.append("unit_id",n.value.unit_id),n.value.minAlert!==null&&n.value.minAlert!==""&&l.append("minAlert",n.value.minAlert),n.value.supplier_id&&l.append("supplier_id",n.value.supplier_id),l.append("sku",n.value.sku||""),l.append("description",n.value.description||""),l.append("nutrition[calories]",n.value.nutrition.calories),l.append("nutrition[fat]",n.value.nutrition.fat),l.append("nutrition[protein]",n.value.nutrition.protein),l.append("nutrition[carbs]",n.value.nutrition.carbs),(n.value.allergies||[]).forEach((e,i)=>l.append(`allergies[${i}]`,e)),(n.value.tags||[]).forEach((e,i)=>l.append(`tags[${i}]`,e)),n.value.imageFile){const e=(n.value.imageFile.type?.split("/")?.[1]||"webp").replace("jpeg","jpg");l.append("image",n.value.imageFile,`image.${e}`)}try{n.value.id?(await M.post(`/inventory/${n.value.id}?_method=PUT`,l,{headers:{"Content-Type":"multipart/form-data"}}),y.success(" Inventory Item updated successfully")):(await M.post("/inventory",l,{headers:{"Content-Type":"multipart/form-data"}}),y.success(" Inventory Item created successfully")),se(),await U();const e=document.getElementById("addItemModal");bootstrap.Modal.getInstance(e)?.hide()}catch(e){e?.response?.status===422&&e.response.data?.errors?(o.value=e.response.data.errors,y.error("Please fill in all required fields correctly.")):(console.error("‚ùå Error saving:",e.response?.data||e.message),y.error("Failed to save Inventory Item"))}finally{te.value=!1}};Se(n,l=>{Object.keys(o.value).forEach(e=>{if(e.includes(".")){const[i,a]=e.split(".");l[i]&&l[i][a]!==""&&delete o.value[e]}else{const i=l[e];i!=null&&i!==""&&(!Array.isArray(i)||i.length>0)&&delete o.value[e]}})},{deep:!0});const Pe=l=>{const e=v=>v===""||v===null||v===void 0?null:Number(v);let i=null,a=null;if(l.category&&typeof l.category=="object"){const v=l.category;v.parent_id?(a=e(v.id),i=e(v.parent_id)):(i=e(v.id),a=null)}else i=e(l.category_id),a=e(l.subcategory_id);n.value={id:l.id,name:l.name??"",category_id:i,subcategory_id:a,unit_id:e(l.unit_id),supplier_id:e(l.supplier_id),minAlert:l.minAlert??0,sku:l.sku??"",description:l.description??"",nutrition:l.nutrition??{calories:0,protein:0,fat:0,carbs:0},allergies:l.allergy_ids??[],tags:l.tag_ids??[],imageFile:null,imageUrl:l.image_url??null},we(()=>{Q.value.some(x=>x.id===n.value.subcategory_id)||(n.value.subcategory_id=null)})};function se(){n.value={id:null,name:"",category_id:null,subcategory_id:null,unit_id:null,minAlert:"",supplier_id:null,sku:"",description:"",nutrition:{calories:"",fat:"",protein:"",carbs:""},allergies:[],tags:[],imageFile:null,imageUrl:null}}const _=g({}),Ne=async l=>{try{const e=await M.get(`/inventory/${l.id}`);_.value=e.data,await Ye(l.id)}catch(e){console.error("Error fetching item:",e)}};function K(){const l=Number(p.value.quantity||0),e=Number(p.value.price||0);p.value.value=l*e}const p=g({product_id:null,name:"",category_id:null,supplier_id:null,available_quantity:0,quantity:0,price:0,value:0,expiry_date:"",description:"",operation_type:"purchase",stock_type:"stockin",purchase_date:new Date().toISOString().slice(0,10),user_id:1}),E=g(!1),z=g();function ve(){p.value.quantity=0,p.value.price=0,p.value.value=0,p.value.expiry_date="",p.value.description=""}const ge=()=>{o.value={}};async function je(){console.log(p.value),E.value=!0,K();try{await M.post("/stock_entries",p.value),y.success(" Stock In saved successfully"),ve(),bootstrap.Modal.getInstance(document.getElementById("stockInModal"))?.hide(),await U(),await H()}catch(l){l?.response?.status===422&&l.response.data?.errors?(o.value=l.response.data.errors,y.error("Please fill in all required fields correctly.")):(y.error("Something went wrong. Please try again.",{autoClose:3e3}),console.error(l))}finally{E.value=!1}}const Oe=g(null),Te=g(null);g(null);const B=g(!1),ne=g(null),Le=l=>{ne.value=l,B.value=!0},Be=()=>{if(B.value=!1,!ne.value){console.error("‚ùå No item selected for stock out"),y.error("No item selected");return}Re(ne.value)};async function Re(l){if(!l){console.error("‚ùå No item provided to confirmStockOut");return}try{console.log(" Attempting stock out for item:",l);const i=(await M.get(`/stock_entries/total/${l.id}`)).data||{},a=i.available||0;if(console.log(" Stock data received:",i),console.log(" Available quantity:",a),a<=0){y.warning(`No available stock for "${l.name}". Current stock: ${a}`,{autoClose:4e3}),B.value=!1;return}const v={product_id:l.id,name:l.name,category_id:l.category?.id,available_quantity:a,quantity:a,price:0,value:0,description:"Auto full stock-out",operation_type:"inventory_stockout",stock_type:"stockout",purchase_date:new Date().toISOString().slice(0,10),user_id:1};console.log(" Submitting stock out payload:",v),await M.post("/stock_entries",v),y.success(`Successfully stocked out ${a} units of "${l.name}"`,{autoClose:3e3}),await U(),await H()}catch(e){console.error("‚ùå Stock out error:",e),console.error("‚ùå Error response:",e.response?.data),e?.response?.data?.errors?.quantity?y.error(e.response.data.errors.quantity[0]):y.error("Stock out failed. Please try again.")}finally{B.value=!1}}async function Qe(){if(E.value=!0,K(),p.value.quantity>p.value.available_quantity){o.value.quantity=["The quantity should not exceed the available quantity."],y.error("The quantity should not exceed the available quantity."),E.value=!1;return}else o.value.quantity=null;try{await M.post("/stock_entries",p.value),y.success("Stock Out saved successfully"),ve(),bootstrap.Modal.getInstance(document.getElementById("stockOutModal"))?.hide(),await U(),await H()}catch(l){l?.response?.status===422&&l.response.data?.errors?(o.value=l.response.data.errors,y.error("Please fill in all required fields correctly.")):(y.error("Something went wrong. Please try again.",{autoClose:3e3}),console.error(l))}finally{E.value=!1}}const He=async l=>{if(!P.value||P.value.length===0){y.error("No inventory data to download");return}try{C.value=!0;const e=await Fe();if(!e.length){y.error("No inventory items found to download"),C.value=!1;return}l==="pdf"?ze(e):l==="excel"?Ze(e):l==="csv"?Ke(e):y.error("Invalid download type")}catch(e){console.error("Download failed:",e),y.error(`Download failed: ${e.message}`)}finally{C.value=!1}},Ke=l=>{try{const e=["name","sku","category","min_alert","unit","preferred_supplier","min_stock_alert","available_stock","calories","fat","protein","carbs","allergies","tags"],i=l.map(r=>{let c="";return r.nutrition&&typeof r.nutrition=="object"?c=Object.entries(r.nutrition).map(([A,j])=>`${A}: ${j}`).join("; "):typeof r.nutrition=="string"&&(c=r.nutrition),[`"${(r.name||"").replace(/"/g,'""')}"`,`"${(r.sku||"").replace(/"/g,'""')}"`,`"${(r.category?.name||"").replace(/"/g,'""')}"`,`"${r.minAlert||""}"`,`"${(r.unit_name||"").replace(/"/g,'""')}"`,`"${(r.supplier_name||"").replace(/"/g,'""')}"`,`"${r.minAlert||""}"`,`"${r.availableStock||""}"`,`"${r.nutrition?.calories||0}"`,`"${r.nutrition?.protein||0}"`,`"${r.nutrition?.fat||0}"`,`"${r.nutrition?.carbs||0}"`,`"${Array.isArray(r.allergies)?r.allergies.join(", "):r.allergies||""}"`,`"${Array.isArray(r.tags)?r.tags.join(", "):r.tags||""}"`]}),a=[e.join(","),...i.map(r=>r.join(","))].join(`
`),v=new Blob([a],{type:"text/csv;charset=utf-8;"}),x=URL.createObjectURL(v),m=document.createElement("a");m.setAttribute("href",x),m.setAttribute("download",`inventory_items_${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(x),y.success(`CSV downloaded successfully (${l.length} items)`,{autoClose:2500})}catch(e){console.error("CSV generation error:",e),y.error(`CSV generation failed: ${e.message}`,{autoClose:5e3})}},ze=l=>{try{const e=new pt("l","mm","a4");e.setFontSize(18),e.setFont("helvetica","bold"),e.text("Inventory Items Report",14,15),e.setFontSize(10),e.setFont("helvetica","normal");const i=new Date().toLocaleString();e.text(`Generated on: ${i}`,14,22),e.text(`Total Items: ${l.length}`,14,28);const a=["Name","SKU","Category","Min Alert","Unit","Preferred Supplier","Min Stock Alert","Available Stock","Calories","Fat","Protein","Carbs","Allergies","Tags"],v=l.map(m=>[m.name||"",m.sku||"",m.category?.name||"",m.minAlert||"",m.unit_name||"",m.supplier_name||"",m.minAlert||"",m.availableStock!==void 0?Number(m.availableStock).toFixed(2):"",m.nutrition?.calories||"",m.nutrition?.fat||"",m.nutrition?.protein||"",m.nutrition?.carbs||"",Array.isArray(m.allergies)?m.allergies.join(", "):m.allergies||"",Array.isArray(m.tags)?m.tags.join(", "):m.tags||""]);mt(e,{head:[a],body:v,startY:35,styles:{fontSize:8,cellPadding:2,halign:"left",lineColor:[0,0,0],lineWidth:.1},headStyles:{fillColor:[41,128,185],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]},margin:{left:14,right:14},didDrawPage:m=>{const r=e.internal.getNumberOfPages(),c=e.internal.pageSize.height;e.setFontSize(8),e.text(`Page ${m.pageNumber} of ${r}`,m.settings.margin.left,c-10)}});const x=`inventory_items_${new Date().toISOString().split("T")[0]}.pdf`;e.save(x),y.success(`PDF downloaded successfully (${l.length} items)`,{autoClose:2500})}catch(e){console.error("PDF generation error:",e),y.error(`PDF generation failed: ${e.message}`,{autoClose:5e3})}},Ze=l=>{try{if(typeof vt>"u")throw new Error("XLSX library is not loaded");const e=l.map(r=>({Name:r.name||"",SKU:r.sku||"",Category:r.category?.name||"",Min_Alert:r.minAlert||"",Unit:r.unit_name||"",Preferred_Supplier:r.supplier_name||"",Min_Stock_Alert:r.minAlert||"",Available_Stock:r.availableStock||"",Calories:r.nutrition?.calories||"",Fat:r.nutrition?.fat||"",Protein:r.nutrition?.protein||"",Carbs:r.nutrition?.carbs||"",Allergies:Array.isArray(r.allergies)?r.allergies.join(", "):r.allergies||"",Tags:Array.isArray(r.tags)?r.tags.join(", "):r.tags||""})),i=W.book_new(),a=W.json_to_sheet(e);a["!cols"]=[{wch:25},{wch:15},{wch:20},{wch:12},{wch:15},{wch:25},{wch:15},{wch:18},{wch:10},{wch:10},{wch:10},{wch:10},{wch:25},{wch:25}],W.book_append_sheet(i,a,"Inventory Items");const v=[{Info:"Generated On",Value:new Date().toLocaleString()},{Info:"Total Records",Value:l.length},{Info:"Exported By",Value:"Inventory Management System"}],x=W.json_to_sheet(v);W.book_append_sheet(i,x,"Report Info");const m=`inventory_items_${new Date().toISOString().split("T")[0]}.xlsx`;gt(i,m),y.success(`Excel file downloaded successfully (${l.length} items)`,{autoClose:2500})}catch(e){console.error("Excel generation error:",e),y.error(`Excel generation failed: ${e.message}`,{autoClose:5e3})}},ye=g(!1),Xe=g(!1),fe=g(null);function Ge(l){fe.value=n.value.imageUrl,fe.value&&(Xe.value=!0)}function We({file:l}){n.value.imageFile=l,n.value.imageUrl=URL.createObjectURL(l)}g("");const be=g(0),_e=g(0),he=g(0),ke=g(0),Z=g([]);async function Ye(l){try{const{data:e}=await M.get(`/stock_entries/by-item/${l}`),i=e?.data||{};console.log(i),Z.value=i.records||[],be.value=i.near_count??0,_e.value=i.expired_count??0,he.value=i.near_qty??0,ke.value=i.expired_qty??0}catch(e){console.error(e),Z.value=[],be.value=_e.value=0,he.value=ke.value=0}}function Je(l){return l==="expired"?"Expired":l==="near"?"Near Expire":"Active"}function et(l){return l==="expired"?"bg-danger":l==="near"?"bg-warning":"bg-success"}const le=F(()=>{const l=Z.value||[];let e=0,i=0,a=0,v=0,x=0;const m=new Date;m.setHours(0,0,0,0);for(const r of l){const c=parseFloat(r?.quantity??0);if(e+=c,i+=Number(r?.price??0),a+=Number(r?.value??0),!r?.expiry_date)v+=c;else{const xe=new Date(r.expiry_date);xe.setHours(0,0,0,0),xe>=m&&(v+=c)}const A=parseFloat(r?.allocated_quantity??0),j=Math.max(0,c-A);(!r?.expiry_date||new Date(r.expiry_date)>=m)&&(x+=j)}return{totalQty:Number(e.toFixed(2)),totalPrice:Number(i.toFixed(2)),totalValue:Number(a.toFixed(2)),notExpiredQty:Number(v.toFixed(2)),availableQty:Number(x.toFixed(2))}}),tt=l=>{if(!l||l.length<=1){y.error("The imported file is empty.");return}const e=l[0];console.log("headers are ",e);const i=l.slice(1);console.log("rows data",i);const a=i.map(c=>({name:c[0]||"",sku:c[1]||"",description:c[2]||"",category:c[3]||"",min_alert:c[4]||"",unit:c[5]||"",preferred_supplier:c[6]||"",purchase_price:c[7]||"",stock:parseInt(c[8])||0,active:c[9]||1,calories:parseFloat(c[10])||0,fat:parseFloat(c[11])||0,protein:parseFloat(c[12])||0,carbs:parseFloat(c[13])||0,allergies:c[14]||"",tags:c[15]||""})),v=a.map(c=>c.name.trim().toLowerCase()),x=v.filter((c,A)=>v.indexOf(c)!==A);if(x.length>0){y.error(`Duplicate item names found in CSV: ${[...new Set(x)].join(", ")}`);return}const m=J.value.map(c=>c.name.trim().toLowerCase()),r=a.filter(c=>m.includes(c.name.trim().toLowerCase()));if(r.length>0){const c=r.map(A=>A.name).join(", ");y.error(`Items already exist in the table: ${c}`);return}M.post("/api/inventory/import",{items:a}).then(()=>{y.success("Items imported successfully");const c=document.querySelector(".modal.show");if(c){const A=bootstrap.Modal.getInstance(c);A&&A.hide()}setTimeout(()=>{document.querySelectorAll(".modal-backdrop").forEach(j=>j.remove()),document.body.classList.remove("modal-open"),document.body.style.overflow="",document.body.style.paddingRight=""},100),U(),H()}).catch(c=>{console.error(c),y.error("Import failed"),setTimeout(()=>{document.querySelectorAll(".modal-backdrop").forEach(j=>j.remove()),document.body.classList.remove("modal-open"),document.body.style.overflow="",document.body.style.paddingRight=""},100)})};return(l,e)=>{const i=st("VueDatePicker");return d(),re(ct,null,{default:Ve(()=>[k(h(nt),{title:"inventory Item"}),t("div",Dt,[e[101]||(e[101]=t("h4",{class:"mb-3"},"Overall Inventory",-1)),t("div",Pt,[(d(!0),u(O,null,X(qe.value,a=>(d(),u("div",{key:a.label,class:"col-md-6 col-xl-3"},[t("div",Nt,[t("div",jt,[t("div",null,[t("div",Ot,s(a.value),1),t("div",Tt,s(a.label),1)]),t("div",{class:b(["icon-chip",a.iconBg])},[(d(),re(it(a.icon),{class:b(a.iconColor),size:"26"},null,8,["class"]))],2)])])]))),128))]),t("div",Lt,[t("div",Bt,[t("div",Rt,[e[41]||(e[41]=t("h4",{class:"mb-0"},"Stock",-1)),t("div",Qt,[t("div",Ht,[e[38]||(e[38]=t("i",{class:"bi bi-search"},null,-1)),e[39]||(e[39]=t("input",{type:"email",name:"email",autocomplete:"email",style:{position:"absolute",left:"-9999px",width:"1px",height:"1px"},tabindex:"-1","aria-hidden":"true"},null,-1)),ce.value?w((d(),u("input",{id:oe,"onUpdate:modelValue":e[0]||(e[0]=a=>q.value=a),key:ue.value,class:"form-control search-input",placeholder:"Search",type:"search",autocomplete:"new-password",name:oe,role:"presentation",onFocus:e[1]||(e[1]=(...a)=>l.handleFocus&&l.handleFocus(...a))},null,32)),[[S,q.value]]):(d(),u("input",Kt))]),k(yt,{modelValue:N.value,"onUpdate:modelValue":e[2]||(e[2]=a=>N.value=a),title:"Inventory Items","modal-id":"inventoryFilterModal","modal-size":"modal-lg",categories:ee.value.categories,suppliers:ee.value.suppliers,"sort-options":ee.value.sortOptions,"stock-status-options":ee.value.stockStatusOptions,"show-price-range":!0,"show-date-range":!1,priceRangeLabel:"Stock Value Range",onApply:$e,onClear:Ee},null,8,["modelValue","categories","suppliers","sort-options","stock-status-options"]),t("button",{"data-bs-toggle":"modal","data-bs-target":"#addItemModal",class:"d-flex align-items-center gap-1 px-4 py-2 btn-sm rounded-pill btn btn-primary text-white",onClick:e[3]||(e[3]=a=>{se(),o.value={},z.value="Create"})},[k(h(wt),{class:"w-4 h-4"}),e[40]||(e[40]=ie(" Add Item ",-1))]),k(_t,{label:"Import",sampleHeaders:["name","sku","description","category","min_alert","unit","preferred_supplier","purchase_price","stock","active","calories","fat","protein","carbs","allergies","tags"],sampleData:[["Milk","SKU-001","Sample one Description","Dairy",5,"Kilogram (kg)","Fresh Fruits Co.",200,350,1,150,33,23,44,"Eggs","Fairtrade"],["Honey","SKU-002","Sample Two Description","Sweets",5,"Kilogram (kg)","Green Veggies Ltd.",159,100,1,150,33,23,44,"Eggs","Fairtrade"]],onOnImport:tt}),k(h(ft),{modelValue:ae.value,"onUpdate:modelValue":e[4]||(e[4]=a=>ae.value=a),options:Ae,optionLabel:"label",optionValue:"value",placeholder:"Export",class:"export-dropdown",onChange:Me},null,8,["modelValue"])])]),t("div",zt,[t("table",Zt,[e[44]||(e[44]=t("thead",{class:"border-top small text-muted"},[t("tr",null,[t("th",null,"S.#"),t("th",null,"Items"),t("th",null,"Image"),t("th",null,"Category"),t("th",null,"Unit"),t("th",null,"Available Stock"),t("th",null,"Stock Value"),t("th",{class:"text-center"},"Availability"),t("th",{class:"text-center"},"Action")])],-1)),C.value?(d(),u("tbody",Xt,[...e[42]||(e[42]=[t("tr",null,[t("td",{colspan:"10",class:"text-center py-5"},[t("div",{class:"spinner-border",role:"status","aria-label":"Loading"})])],-1)])])):(d(),u("tbody",Gt,[(d(!0),u(O,null,X(P.value,(a,v)=>(d(),u("tr",{key:a.id},[t("td",null,s(I.value.from+v),1),t("td",Wt,s(a.name),1),t("td",null,[k(rt,{file:a.image_url||"/assets/img/default.png",alt:a.name,width:50,height:50,custom_class:"cursor-pointer"},null,8,["file","alt"])]),t("td",Yt,s(a.category?.name),1),t("td",null,s(a.unit_name),1),t("td",null,s(a.availableStock?a.availableStock.toFixed(2):0),1),t("td",null,s(a.stockValue||0),1),t("td",Jt,[a.availableStock===0?(d(),u("span",el,"Out of stock")):a.availableStock<=a.minAlert?(d(),u("span",tl,"Low-stock")):(d(),u("span",ll,"In-stock"))]),t("td",al,[t("div",ol,[t("button",{onClick:x=>Le(a),title:"Stock Out",class:"p-2 rounded-full text-red-600 hover:bg-red-100"},[k(h(At),{class:"w-4 h-4"})],8,sl),k(qt,{show:B.value,title:"Confirm Stock Out",message:"Are you sure you want to stock out this item?",onConfirm:Be,onClose:e[5]||(e[5]=x=>B.value=!1)},null,8,["show"]),t("button",{onClick:x=>Ne(a),"data-bs-toggle":"modal","data-bs-target":"#viewItemModal",title:"View Item",class:"p-2 rounded-full text-primary hover:bg-gray-100"},[k(h(St),{class:"w-4 h-4"})],8,nl),t("button",{onClick:()=>{Pe(a),o.value={},z.value="Edit"},"data-bs-toggle":"modal","data-bs-target":"#addItemModal",title:"Edit",class:"p-2 rounded-full text-blue-600 hover:bg-blue-100"},[k(h(Ct),{class:"w-4 h-4"})],8,il)])])]))),128)),P.value.length===0?(d(),u("tr",rl,[...e[43]||(e[43]=[t("td",{colspan:"10",class:"text-center text-muted py-4"}," No items found. ",-1)])])):f("",!0)]))])]),!C.value&&I.value.last_page>1?(d(),u("div",dl,[t("div",ul," Showing "+s(I.value.from)+" to "+s(I.value.to)+" of "+s(I.value.total)+" entries ",1),k(dt,{pagination:I.value.links,isApiDriven:!0,onPageChanged:Ue},null,8,["pagination"])])):f("",!0)])]),t("div",cl,[t("div",pl,[t("div",ml,[t("div",vl,[t("h5",gl,s(z.value==="Edit"?"Edit Item":"Add New Item"),1),e[45]||(e[45]=t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})])],-1))]),t("div",yl,[t("div",fl,[t("div",bl,[e[46]||(e[46]=t("label",{class:"form-label"},"Product Name",-1)),w(t("input",{"onUpdate:modelValue":e[6]||(e[6]=a=>n.value.name=a),type:"text",class:b(["form-control",{"is-invalid":o.value.name}]),placeholder:"e.g., Chicken Breast"},null,2),[[S,n.value.name]]),o.value.name?(d(),u("small",_l,s(o.value.name[0]),1)):f("",!0)]),t("div",hl,[e[47]||(e[47]=t("label",{class:"form-label"},"Category",-1)),k(h(G),{modelValue:n.value.category_id,"onUpdate:modelValue":[e[7]||(e[7]=a=>n.value.category_id=a),e[8]||(e[8]=a=>n.value.subcategory_id=null)],options:Y.value,optionLabel:"name",optionValue:"id",placeholder:"Select Category",class:b(["w-100 select",{"is-invalid":o.value.category_id}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","class"]),o.value.category_id?(d(),u("small",kl,s(o.value.category_id[0]),1)):f("",!0)]),Q.value.length?(d(),u("div",xl,[e[48]||(e[48]=t("label",{class:"form-label"},"Subcategory",-1)),k(h(G),{modelValue:n.value.subcategory_id,"onUpdate:modelValue":e[9]||(e[9]=a=>n.value.subcategory_id=a),options:Q.value,optionLabel:"name",optionValue:"id",placeholder:"Select Subcategory",class:b(["w-100 select",{"is-invalid":o.value.subcategory_id}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","class"]),o.value.subcategory_id?(d(),u("small",wl,s(o.value.subcategory_id[0]),1)):f("",!0)])):f("",!0),t("div",Sl,[e[49]||(e[49]=t("label",{class:"form-label d-block"},"Minimum Stock Alert Level",-1)),w(t("input",{"onUpdate:modelValue":e[10]||(e[10]=a=>n.value.minAlert=a),type:"number",min:"0",class:b(["form-control",{"is-invalid":o.value.minAlert}]),placeholder:"e.g., 5"},null,2),[[S,n.value.minAlert]]),o.value.minAlert?(d(),u("small",Cl,s(o.value.minAlert[0]),1)):f("",!0)]),t("div",Il,[e[50]||(e[50]=t("label",{class:"form-label"},"Unit Type",-1)),k(h(G),{modelValue:n.value.unit_id,"onUpdate:modelValue":e[11]||(e[11]=a=>n.value.unit_id=a),options:V.units,optionLabel:"name",optionValue:"id",placeholder:"Select Unit",class:b(["w-100 select",{"is-invalid":o.value.unit_id}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","class"]),o.value.unit_id?(d(),u("small",Vl,s(o.value.unit_id[0]),1)):f("",!0)]),t("div",Al,[e[51]||(e[51]=t("label",{class:"form-label"},"Preferred Supplier",-1)),k(h(G),{modelValue:n.value.supplier_id,"onUpdate:modelValue":e[12]||(e[12]=a=>n.value.supplier_id=a),options:V.suppliers,optionLabel:"name",optionValue:"id",placeholder:"Select Supplier",class:b(["w-100 select",{"is-invalid":o.value.supplier_id}]),appendTo:"self",autoZIndex:!0,baseZIndex:2e3},null,8,["modelValue","options","class"]),o.value.supplier_id?(d(),u("small",Ml,s(o.value.supplier_id[0]),1)):f("",!0)]),t("div",Fl,[e[52]||(e[52]=t("label",{class:"form-label"},"SKU (Optional)",-1)),w(t("input",{"onUpdate:modelValue":e[13]||(e[13]=a=>n.value.sku=a),type:"text",class:b(["form-control",{"is-invalid":o.value.sku}]),placeholder:"Stock Keeping Unit"},null,2),[[S,n.value.sku]]),o.value.sku?(d(),u("small",Ul,s(o.value.sku[0]),1)):f("",!0)]),t("div",$l,[e[53]||(e[53]=t("label",{class:"form-label"},"Description",-1)),w(t("textarea",{"onUpdate:modelValue":e[14]||(e[14]=a=>n.value.description=a),rows:"4",class:b(["form-control",{"is-invalid":o.value.description}]),placeholder:"Notes about this product"},null,2),[[S,n.value.description]]),o.value.description?(d(),u("small",El,s(o.value.description[0]),1)):f("",!0)])]),e[63]||(e[63]=t("h6",{class:"mb-3"}," Nutrition Information (per unit) ",-1)),t("div",ql,[t("div",Dl,[e[54]||(e[54]=t("label",{class:"form-label"},"Calories",-1)),w(t("input",{"onUpdate:modelValue":e[15]||(e[15]=a=>n.value.nutrition.calories=a),type:"number",min:"0",class:b(["form-control",{"is-invalid":o.value["nutrition.calories"]}])},null,2),[[S,n.value.nutrition.calories]]),o.value["nutrition.calories"]?(d(),u("small",Pl,s(o.value["nutrition.calories"][0]),1)):f("",!0)]),t("div",Nl,[e[55]||(e[55]=t("label",{class:"form-label"},"Fat (g)",-1)),w(t("input",{"onUpdate:modelValue":e[16]||(e[16]=a=>n.value.nutrition.fat=a),type:"number",min:"0",class:b(["form-control",{"is-invalid":o.value["nutrition.fat"]}])},null,2),[[S,n.value.nutrition.fat]]),o.value["nutrition.fat"]?(d(),u("small",jl,s(o.value["nutrition.fat"][0]),1)):f("",!0)]),t("div",Ol,[e[56]||(e[56]=t("label",{class:"form-label"},"Protein (g)",-1)),w(t("input",{"onUpdate:modelValue":e[17]||(e[17]=a=>n.value.nutrition.protein=a),type:"number",min:"0",class:b(["form-control",{"is-invalid":o.value["nutrition.protein"]}])},null,2),[[S,n.value.nutrition.protein]]),o.value["nutrition.protein"]?(d(),u("small",Tl,s(o.value["nutrition.protein"][0]),1)):f("",!0)]),t("div",Ll,[e[57]||(e[57]=t("label",{class:"form-label"},"Carbs (g)",-1)),w(t("input",{"onUpdate:modelValue":e[18]||(e[18]=a=>n.value.nutrition.carbs=a),type:"number",min:"0",class:b(["form-control",{"is-invalid":o.value["nutrition.carbs"]}])},null,2),[[S,n.value.nutrition.carbs]]),o.value["nutrition.carbs"]?(d(),u("small",Bl,s(o.value["nutrition.carbs"][0]),1)):f("",!0)])]),t("div",Rl,[t("div",Ql,[e[58]||(e[58]=t("label",{class:"form-label d-block"},"Allergies",-1)),k(h(Ce),{modelValue:n.value.allergies,"onUpdate:modelValue":e[19]||(e[19]=a=>n.value.allergies=a),options:V.allergies,optionLabel:"name",optionValue:"id",filter:"",placeholder:"Select Allergies",class:b(["w-full md:w-80 select",{"is-invalid":o.value.allergies}]),appendTo:"self",display:"chip"},null,8,["modelValue","options","class"]),o.value.allergies?(d(),u("small",Hl,s(o.value.allergies[0]),1)):f("",!0)]),t("div",Kl,[e[59]||(e[59]=t("label",{class:"form-label d-block"},"Tags (Halal, Haram, etc.)",-1)),k(h(Ce),{modelValue:n.value.tags,"onUpdate:modelValue":e[20]||(e[20]=a=>n.value.tags=a),options:V.tags,optionLabel:"name",optionValue:"id",filter:"",placeholder:"Select Tags",class:b(["w-full md:w-80 select",{"is-invalid":o.value.tags}]),appendTo:"self",display:"chip"},null,8,["modelValue","options","class"]),o.value.tags?(d(),u("small",zl,s(o.value.tags[0]),1)):f("",!0)])]),t("div",Zl,[t("div",{class:b(["logo-card",{"is-invalid":o.value.image}])},[t("div",{class:"logo-frame",onClick:e[21]||(e[21]=a=>n.value.imageUrl&&Ge())},[n.value.imageUrl?(d(),u("img",{key:0,src:n.value.imageUrl,alt:"Image"},null,8,Xl)):(d(),u("div",Gl,[...e[60]||(e[60]=[t("i",{class:"bi bi-image"},null,-1)])]))]),e[61]||(e[61]=t("small",{class:"text-muted mt-2 d-block"},"Upload Image",-1)),k(ut,{show:ye.value,onClose:e[22]||(e[22]=a=>ye.value=!1),onCropped:We},null,8,["show"])],2),o.value.image?(d(),u("small",Wl,s(o.value.image[0]),1)):f("",!0)]),t("div",Yl,[t("button",{class:"btn btn-primary btn-sm rounded-pill px-5 py-2",disabled:te.value,onClick:De},[te.value?(d(),u(O,{key:0},[e[62]||(e[62]=t("span",{class:"spinner-border spinner-border-sm me-2"},null,-1)),ie(" "+s((z.value==="Edit","Saving...")),1)],64)):(d(),u(O,{key:1},[ie(s((z.value==="Edit","Save")),1)],64))],8,Jl),t("button",{class:"btn btn-secondary rounded-pill px-4 ms-2","data-bs-dismiss":"modal",onClick:se}," Cancel ")])])])])]),t("div",ea,[t("div",ta,[t("div",la,[t("div",aa,[t("div",oa,[e[65]||(e[65]=t("i",{class:"bi bi-box-seam text-primary fs-4"},null,-1)),t("div",null,[e[64]||(e[64]=t("h5",{class:"modal-title fw-semibold mb-0"}," View Inventory Item ",-1)),_.value?.sku?(d(),u("small",sa,"SKU: "+s(_.value.sku),1)):f("",!0)])]),e[66]||(e[66]=t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})])],-1))]),t("div",na,[_.value?(d(),u("div",ia,[t("div",ra,[t("div",da,[t("div",ua,[t("h5",ca,s(_.value.name),1),t("p",pa," SKU: "+s(_.value.sku),1),t("div",ma,[t("div",va,[e[67]||(e[67]=t("div",{class:"text-muted"}," Category ",-1)),t("div",ga,s(_.value.category_name||"‚Äî"),1)]),t("div",ya,[e[68]||(e[68]=t("div",{class:"text-muted"}," Unit ",-1)),t("div",fa,s(_.value.unit_name),1)]),t("div",ba,[e[69]||(e[69]=t("div",{class:"text-muted"}," Min Alert ",-1)),t("div",_a,s(_.value.minAlert),1)]),t("div",ha,[e[70]||(e[70]=t("div",{class:"text-muted"}," Supplier ",-1)),t("div",ka,s(_.value.supplier_name),1)]),t("div",xa,[e[71]||(e[71]=t("div",{class:"text-muted"}," Description ",-1)),t("div",wa,s(_.value.description||"‚Äî"),1)])]),e[72]||(e[72]=t("h6",{class:"fw-semibold"}," Nutrition (per 100g) ",-1)),t("div",Sa,[t("span",Ca,"Calories: "+s(_.value.nutrition?.calories??"‚Äî"),1),t("span",Ia,"Protein: "+s(_.value.nutrition?.protein??"‚Äî"),1),t("span",Va,"Fat: "+s(_.value.nutrition?.fat??"‚Äî"),1),t("span",Aa,"Carbs: "+s(_.value.nutrition?.carbs??"‚Äî"),1)]),e[73]||(e[73]=t("hr",null,null,-1)),e[74]||(e[74]=t("h6",{class:"fw-semibold"},"Tags",-1)),t("div",Ma,[(d(!0),u(O,null,X(_.value.tags,a=>(d(),u("span",{key:a,class:"badge rounded-pill bg-info text-white"},s(a),1))),128))]),e[75]||(e[75]=t("hr",null,null,-1)),e[76]||(e[76]=t("h6",{class:"fw-semibold"}," Allergies ",-1)),t("div",Fa,[(d(!0),u(O,null,X(_.value.allergies,a=>(d(),u("span",{key:a,class:"badge rounded-pill bg-danger text-white"},s(a),1))),128))])])])]),t("div",Ua,[t("div",$a,[t("div",Ea,[_.value.image_url?(d(),u("div",qa,[t("img",{src:_.value.image_url,alt:"Item Image",class:"w-100 rounded-3",style:{"object-fit":"cover"}},null,8,Da)])):f("",!0)]),t("div",Pa,[e[77]||(e[77]=t("span",{class:"text-muted"},"Stocked In",-1)),t("span",Na,s(le.value.availableQty),1)]),t("div",ja,[e[78]||(e[78]=t("span",{class:"text-muted"},"Updated On",-1)),t("span",Oa,s(h(D)(_.value.updated_at)),1)]),t("div",Ta,[e[79]||(e[79]=t("span",{class:"text-muted"},"Added By",-1)),t("span",La,s(_.value.user),1)])])])])):f("",!0),t("div",Ba,[e[84]||(e[84]=t("div",{class:"card-header bg-white d-flex justify-content-between align-items-center"},[t("h5",{class:"mb-0"},"Stock History")],-1)),t("div",Ra,[t("table",Qa,[e[83]||(e[83]=t("thead",{class:"table-primary"},[t("tr",null,[t("th",{style:{width:"80px"}},"S.#"),t("th",null,"Qty"),t("th",null,"Price"),t("th",null,"Value"),t("th",null,"Description"),t("th",null,"Purchase Date"),t("th",null,"Expiry Date"),t("th",{class:"text-center"}," Status ")])],-1)),t("tbody",null,[(d(!0),u(O,null,X(Z.value,(a,v)=>(d(),u("tr",{key:a.id},[t("td",Ha,s(v+1),1),t("td",null,s(a.quantity),1),t("td",null,s(h(T)(a.price)),1),t("td",Ka,s(h(T)(a.value)),1),t("td",za,s(a.description||"‚Äî"),1),t("td",Za,s(h(D)(a.purchase_date)),1),t("td",Xa,s(h(D)(a.expiry_date)),1),t("td",Ga,[t("span",{style:{"min-width":"100px"},class:b(["badge rounded-pill d-inline-block text-center",et(a.status)])},s(Je(a.status)),3)])]))),128)),Z.value.length?f("",!0):(d(),u("tr",Wa,[...e[80]||(e[80]=[t("td",{colspan:"9",class:"text-center text-muted py-4"}," No items found. ",-1)])]))]),t("tfoot",null,[t("tr",null,[e[81]||(e[81]=t("th",null,"Totals",-1)),t("th",null,s(le.value.totalQty),1),t("th",null,s(h(T)(le.value.totalPrice)),1),t("th",Ya,s(h(T)(le.value.totalValue)),1),e[82]||(e[82]=t("th",{colspan:"4"},null,-1))])])])])])])])])]),t("div",Ja,[t("div",eo,[t("div",to,[t("div",lo,[t("h5",ao," Stock In: "+s(p.value.name),1),t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close",onClick:ge},[...e[85]||(e[85]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",oo,[t("div",so,[t("div",no,[e[86]||(e[86]=t("label",{class:"form-label"},"Product Name",-1)),w(t("input",{type:"text","onUpdate:modelValue":e[23]||(e[23]=a=>p.value.name=a),class:b(["form-control",{"is-invalid":o.value.name}]),readonly:""},null,2),[[S,p.value.name]]),o.value.name?(d(),u("small",io,s(o.value.name[0]),1)):f("",!0)]),t("div",ro,[e[87]||(e[87]=t("label",{class:"form-label"},"Category",-1)),t("input",{type:"text",value:Te.value,class:"form-control",readonly:""},null,8,uo),o.value.category_id?(d(),u("small",co,s(o.value.category_id[0]),1)):f("",!0)]),t("div",po,[e[88]||(e[88]=t("label",{class:"form-label"},"Supplier",-1)),k(h(G),{modelValue:p.value.supplier_id,"onUpdate:modelValue":e[24]||(e[24]=a=>p.value.supplier_id=a),options:V.suppliers,optionLabel:"name",optionValue:"id",placeholder:"Select Supplier",class:b(["w-100",{"is-invalid":o.value.supplier_id}]),appendTo:"self"},null,8,["modelValue","options","class"]),o.value.supplier_id?(d(),u("small",mo,s(o.value.supplier_id[0]),1)):f("",!0)]),t("div",vo,[e[89]||(e[89]=t("label",{class:"form-label"},"Available Quantity",-1)),w(t("input",{type:"number","onUpdate:modelValue":e[25]||(e[25]=a=>p.value.available_quantity=a),class:"form-control",readonly:""},null,512),[[S,p.value.available_quantity]])]),t("div",go,[e[90]||(e[90]=t("label",{class:"form-label"},"Quantity",-1)),w(t("input",{type:"number","onUpdate:modelValue":e[26]||(e[26]=a=>p.value.quantity=a),class:b(["form-control",{"is-invalid":o.value.quantity}]),min:"0",onInput:e[27]||(e[27]=a=>K())},null,34),[[S,p.value.quantity]]),o.value.quantity?(d(),u("small",yo,s(o.value.quantity[0]),1)):f("",!0)]),t("div",fo,[e[91]||(e[91]=t("label",{class:"form-label"},"Price",-1)),w(t("input",{type:"number","onUpdate:modelValue":e[28]||(e[28]=a=>p.value.price=a),class:b(["form-control",{"is-invalid":o.value.price}]),min:"0",onInput:e[29]||(e[29]=a=>K())},null,34),[[S,p.value.price]]),o.value.price?(d(),u("small",bo,s(o.value.price[0]),1)):f("",!0)]),t("div",_o,[e[92]||(e[92]=t("label",{class:"form-label"},"Value",-1)),w(t("input",{type:"text","onUpdate:modelValue":e[30]||(e[30]=a=>p.value.value=a),class:"form-control",readonly:""},null,512),[[S,p.value.value]])]),t("div",ho,[e[93]||(e[93]=t("label",{class:"form-label"},"Expiry Date",-1)),k(i,{modelValue:p.value.expiry_date,"onUpdate:modelValue":e[31]||(e[31]=a=>p.value.expiry_date=a),format:h(D),"min-date":new Date,class:b({"is-invalid":o.value.expiry_date}),enableTimePicker:!1,placeholder:"Select date"},null,8,["modelValue","format","min-date","class"]),o.value.expiry_date?(d(),u("small",ko,s(o.value.expiry_date[0]),1)):f("",!0)]),t("div",xo,[e[94]||(e[94]=t("label",{class:"form-label"},"Notes / Reason",-1)),w(t("textarea",{"onUpdate:modelValue":e[32]||(e[32]=a=>p.value.description=a),rows:"3",class:"form-control"},null,512),[[S,p.value.description]])])]),t("div",wo,[t("button",{class:"d-flex align-items-center justify-content-center gap-2 px-4 py-2 rounded-pill btn btn-primary text-white",disabled:E.value,onClick:je},[E.value?(d(),u("span",Co)):f("",!0),t("span",null,s(E.value?"Saving...":"Stock In"),1)],8,So)])])])])]),t("div",Io,[t("div",Vo,[t("div",Ao,[t("div",Mo,[t("h5",Fo," Stock Out : "+s(p.value.name),1),t("button",{class:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100 transition transform hover:scale-110","data-bs-dismiss":"modal","aria-label":"Close",title:"Close",onClick:ge},[...e[95]||(e[95]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",Uo,[t("div",$o,[t("div",Eo,[e[96]||(e[96]=t("label",{class:"form-label"},"Product Name",-1)),w(t("input",{type:"text","onUpdate:modelValue":e[33]||(e[33]=a=>p.value.name=a),class:"form-control",readonly:""},null,512),[[S,p.value.name]])]),t("div",qo,[e[97]||(e[97]=t("label",{class:"form-label"},"Category",-1)),t("input",{type:"text",value:Oe.value,class:"form-control",readonly:""},null,8,Do),o.value.category_id?(d(),u("small",Po,s(o.value.category_id[0]),1)):f("",!0)]),t("div",No,[e[98]||(e[98]=t("label",{class:"form-label"},"Available Quantity",-1)),w(t("input",{type:"number","onUpdate:modelValue":e[34]||(e[34]=a=>p.value.available_quantity=a),class:"form-control",readonly:""},null,512),[[S,p.value.available_quantity]])]),t("div",jo,[e[99]||(e[99]=t("label",{class:"form-label"},"Quantity",-1)),w(t("input",{type:"number","onUpdate:modelValue":e[35]||(e[35]=a=>p.value.quantity=a),class:b(["form-control",{"is-invalid":o.value.quantity}]),min:"0",onInput:e[36]||(e[36]=a=>K())},null,34),[[S,p.value.quantity]]),o.value.quantity?(d(),u("small",Oo,s(o.value.quantity[0]),1)):f("",!0)]),t("div",To,[e[100]||(e[100]=t("label",{class:"form-label"},"Notes / Reason",-1)),w(t("textarea",{"onUpdate:modelValue":e[37]||(e[37]=a=>p.value.description=a),rows:"3",class:"form-control"},null,512),[[S,p.value.description]])])]),t("div",Lo,[t("button",{class:"d-flex align-items-center gap-1 px-4 py-2 rounded-pill btn btn-danger text-white",disabled:E.value,onClick:Qe}," Stock Out ",8,Bo)])])])])])])]),_:1})}}},ms=Ie(Ro,[["__scopeId","data-v-8d1b3c53"]]);export{ms as default};
